import{e as Gs}from"../app.c9c0b13e.js";function ga(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}function Bs(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}var Xs={value:()=>{}};function xn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Bn(n)}function Bn(e){this._=e}function Zs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Bn.prototype=xn.prototype={constructor:Bn,on:function(e,t){var n=this._,r=Zs(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Ys(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=va(n[i],e.name,t);else if(t==null)for(i in n)n[i]=va(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Bn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Ys(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function va(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Xs,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Vr="http://www.w3.org/1999/xhtml";const _a={svg:"http://www.w3.org/2000/svg",xhtml:Vr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _r(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_a.hasOwnProperty(t)?{space:_a[t],local:e}:e}function Js(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Vr&&t.documentElement.namespaceURI===Vr?t.createElement(e):t.createElementNS(n,e)}}function Ws(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function yo(e){var t=_r(e);return(t.local?Ws:Js)(t)}function Qs(){}function oi(e){return e==null?Qs:function(){return this.querySelector(e)}}function el(e){typeof e!="function"&&(e=oi(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),l,u,c=0;c<o;++c)(l=a[c])&&(u=e.call(l,l.__data__,c,a))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new De(r,this._parents)}function tl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function nl(){return[]}function go(e){return e==null?nl:function(){return this.querySelectorAll(e)}}function rl(e){return function(){return tl(e.apply(this,arguments))}}function il(e){typeof e=="function"?e=rl(e):e=go(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&(r.push(e.call(l,l.__data__,u,o)),i.push(l));return new De(r,i)}function vo(e){return function(){return this.matches(e)}}function _o(e){return function(t){return t.matches(e)}}var al=Array.prototype.find;function ol(e){return function(){return al.call(this.children,e)}}function sl(){return this.firstElementChild}function ll(e){return this.select(e==null?sl:ol(typeof e=="function"?e:_o(e)))}var ul=Array.prototype.filter;function cl(){return Array.from(this.children)}function fl(e){return function(){return ul.call(this.children,e)}}function dl(e){return this.selectAll(e==null?cl:fl(typeof e=="function"?e:_o(e)))}function hl(e){typeof e!="function"&&(e=vo(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&e.call(l,l.__data__,u,a)&&s.push(l);return new De(r,this._parents)}function $o(e){return new Array(e.length)}function pl(){return new De(this._enter||this._groups.map($o),this._parents)}function rr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rr.prototype={constructor:rr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ml(e){return function(){return e}}function yl(e,t,n,r,i,a){for(var o=0,s,l=t.length,u=a.length;o<u;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new rr(e,a[o]);for(;o<l;++o)(s=t[o])&&(i[o]=s)}function gl(e,t,n,r,i,a,o){var s,l,u=new Map,c=t.length,d=a.length,y=new Array(c),p;for(s=0;s<c;++s)(l=t[s])&&(y[s]=p=o.call(l,l.__data__,s,t)+"",u.has(p)?i[s]=l:u.set(p,l));for(s=0;s<d;++s)p=o.call(e,a[s],s,a)+"",(l=u.get(p))?(r[s]=l,l.__data__=a[s],u.delete(p)):n[s]=new rr(e,a[s]);for(s=0;s<c;++s)(l=t[s])&&u.get(y[s])===l&&(i[s]=l)}function vl(e){return e.__data__}function _l(e,t){if(!arguments.length)return Array.from(this,vl);var n=t?gl:yl,r=this._parents,i=this._groups;typeof e!="function"&&(e=ml(e));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],d=i[u],y=d.length,p=$l(e.call(c,c&&c.__data__,u,r)),$=p.length,_=s[u]=new Array($),m=o[u]=new Array($),f=l[u]=new Array(y);n(c,d,_,m,f,p,t);for(var w=0,x=0,g,C;w<$;++w)if(g=_[w]){for(w>=x&&(x=w+1);!(C=m[x])&&++x<$;);g._next=C||null}}return o=new De(o,r),o._enter=s,o._exit=l,o}function $l(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wl(){return new De(this._exit||this._groups.map($o),this._parents)}function bl(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function El(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u=n[l],c=r[l],d=u.length,y=s[l]=new Array(d),p,$=0;$<d;++$)(p=u[$]||c[$])&&(y[$]=p);for(;l<i;++l)s[l]=n[l];return new De(s,this._parents)}function Sl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function xl(e){e||(e=Nl);function t(d,y){return d&&y?e(d.__data__,y.__data__):!d-!y}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,l=i[a]=new Array(s),u,c=0;c<s;++c)(u=o[c])&&(l[c]=u);l.sort(t)}return new De(i,this._parents).order()}function Nl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function kl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Pl(){return Array.from(this)}function Tl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Cl(){let e=0;for(const t of this)++e;return e}function Al(){return!this.node()}function Ol(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function Rl(e){return function(){this.removeAttribute(e)}}function Ml(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dl(e,t){return function(){this.setAttribute(e,t)}}function Il(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function jl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function zl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Vl(e,t){var n=_r(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Ml:Rl:typeof t=="function"?n.local?zl:jl:n.local?Il:Dl)(n,t))}function wo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Fl(e){return function(){this.style.removeProperty(e)}}function Ll(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ql(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ul(e,t,n){return arguments.length>1?this.each((t==null?Fl:typeof t=="function"?ql:Ll)(e,t,n==null?"":n)):Ht(this.node(),e)}function Ht(e,t){return e.style.getPropertyValue(t)||wo(e).getComputedStyle(e,null).getPropertyValue(t)}function Hl(e){return function(){delete this[e]}}function Kl(e,t){return function(){this[e]=t}}function Gl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Bl(e,t){return arguments.length>1?this.each((t==null?Hl:typeof t=="function"?Gl:Kl)(e,t)):this.node()[e]}function bo(e){return e.trim().split(/^|\s+/)}function si(e){return e.classList||new Eo(e)}function Eo(e){this._node=e,this._names=bo(e.getAttribute("class")||"")}Eo.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function So(e,t){for(var n=si(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function xo(e,t){for(var n=si(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Xl(e){return function(){So(this,e)}}function Zl(e){return function(){xo(this,e)}}function Yl(e,t){return function(){(t.apply(this,arguments)?So:xo)(this,e)}}function Jl(e,t){var n=bo(e+"");if(arguments.length<2){for(var r=si(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Yl:t?Xl:Zl)(n,t))}function Wl(){this.textContent=""}function Ql(e){return function(){this.textContent=e}}function eu(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function tu(e){return arguments.length?this.each(e==null?Wl:(typeof e=="function"?eu:Ql)(e)):this.node().textContent}function nu(){this.innerHTML=""}function ru(e){return function(){this.innerHTML=e}}function iu(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function au(e){return arguments.length?this.each(e==null?nu:(typeof e=="function"?iu:ru)(e)):this.node().innerHTML}function ou(){this.nextSibling&&this.parentNode.appendChild(this)}function su(){return this.each(ou)}function lu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uu(){return this.each(lu)}function cu(e){var t=typeof e=="function"?e:yo(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function fu(){return null}function du(e,t){var n=typeof e=="function"?e:yo(e),r=t==null?fu:typeof t=="function"?t:oi(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function hu(){var e=this.parentNode;e&&e.removeChild(this)}function pu(){return this.each(hu)}function mu(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function gu(e){return this.select(e?yu:mu)}function vu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function _u(e){return function(t){e.call(this,t,this.__data__)}}function $u(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function wu(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function bu(e,t,n){return function(){var r=this.__on,i,a=_u(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Eu(e,t,n){var r=$u(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?bu:wu,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function No(e,t,n){var r=wo(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Su(e,t){return function(){return No(this,e,t)}}function xu(e,t){return function(){return No(this,e,t.apply(this,arguments))}}function Nu(e,t){return this.each((typeof t=="function"?xu:Su)(e,t))}function*ku(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var ko=[null];function De(e,t){this._groups=e,this._parents=t}function Nn(){return new De([[document.documentElement]],ko)}function Pu(){return this}De.prototype=Nn.prototype={constructor:De,select:el,selectAll:il,selectChild:ll,selectChildren:dl,filter:hl,data:_l,enter:pl,exit:wl,join:bl,merge:El,selection:Pu,order:Sl,sort:xl,call:kl,nodes:Pl,node:Tl,size:Cl,empty:Al,each:Ol,attr:Vl,style:Ul,property:Bl,classed:Jl,text:tu,html:au,raise:su,lower:uu,append:cu,insert:du,remove:pu,clone:gu,datum:vu,on:Eu,dispatch:Nu,[Symbol.iterator]:ku};function xe(e){return typeof e=="string"?new De([[document.querySelector(e)]],[document.documentElement]):new De([[e]],ko)}function Tu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function it(e,t){if(e=Tu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Cu={passive:!1},_n={capture:!0,passive:!1};function Tr(e){e.stopImmediatePropagation()}function Ft(e){e.preventDefault(),e.stopImmediatePropagation()}function Po(e){var t=e.document.documentElement,n=xe(e).on("dragstart.drag",Ft,_n);"onselectstart"in t?n.on("selectstart.drag",Ft,_n):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function To(e,t){var n=e.document.documentElement,r=xe(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ft,_n),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const jn=e=>()=>e;function Fr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:o,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Fr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Au(e){return!e.ctrlKey&&!e.button}function Ou(){return this.parentNode}function Ru(e,t){return t==null?{x:e.x,y:e.y}:t}function Mu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Du(){var e=Au,t=Ou,n=Ru,r=Mu,i={},a=xn("start","drag","end"),o=0,s,l,u,c,d=0;function y(g){g.on("mousedown.drag",p).filter(r).on("touchstart.drag",m).on("touchmove.drag",f,Cu).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(g,C){if(!(c||!e.call(this,g,C))){var S=x(this,t.call(this,g,C),g,C,"mouse");!S||(xe(g.view).on("mousemove.drag",$,_n).on("mouseup.drag",_,_n),Po(g.view),Tr(g),u=!1,s=g.clientX,l=g.clientY,S("start",g))}}function $(g){if(Ft(g),!u){var C=g.clientX-s,S=g.clientY-l;u=C*C+S*S>d}i.mouse("drag",g)}function _(g){xe(g.view).on("mousemove.drag mouseup.drag",null),To(g.view,u),Ft(g),i.mouse("end",g)}function m(g,C){if(!!e.call(this,g,C)){var S=g.changedTouches,k=t.call(this,g,C),M=S.length,L,H;for(L=0;L<M;++L)(H=x(this,k,g,C,S[L].identifier,S[L]))&&(Tr(g),H("start",g,S[L]))}}function f(g){var C=g.changedTouches,S=C.length,k,M;for(k=0;k<S;++k)(M=i[C[k].identifier])&&(Ft(g),M("drag",g,C[k]))}function w(g){var C=g.changedTouches,S=C.length,k,M;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),k=0;k<S;++k)(M=i[C[k].identifier])&&(Tr(g),M("end",g,C[k]))}function x(g,C,S,k,M,L){var H=a.copy(),Y=it(L||S,C),Z,ee,T;if((T=n.call(g,new Fr("beforestart",{sourceEvent:S,target:y,identifier:M,active:o,x:Y[0],y:Y[1],dx:0,dy:0,dispatch:H}),k))!=null)return Z=T.x-Y[0]||0,ee=T.y-Y[1]||0,function V(z,U,X){var J=Y,j;switch(z){case"start":i[M]=V,j=o++;break;case"end":delete i[M],--o;case"drag":Y=it(X||U,C),j=o;break}H.call(z,g,new Fr(z,{sourceEvent:U,subject:T,target:y,identifier:M,active:j,x:Y[0]+Z,y:Y[1]+ee,dx:Y[0]-J[0],dy:Y[1]-J[1],dispatch:H}),k)}}return y.filter=function(g){return arguments.length?(e=typeof g=="function"?g:jn(!!g),y):e},y.container=function(g){return arguments.length?(t=typeof g=="function"?g:jn(g),y):t},y.subject=function(g){return arguments.length?(n=typeof g=="function"?g:jn(g),y):n},y.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:jn(!!g),y):r},y.on=function(){var g=a.on.apply(a,arguments);return g===a?y:g},y.clickDistance=function(g){return arguments.length?(d=(g=+g)*g,y):Math.sqrt(d)},y}function li(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Co(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function kn(){}var $n=.7,ir=1/$n,Lt="\\s*([+-]?\\d+)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Iu=/^#([0-9a-f]{3,8})$/,ju=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),zu=new RegExp(`^rgb\\(${Qe},${Qe},${Qe}\\)$`),Vu=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${wn}\\)$`),Fu=new RegExp(`^rgba\\(${Qe},${Qe},${Qe},${wn}\\)$`),Lu=new RegExp(`^hsl\\(${wn},${Qe},${Qe}\\)$`),qu=new RegExp(`^hsla\\(${wn},${Qe},${Qe},${wn}\\)$`),$a={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};li(kn,bn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:wa,formatHex:wa,formatHex8:Uu,formatHsl:Hu,formatRgb:ba,toString:ba});function wa(){return this.rgb().formatHex()}function Uu(){return this.rgb().formatHex8()}function Hu(){return Ao(this).formatHsl()}function ba(){return this.rgb().formatRgb()}function bn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Iu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Ea(t):n===3?new Ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?zn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?zn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ju.exec(e))?new Ae(t[1],t[2],t[3],1):(t=zu.exec(e))?new Ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Vu.exec(e))?zn(t[1],t[2],t[3],t[4]):(t=Fu.exec(e))?zn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Lu.exec(e))?Na(t[1],t[2]/100,t[3]/100,1):(t=qu.exec(e))?Na(t[1],t[2]/100,t[3]/100,t[4]):$a.hasOwnProperty(e)?Ea($a[e]):e==="transparent"?new Ae(NaN,NaN,NaN,0):null}function Ea(e){return new Ae(e>>16&255,e>>8&255,e&255,1)}function zn(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ae(e,t,n,r)}function Ku(e){return e instanceof kn||(e=bn(e)),e?(e=e.rgb(),new Ae(e.r,e.g,e.b,e.opacity)):new Ae}function Lr(e,t,n,r){return arguments.length===1?Ku(e):new Ae(e,t,n,r==null?1:r)}function Ae(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}li(Ae,Lr,Co(kn,{brighter(e){return e=e==null?ir:Math.pow(ir,e),new Ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?$n:Math.pow($n,e),new Ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ae(xt(this.r),xt(this.g),xt(this.b),ar(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sa,formatHex:Sa,formatHex8:Gu,formatRgb:xa,toString:xa}));function Sa(){return`#${St(this.r)}${St(this.g)}${St(this.b)}`}function Gu(){return`#${St(this.r)}${St(this.g)}${St(this.b)}${St((isNaN(this.opacity)?1:this.opacity)*255)}`}function xa(){const e=ar(this.opacity);return`${e===1?"rgb(":"rgba("}${xt(this.r)}, ${xt(this.g)}, ${xt(this.b)}${e===1?")":`, ${e})`}`}function ar(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function St(e){return e=xt(e),(e<16?"0":"")+e.toString(16)}function Na(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Le(e,t,n,r)}function Ao(e){if(e instanceof Le)return new Le(e.h,e.s,e.l,e.opacity);if(e instanceof kn||(e=bn(e)),!e)return new Le;if(e instanceof Le)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Le(o,s,l,e.opacity)}function Bu(e,t,n,r){return arguments.length===1?Ao(e):new Le(e,t,n,r==null?1:r)}function Le(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}li(Le,Bu,Co(kn,{brighter(e){return e=e==null?ir:Math.pow(ir,e),new Le(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?$n:Math.pow($n,e),new Le(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ae(Cr(e>=240?e-240:e+120,i,r),Cr(e,i,r),Cr(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Le(ka(this.h),Vn(this.s),Vn(this.l),ar(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ar(this.opacity);return`${e===1?"hsl(":"hsla("}${ka(this.h)}, ${Vn(this.s)*100}%, ${Vn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ka(e){return e=(e||0)%360,e<0?e+360:e}function Vn(e){return Math.max(0,Math.min(1,e||0))}function Cr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Oo=e=>()=>e;function Xu(e,t){return function(n){return e+n*t}}function Zu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Yu(e){return(e=+e)==1?Ro:function(t,n){return n-t?Zu(t,n,e):Oo(isNaN(t)?n:t)}}function Ro(e,t){var n=t-e;return n?Xu(e,n):Oo(isNaN(e)?t:e)}const Pa=function e(t){var n=Yu(t);function r(i,a){var o=n((i=Lr(i)).r,(a=Lr(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),u=Ro(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function ht(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var qr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ar=new RegExp(qr.source,"g");function Ju(e){return function(){return e}}function Wu(e){return function(t){return e(t)+""}}function Qu(e,t){var n=qr.lastIndex=Ar.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(r=qr.exec(e))&&(i=Ar.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:ht(r,i)})),n=Ar.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?Wu(l[0].x):Ju(t):(t=l.length,function(u){for(var c=0,d;c<t;++c)s[(d=l[c]).i]=d.x(u);return s.join("")})}var Ta=180/Math.PI,Ur={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Mo(e,t,n,r,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Ta,skewX:Math.atan(l)*Ta,scaleX:o,scaleY:s}}var Fn;function ec(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ur:Mo(t.a,t.b,t.c,t.d,t.e,t.f)}function tc(e){return e==null||(Fn||(Fn=document.createElementNS("http://www.w3.org/2000/svg","g")),Fn.setAttribute("transform",e),!(e=Fn.transform.baseVal.consolidate()))?Ur:(e=e.matrix,Mo(e.a,e.b,e.c,e.d,e.e,e.f))}function Do(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function a(u,c,d,y,p,$){if(u!==d||c!==y){var _=p.push("translate(",null,t,null,n);$.push({i:_-4,x:ht(u,d)},{i:_-2,x:ht(c,y)})}else(d||y)&&p.push("translate("+d+t+y+n)}function o(u,c,d,y){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),y.push({i:d.push(i(d)+"rotate(",null,r)-2,x:ht(u,c)})):c&&d.push(i(d)+"rotate("+c+r)}function s(u,c,d,y){u!==c?y.push({i:d.push(i(d)+"skewX(",null,r)-2,x:ht(u,c)}):c&&d.push(i(d)+"skewX("+c+r)}function l(u,c,d,y,p,$){if(u!==d||c!==y){var _=p.push(i(p)+"scale(",null,",",null,")");$.push({i:_-4,x:ht(u,d)},{i:_-2,x:ht(c,y)})}else(d!==1||y!==1)&&p.push(i(p)+"scale("+d+","+y+")")}return function(u,c){var d=[],y=[];return u=e(u),c=e(c),a(u.translateX,u.translateY,c.translateX,c.translateY,d,y),o(u.rotate,c.rotate,d,y),s(u.skewX,c.skewX,d,y),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,y),u=c=null,function(p){for(var $=-1,_=y.length,m;++$<_;)d[(m=y[$]).i]=m.x(p);return d.join("")}}}var nc=Do(ec,"px, ","px)","deg)"),rc=Do(tc,", ",")",")"),ic=1e-12;function Ca(e){return((e=Math.exp(e))+1/e)/2}function ac(e){return((e=Math.exp(e))-1/e)/2}function oc(e){return((e=Math.exp(2*e))-1)/(e+1)}const sc=function e(t,n,r){function i(a,o){var s=a[0],l=a[1],u=a[2],c=o[0],d=o[1],y=o[2],p=c-s,$=d-l,_=p*p+$*$,m,f;if(_<ic)f=Math.log(y/u)/t,m=function(k){return[s+k*p,l+k*$,u*Math.exp(t*k*f)]};else{var w=Math.sqrt(_),x=(y*y-u*u+r*_)/(2*u*n*w),g=(y*y-u*u-r*_)/(2*y*n*w),C=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(g*g+1)-g);f=(S-C)/t,m=function(k){var M=k*f,L=Ca(C),H=u/(n*w)*(L*oc(t*M+C)-ac(C));return[s+H*p,l+H*$,u*L/Ca(t*M+C)]}}return m.duration=f*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,l=s*s;return e(o,s,l)},i}(Math.SQRT2,2,4);var Kt=0,cn=0,on=0,Io=1e3,or,fn,sr=0,Nt=0,$r=0,En=typeof performance=="object"&&performance.now?performance:Date,jo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ui(){return Nt||(jo(lc),Nt=En.now()+$r)}function lc(){Nt=0}function lr(){this._call=this._time=this._next=null}lr.prototype=ci.prototype={constructor:lr,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ui():+n)+(t==null?0:+t),!this._next&&fn!==this&&(fn?fn._next=this:or=this,fn=this),this._call=e,this._time=n,Hr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Hr())}};function ci(e,t,n){var r=new lr;return r.restart(e,t,n),r}function uc(){ui(),++Kt;for(var e=or,t;e;)(t=Nt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Kt}function Aa(){Nt=(sr=En.now())+$r,Kt=cn=0;try{uc()}finally{Kt=0,fc(),Nt=0}}function cc(){var e=En.now(),t=e-sr;t>Io&&($r-=t,sr=e)}function fc(){for(var e,t=or,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:or=n);fn=e,Hr(r)}function Hr(e){if(!Kt){cn&&(cn=clearTimeout(cn));var t=e-Nt;t>24?(e<1/0&&(cn=setTimeout(Aa,e-En.now()-$r)),on&&(on=clearInterval(on))):(on||(sr=En.now(),on=setInterval(cc,Io)),Kt=1,jo(Aa))}}function Oa(e,t,n){var r=new lr;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var dc=xn("start","end","cancel","interrupt"),hc=[],zo=0,Ra=1,Kr=2,Xn=3,Ma=4,Gr=5,Zn=6;function wr(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;pc(e,n,{name:t,index:r,group:i,on:dc,tween:hc,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:zo})}function fi(e,t){var n=He(e,t);if(n.state>zo)throw new Error("too late; already scheduled");return n}function et(e,t){var n=He(e,t);if(n.state>Xn)throw new Error("too late; already running");return n}function He(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pc(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=ci(a,0,n.time);function a(u){n.state=Ra,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,d,y,p;if(n.state!==Ra)return l();for(c in r)if(p=r[c],p.name===n.name){if(p.state===Xn)return Oa(o);p.state===Ma?(p.state=Zn,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[c]):+c<t&&(p.state=Zn,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[c])}if(Oa(function(){n.state===Xn&&(n.state=Ma,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Kr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Kr){for(n.state=Xn,i=new Array(y=n.tween.length),c=0,d=-1;c<y;++c)(p=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=p);i.length=d+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Gr,1),d=-1,y=i.length;++d<y;)i[d].call(e,c);n.state===Gr&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Zn,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Yn(e,t){var n=e.__transition,r,i,a=!0,o;if(!!n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>Kr&&r.state<Gr,r.state=Zn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function mc(e){return this.each(function(){Yn(this,e)})}function yc(e,t){var n,r;return function(){var i=et(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function gc(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=et(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function vc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=He(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?yc:gc)(n,e,t))}function di(e,t,n){var r=e._id;return e.each(function(){var i=et(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return He(i,r).value[t]}}function Vo(e,t){var n;return(typeof t=="number"?ht:t instanceof bn?Pa:(n=bn(t))?(t=n,Pa):Qu)(e,t)}function _c(e){return function(){this.removeAttribute(e)}}function $c(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wc(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function bc(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function Ec(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function Sc(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function xc(e,t){var n=_r(e),r=n==="transform"?rc:Vo;return this.attrTween(e,typeof t=="function"?(n.local?Sc:Ec)(n,r,di(this,"attr."+e,t)):t==null?(n.local?$c:_c)(n):(n.local?bc:wc)(n,r,t))}function Nc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function kc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Pc(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&kc(e,a)),n}return i._value=t,i}function Tc(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Nc(e,a)),n}return i._value=t,i}function Cc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=_r(e);return this.tween(n,(r.local?Pc:Tc)(r,t))}function Ac(e,t){return function(){fi(this,e).delay=+t.apply(this,arguments)}}function Oc(e,t){return t=+t,function(){fi(this,e).delay=t}}function Rc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ac:Oc)(t,e)):He(this.node(),t).delay}function Mc(e,t){return function(){et(this,e).duration=+t.apply(this,arguments)}}function Dc(e,t){return t=+t,function(){et(this,e).duration=t}}function Ic(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Mc:Dc)(t,e)):He(this.node(),t).duration}function jc(e,t){if(typeof t!="function")throw new Error;return function(){et(this,e).ease=t}}function zc(e){var t=this._id;return arguments.length?this.each(jc(t,e)):He(this.node(),t).ease}function Vc(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;et(this,e).ease=n}}function Fc(e){if(typeof e!="function")throw new Error;return this.each(Vc(this._id,e))}function Lc(e){typeof e!="function"&&(e=vo(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&e.call(l,l.__data__,u,a)&&s.push(l);return new ut(r,this._parents,this._name,this._id)}function qc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=t[s],u=n[s],c=l.length,d=o[s]=new Array(c),y,p=0;p<c;++p)(y=l[p]||u[p])&&(d[p]=y);for(;s<r;++s)o[s]=t[s];return new ut(o,this._parents,this._name,this._id)}function Uc(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Hc(e,t,n){var r,i,a=Uc(t)?fi:et;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function Kc(e,t){var n=this._id;return arguments.length<2?He(this.node(),n).on.on(e):this.each(Hc(n,e,t))}function Gc(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Bc(){return this.on("end.remove",Gc(this._id))}function Xc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=oi(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],l=s.length,u=a[o]=new Array(l),c,d,y=0;y<l;++y)(c=s[y])&&(d=e.call(c,c.__data__,y,s))&&("__data__"in c&&(d.__data__=c.__data__),u[y]=d,wr(u[y],t,n,y,u,He(c,n)));return new ut(a,this._parents,t,n)}function Zc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=go(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,d=0;d<u;++d)if(c=l[d]){for(var y=e.call(c,c.__data__,d,l),p,$=He(c,n),_=0,m=y.length;_<m;++_)(p=y[_])&&wr(p,t,n,_,y,$);a.push(y),o.push(c)}return new ut(a,o,t,n)}var Yc=Nn.prototype.constructor;function Jc(){return new Yc(this._groups,this._parents)}function Wc(e,t){var n,r,i;return function(){var a=Ht(this,e),o=(this.style.removeProperty(e),Ht(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function Fo(e){return function(){this.style.removeProperty(e)}}function Qc(e,t,n){var r,i=n+"",a;return function(){var o=Ht(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function ef(e,t,n){var r,i,a;return function(){var o=Ht(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),Ht(this,e))),o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s))}}function tf(e,t){var n,r,i,a="style."+t,o="end."+a,s;return function(){var l=et(this,e),u=l.on,c=l.value[a]==null?s||(s=Fo(t)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(o,i=c),l.on=r}}function nf(e,t,n){var r=(e+="")=="transform"?nc:Vo;return t==null?this.styleTween(e,Wc(e,r)).on("end.style."+e,Fo(e)):typeof t=="function"?this.styleTween(e,ef(e,r,di(this,"style."+e,t))).each(tf(this._id,e)):this.styleTween(e,Qc(e,r,t),n).on("end.style."+e,null)}function rf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function af(e,t,n){var r,i;function a(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&rf(e,o,n)),r}return a._value=t,a}function of(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,af(e,t,n==null?"":n))}function sf(e){return function(){this.textContent=e}}function lf(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function uf(e){return this.tween("text",typeof e=="function"?lf(di(this,"text",e)):sf(e==null?"":e+""))}function cf(e){return function(t){this.textContent=e.call(this,t)}}function ff(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&cf(i)),t}return r._value=e,r}function df(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ff(e))}function hf(){for(var e=this._name,t=this._id,n=Lo(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)if(l=o[u]){var c=He(l,t);wr(l,e,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ut(r,this._parents,e,n)}function pf(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){--i===0&&a()}};n.each(function(){var u=et(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),u.on=t}),i===0&&a()})}var mf=0;function ut(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Lo(){return++mf}var rt=Nn.prototype;ut.prototype={constructor:ut,select:Xc,selectAll:Zc,selectChild:rt.selectChild,selectChildren:rt.selectChildren,filter:Lc,merge:qc,selection:Jc,transition:hf,call:rt.call,nodes:rt.nodes,node:rt.node,size:rt.size,empty:rt.empty,each:rt.each,on:Kc,attr:xc,attrTween:Cc,style:nf,styleTween:of,text:uf,textTween:df,remove:Bc,tween:vc,delay:Rc,duration:Ic,ease:zc,easeVarying:Fc,end:pf,[Symbol.iterator]:rt[Symbol.iterator]};function yf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var hi=3;(function e(t){t=+t;function n(r){return Math.pow(r,t)}return n.exponent=e,n})(hi);(function e(t){t=+t;function n(r){return 1-Math.pow(1-r,t)}return n.exponent=e,n})(hi);var gf=function e(t){t=+t;function n(r){return((r*=2)<=1?Math.pow(r,t):2-Math.pow(2-r,t))/2}return n.exponent=e,n}(hi),vf={time:null,delay:0,duration:250,ease:yf};function _f(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function $f(e){var t,n;e instanceof ut?(t=e._id,e=e._name):(t=Lo(),(n=vf).time=ui(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&wr(l,e,t,u,o,n||_f(l,t));return new ut(r,this._parents,e,t)}Nn.prototype.interrupt=mc;Nn.prototype.transition=$f;function wf(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return qo(this.cover(t,n),t,n,e)}function qo(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,l=e._y0,u=e._x1,c=e._y1,d,y,p,$,_,m,f,w;if(!a)return e._root=o,e;for(;a.length;)if((_=t>=(d=(s+u)/2))?s=d:u=d,(m=n>=(y=(l+c)/2))?l=y:c=y,i=a,!(a=a[f=m<<1|_]))return i[f]=o,e;if(p=+e._x.call(null,a.data),$=+e._y.call(null,a.data),t===p&&n===$)return o.next=a,i?i[f]=o:e._root=o,e;do i=i?i[f]=new Array(4):e._root=new Array(4),(_=t>=(d=(s+u)/2))?s=d:u=d,(m=n>=(y=(l+c)/2))?l=y:c=y;while((f=m<<1|_)===(w=($>=y)<<1|p>=d));return i[w]=a,i[f]=o,e}function bf(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),l=1/0,u=1/0,c=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<l&&(l=i),i>c&&(c=i),a<u&&(u=a),a>d&&(d=a));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),n=0;n<r;++n)qo(this,o[n],s[n],e[n]);return this}function Ef(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,l,u;n>e||e>=i||r>t||t>=a;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=s,s=l,o*=2,u){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function Sf(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function xf(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ne(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Nf(e,t,n){var r,i=this._x0,a=this._y0,o,s,l,u,c=this._x1,d=this._y1,y=[],p=this._root,$,_;for(p&&y.push(new Ne(p,i,a,c,d)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,d=t+n,n*=n);$=y.pop();)if(!(!(p=$.node)||(o=$.x0)>c||(s=$.y0)>d||(l=$.x1)<i||(u=$.y1)<a))if(p.length){var m=(o+l)/2,f=(s+u)/2;y.push(new Ne(p[3],m,f,l,u),new Ne(p[2],o,f,m,u),new Ne(p[1],m,s,l,f),new Ne(p[0],o,s,m,f)),(_=(t>=f)<<1|e>=m)&&($=y[y.length-1],y[y.length-1]=y[y.length-1-_],y[y.length-1-_]=$)}else{var w=e-+this._x.call(null,p.data),x=t-+this._y.call(null,p.data),g=w*w+x*x;if(g<n){var C=Math.sqrt(n=g);i=e-C,a=t-C,c=e+C,d=t+C,r=p.data}}return r}function kf(e){if(isNaN(c=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,d,y,p,$,_,m,f;if(!n)return this;if(n.length)for(;;){if(($=c>=(y=(o+l)/2))?o=y:l=y,(_=d>=(p=(s+u)/2))?s=p:u=p,t=n,!(n=n[m=_<<1|$]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,f=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[f]=n:this._root=n),this):(this._root=a,this)}function Pf(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Tf(){return this._root}function Cf(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Af(e){var t=[],n,r=this._root,i,a,o,s,l;for(r&&t.push(new Ne(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,l=n.y1)&&r.length){var u=(a+s)/2,c=(o+l)/2;(i=r[3])&&t.push(new Ne(i,u,c,s,l)),(i=r[2])&&t.push(new Ne(i,a,c,u,l)),(i=r[1])&&t.push(new Ne(i,u,o,s,c)),(i=r[0])&&t.push(new Ne(i,a,o,u,c))}return this}function Of(e){var t=[],n=[],r;for(this._root&&t.push(new Ne(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,l=r.x1,u=r.y1,c=(o+l)/2,d=(s+u)/2;(a=i[0])&&t.push(new Ne(a,o,s,c,d)),(a=i[1])&&t.push(new Ne(a,c,s,l,d)),(a=i[2])&&t.push(new Ne(a,o,d,c,u)),(a=i[3])&&t.push(new Ne(a,c,d,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Rf(e){return e[0]}function Mf(e){return arguments.length?(this._x=e,this):this._x}function Df(e){return e[1]}function If(e){return arguments.length?(this._y=e,this):this._y}function pi(e,t,n){var r=new mi(t==null?Rf:t,n==null?Df:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function mi(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Da(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ke=pi.prototype=mi.prototype;ke.copy=function(){var e=new mi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Da(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Da(r));return e};ke.add=wf;ke.addAll=bf;ke.cover=Ef;ke.data=Sf;ke.extent=xf;ke.find=Nf;ke.remove=kf;ke.removeAll=Pf;ke.root=Tf;ke.size=Cf;ke.visit=Af;ke.visitAfter=Of;ke.x=Mf;ke.y=If;function Me(e){return function(){return e}}function Vt(e){return(e()-.5)*1e-6}function jf(e){return e.index}function Ia(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function zf(e){var t=jf,n=d,r,i=Me(30),a,o,s,l,u,c=1;e==null&&(e=[]);function d(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function y(m){for(var f=0,w=e.length;f<c;++f)for(var x=0,g,C,S,k,M,L,H;x<w;++x)g=e[x],C=g.source,S=g.target,k=S.x+S.vx-C.x-C.vx||Vt(u),M=S.y+S.vy-C.y-C.vy||Vt(u),L=Math.sqrt(k*k+M*M),L=(L-a[x])/L*m*r[x],k*=L,M*=L,S.vx-=k*(H=l[x]),S.vy-=M*H,C.vx+=k*(H=1-H),C.vy+=M*H}function p(){if(!!o){var m,f=o.length,w=e.length,x=new Map(o.map((C,S)=>[t(C,S,o),C])),g;for(m=0,s=new Array(f);m<w;++m)g=e[m],g.index=m,typeof g.source!="object"&&(g.source=Ia(x,g.source)),typeof g.target!="object"&&(g.target=Ia(x,g.target)),s[g.source.index]=(s[g.source.index]||0)+1,s[g.target.index]=(s[g.target.index]||0)+1;for(m=0,l=new Array(w);m<w;++m)g=e[m],l[m]=s[g.source.index]/(s[g.source.index]+s[g.target.index]);r=new Array(w),$(),a=new Array(w),_()}}function $(){if(!!o)for(var m=0,f=e.length;m<f;++m)r[m]=+n(e[m],m,e)}function _(){if(!!o)for(var m=0,f=e.length;m<f;++m)a[m]=+i(e[m],m,e)}return y.initialize=function(m,f){o=m,u=f,p()},y.links=function(m){return arguments.length?(e=m,p(),y):e},y.id=function(m){return arguments.length?(t=m,y):t},y.iterations=function(m){return arguments.length?(c=+m,y):c},y.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Me(+m),$(),y):n},y.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Me(+m),_(),y):i},y}const Vf=1664525,Ff=1013904223,ja=4294967296;function Lf(){let e=1;return()=>(e=(Vf*e+Ff)%ja)/ja}function qf(e){return e.x}function Uf(e){return e.y}var Hf=10,Kf=Math.PI*(3-Math.sqrt(5));function Gf(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,l=ci(d),u=xn("tick","end"),c=Lf();e==null&&(e=[]);function d(){y(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function y(_){var m,f=e.length,w;_===void 0&&(_=1);for(var x=0;x<_;++x)for(n+=(a-n)*i,s.forEach(function(g){g(n)}),m=0;m<f;++m)w=e[m],w.fx==null?w.x+=w.vx*=o:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=o:(w.y=w.fy,w.vy=0);return t}function p(){for(var _=0,m=e.length,f;_<m;++_){if(f=e[_],f.index=_,f.fx!=null&&(f.x=f.fx),f.fy!=null&&(f.y=f.fy),isNaN(f.x)||isNaN(f.y)){var w=Hf*Math.sqrt(.5+_),x=_*Kf;f.x=w*Math.cos(x),f.y=w*Math.sin(x)}(isNaN(f.vx)||isNaN(f.vy))&&(f.vx=f.vy=0)}}function $(_){return _.initialize&&_.initialize(e,c),_}return p(),t={tick:y,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(_){return arguments.length?(e=_,p(),s.forEach($),t):e},alpha:function(_){return arguments.length?(n=+_,t):n},alphaMin:function(_){return arguments.length?(r=+_,t):r},alphaDecay:function(_){return arguments.length?(i=+_,t):+i},alphaTarget:function(_){return arguments.length?(a=+_,t):a},velocityDecay:function(_){return arguments.length?(o=1-_,t):1-o},randomSource:function(_){return arguments.length?(c=_,s.forEach($),t):c},force:function(_,m){return arguments.length>1?(m==null?s.delete(_):s.set(_,$(m)),t):s.get(_)},find:function(_,m,f){var w=0,x=e.length,g,C,S,k,M;for(f==null?f=1/0:f*=f,w=0;w<x;++w)k=e[w],g=_-k.x,C=m-k.y,S=g*g+C*C,S<f&&(M=k,f=S);return M},on:function(_,m){return arguments.length>1?(u.on(_,m),t):u.on(_)}}}function Bf(){var e,t,n,r,i=Me(-30),a,o=1,s=1/0,l=.81;function u(p){var $,_=e.length,m=pi(e,qf,Uf).visitAfter(d);for(r=p,$=0;$<_;++$)t=e[$],m.visit(y)}function c(){if(!!e){var p,$=e.length,_;for(a=new Array($),p=0;p<$;++p)_=e[p],a[_.index]=+i(_,p,e)}}function d(p){var $=0,_,m,f=0,w,x,g;if(p.length){for(w=x=g=0;g<4;++g)(_=p[g])&&(m=Math.abs(_.value))&&($+=_.value,f+=m,w+=m*_.x,x+=m*_.y);p.x=w/f,p.y=x/f}else{_=p,_.x=_.data.x,_.y=_.data.y;do $+=a[_.data.index];while(_=_.next)}p.value=$}function y(p,$,_,m){if(!p.value)return!0;var f=p.x-t.x,w=p.y-t.y,x=m-$,g=f*f+w*w;if(x*x/l<g)return g<s&&(f===0&&(f=Vt(n),g+=f*f),w===0&&(w=Vt(n),g+=w*w),g<o&&(g=Math.sqrt(o*g)),t.vx+=f*p.value*r/g,t.vy+=w*p.value*r/g),!0;if(p.length||g>=s)return;(p.data!==t||p.next)&&(f===0&&(f=Vt(n),g+=f*f),w===0&&(w=Vt(n),g+=w*w),g<o&&(g=Math.sqrt(o*g)));do p.data!==t&&(x=a[p.data.index]*r/g,t.vx+=f*x,t.vy+=w*x);while(p=p.next)}return u.initialize=function(p,$){e=p,n=$,c()},u.strength=function(p){return arguments.length?(i=typeof p=="function"?p:Me(+p),c(),u):i},u.distanceMin=function(p){return arguments.length?(o=p*p,u):Math.sqrt(o)},u.distanceMax=function(p){return arguments.length?(s=p*p,u):Math.sqrt(s)},u.theta=function(p){return arguments.length?(l=p*p,u):Math.sqrt(l)},u}function Xf(e){var t=Me(.1),n,r,i;typeof e!="function"&&(e=Me(e==null?0:+e));function a(s){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*s}function o(){if(!!n){var s,l=n.length;for(r=new Array(l),i=new Array(l),s=0;s<l;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Me(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Me(+s),o(),a):e},a}function Zf(e){var t=Me(.1),n,r,i;typeof e!="function"&&(e=Me(e==null?0:+e));function a(s){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*s}function o(){if(!!n){var s,l=n.length;for(r=new Array(l),i=new Array(l),s=0;s<l;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Me(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:Me(+s),o(),a):e},a}const Ln=e=>()=>e;function Yf(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function at(e,t,n){this.k=e,this.x=t,this.y=n}at.prototype={constructor:at,scale:function(e){return e===1?this:new at(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new at(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var br=new at(1,0,0);at.prototype;function Or(e){e.stopImmediatePropagation()}function sn(e){e.preventDefault(),e.stopImmediatePropagation()}function Jf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Wf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function za(){return this.__zoom||br}function Qf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ed(){return navigator.maxTouchPoints||"ontouchstart"in this}function td(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function nd(){var e=Jf,t=Wf,n=td,r=Qf,i=ed,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],s=250,l=sc,u=xn("start","zoom","end"),c,d,y,p=500,$=150,_=0,m=10;function f(T){T.property("__zoom",za).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",H).filter(i).on("touchstart.zoom",Y).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",ee).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.transform=function(T,V,z,U){var X=T.selection?T.selection():T;X.property("__zoom",za),T!==X?C(T,V,z,U):X.interrupt().each(function(){S(this,arguments).event(U).start().zoom(null,typeof V=="function"?V.apply(this,arguments):V).end()})},f.scaleBy=function(T,V,z,U){f.scaleTo(T,function(){var X=this.__zoom.k,J=typeof V=="function"?V.apply(this,arguments):V;return X*J},z,U)},f.scaleTo=function(T,V,z,U){f.transform(T,function(){var X=t.apply(this,arguments),J=this.__zoom,j=z==null?g(X):typeof z=="function"?z.apply(this,arguments):z,P=J.invert(j),I=typeof V=="function"?V.apply(this,arguments):V;return n(x(w(J,I),j,P),X,o)},z,U)},f.translateBy=function(T,V,z,U){f.transform(T,function(){return n(this.__zoom.translate(typeof V=="function"?V.apply(this,arguments):V,typeof z=="function"?z.apply(this,arguments):z),t.apply(this,arguments),o)},null,U)},f.translateTo=function(T,V,z,U,X){f.transform(T,function(){var J=t.apply(this,arguments),j=this.__zoom,P=U==null?g(J):typeof U=="function"?U.apply(this,arguments):U;return n(br.translate(P[0],P[1]).scale(j.k).translate(typeof V=="function"?-V.apply(this,arguments):-V,typeof z=="function"?-z.apply(this,arguments):-z),J,o)},U,X)};function w(T,V){return V=Math.max(a[0],Math.min(a[1],V)),V===T.k?T:new at(V,T.x,T.y)}function x(T,V,z){var U=V[0]-z[0]*T.k,X=V[1]-z[1]*T.k;return U===T.x&&X===T.y?T:new at(T.k,U,X)}function g(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function C(T,V,z,U){T.on("start.zoom",function(){S(this,arguments).event(U).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(U).end()}).tween("zoom",function(){var X=this,J=arguments,j=S(X,J).event(U),P=t.apply(X,J),I=z==null?g(P):typeof z=="function"?z.apply(X,J):z,A=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),h=X.__zoom,b=typeof V=="function"?V.apply(X,J):V,D=l(h.invert(I).concat(A/h.k),b.invert(I).concat(A/b.k));return function(F){if(F===1)F=b;else{var q=D(F),te=A/q[2];F=new at(te,I[0]-q[0]*te,I[1]-q[1]*te)}j.zoom(null,F)}})}function S(T,V,z){return!z&&T.__zooming||new k(T,V)}function k(T,V){this.that=T,this.args=V,this.active=0,this.sourceEvent=null,this.extent=t.apply(T,V),this.taps=0}k.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,V){return this.mouse&&T!=="mouse"&&(this.mouse[1]=V.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=V.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=V.invert(this.touch1[0])),this.that.__zoom=V,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var V=xe(this.that).datum();u.call(T,this.that,new Yf(T,{sourceEvent:this.sourceEvent,target:f,type:T,transform:this.that.__zoom,dispatch:u}),V)}};function M(T,...V){if(!e.apply(this,arguments))return;var z=S(this,V).event(T),U=this.__zoom,X=Math.max(a[0],Math.min(a[1],U.k*Math.pow(2,r.apply(this,arguments)))),J=it(T);if(z.wheel)(z.mouse[0][0]!==J[0]||z.mouse[0][1]!==J[1])&&(z.mouse[1]=U.invert(z.mouse[0]=J)),clearTimeout(z.wheel);else{if(U.k===X)return;z.mouse=[J,U.invert(J)],Yn(this),z.start()}sn(T),z.wheel=setTimeout(j,$),z.zoom("mouse",n(x(w(U,X),z.mouse[0],z.mouse[1]),z.extent,o));function j(){z.wheel=null,z.end()}}function L(T,...V){if(y||!e.apply(this,arguments))return;var z=T.currentTarget,U=S(this,V,!0).event(T),X=xe(T.view).on("mousemove.zoom",I,!0).on("mouseup.zoom",A,!0),J=it(T,z),j=T.clientX,P=T.clientY;Po(T.view),Or(T),U.mouse=[J,this.__zoom.invert(J)],Yn(this),U.start();function I(h){if(sn(h),!U.moved){var b=h.clientX-j,D=h.clientY-P;U.moved=b*b+D*D>_}U.event(h).zoom("mouse",n(x(U.that.__zoom,U.mouse[0]=it(h,z),U.mouse[1]),U.extent,o))}function A(h){X.on("mousemove.zoom mouseup.zoom",null),To(h.view,U.moved),sn(h),U.event(h).end()}}function H(T,...V){if(!!e.apply(this,arguments)){var z=this.__zoom,U=it(T.changedTouches?T.changedTouches[0]:T,this),X=z.invert(U),J=z.k*(T.shiftKey?.5:2),j=n(x(w(z,J),U,X),t.apply(this,V),o);sn(T),s>0?xe(this).transition().duration(s).call(C,j,U,T):xe(this).call(f.transform,j,U,T)}}function Y(T,...V){if(!!e.apply(this,arguments)){var z=T.touches,U=z.length,X=S(this,V,T.changedTouches.length===U).event(T),J,j,P,I;for(Or(T),j=0;j<U;++j)P=z[j],I=it(P,this),I=[I,this.__zoom.invert(I),P.identifier],X.touch0?!X.touch1&&X.touch0[2]!==I[2]&&(X.touch1=I,X.taps=0):(X.touch0=I,J=!0,X.taps=1+!!c);c&&(c=clearTimeout(c)),J&&(X.taps<2&&(d=I[0],c=setTimeout(function(){c=null},p)),Yn(this),X.start())}}function Z(T,...V){if(!!this.__zooming){var z=S(this,V).event(T),U=T.changedTouches,X=U.length,J,j,P,I;for(sn(T),J=0;J<X;++J)j=U[J],P=it(j,this),z.touch0&&z.touch0[2]===j.identifier?z.touch0[0]=P:z.touch1&&z.touch1[2]===j.identifier&&(z.touch1[0]=P);if(j=z.that.__zoom,z.touch1){var A=z.touch0[0],h=z.touch0[1],b=z.touch1[0],D=z.touch1[1],F=(F=b[0]-A[0])*F+(F=b[1]-A[1])*F,q=(q=D[0]-h[0])*q+(q=D[1]-h[1])*q;j=w(j,Math.sqrt(F/q)),P=[(A[0]+b[0])/2,(A[1]+b[1])/2],I=[(h[0]+D[0])/2,(h[1]+D[1])/2]}else if(z.touch0)P=z.touch0[0],I=z.touch0[1];else return;z.zoom("touch",n(x(j,P,I),z.extent,o))}}function ee(T,...V){if(!!this.__zooming){var z=S(this,V).event(T),U=T.changedTouches,X=U.length,J,j;for(Or(T),y&&clearTimeout(y),y=setTimeout(function(){y=null},p),J=0;J<X;++J)j=U[J],z.touch0&&z.touch0[2]===j.identifier?delete z.touch0:z.touch1&&z.touch1[2]===j.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(j=it(j,this),Math.hypot(d[0]-j[0],d[1]-j[1])<m)){var P=xe(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return f.wheelDelta=function(T){return arguments.length?(r=typeof T=="function"?T:Ln(+T),f):r},f.filter=function(T){return arguments.length?(e=typeof T=="function"?T:Ln(!!T),f):e},f.touchable=function(T){return arguments.length?(i=typeof T=="function"?T:Ln(!!T),f):i},f.extent=function(T){return arguments.length?(t=typeof T=="function"?T:Ln([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),f):t},f.scaleExtent=function(T){return arguments.length?(a[0]=+T[0],a[1]=+T[1],f):[a[0],a[1]]},f.translateExtent=function(T){return arguments.length?(o[0][0]=+T[0][0],o[1][0]=+T[1][0],o[0][1]=+T[0][1],o[1][1]=+T[1][1],f):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},f.constrain=function(T){return arguments.length?(n=T,f):n},f.duration=function(T){return arguments.length?(s=+T,f):s},f.interpolate=function(T){return arguments.length?(l=T,f):l},f.on=function(){var T=u.on.apply(u,arguments);return T===u?f:T},f.clickDistance=function(T){return arguments.length?(_=(T=+T)*T,f):Math.sqrt(_)},f.tapDistance=function(T){return arguments.length?(m=+T,f):m},f}var rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function id(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Br={exports:{}},Uo={},Ue={},Gt={},Pn={},re={},Sn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends t{constructor(w){if(super(),!e.IDENTIFIER.test(w))throw new Error("CodeGen: name must be a valid identifier");this.str=w}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class r extends t{constructor(w){super(),this._items=typeof w=="string"?[w]:w}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const w=this._items[0];return w===""||w==='""'}get str(){var w;return(w=this._str)!==null&&w!==void 0?w:this._str=this._items.reduce((x,g)=>`${x}${g}`,"")}get names(){var w;return(w=this._names)!==null&&w!==void 0?w:this._names=this._items.reduce((x,g)=>(g instanceof n&&(x[g.str]=(x[g.str]||0)+1),x),{})}}e._Code=r,e.nil=new r("");function i(f,...w){const x=[f[0]];let g=0;for(;g<w.length;)s(x,w[g]),x.push(f[++g]);return new r(x)}e._=i;const a=new r("+");function o(f,...w){const x=[p(f[0])];let g=0;for(;g<w.length;)x.push(a),s(x,w[g]),x.push(a,p(f[++g]));return l(x),new r(x)}e.str=o;function s(f,w){w instanceof r?f.push(...w._items):w instanceof n?f.push(w):f.push(d(w))}e.addCodeArg=s;function l(f){let w=1;for(;w<f.length-1;){if(f[w]===a){const x=u(f[w-1],f[w+1]);if(x!==void 0){f.splice(w-1,3,x);continue}f[w++]="+"}w++}}function u(f,w){if(w==='""')return f;if(f==='""')return w;if(typeof f=="string")return w instanceof n||f[f.length-1]!=='"'?void 0:typeof w!="string"?`${f.slice(0,-1)}${w}"`:w[0]==='"'?f.slice(0,-1)+w.slice(1):void 0;if(typeof w=="string"&&w[0]==='"'&&!(f instanceof n))return`"${f}${w.slice(1)}`}function c(f,w){return w.emptyStr()?f:f.emptyStr()?w:o`${f}${w}`}e.strConcat=c;function d(f){return typeof f=="number"||typeof f=="boolean"||f===null?f:p(Array.isArray(f)?f.join(","):f)}function y(f){return new r(p(f))}e.stringify=y;function p(f){return JSON.stringify(f).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=p;function $(f){return typeof f=="string"&&e.IDENTIFIER.test(f)?new r(`.${f}`):i`[${f}]`}e.getProperty=$;function _(f){if(typeof f=="string"&&e.IDENTIFIER.test(f))return new r(`${f}`);throw new Error(`CodeGen: invalid export name: ${f}, use explicit $id name mapping`)}e.getEsmExportName=_;function m(f){return new r(f.toString())}e.regexpCode=m})(Sn);var Xr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Sn;class n extends Error{constructor(u){super(`CodeGen: "code" for ${u} not defined`),this.value=u.value}}var r;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class i{constructor({prefixes:u,parent:c}={}){this._names={},this._prefixes=u,this._parent=c}toName(u){return u instanceof t.Name?u:this.name(u)}name(u){return new t.Name(this._newName(u))}_newName(u){const c=this._names[u]||this._nameGroup(u);return`${u}${c.index++}`}_nameGroup(u){var c,d;if(((d=(c=this._parent)===null||c===void 0?void 0:c._prefixes)===null||d===void 0?void 0:d.has(u))||this._prefixes&&!this._prefixes.has(u))throw new Error(`CodeGen: prefix "${u}" is not allowed in this scope`);return this._names[u]={prefix:u,index:0}}}e.Scope=i;class a extends t.Name{constructor(u,c){super(c),this.prefix=u}setValue(u,{property:c,itemIndex:d}){this.value=u,this.scopePath=(0,t._)`.${new t.Name(c)}[${d}]`}}e.ValueScopeName=a;const o=(0,t._)`\n`;class s extends i{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?o:t.nil}}get(){return this._scope}name(u){return new a(u,this._newName(u))}value(u,c){var d;if(c.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const y=this.toName(u),{prefix:p}=y,$=(d=c.key)!==null&&d!==void 0?d:c.ref;let _=this._values[p];if(_){const w=_.get($);if(w)return w}else _=this._values[p]=new Map;_.set($,y);const m=this._scope[p]||(this._scope[p]=[]),f=m.length;return m[f]=c.ref,y.setValue(c,{property:p,itemIndex:f}),y}getValue(u,c){const d=this._values[u];if(!!d)return d.get(c)}scopeRefs(u,c=this._values){return this._reduceValues(c,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,t._)`${u}${d.scopePath}`})}scopeCode(u=this._values,c,d){return this._reduceValues(u,y=>{if(y.value===void 0)throw new Error(`CodeGen: name "${y}" has no value`);return y.value.code},c,d)}_reduceValues(u,c,d={},y){let p=t.nil;for(const $ in u){const _=u[$];if(!_)continue;const m=d[$]=d[$]||new Map;_.forEach(f=>{if(m.has(f))return;m.set(f,r.Started);let w=c(f);if(w){const x=this.opts.es5?e.varKinds.var:e.varKinds.const;p=(0,t._)`${p}${x} ${f} = ${w};${this.opts._n}`}else if(w=y==null?void 0:y(f))p=(0,t._)`${p}${w}${this.opts._n}`;else throw new n(f);m.set(f,r.Completed)})}return p}}e.ValueScope=s})(Xr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Sn,n=Xr;var r=Sn;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var i=Xr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class a{optimizeNodes(){return this}optimizeNames(h,b){return this}}class o extends a{constructor(h,b,D){super(),this.varKind=h,this.name=b,this.rhs=D}render({es5:h,_n:b}){const D=h?n.varKinds.var:this.varKind,F=this.rhs===void 0?"":` = ${this.rhs}`;return`${D} ${this.name}${F};`+b}optimizeNames(h,b){if(!!h[this.name.str])return this.rhs&&(this.rhs=T(this.rhs,h,b)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class s extends a{constructor(h,b,D){super(),this.lhs=h,this.rhs=b,this.sideEffects=D}render({_n:h}){return`${this.lhs} = ${this.rhs};`+h}optimizeNames(h,b){if(!(this.lhs instanceof t.Name&&!h[this.lhs.str]&&!this.sideEffects))return this.rhs=T(this.rhs,h,b),this}get names(){const h=this.lhs instanceof t.Name?{}:{...this.lhs.names};return ee(h,this.rhs)}}class l extends s{constructor(h,b,D,F){super(h,D,F),this.op=b}render({_n:h}){return`${this.lhs} ${this.op}= ${this.rhs};`+h}}class u extends a{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`${this.label}:`+h}}class c extends a{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`break${this.label?` ${this.label}`:""};`+h}}class d extends a{constructor(h){super(),this.error=h}render({_n:h}){return`throw ${this.error};`+h}get names(){return this.error.names}}class y extends a{constructor(h){super(),this.code=h}render({_n:h}){return`${this.code};`+h}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(h,b){return this.code=T(this.code,h,b),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class p extends a{constructor(h=[]){super(),this.nodes=h}render(h){return this.nodes.reduce((b,D)=>b+D.render(h),"")}optimizeNodes(){const{nodes:h}=this;let b=h.length;for(;b--;){const D=h[b].optimizeNodes();Array.isArray(D)?h.splice(b,1,...D):D?h[b]=D:h.splice(b,1)}return h.length>0?this:void 0}optimizeNames(h,b){const{nodes:D}=this;let F=D.length;for(;F--;){const q=D[F];q.optimizeNames(h,b)||(V(h,q.names),D.splice(F,1))}return D.length>0?this:void 0}get names(){return this.nodes.reduce((h,b)=>Z(h,b.names),{})}}class $ extends p{render(h){return"{"+h._n+super.render(h)+"}"+h._n}}class _ extends p{}class m extends ${}m.kind="else";class f extends ${constructor(h,b){super(b),this.condition=h}render(h){let b=`if(${this.condition})`+super.render(h);return this.else&&(b+="else "+this.else.render(h)),b}optimizeNodes(){super.optimizeNodes();const h=this.condition;if(h===!0)return this.nodes;let b=this.else;if(b){const D=b.optimizeNodes();b=this.else=Array.isArray(D)?new m(D):D}if(b)return h===!1?b instanceof f?b:b.nodes:this.nodes.length?this:new f(z(h),b instanceof f?[b]:b.nodes);if(!(h===!1||!this.nodes.length))return this}optimizeNames(h,b){var D;if(this.else=(D=this.else)===null||D===void 0?void 0:D.optimizeNames(h,b),!!(super.optimizeNames(h,b)||this.else))return this.condition=T(this.condition,h,b),this}get names(){const h=super.names;return ee(h,this.condition),this.else&&Z(h,this.else.names),h}}f.kind="if";class w extends ${}w.kind="for";class x extends w{constructor(h){super(),this.iteration=h}render(h){return`for(${this.iteration})`+super.render(h)}optimizeNames(h,b){if(!!super.optimizeNames(h,b))return this.iteration=T(this.iteration,h,b),this}get names(){return Z(super.names,this.iteration.names)}}class g extends w{constructor(h,b,D,F){super(),this.varKind=h,this.name=b,this.from=D,this.to=F}render(h){const b=h.es5?n.varKinds.var:this.varKind,{name:D,from:F,to:q}=this;return`for(${b} ${D}=${F}; ${D}<${q}; ${D}++)`+super.render(h)}get names(){const h=ee(super.names,this.from);return ee(h,this.to)}}class C extends w{constructor(h,b,D,F){super(),this.loop=h,this.varKind=b,this.name=D,this.iterable=F}render(h){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(h)}optimizeNames(h,b){if(!!super.optimizeNames(h,b))return this.iterable=T(this.iterable,h,b),this}get names(){return Z(super.names,this.iterable.names)}}class S extends ${constructor(h,b,D){super(),this.name=h,this.args=b,this.async=D}render(h){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(h)}}S.kind="func";class k extends p{render(h){return"return "+super.render(h)}}k.kind="return";class M extends ${render(h){let b="try"+super.render(h);return this.catch&&(b+=this.catch.render(h)),this.finally&&(b+=this.finally.render(h)),b}optimizeNodes(){var h,b;return super.optimizeNodes(),(h=this.catch)===null||h===void 0||h.optimizeNodes(),(b=this.finally)===null||b===void 0||b.optimizeNodes(),this}optimizeNames(h,b){var D,F;return super.optimizeNames(h,b),(D=this.catch)===null||D===void 0||D.optimizeNames(h,b),(F=this.finally)===null||F===void 0||F.optimizeNames(h,b),this}get names(){const h=super.names;return this.catch&&Z(h,this.catch.names),this.finally&&Z(h,this.finally.names),h}}class L extends ${constructor(h){super(),this.error=h}render(h){return`catch(${this.error})`+super.render(h)}}L.kind="catch";class H extends ${render(h){return"finally"+super.render(h)}}H.kind="finally";class Y{constructor(h,b={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...b,_n:b.lines?`
`:""},this._extScope=h,this._scope=new n.Scope({parent:h}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(h){return this._scope.name(h)}scopeName(h){return this._extScope.name(h)}scopeValue(h,b){const D=this._extScope.value(h,b);return(this._values[D.prefix]||(this._values[D.prefix]=new Set)).add(D),D}getScopeValue(h,b){return this._extScope.getValue(h,b)}scopeRefs(h){return this._extScope.scopeRefs(h,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(h,b,D,F){const q=this._scope.toName(b);return D!==void 0&&F&&(this._constants[q.str]=D),this._leafNode(new o(h,q,D)),q}const(h,b,D){return this._def(n.varKinds.const,h,b,D)}let(h,b,D){return this._def(n.varKinds.let,h,b,D)}var(h,b,D){return this._def(n.varKinds.var,h,b,D)}assign(h,b,D){return this._leafNode(new s(h,b,D))}add(h,b){return this._leafNode(new l(h,e.operators.ADD,b))}code(h){return typeof h=="function"?h():h!==t.nil&&this._leafNode(new y(h)),this}object(...h){const b=["{"];for(const[D,F]of h)b.length>1&&b.push(","),b.push(D),(D!==F||this.opts.es5)&&(b.push(":"),(0,t.addCodeArg)(b,F));return b.push("}"),new t._Code(b)}if(h,b,D){if(this._blockNode(new f(h)),b&&D)this.code(b).else().code(D).endIf();else if(b)this.code(b).endIf();else if(D)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(h){return this._elseNode(new f(h))}else(){return this._elseNode(new m)}endIf(){return this._endBlockNode(f,m)}_for(h,b){return this._blockNode(h),b&&this.code(b).endFor(),this}for(h,b){return this._for(new x(h),b)}forRange(h,b,D,F,q=this.opts.es5?n.varKinds.var:n.varKinds.let){const te=this._scope.toName(h);return this._for(new g(q,te,b,D),()=>F(te))}forOf(h,b,D,F=n.varKinds.const){const q=this._scope.toName(h);if(this.opts.es5){const te=b instanceof t.Name?b:this.var("_arr",b);return this.forRange("_i",0,(0,t._)`${te}.length`,ae=>{this.var(q,(0,t._)`${te}[${ae}]`),D(q)})}return this._for(new C("of",F,q,b),()=>D(q))}forIn(h,b,D,F=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(h,(0,t._)`Object.keys(${b})`,D);const q=this._scope.toName(h);return this._for(new C("in",F,q,b),()=>D(q))}endFor(){return this._endBlockNode(w)}label(h){return this._leafNode(new u(h))}break(h){return this._leafNode(new c(h))}return(h){const b=new k;if(this._blockNode(b),this.code(h),b.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(h,b,D){if(!b&&!D)throw new Error('CodeGen: "try" without "catch" and "finally"');const F=new M;if(this._blockNode(F),this.code(h),b){const q=this.name("e");this._currNode=F.catch=new L(q),b(q)}return D&&(this._currNode=F.finally=new H,this.code(D)),this._endBlockNode(L,H)}throw(h){return this._leafNode(new d(h))}block(h,b){return this._blockStarts.push(this._nodes.length),h&&this.code(h).endBlock(b),this}endBlock(h){const b=this._blockStarts.pop();if(b===void 0)throw new Error("CodeGen: not in self-balancing block");const D=this._nodes.length-b;if(D<0||h!==void 0&&D!==h)throw new Error(`CodeGen: wrong number of nodes: ${D} vs ${h} expected`);return this._nodes.length=b,this}func(h,b=t.nil,D,F){return this._blockNode(new S(h,b,D)),F&&this.code(F).endFunc(),this}endFunc(){return this._endBlockNode(S)}optimize(h=1){for(;h-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(h){return this._currNode.nodes.push(h),this}_blockNode(h){this._currNode.nodes.push(h),this._nodes.push(h)}_endBlockNode(h,b){const D=this._currNode;if(D instanceof h||b&&D instanceof b)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${b?`${h.kind}/${b.kind}`:h.kind}"`)}_elseNode(h){const b=this._currNode;if(!(b instanceof f))throw new Error('CodeGen: "else" without "if"');return this._currNode=b.else=h,this}get _root(){return this._nodes[0]}get _currNode(){const h=this._nodes;return h[h.length-1]}set _currNode(h){const b=this._nodes;b[b.length-1]=h}}e.CodeGen=Y;function Z(A,h){for(const b in h)A[b]=(A[b]||0)+(h[b]||0);return A}function ee(A,h){return h instanceof t._CodeOrName?Z(A,h.names):A}function T(A,h,b){if(A instanceof t.Name)return D(A);if(!F(A))return A;return new t._Code(A._items.reduce((q,te)=>(te instanceof t.Name&&(te=D(te)),te instanceof t._Code?q.push(...te._items):q.push(te),q),[]));function D(q){const te=b[q.str];return te===void 0||h[q.str]!==1?q:(delete h[q.str],te)}function F(q){return q instanceof t._Code&&q._items.some(te=>te instanceof t.Name&&h[te.str]===1&&b[te.str]!==void 0)}}function V(A,h){for(const b in h)A[b]=(A[b]||0)-(h[b]||0)}function z(A){return typeof A=="boolean"||typeof A=="number"||A===null?!A:(0,t._)`!${I(A)}`}e.not=z;const U=P(e.operators.AND);function X(...A){return A.reduce(U)}e.and=X;const J=P(e.operators.OR);function j(...A){return A.reduce(J)}e.or=j;function P(A){return(h,b)=>h===t.nil?b:b===t.nil?h:(0,t._)`${I(h)} ${A} ${I(b)}`}function I(A){return A instanceof t.Name?A:(0,t._)`(${A})`}})(re);var se={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=re,n=Sn;function r(S){const k={};for(const M of S)k[M]=!0;return k}e.toHash=r;function i(S,k){return typeof k=="boolean"?k:Object.keys(k).length===0?!0:(a(S,k),!o(k,S.self.RULES.all))}e.alwaysValidSchema=i;function a(S,k=S.schema){const{opts:M,self:L}=S;if(!M.strictSchema||typeof k=="boolean")return;const H=L.RULES.keywords;for(const Y in k)H[Y]||C(S,`unknown keyword: "${Y}"`)}e.checkUnknownRules=a;function o(S,k){if(typeof S=="boolean")return!S;for(const M in S)if(k[M])return!0;return!1}e.schemaHasRules=o;function s(S,k){if(typeof S=="boolean")return!S;for(const M in S)if(M!=="$ref"&&k.all[M])return!0;return!1}e.schemaHasRulesButRef=s;function l({topSchemaRef:S,schemaPath:k},M,L,H){if(!H){if(typeof M=="number"||typeof M=="boolean")return M;if(typeof M=="string")return(0,t._)`${M}`}return(0,t._)`${S}${k}${(0,t.getProperty)(L)}`}e.schemaRefOrVal=l;function u(S){return y(decodeURIComponent(S))}e.unescapeFragment=u;function c(S){return encodeURIComponent(d(S))}e.escapeFragment=c;function d(S){return typeof S=="number"?`${S}`:S.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=d;function y(S){return S.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=y;function p(S,k){if(Array.isArray(S))for(const M of S)k(M);else k(S)}e.eachItem=p;function $({mergeNames:S,mergeToName:k,mergeValues:M,resultToName:L}){return(H,Y,Z,ee)=>{const T=Z===void 0?Y:Z instanceof t.Name?(Y instanceof t.Name?S(H,Y,Z):k(H,Y,Z),Z):Y instanceof t.Name?(k(H,Z,Y),Y):M(Y,Z);return ee===t.Name&&!(T instanceof t.Name)?L(H,T):T}}e.mergeEvaluated={props:$({mergeNames:(S,k,M)=>S.if((0,t._)`${M} !== true && ${k} !== undefined`,()=>{S.if((0,t._)`${k} === true`,()=>S.assign(M,!0),()=>S.assign(M,(0,t._)`${M} || {}`).code((0,t._)`Object.assign(${M}, ${k})`))}),mergeToName:(S,k,M)=>S.if((0,t._)`${M} !== true`,()=>{k===!0?S.assign(M,!0):(S.assign(M,(0,t._)`${M} || {}`),m(S,M,k))}),mergeValues:(S,k)=>S===!0?!0:{...S,...k},resultToName:_}),items:$({mergeNames:(S,k,M)=>S.if((0,t._)`${M} !== true && ${k} !== undefined`,()=>S.assign(M,(0,t._)`${k} === true ? true : ${M} > ${k} ? ${M} : ${k}`)),mergeToName:(S,k,M)=>S.if((0,t._)`${M} !== true`,()=>S.assign(M,k===!0?!0:(0,t._)`${M} > ${k} ? ${M} : ${k}`)),mergeValues:(S,k)=>S===!0?!0:Math.max(S,k),resultToName:(S,k)=>S.var("items",k)})};function _(S,k){if(k===!0)return S.var("props",!0);const M=S.var("props",(0,t._)`{}`);return k!==void 0&&m(S,M,k),M}e.evaluatedPropsToName=_;function m(S,k,M){Object.keys(M).forEach(L=>S.assign((0,t._)`${k}${(0,t.getProperty)(L)}`,!0))}e.setEvaluated=m;const f={};function w(S,k){return S.scopeValue("func",{ref:k,code:f[k.code]||(f[k.code]=new n._Code(k.code))})}e.useFunc=w;var x;(function(S){S[S.Num=0]="Num",S[S.Str=1]="Str"})(x=e.Type||(e.Type={}));function g(S,k,M){if(S instanceof t.Name){const L=k===x.Num;return M?L?(0,t._)`"[" + ${S} + "]"`:(0,t._)`"['" + ${S} + "']"`:L?(0,t._)`"/" + ${S}`:(0,t._)`"/" + ${S}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return M?(0,t.getProperty)(S).toString():"/"+d(S)}e.getErrorPath=g;function C(S,k,M=S.opts.strictSchema){if(!!M){if(k=`strict mode: ${k}`,M===!0)throw new Error(k);S.self.logger.warn(k)}}e.checkStrictMode=C})(se);var tt={};Object.defineProperty(tt,"__esModule",{value:!0});const be=re,ad={data:new be.Name("data"),valCxt:new be.Name("valCxt"),instancePath:new be.Name("instancePath"),parentData:new be.Name("parentData"),parentDataProperty:new be.Name("parentDataProperty"),rootData:new be.Name("rootData"),dynamicAnchors:new be.Name("dynamicAnchors"),vErrors:new be.Name("vErrors"),errors:new be.Name("errors"),this:new be.Name("this"),self:new be.Name("self"),scope:new be.Name("scope"),json:new be.Name("json"),jsonPos:new be.Name("jsonPos"),jsonLen:new be.Name("jsonLen"),jsonPart:new be.Name("jsonPart")};tt.default=ad;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=re,n=se,r=tt;e.keywordError={message:({keyword:m})=>(0,t.str)`must pass "${m}" keyword validation`},e.keyword$DataError={message:({keyword:m,schemaType:f})=>f?(0,t.str)`"${m}" keyword must be ${f} ($data)`:(0,t.str)`"${m}" keyword is invalid ($data)`};function i(m,f=e.keywordError,w,x){const{it:g}=m,{gen:C,compositeRule:S,allErrors:k}=g,M=d(m,f,w);(x!=null?x:S||k)?l(C,M):u(g,(0,t._)`[${M}]`)}e.reportError=i;function a(m,f=e.keywordError,w){const{it:x}=m,{gen:g,compositeRule:C,allErrors:S}=x,k=d(m,f,w);l(g,k),C||S||u(x,r.default.vErrors)}e.reportExtraError=a;function o(m,f){m.assign(r.default.errors,f),m.if((0,t._)`${r.default.vErrors} !== null`,()=>m.if(f,()=>m.assign((0,t._)`${r.default.vErrors}.length`,f),()=>m.assign(r.default.vErrors,null)))}e.resetErrorsCount=o;function s({gen:m,keyword:f,schemaValue:w,data:x,errsCount:g,it:C}){if(g===void 0)throw new Error("ajv implementation error");const S=m.name("err");m.forRange("i",g,r.default.errors,k=>{m.const(S,(0,t._)`${r.default.vErrors}[${k}]`),m.if((0,t._)`${S}.instancePath === undefined`,()=>m.assign((0,t._)`${S}.instancePath`,(0,t.strConcat)(r.default.instancePath,C.errorPath))),m.assign((0,t._)`${S}.schemaPath`,(0,t.str)`${C.errSchemaPath}/${f}`),C.opts.verbose&&(m.assign((0,t._)`${S}.schema`,w),m.assign((0,t._)`${S}.data`,x))})}e.extendErrors=s;function l(m,f){const w=m.const("err",f);m.if((0,t._)`${r.default.vErrors} === null`,()=>m.assign(r.default.vErrors,(0,t._)`[${w}]`),(0,t._)`${r.default.vErrors}.push(${w})`),m.code((0,t._)`${r.default.errors}++`)}function u(m,f){const{gen:w,validateName:x,schemaEnv:g}=m;g.$async?w.throw((0,t._)`new ${m.ValidationError}(${f})`):(w.assign((0,t._)`${x}.errors`,f),w.return(!1))}const c={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function d(m,f,w){const{createErrors:x}=m.it;return x===!1?(0,t._)`{}`:y(m,f,w)}function y(m,f,w={}){const{gen:x,it:g}=m,C=[p(g,w),$(m,w)];return _(m,f,C),x.object(...C)}function p({errorPath:m},{instancePath:f}){const w=f?(0,t.str)`${m}${(0,n.getErrorPath)(f,n.Type.Str)}`:m;return[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,w)]}function $({keyword:m,it:{errSchemaPath:f}},{schemaPath:w,parentSchema:x}){let g=x?f:(0,t.str)`${f}/${m}`;return w&&(g=(0,t.str)`${g}${(0,n.getErrorPath)(w,n.Type.Str)}`),[c.schemaPath,g]}function _(m,{params:f,message:w},x){const{keyword:g,data:C,schemaValue:S,it:k}=m,{opts:M,propertyName:L,topSchemaRef:H,schemaPath:Y}=k;x.push([c.keyword,g],[c.params,typeof f=="function"?f(m):f||(0,t._)`{}`]),M.messages&&x.push([c.message,typeof w=="function"?w(m):w]),M.verbose&&x.push([c.schema,S],[c.parentSchema,(0,t._)`${H}${Y}`],[r.default.data,C]),L&&x.push([c.propertyName,L])}})(Pn);Object.defineProperty(Gt,"__esModule",{value:!0});Gt.boolOrEmptySchema=Gt.topBoolOrEmptySchema=void 0;const od=Pn,sd=re,ld=tt,ud={message:"boolean schema is false"};function cd(e){const{gen:t,schema:n,validateName:r}=e;n===!1?Ho(e,!1):typeof n=="object"&&n.$async===!0?t.return(ld.default.data):(t.assign((0,sd._)`${r}.errors`,null),t.return(!0))}Gt.topBoolOrEmptySchema=cd;function fd(e,t){const{gen:n,schema:r}=e;r===!1?(n.var(t,!1),Ho(e)):n.var(t,!0)}Gt.boolOrEmptySchema=fd;function Ho(e,t){const{gen:n,data:r}=e,i={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,od.reportError)(i,ud,void 0,t)}var Tn={},kt={};Object.defineProperty(kt,"__esModule",{value:!0});kt.getRules=kt.isJSONType=void 0;const dd=["string","number","integer","boolean","null","object","array"],hd=new Set(dd);function pd(e){return typeof e=="string"&&hd.has(e)}kt.isJSONType=pd;function md(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}kt.getRules=md;var ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot.shouldUseRule=ot.shouldUseGroup=ot.schemaHasRulesForType=void 0;function yd({schema:e,self:t},n){const r=t.RULES.types[n];return r&&r!==!0&&Ko(e,r)}ot.schemaHasRulesForType=yd;function Ko(e,t){return t.rules.some(n=>Go(e,n))}ot.shouldUseGroup=Ko;function Go(e,t){var n;return e[t.keyword]!==void 0||((n=t.definition.implements)===null||n===void 0?void 0:n.some(r=>e[r]!==void 0))}ot.shouldUseRule=Go;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=kt,n=ot,r=Pn,i=re,a=se;var o;(function(x){x[x.Correct=0]="Correct",x[x.Wrong=1]="Wrong"})(o=e.DataType||(e.DataType={}));function s(x){const g=l(x.type);if(g.includes("null")){if(x.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!g.length&&x.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');x.nullable===!0&&g.push("null")}return g}e.getSchemaTypes=s;function l(x){const g=Array.isArray(x)?x:x?[x]:[];if(g.every(t.isJSONType))return g;throw new Error("type must be JSONType or JSONType[]: "+g.join(","))}e.getJSONTypes=l;function u(x,g){const{gen:C,data:S,opts:k}=x,M=d(g,k.coerceTypes),L=g.length>0&&!(M.length===0&&g.length===1&&(0,n.schemaHasRulesForType)(x,g[0]));if(L){const H=_(g,S,k.strictNumbers,o.Wrong);C.if(H,()=>{M.length?y(x,g,M):f(x)})}return L}e.coerceAndCheckDataType=u;const c=new Set(["string","number","integer","boolean","null"]);function d(x,g){return g?x.filter(C=>c.has(C)||g==="array"&&C==="array"):[]}function y(x,g,C){const{gen:S,data:k,opts:M}=x,L=S.let("dataType",(0,i._)`typeof ${k}`),H=S.let("coerced",(0,i._)`undefined`);M.coerceTypes==="array"&&S.if((0,i._)`${L} == 'object' && Array.isArray(${k}) && ${k}.length == 1`,()=>S.assign(k,(0,i._)`${k}[0]`).assign(L,(0,i._)`typeof ${k}`).if(_(g,k,M.strictNumbers),()=>S.assign(H,k))),S.if((0,i._)`${H} !== undefined`);for(const Z of C)(c.has(Z)||Z==="array"&&M.coerceTypes==="array")&&Y(Z);S.else(),f(x),S.endIf(),S.if((0,i._)`${H} !== undefined`,()=>{S.assign(k,H),p(x,H)});function Y(Z){switch(Z){case"string":S.elseIf((0,i._)`${L} == "number" || ${L} == "boolean"`).assign(H,(0,i._)`"" + ${k}`).elseIf((0,i._)`${k} === null`).assign(H,(0,i._)`""`);return;case"number":S.elseIf((0,i._)`${L} == "boolean" || ${k} === null
              || (${L} == "string" && ${k} && ${k} == +${k})`).assign(H,(0,i._)`+${k}`);return;case"integer":S.elseIf((0,i._)`${L} === "boolean" || ${k} === null
              || (${L} === "string" && ${k} && ${k} == +${k} && !(${k} % 1))`).assign(H,(0,i._)`+${k}`);return;case"boolean":S.elseIf((0,i._)`${k} === "false" || ${k} === 0 || ${k} === null`).assign(H,!1).elseIf((0,i._)`${k} === "true" || ${k} === 1`).assign(H,!0);return;case"null":S.elseIf((0,i._)`${k} === "" || ${k} === 0 || ${k} === false`),S.assign(H,null);return;case"array":S.elseIf((0,i._)`${L} === "string" || ${L} === "number"
              || ${L} === "boolean" || ${k} === null`).assign(H,(0,i._)`[${k}]`)}}}function p({gen:x,parentData:g,parentDataProperty:C},S){x.if((0,i._)`${g} !== undefined`,()=>x.assign((0,i._)`${g}[${C}]`,S))}function $(x,g,C,S=o.Correct){const k=S===o.Correct?i.operators.EQ:i.operators.NEQ;let M;switch(x){case"null":return(0,i._)`${g} ${k} null`;case"array":M=(0,i._)`Array.isArray(${g})`;break;case"object":M=(0,i._)`${g} && typeof ${g} == "object" && !Array.isArray(${g})`;break;case"integer":M=L((0,i._)`!(${g} % 1) && !isNaN(${g})`);break;case"number":M=L();break;default:return(0,i._)`typeof ${g} ${k} ${x}`}return S===o.Correct?M:(0,i.not)(M);function L(H=i.nil){return(0,i.and)((0,i._)`typeof ${g} == "number"`,H,C?(0,i._)`isFinite(${g})`:i.nil)}}e.checkDataType=$;function _(x,g,C,S){if(x.length===1)return $(x[0],g,C,S);let k;const M=(0,a.toHash)(x);if(M.array&&M.object){const L=(0,i._)`typeof ${g} != "object"`;k=M.null?L:(0,i._)`!${g} || ${L}`,delete M.null,delete M.array,delete M.object}else k=i.nil;M.number&&delete M.integer;for(const L in M)k=(0,i.and)(k,$(L,g,C,S));return k}e.checkDataTypes=_;const m={message:({schema:x})=>`must be ${x}`,params:({schema:x,schemaValue:g})=>typeof x=="string"?(0,i._)`{type: ${x}}`:(0,i._)`{type: ${g}}`};function f(x){const g=w(x);(0,r.reportError)(g,m)}e.reportTypeError=f;function w(x){const{gen:g,data:C,schema:S}=x,k=(0,a.schemaRefOrVal)(x,S,"type");return{gen:g,keyword:"type",data:C,schema:S.type,schemaCode:k,schemaValue:k,parentSchema:S,params:{},it:x}}})(Tn);var Er={};Object.defineProperty(Er,"__esModule",{value:!0});Er.assignDefaults=void 0;const It=re,gd=se;function vd(e,t){const{properties:n,items:r}=e.schema;if(t==="object"&&n)for(const i in n)Va(e,i,n[i].default);else t==="array"&&Array.isArray(r)&&r.forEach((i,a)=>Va(e,a,i.default))}Er.assignDefaults=vd;function Va(e,t,n){const{gen:r,compositeRule:i,data:a,opts:o}=e;if(n===void 0)return;const s=(0,It._)`${a}${(0,It.getProperty)(t)}`;if(i){(0,gd.checkStrictMode)(e,`default is ignored for: ${s}`);return}let l=(0,It._)`${s} === undefined`;o.useDefaults==="empty"&&(l=(0,It._)`${l} || ${s} === null || ${s} === ""`),r.if(l,(0,It._)`${s} = ${(0,It.stringify)(n)}`)}var We={},ne={};Object.defineProperty(ne,"__esModule",{value:!0});ne.validateUnion=ne.validateArray=ne.usePattern=ne.callValidateCode=ne.schemaProperties=ne.allSchemaProperties=ne.noPropertyInData=ne.propertyInData=ne.isOwnProperty=ne.hasPropFunc=ne.reportMissingProp=ne.checkMissingProp=ne.checkReportMissingProp=void 0;const fe=re,yi=se,ft=tt,_d=se;function $d(e,t){const{gen:n,data:r,it:i}=e;n.if(vi(n,r,t,i.opts.ownProperties),()=>{e.setParams({missingProperty:(0,fe._)`${t}`},!0),e.error()})}ne.checkReportMissingProp=$d;function wd({gen:e,data:t,it:{opts:n}},r,i){return(0,fe.or)(...r.map(a=>(0,fe.and)(vi(e,t,a,n.ownProperties),(0,fe._)`${i} = ${a}`)))}ne.checkMissingProp=wd;function bd(e,t){e.setParams({missingProperty:t},!0),e.error()}ne.reportMissingProp=bd;function Bo(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,fe._)`Object.prototype.hasOwnProperty`})}ne.hasPropFunc=Bo;function gi(e,t,n){return(0,fe._)`${Bo(e)}.call(${t}, ${n})`}ne.isOwnProperty=gi;function Ed(e,t,n,r){const i=(0,fe._)`${t}${(0,fe.getProperty)(n)} !== undefined`;return r?(0,fe._)`${i} && ${gi(e,t,n)}`:i}ne.propertyInData=Ed;function vi(e,t,n,r){const i=(0,fe._)`${t}${(0,fe.getProperty)(n)} === undefined`;return r?(0,fe.or)(i,(0,fe.not)(gi(e,t,n))):i}ne.noPropertyInData=vi;function Xo(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}ne.allSchemaProperties=Xo;function Sd(e,t){return Xo(t).filter(n=>!(0,yi.alwaysValidSchema)(e,t[n]))}ne.schemaProperties=Sd;function xd({schemaCode:e,data:t,it:{gen:n,topSchemaRef:r,schemaPath:i,errorPath:a},it:o},s,l,u){const c=u?(0,fe._)`${e}, ${t}, ${r}${i}`:t,d=[[ft.default.instancePath,(0,fe.strConcat)(ft.default.instancePath,a)],[ft.default.parentData,o.parentData],[ft.default.parentDataProperty,o.parentDataProperty],[ft.default.rootData,ft.default.rootData]];o.opts.dynamicRef&&d.push([ft.default.dynamicAnchors,ft.default.dynamicAnchors]);const y=(0,fe._)`${c}, ${n.object(...d)}`;return l!==fe.nil?(0,fe._)`${s}.call(${l}, ${y})`:(0,fe._)`${s}(${y})`}ne.callValidateCode=xd;const Nd=(0,fe._)`new RegExp`;function kd({gen:e,it:{opts:t}},n){const r=t.unicodeRegExp?"u":"",{regExp:i}=t.code,a=i(n,r);return e.scopeValue("pattern",{key:a.toString(),ref:a,code:(0,fe._)`${i.code==="new RegExp"?Nd:(0,_d.useFunc)(e,i)}(${n}, ${r})`})}ne.usePattern=kd;function Pd(e){const{gen:t,data:n,keyword:r,it:i}=e,a=t.name("valid");if(i.allErrors){const s=t.let("valid",!0);return o(()=>t.assign(s,!1)),s}return t.var(a,!0),o(()=>t.break()),a;function o(s){const l=t.const("len",(0,fe._)`${n}.length`);t.forRange("i",0,l,u=>{e.subschema({keyword:r,dataProp:u,dataPropType:yi.Type.Num},a),t.if((0,fe.not)(a),s)})}}ne.validateArray=Pd;function Td(e){const{gen:t,schema:n,keyword:r,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(l=>(0,yi.alwaysValidSchema)(i,l))&&!i.opts.unevaluated)return;const o=t.let("valid",!1),s=t.name("_valid");t.block(()=>n.forEach((l,u)=>{const c=e.subschema({keyword:r,schemaProp:u,compositeRule:!0},s);t.assign(o,(0,fe._)`${o} || ${s}`),e.mergeValidEvaluated(c,s)||t.if((0,fe.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}ne.validateUnion=Td;Object.defineProperty(We,"__esModule",{value:!0});We.validateKeywordUsage=We.validSchemaType=We.funcKeywordCode=We.macroKeywordCode=void 0;const Se=re,wt=tt,Cd=ne,Ad=Pn;function Od(e,t){const{gen:n,keyword:r,schema:i,parentSchema:a,it:o}=e,s=t.macro.call(o.self,i,a,o),l=Zo(n,r,s);o.opts.validateSchema!==!1&&o.self.validateSchema(s,!0);const u=n.name("valid");e.subschema({schema:s,schemaPath:Se.nil,errSchemaPath:`${o.errSchemaPath}/${r}`,topSchemaRef:l,compositeRule:!0},u),e.pass(u,()=>e.error(!0))}We.macroKeywordCode=Od;function Rd(e,t){var n;const{gen:r,keyword:i,schema:a,parentSchema:o,$data:s,it:l}=e;Dd(l,t);const u=!s&&t.compile?t.compile.call(l.self,a,o,l):t.validate,c=Zo(r,i,u),d=r.let("valid");e.block$data(d,y),e.ok((n=t.valid)!==null&&n!==void 0?n:d);function y(){if(t.errors===!1)_(),t.modifying&&Fa(e),m(()=>e.error());else{const f=t.async?p():$();t.modifying&&Fa(e),m(()=>Md(e,f))}}function p(){const f=r.let("ruleErrs",null);return r.try(()=>_((0,Se._)`await `),w=>r.assign(d,!1).if((0,Se._)`${w} instanceof ${l.ValidationError}`,()=>r.assign(f,(0,Se._)`${w}.errors`),()=>r.throw(w))),f}function $(){const f=(0,Se._)`${c}.errors`;return r.assign(f,null),_(Se.nil),f}function _(f=t.async?(0,Se._)`await `:Se.nil){const w=l.opts.passContext?wt.default.this:wt.default.self,x=!("compile"in t&&!s||t.schema===!1);r.assign(d,(0,Se._)`${f}${(0,Cd.callValidateCode)(e,c,w,x)}`,t.modifying)}function m(f){var w;r.if((0,Se.not)((w=t.valid)!==null&&w!==void 0?w:d),f)}}We.funcKeywordCode=Rd;function Fa(e){const{gen:t,data:n,it:r}=e;t.if(r.parentData,()=>t.assign(n,(0,Se._)`${r.parentData}[${r.parentDataProperty}]`))}function Md(e,t){const{gen:n}=e;n.if((0,Se._)`Array.isArray(${t})`,()=>{n.assign(wt.default.vErrors,(0,Se._)`${wt.default.vErrors} === null ? ${t} : ${wt.default.vErrors}.concat(${t})`).assign(wt.default.errors,(0,Se._)`${wt.default.vErrors}.length`),(0,Ad.extendErrors)(e)},()=>e.error())}function Dd({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function Zo(e,t,n){if(n===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,Se.stringify)(n)})}function Id(e,t,n=!1){return!t.length||t.some(r=>r==="array"?Array.isArray(e):r==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==r||n&&typeof e>"u")}We.validSchemaType=Id;function jd({schema:e,opts:t,self:n,errSchemaPath:r},i,a){if(Array.isArray(i.keyword)?!i.keyword.includes(a):i.keyword!==a)throw new Error("ajv implementation error");const o=i.dependencies;if(o!=null&&o.some(s=>!Object.prototype.hasOwnProperty.call(e,s)))throw new Error(`parent schema must have dependencies of ${a}: ${o.join(",")}`);if(i.validateSchema&&!i.validateSchema(e[a])){const l=`keyword "${a}" value is invalid at path "${r}": `+n.errorsText(i.validateSchema.errors);if(t.validateSchema==="log")n.logger.error(l);else throw new Error(l)}}We.validateKeywordUsage=jd;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.extendSubschemaMode=mt.extendSubschemaData=mt.getSubschema=void 0;const Je=re,Yo=se;function zd(e,{keyword:t,schemaProp:n,schema:r,schemaPath:i,errSchemaPath:a,topSchemaRef:o}){if(t!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const s=e.schema[t];return n===void 0?{schema:s,schemaPath:(0,Je._)`${e.schemaPath}${(0,Je.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:s[n],schemaPath:(0,Je._)`${e.schemaPath}${(0,Je.getProperty)(t)}${(0,Je.getProperty)(n)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Yo.escapeFragment)(n)}`}}if(r!==void 0){if(i===void 0||a===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:i,topSchemaRef:o,errSchemaPath:a}}throw new Error('either "keyword" or "schema" must be passed')}mt.getSubschema=zd;function Vd(e,t,{dataProp:n,dataPropType:r,data:i,dataTypes:a,propertyName:o}){if(i!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:s}=t;if(n!==void 0){const{errorPath:u,dataPathArr:c,opts:d}=t,y=s.let("data",(0,Je._)`${t.data}${(0,Je.getProperty)(n)}`,!0);l(y),e.errorPath=(0,Je.str)`${u}${(0,Yo.getErrorPath)(n,r,d.jsPropertySyntax)}`,e.parentDataProperty=(0,Je._)`${n}`,e.dataPathArr=[...c,e.parentDataProperty]}if(i!==void 0){const u=i instanceof Je.Name?i:s.let("data",i,!0);l(u),o!==void 0&&(e.propertyName=o)}a&&(e.dataTypes=a);function l(u){e.data=u,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,u]}}mt.extendSubschemaData=Vd;function Fd(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:r,createErrors:i,allErrors:a}){r!==void 0&&(e.compositeRule=r),i!==void 0&&(e.createErrors=i),a!==void 0&&(e.allErrors=a),e.jtdDiscriminator=t,e.jtdMetadata=n}mt.extendSubschemaMode=Fd;var we={},Jo=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},Wo={exports:{}},pt=Wo.exports=function(e,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var r=typeof n=="function"?n:n.pre||function(){},i=n.post||function(){};Jn(t,r,i,e,"",e)};pt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};pt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};pt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};pt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Jn(e,t,n,r,i,a,o,s,l,u){if(r&&typeof r=="object"&&!Array.isArray(r)){t(r,i,a,o,s,l,u);for(var c in r){var d=r[c];if(Array.isArray(d)){if(c in pt.arrayKeywords)for(var y=0;y<d.length;y++)Jn(e,t,n,d[y],i+"/"+c+"/"+y,a,i,c,r,y)}else if(c in pt.propsKeywords){if(d&&typeof d=="object")for(var p in d)Jn(e,t,n,d[p],i+"/"+c+"/"+Ld(p),a,i,c,r,p)}else(c in pt.keywords||e.allKeys&&!(c in pt.skipKeywords))&&Jn(e,t,n,d,i+"/"+c,a,i,c,r)}n(r,i,a,o,s,l,u)}}function Ld(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(we,"__esModule",{value:!0});we.getSchemaRefs=we.resolveUrl=we.normalizeId=we._getFullPath=we.getFullPath=we.inlineRef=void 0;const qd=se,Ud=Jo,Hd=Wo.exports,Kd=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Gd(e,t=!0){return typeof e=="boolean"?!0:t===!0?!Zr(e):t?Qo(e)<=t:!1}we.inlineRef=Gd;const Bd=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Zr(e){for(const t in e){if(Bd.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(Zr)||typeof n=="object"&&Zr(n))return!0}return!1}function Qo(e){let t=0;for(const n in e){if(n==="$ref")return 1/0;if(t++,!Kd.has(n)&&(typeof e[n]=="object"&&(0,qd.eachItem)(e[n],r=>t+=Qo(r)),t===1/0))return 1/0}return t}function es(e,t="",n){n!==!1&&(t=qt(t));const r=e.parse(t);return ts(e,r)}we.getFullPath=es;function ts(e,t){return e.serialize(t).split("#")[0]+"#"}we._getFullPath=ts;const Xd=/#\/?$/;function qt(e){return e?e.replace(Xd,""):""}we.normalizeId=qt;function Zd(e,t,n){return n=qt(n),e.resolve(t,n)}we.resolveUrl=Zd;const Yd=/^[a-z_][-a-z0-9._]*$/i;function Jd(e,t){if(typeof e=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,i=qt(e[n]||t),a={"":i},o=es(r,i,!1),s={},l=new Set;return Hd(e,{allKeys:!0},(d,y,p,$)=>{if($===void 0)return;const _=o+y;let m=a[$];typeof d[n]=="string"&&(m=f.call(this,d[n])),w.call(this,d.$anchor),w.call(this,d.$dynamicAnchor),a[y]=m;function f(x){const g=this.opts.uriResolver.resolve;if(x=qt(m?g(m,x):x),l.has(x))throw c(x);l.add(x);let C=this.refs[x];return typeof C=="string"&&(C=this.refs[C]),typeof C=="object"?u(d,C.schema,x):x!==qt(_)&&(x[0]==="#"?(u(d,s[x],x),s[x]=d):this.refs[x]=_),x}function w(x){if(typeof x=="string"){if(!Yd.test(x))throw new Error(`invalid anchor "${x}"`);f.call(this,`#${x}`)}}}),s;function u(d,y,p){if(y!==void 0&&!Ud(d,y))throw c(p)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}we.getSchemaRefs=Jd;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getData=Ue.KeywordCxt=Ue.validateFunctionCode=void 0;const ns=Gt,La=Tn,_i=ot,ur=Tn,Wd=Er,pn=We,Rr=mt,K=re,W=tt,Qd=we,st=se,ln=Pn;function eh(e){if(as(e)&&(os(e),is(e))){rh(e);return}rs(e,()=>(0,ns.topBoolOrEmptySchema)(e))}Ue.validateFunctionCode=eh;function rs({gen:e,validateName:t,schema:n,schemaEnv:r,opts:i},a){i.code.es5?e.func(t,(0,K._)`${W.default.data}, ${W.default.valCxt}`,r.$async,()=>{e.code((0,K._)`"use strict"; ${qa(n,i)}`),nh(e,i),e.code(a)}):e.func(t,(0,K._)`${W.default.data}, ${th(i)}`,r.$async,()=>e.code(qa(n,i)).code(a))}function th(e){return(0,K._)`{${W.default.instancePath}="", ${W.default.parentData}, ${W.default.parentDataProperty}, ${W.default.rootData}=${W.default.data}${e.dynamicRef?(0,K._)`, ${W.default.dynamicAnchors}={}`:K.nil}}={}`}function nh(e,t){e.if(W.default.valCxt,()=>{e.var(W.default.instancePath,(0,K._)`${W.default.valCxt}.${W.default.instancePath}`),e.var(W.default.parentData,(0,K._)`${W.default.valCxt}.${W.default.parentData}`),e.var(W.default.parentDataProperty,(0,K._)`${W.default.valCxt}.${W.default.parentDataProperty}`),e.var(W.default.rootData,(0,K._)`${W.default.valCxt}.${W.default.rootData}`),t.dynamicRef&&e.var(W.default.dynamicAnchors,(0,K._)`${W.default.valCxt}.${W.default.dynamicAnchors}`)},()=>{e.var(W.default.instancePath,(0,K._)`""`),e.var(W.default.parentData,(0,K._)`undefined`),e.var(W.default.parentDataProperty,(0,K._)`undefined`),e.var(W.default.rootData,W.default.data),t.dynamicRef&&e.var(W.default.dynamicAnchors,(0,K._)`{}`)})}function rh(e){const{schema:t,opts:n,gen:r}=e;rs(e,()=>{n.$comment&&t.$comment&&ls(e),lh(e),r.let(W.default.vErrors,null),r.let(W.default.errors,0),n.unevaluated&&ih(e),ss(e),fh(e)})}function ih(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,K._)`${n}.evaluated`),t.if((0,K._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,K._)`${e.evaluated}.props`,(0,K._)`undefined`)),t.if((0,K._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,K._)`${e.evaluated}.items`,(0,K._)`undefined`))}function qa(e,t){const n=typeof e=="object"&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,K._)`/*# sourceURL=${n} */`:K.nil}function ah(e,t){if(as(e)&&(os(e),is(e))){oh(e,t);return}(0,ns.boolOrEmptySchema)(e,t)}function is({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const n in e)if(t.RULES.all[n])return!0;return!1}function as(e){return typeof e.schema!="boolean"}function oh(e,t){const{schema:n,gen:r,opts:i}=e;i.$comment&&n.$comment&&ls(e),uh(e),ch(e);const a=r.const("_errs",W.default.errors);ss(e,a),r.var(t,(0,K._)`${a} === ${W.default.errors}`)}function os(e){(0,st.checkUnknownRules)(e),sh(e)}function ss(e,t){if(e.opts.jtd)return Ua(e,[],!1,t);const n=(0,La.getSchemaTypes)(e.schema),r=(0,La.coerceAndCheckDataType)(e,n);Ua(e,n,!r,t)}function sh(e){const{schema:t,errSchemaPath:n,opts:r,self:i}=e;t.$ref&&r.ignoreKeywordsWithRef&&(0,st.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function lh(e){const{schema:t,opts:n}=e;t.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,st.checkStrictMode)(e,"default is ignored in the schema root")}function uh(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,Qd.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function ch(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function ls({gen:e,schemaEnv:t,schema:n,errSchemaPath:r,opts:i}){const a=n.$comment;if(i.$comment===!0)e.code((0,K._)`${W.default.self}.logger.log(${a})`);else if(typeof i.$comment=="function"){const o=(0,K.str)`${r}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code((0,K._)`${W.default.self}.opts.$comment(${a}, ${o}, ${s}.schema)`)}}function fh(e){const{gen:t,schemaEnv:n,validateName:r,ValidationError:i,opts:a}=e;n.$async?t.if((0,K._)`${W.default.errors} === 0`,()=>t.return(W.default.data),()=>t.throw((0,K._)`new ${i}(${W.default.vErrors})`)):(t.assign((0,K._)`${r}.errors`,W.default.vErrors),a.unevaluated&&dh(e),t.return((0,K._)`${W.default.errors} === 0`))}function dh({gen:e,evaluated:t,props:n,items:r}){n instanceof K.Name&&e.assign((0,K._)`${t}.props`,n),r instanceof K.Name&&e.assign((0,K._)`${t}.items`,r)}function Ua(e,t,n,r){const{gen:i,schema:a,data:o,allErrors:s,opts:l,self:u}=e,{RULES:c}=u;if(a.$ref&&(l.ignoreKeywordsWithRef||!(0,st.schemaHasRulesButRef)(a,c))){i.block(()=>cs(e,"$ref",c.all.$ref.definition));return}l.jtd||hh(e,t),i.block(()=>{for(const y of c.rules)d(y);d(c.post)});function d(y){!(0,_i.shouldUseGroup)(a,y)||(y.type?(i.if((0,ur.checkDataType)(y.type,o,l.strictNumbers)),Ha(e,y),t.length===1&&t[0]===y.type&&n&&(i.else(),(0,ur.reportTypeError)(e)),i.endIf()):Ha(e,y),s||i.if((0,K._)`${W.default.errors} === ${r||0}`))}}function Ha(e,t){const{gen:n,schema:r,opts:{useDefaults:i}}=e;i&&(0,Wd.assignDefaults)(e,t.type),n.block(()=>{for(const a of t.rules)(0,_i.shouldUseRule)(r,a)&&cs(e,a.keyword,a.definition,t.type)})}function hh(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(ph(e,t),e.opts.allowUnionTypes||mh(e,t),yh(e,e.dataTypes))}function ph(e,t){if(!!t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(n=>{Ka(e.dataTypes,n)||$i(e,`type "${n}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(n=>Ka(t,n))}}function mh(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&$i(e,"use allowUnionTypes to allow union type keyword")}function yh(e,t){const n=e.self.RULES.all;for(const r in n){const i=n[r];if(typeof i=="object"&&(0,_i.shouldUseRule)(e.schema,i)){const{type:a}=i.definition;a.length&&!a.some(o=>gh(t,o))&&$i(e,`missing type "${a.join(",")}" for keyword "${r}"`)}}}function gh(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function Ka(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function $i(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${n}" (strictTypes)`,(0,st.checkStrictMode)(e,t,e.opts.strictTypes)}class us{constructor(t,n,r){if((0,pn.validateKeywordUsage)(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,st.schemaRefOrVal)(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",fs(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,pn.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=t.gen.const("_errs",W.default.errors))}result(t,n,r){this.failResult((0,K.not)(t),n,r)}failResult(t,n,r){this.gen.if(t),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,n){this.failResult((0,K.not)(t),void 0,n)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:n}=this;this.fail((0,K._)`${n} !== undefined && (${(0,K.or)(this.invalid$data(),t)})`)}error(t,n,r){if(n){this.setParams(n),this._error(t,r),this.setParams({});return}this._error(t,r)}_error(t,n){(t?ln.reportExtraError:ln.reportError)(this,this.def.error,n)}$dataError(){(0,ln.reportError)(this,this.def.$dataError||ln.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,ln.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,n){n?Object.assign(this.params,t):this.params=t}block$data(t,n,r=K.nil){this.gen.block(()=>{this.check$data(t,r),n()})}check$data(t=K.nil,n=K.nil){if(!this.$data)return;const{gen:r,schemaCode:i,schemaType:a,def:o}=this;r.if((0,K.or)((0,K._)`${i} === undefined`,n)),t!==K.nil&&r.assign(t,!0),(a.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),t!==K.nil&&r.assign(t,!1)),r.else()}invalid$data(){const{gen:t,schemaCode:n,schemaType:r,def:i,it:a}=this;return(0,K.or)(o(),s());function o(){if(r.length){if(!(n instanceof K.Name))throw new Error("ajv implementation error");const l=Array.isArray(r)?r:[r];return(0,K._)`${(0,ur.checkDataTypes)(l,n,a.opts.strictNumbers,ur.DataType.Wrong)}`}return K.nil}function s(){if(i.validateSchema){const l=t.scopeValue("validate$data",{ref:i.validateSchema});return(0,K._)`!${l}(${n})`}return K.nil}}subschema(t,n){const r=(0,Rr.getSubschema)(this.it,t);(0,Rr.extendSubschemaData)(r,this.it,t),(0,Rr.extendSubschemaMode)(r,t);const i={...this.it,...r,items:void 0,props:void 0};return ah(i,n),i}mergeEvaluated(t,n){const{it:r,gen:i}=this;!r.opts.unevaluated||(r.props!==!0&&t.props!==void 0&&(r.props=st.mergeEvaluated.props(i,t.props,r.props,n)),r.items!==!0&&t.items!==void 0&&(r.items=st.mergeEvaluated.items(i,t.items,r.items,n)))}mergeValidEvaluated(t,n){const{it:r,gen:i}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return i.if(n,()=>this.mergeEvaluated(t,K.Name)),!0}}Ue.KeywordCxt=us;function cs(e,t,n,r){const i=new us(e,n,t);"code"in n?n.code(i,r):i.$data&&n.validate?(0,pn.funcKeywordCode)(i,n):"macro"in n?(0,pn.macroKeywordCode)(i,n):(n.compile||n.validate)&&(0,pn.funcKeywordCode)(i,n)}const vh=/^\/(?:[^~]|~0|~1)*$/,_h=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function fs(e,{dataLevel:t,dataNames:n,dataPathArr:r}){let i,a;if(e==="")return W.default.rootData;if(e[0]==="/"){if(!vh.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);i=e,a=W.default.rootData}else{const u=_h.exec(e);if(!u)throw new Error(`Invalid JSON-pointer: ${e}`);const c=+u[1];if(i=u[2],i==="#"){if(c>=t)throw new Error(l("property/index",c));return r[t-c]}if(c>t)throw new Error(l("data",c));if(a=n[t-c],!i)return a}let o=a;const s=i.split("/");for(const u of s)u&&(a=(0,K._)`${a}${(0,K.getProperty)((0,st.unescapeJsonPointer)(u))}`,o=(0,K._)`${o} && ${a}`);return o;function l(u,c){return`Cannot access ${u} ${c} levels up, current level is ${t}`}}Ue.getData=fs;var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});class $h extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}Cn.default=$h;var An={};Object.defineProperty(An,"__esModule",{value:!0});const Mr=we;class wh extends Error{constructor(t,n,r,i){super(i||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,Mr.resolveUrl)(t,n,r),this.missingSchema=(0,Mr.normalizeId)((0,Mr.getFullPath)(t,this.missingRef))}}An.default=wh;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.resolveSchema=Ce.getCompilingSchema=Ce.resolveRef=Ce.compileSchema=Ce.SchemaEnv=void 0;const Ve=re,bh=Cn,$t=tt,qe=we,Ga=se,Eh=Ue;class Sr{constructor(t){var n;this.refs={},this.dynamicAnchors={};let r;typeof t.schema=="object"&&(r=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(n=t.baseId)!==null&&n!==void 0?n:(0,qe.normalizeId)(r==null?void 0:r[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}Ce.SchemaEnv=Sr;function wi(e){const t=ds.call(this,e);if(t)return t;const n=(0,qe.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:r,lines:i}=this.opts.code,{ownProperties:a}=this.opts,o=new Ve.CodeGen(this.scope,{es5:r,lines:i,ownProperties:a});let s;e.$async&&(s=o.scopeValue("Error",{ref:bh.default,code:(0,Ve._)`require("ajv/dist/runtime/validation_error").default`}));const l=o.scopeName("validate");e.validateName=l;const u={gen:o,allErrors:this.opts.allErrors,data:$t.default.data,parentData:$t.default.parentData,parentDataProperty:$t.default.parentDataProperty,dataNames:[$t.default.data],dataPathArr:[Ve.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Ve.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:s,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:Ve.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Ve._)`""`,opts:this.opts,self:this};let c;try{this._compilations.add(e),(0,Eh.validateFunctionCode)(u),o.optimize(this.opts.code.optimize);const d=o.toString();c=`${o.scopeRefs($t.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,e));const p=new Function(`${$t.default.self}`,`${$t.default.scope}`,c)(this,this.scope.get());if(this.scope.value(l,{ref:p}),p.errors=null,p.schema=e.schema,p.schemaEnv=e,e.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:l,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:$,items:_}=u;p.evaluated={props:$ instanceof Ve.Name?void 0:$,items:_ instanceof Ve.Name?void 0:_,dynamicProps:$ instanceof Ve.Name,dynamicItems:_ instanceof Ve.Name},p.source&&(p.source.evaluated=(0,Ve.stringify)(p.evaluated))}return e.validate=p,e}catch(d){throw delete e.validate,delete e.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(e)}}Ce.compileSchema=wi;function Sh(e,t,n){var r;n=(0,qe.resolveUrl)(this.opts.uriResolver,t,n);const i=e.refs[n];if(i)return i;let a=kh.call(this,e,n);if(a===void 0){const o=(r=e.localRefs)===null||r===void 0?void 0:r[n],{schemaId:s}=this.opts;o&&(a=new Sr({schema:o,schemaId:s,root:e,baseId:t}))}if(a!==void 0)return e.refs[n]=xh.call(this,a)}Ce.resolveRef=Sh;function xh(e){return(0,qe.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:wi.call(this,e)}function ds(e){for(const t of this._compilations)if(Nh(t,e))return t}Ce.getCompilingSchema=ds;function Nh(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function kh(e,t){let n;for(;typeof(n=this.refs[t])=="string";)t=n;return n||this.schemas[t]||xr.call(this,e,t)}function xr(e,t){const n=this.opts.uriResolver.parse(t),r=(0,qe._getFullPath)(this.opts.uriResolver,n);let i=(0,qe.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===i)return Dr.call(this,n,e);const a=(0,qe.normalizeId)(r),o=this.refs[a]||this.schemas[a];if(typeof o=="string"){const s=xr.call(this,e,o);return typeof(s==null?void 0:s.schema)!="object"?void 0:Dr.call(this,n,s)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||wi.call(this,o),a===(0,qe.normalizeId)(t)){const{schema:s}=o,{schemaId:l}=this.opts,u=s[l];return u&&(i=(0,qe.resolveUrl)(this.opts.uriResolver,i,u)),new Sr({schema:s,schemaId:l,root:e,baseId:i})}return Dr.call(this,n,o)}}Ce.resolveSchema=xr;const Ph=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Dr(e,{baseId:t,schema:n,root:r}){var i;if(((i=e.fragment)===null||i===void 0?void 0:i[0])!=="/")return;for(const s of e.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const l=n[(0,Ga.unescapeFragment)(s)];if(l===void 0)return;n=l;const u=typeof n=="object"&&n[this.opts.schemaId];!Ph.has(s)&&u&&(t=(0,qe.resolveUrl)(this.opts.uriResolver,t,u))}let a;if(typeof n!="boolean"&&n.$ref&&!(0,Ga.schemaHasRulesButRef)(n,this.RULES)){const s=(0,qe.resolveUrl)(this.opts.uriResolver,t,n.$ref);a=xr.call(this,r,s)}const{schemaId:o}=this.opts;if(a=a||new Sr({schema:n,schemaId:o,root:r,baseId:t}),a.schema!==a.root.schema)return a}const Th="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Ch="Meta-schema for $data reference (JSON AnySchema extension proposal)",Ah="object",Oh=["$data"],Rh={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Mh=!1,Dh={$id:Th,description:Ch,type:Ah,required:Oh,properties:Rh,additionalProperties:Mh};var bi={},Yr={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(n,r){r(t)})(rd,function(n){function r(){for(var E=arguments.length,v=Array(E),N=0;N<E;N++)v[N]=arguments[N];if(v.length>1){v[0]=v[0].slice(0,-1);for(var R=v.length-1,O=1;O<R;++O)v[O]=v[O].slice(1,-1);return v[R]=v[R].slice(1),v.join("")}else return v[0]}function i(E){return"(?:"+E+")"}function a(E){return E===void 0?"undefined":E===null?"null":Object.prototype.toString.call(E).split(" ").pop().split("]").shift().toLowerCase()}function o(E){return E.toUpperCase()}function s(E){return E!=null?E instanceof Array?E:typeof E.length!="number"||E.split||E.setInterval||E.call?[E]:Array.prototype.slice.call(E):[]}function l(E,v){var N=E;if(v)for(var R in v)N[R]=v[R];return N}function u(E){var v="[A-Za-z]",N="[0-9]",R=r(N,"[A-Fa-f]"),O=i(i("%[EFef]"+R+"%"+R+R+"%"+R+R)+"|"+i("%[89A-Fa-f]"+R+"%"+R+R)+"|"+i("%"+R+R)),G="[\\:\\/\\?\\#\\[\\]\\@]",B="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",oe=r(G,B),ue=E?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ye=E?"[\\uE000-\\uF8FF]":"[]",ie=r(v,N,"[\\-\\.\\_\\~]",ue);i(v+r(v,N,"[\\+\\-\\.]")+"*"),i(i(O+"|"+r(ie,B,"[\\:]"))+"*");var le=i(i("25[0-5]")+"|"+i("2[0-4]"+N)+"|"+i("1"+N+N)+"|"+i("0?[1-9]"+N)+"|0?0?"+N),ge=i(le+"\\."+le+"\\."+le+"\\."+le),Q=i(R+"{1,4}"),de=i(i(Q+"\\:"+Q)+"|"+ge),_e=i(i(Q+"\\:")+"{6}"+de),he=i("\\:\\:"+i(Q+"\\:")+"{5}"+de),ct=i(i(Q)+"?\\:\\:"+i(Q+"\\:")+"{4}"+de),Xe=i(i(i(Q+"\\:")+"{0,1}"+Q)+"?\\:\\:"+i(Q+"\\:")+"{3}"+de),Ze=i(i(i(Q+"\\:")+"{0,2}"+Q)+"?\\:\\:"+i(Q+"\\:")+"{2}"+de),Dt=i(i(i(Q+"\\:")+"{0,3}"+Q)+"?\\:\\:"+Q+"\\:"+de),vt=i(i(i(Q+"\\:")+"{0,4}"+Q)+"?\\:\\:"+de),je=i(i(i(Q+"\\:")+"{0,5}"+Q)+"?\\:\\:"+Q),Ye=i(i(i(Q+"\\:")+"{0,6}"+Q)+"?\\:\\:"),_t=i([_e,he,ct,Xe,Ze,Dt,vt,je,Ye].join("|")),nt=i(i(ie+"|"+O)+"+");i("[vV]"+R+"+\\."+r(ie,B,"[\\:]")+"+"),i(i(O+"|"+r(ie,B))+"*");var rn=i(O+"|"+r(ie,B,"[\\:\\@]"));return i(i(O+"|"+r(ie,B,"[\\@]"))+"+"),i(i(rn+"|"+r("[\\/\\?]",ye))+"*"),{NOT_SCHEME:new RegExp(r("[^]",v,N,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",ie,B),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",ie,B),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",ie,B),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",ie,B),"g"),NOT_QUERY:new RegExp(r("[^\\%]",ie,B,"[\\:\\@\\/\\?]",ye),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",ie,B,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",ie,B),"g"),UNRESERVED:new RegExp(ie,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",ie,oe),"g"),PCT_ENCODED:new RegExp(O,"g"),IPV4ADDRESS:new RegExp("^("+ge+")$"),IPV6ADDRESS:new RegExp("^\\[?("+_t+")"+i(i("\\%25|\\%(?!"+R+"{2})")+"("+nt+")")+"?\\]?$")}}var c=u(!1),d=u(!0),y=function(){function E(v,N){var R=[],O=!0,G=!1,B=void 0;try{for(var oe=v[Symbol.iterator](),ue;!(O=(ue=oe.next()).done)&&(R.push(ue.value),!(N&&R.length===N));O=!0);}catch(ye){G=!0,B=ye}finally{try{!O&&oe.return&&oe.return()}finally{if(G)throw B}}return R}return function(v,N){if(Array.isArray(v))return v;if(Symbol.iterator in Object(v))return E(v,N);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(E){if(Array.isArray(E)){for(var v=0,N=Array(E.length);v<E.length;v++)N[v]=E[v];return N}else return Array.from(E)},$=2147483647,_=36,m=1,f=26,w=38,x=700,g=72,C=128,S="-",k=/^xn--/,M=/[^\0-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Y=_-m,Z=Math.floor,ee=String.fromCharCode;function T(E){throw new RangeError(H[E])}function V(E,v){for(var N=[],R=E.length;R--;)N[R]=v(E[R]);return N}function z(E,v){var N=E.split("@"),R="";N.length>1&&(R=N[0]+"@",E=N[1]),E=E.replace(L,".");var O=E.split("."),G=V(O,v).join(".");return R+G}function U(E){for(var v=[],N=0,R=E.length;N<R;){var O=E.charCodeAt(N++);if(O>=55296&&O<=56319&&N<R){var G=E.charCodeAt(N++);(G&64512)==56320?v.push(((O&1023)<<10)+(G&1023)+65536):(v.push(O),N--)}else v.push(O)}return v}var X=function(v){return String.fromCodePoint.apply(String,p(v))},J=function(v){return v-48<10?v-22:v-65<26?v-65:v-97<26?v-97:_},j=function(v,N){return v+22+75*(v<26)-((N!=0)<<5)},P=function(v,N,R){var O=0;for(v=R?Z(v/x):v>>1,v+=Z(v/N);v>Y*f>>1;O+=_)v=Z(v/Y);return Z(O+(Y+1)*v/(v+w))},I=function(v){var N=[],R=v.length,O=0,G=C,B=g,oe=v.lastIndexOf(S);oe<0&&(oe=0);for(var ue=0;ue<oe;++ue)v.charCodeAt(ue)>=128&&T("not-basic"),N.push(v.charCodeAt(ue));for(var ye=oe>0?oe+1:0;ye<R;){for(var ie=O,le=1,ge=_;;ge+=_){ye>=R&&T("invalid-input");var Q=J(v.charCodeAt(ye++));(Q>=_||Q>Z(($-O)/le))&&T("overflow"),O+=Q*le;var de=ge<=B?m:ge>=B+f?f:ge-B;if(Q<de)break;var _e=_-de;le>Z($/_e)&&T("overflow"),le*=_e}var he=N.length+1;B=P(O-ie,he,ie==0),Z(O/he)>$-G&&T("overflow"),G+=Z(O/he),O%=he,N.splice(O++,0,G)}return String.fromCodePoint.apply(String,N)},A=function(v){var N=[];v=U(v);var R=v.length,O=C,G=0,B=g,oe=!0,ue=!1,ye=void 0;try{for(var ie=v[Symbol.iterator](),le;!(oe=(le=ie.next()).done);oe=!0){var ge=le.value;ge<128&&N.push(ee(ge))}}catch(an){ue=!0,ye=an}finally{try{!oe&&ie.return&&ie.return()}finally{if(ue)throw ye}}var Q=N.length,de=Q;for(Q&&N.push(S);de<R;){var _e=$,he=!0,ct=!1,Xe=void 0;try{for(var Ze=v[Symbol.iterator](),Dt;!(he=(Dt=Ze.next()).done);he=!0){var vt=Dt.value;vt>=O&&vt<_e&&(_e=vt)}}catch(an){ct=!0,Xe=an}finally{try{!he&&Ze.return&&Ze.return()}finally{if(ct)throw Xe}}var je=de+1;_e-O>Z(($-G)/je)&&T("overflow"),G+=(_e-O)*je,O=_e;var Ye=!0,_t=!1,nt=void 0;try{for(var rn=v[Symbol.iterator](),ha;!(Ye=(ha=rn.next()).done);Ye=!0){var pa=ha.value;if(pa<O&&++G>$&&T("overflow"),pa==O){for(var Mn=G,Dn=_;;Dn+=_){var In=Dn<=B?m:Dn>=B+f?f:Dn-B;if(Mn<In)break;var ma=Mn-In,ya=_-In;N.push(ee(j(In+ma%ya,0))),Mn=Z(ma/ya)}N.push(ee(j(Mn,0))),B=P(G,je,de==Q),G=0,++de}}}catch(an){_t=!0,nt=an}finally{try{!Ye&&rn.return&&rn.return()}finally{if(_t)throw nt}}++G,++O}return N.join("")},h=function(v){return z(v,function(N){return k.test(N)?I(N.slice(4).toLowerCase()):N})},b=function(v){return z(v,function(N){return M.test(N)?"xn--"+A(N):N})},D={version:"2.1.0",ucs2:{decode:U,encode:X},decode:I,encode:A,toASCII:b,toUnicode:h},F={};function q(E){var v=E.charCodeAt(0),N=void 0;return v<16?N="%0"+v.toString(16).toUpperCase():v<128?N="%"+v.toString(16).toUpperCase():v<2048?N="%"+(v>>6|192).toString(16).toUpperCase()+"%"+(v&63|128).toString(16).toUpperCase():N="%"+(v>>12|224).toString(16).toUpperCase()+"%"+(v>>6&63|128).toString(16).toUpperCase()+"%"+(v&63|128).toString(16).toUpperCase(),N}function te(E){for(var v="",N=0,R=E.length;N<R;){var O=parseInt(E.substr(N+1,2),16);if(O<128)v+=String.fromCharCode(O),N+=3;else if(O>=194&&O<224){if(R-N>=6){var G=parseInt(E.substr(N+4,2),16);v+=String.fromCharCode((O&31)<<6|G&63)}else v+=E.substr(N,6);N+=6}else if(O>=224){if(R-N>=9){var B=parseInt(E.substr(N+4,2),16),oe=parseInt(E.substr(N+7,2),16);v+=String.fromCharCode((O&15)<<12|(B&63)<<6|oe&63)}else v+=E.substr(N,9);N+=9}else v+=E.substr(N,3),N+=3}return v}function ae(E,v){function N(R){var O=te(R);return O.match(v.UNRESERVED)?O:R}return E.scheme&&(E.scheme=String(E.scheme).replace(v.PCT_ENCODED,N).toLowerCase().replace(v.NOT_SCHEME,"")),E.userinfo!==void 0&&(E.userinfo=String(E.userinfo).replace(v.PCT_ENCODED,N).replace(v.NOT_USERINFO,q).replace(v.PCT_ENCODED,o)),E.host!==void 0&&(E.host=String(E.host).replace(v.PCT_ENCODED,N).toLowerCase().replace(v.NOT_HOST,q).replace(v.PCT_ENCODED,o)),E.path!==void 0&&(E.path=String(E.path).replace(v.PCT_ENCODED,N).replace(E.scheme?v.NOT_PATH:v.NOT_PATH_NOSCHEME,q).replace(v.PCT_ENCODED,o)),E.query!==void 0&&(E.query=String(E.query).replace(v.PCT_ENCODED,N).replace(v.NOT_QUERY,q).replace(v.PCT_ENCODED,o)),E.fragment!==void 0&&(E.fragment=String(E.fragment).replace(v.PCT_ENCODED,N).replace(v.NOT_FRAGMENT,q).replace(v.PCT_ENCODED,o)),E}function me(E){return E.replace(/^0*(.*)/,"$1")||"0"}function Ke(E,v){var N=E.match(v.IPV4ADDRESS)||[],R=y(N,2),O=R[1];return O?O.split(".").map(me).join("."):E}function Tt(E,v){var N=E.match(v.IPV6ADDRESS)||[],R=y(N,3),O=R[1],G=R[2];if(O){for(var B=O.toLowerCase().split("::").reverse(),oe=y(B,2),ue=oe[0],ye=oe[1],ie=ye?ye.split(":").map(me):[],le=ue.split(":").map(me),ge=v.IPV4ADDRESS.test(le[le.length-1]),Q=ge?7:8,de=le.length-Q,_e=Array(Q),he=0;he<Q;++he)_e[he]=ie[he]||le[de+he]||"";ge&&(_e[Q-1]=Ke(_e[Q-1],v));var ct=_e.reduce(function(je,Ye,_t){if(!Ye||Ye==="0"){var nt=je[je.length-1];nt&&nt.index+nt.length===_t?nt.length++:je.push({index:_t,length:1})}return je},[]),Xe=ct.sort(function(je,Ye){return Ye.length-je.length})[0],Ze=void 0;if(Xe&&Xe.length>1){var Dt=_e.slice(0,Xe.index),vt=_e.slice(Xe.index+Xe.length);Ze=Dt.join(":")+"::"+vt.join(":")}else Ze=_e.join(":");return G&&(Ze+="%"+G),Ze}else return E}var Yt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Jt="".match(/(){0}/)[1]===void 0;function Re(E){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N={},R=v.iri!==!1?d:c;v.reference==="suffix"&&(E=(v.scheme?v.scheme+":":"")+"//"+E);var O=E.match(Yt);if(O){Jt?(N.scheme=O[1],N.userinfo=O[3],N.host=O[4],N.port=parseInt(O[5],10),N.path=O[6]||"",N.query=O[7],N.fragment=O[8],isNaN(N.port)&&(N.port=O[5])):(N.scheme=O[1]||void 0,N.userinfo=E.indexOf("@")!==-1?O[3]:void 0,N.host=E.indexOf("//")!==-1?O[4]:void 0,N.port=parseInt(O[5],10),N.path=O[6]||"",N.query=E.indexOf("?")!==-1?O[7]:void 0,N.fragment=E.indexOf("#")!==-1?O[8]:void 0,isNaN(N.port)&&(N.port=E.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?O[4]:void 0)),N.host&&(N.host=Tt(Ke(N.host,R),R)),N.scheme===void 0&&N.userinfo===void 0&&N.host===void 0&&N.port===void 0&&!N.path&&N.query===void 0?N.reference="same-document":N.scheme===void 0?N.reference="relative":N.fragment===void 0?N.reference="absolute":N.reference="uri",v.reference&&v.reference!=="suffix"&&v.reference!==N.reference&&(N.error=N.error||"URI is not a "+v.reference+" reference.");var G=F[(v.scheme||N.scheme||"").toLowerCase()];if(!v.unicodeSupport&&(!G||!G.unicodeSupport)){if(N.host&&(v.domainHost||G&&G.domainHost))try{N.host=D.toASCII(N.host.replace(R.PCT_ENCODED,te).toLowerCase())}catch(B){N.error=N.error||"Host's domain name can not be converted to ASCII via punycode: "+B}ae(N,c)}else ae(N,R);G&&G.parse&&G.parse(N,v)}else N.error=N.error||"URI can not be parsed.";return N}function Wt(E,v){var N=v.iri!==!1?d:c,R=[];return E.userinfo!==void 0&&(R.push(E.userinfo),R.push("@")),E.host!==void 0&&R.push(Tt(Ke(String(E.host),N),N).replace(N.IPV6ADDRESS,function(O,G,B){return"["+G+(B?"%25"+B:"")+"]"})),(typeof E.port=="number"||typeof E.port=="string")&&(R.push(":"),R.push(String(E.port))),R.length?R.join(""):void 0}var Ct=/^\.\.?\//,At=/^\/\.(\/|$)/,Ot=/^\/\.\.(\/|$)/,Qt=/^\/?(?:.|\n)*?(?=\/|$)/;function Ge(E){for(var v=[];E.length;)if(E.match(Ct))E=E.replace(Ct,"");else if(E.match(At))E=E.replace(At,"/");else if(E.match(Ot))E=E.replace(Ot,"/"),v.pop();else if(E==="."||E==="..")E="";else{var N=E.match(Qt);if(N){var R=N[0];E=E.slice(R.length),v.push(R)}else throw new Error("Unexpected dot segment condition")}return v.join("")}function Pe(E){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=v.iri?d:c,R=[],O=F[(v.scheme||E.scheme||"").toLowerCase()];if(O&&O.serialize&&O.serialize(E,v),E.host&&!N.IPV6ADDRESS.test(E.host)){if(v.domainHost||O&&O.domainHost)try{E.host=v.iri?D.toUnicode(E.host):D.toASCII(E.host.replace(N.PCT_ENCODED,te).toLowerCase())}catch(oe){E.error=E.error||"Host's domain name can not be converted to "+(v.iri?"Unicode":"ASCII")+" via punycode: "+oe}}ae(E,N),v.reference!=="suffix"&&E.scheme&&(R.push(E.scheme),R.push(":"));var G=Wt(E,v);if(G!==void 0&&(v.reference!=="suffix"&&R.push("//"),R.push(G),E.path&&E.path.charAt(0)!=="/"&&R.push("/")),E.path!==void 0){var B=E.path;!v.absolutePath&&(!O||!O.absolutePath)&&(B=Ge(B)),G===void 0&&(B=B.replace(/^\/\//,"/%2F")),R.push(B)}return E.query!==void 0&&(R.push("?"),R.push(E.query)),E.fragment!==void 0&&(R.push("#"),R.push(E.fragment)),R.join("")}function Rt(E,v){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},R=arguments[3],O={};return R||(E=Re(Pe(E,N),N),v=Re(Pe(v,N),N)),N=N||{},!N.tolerant&&v.scheme?(O.scheme=v.scheme,O.userinfo=v.userinfo,O.host=v.host,O.port=v.port,O.path=Ge(v.path||""),O.query=v.query):(v.userinfo!==void 0||v.host!==void 0||v.port!==void 0?(O.userinfo=v.userinfo,O.host=v.host,O.port=v.port,O.path=Ge(v.path||""),O.query=v.query):(v.path?(v.path.charAt(0)==="/"?O.path=Ge(v.path):((E.userinfo!==void 0||E.host!==void 0||E.port!==void 0)&&!E.path?O.path="/"+v.path:E.path?O.path=E.path.slice(0,E.path.lastIndexOf("/")+1)+v.path:O.path=v.path,O.path=Ge(O.path)),O.query=v.query):(O.path=E.path,v.query!==void 0?O.query=v.query:O.query=E.query),O.userinfo=E.userinfo,O.host=E.host,O.port=E.port),O.scheme=E.scheme),O.fragment=v.fragment,O}function en(E,v,N){var R=l({scheme:"null"},N);return Pe(Rt(Re(E,R),Re(v,R),R,!0),R)}function yt(E,v){return typeof E=="string"?E=Pe(Re(E,v),v):a(E)==="object"&&(E=Re(Pe(E,v),v)),E}function tn(E,v,N){return typeof E=="string"?E=Pe(Re(E,N),N):a(E)==="object"&&(E=Pe(E,N)),typeof v=="string"?v=Pe(Re(v,N),N):a(v)==="object"&&(v=Pe(v,N)),E===v}function Rn(E,v){return E&&E.toString().replace(!v||!v.iri?c.ESCAPE:d.ESCAPE,q)}function Ie(E,v){return E&&E.toString().replace(!v||!v.iri?c.PCT_ENCODED:d.PCT_ENCODED,te)}var gt={scheme:"http",domainHost:!0,parse:function(v,N){return v.host||(v.error=v.error||"HTTP URIs must have a host."),v},serialize:function(v,N){var R=String(v.scheme).toLowerCase()==="https";return(v.port===(R?443:80)||v.port==="")&&(v.port=void 0),v.path||(v.path="/"),v}},aa={scheme:"https",domainHost:gt.domainHost,parse:gt.parse,serialize:gt.serialize};function oa(E){return typeof E.secure=="boolean"?E.secure:String(E.scheme).toLowerCase()==="wss"}var nn={scheme:"ws",domainHost:!0,parse:function(v,N){var R=v;return R.secure=oa(R),R.resourceName=(R.path||"/")+(R.query?"?"+R.query:""),R.path=void 0,R.query=void 0,R},serialize:function(v,N){if((v.port===(oa(v)?443:80)||v.port==="")&&(v.port=void 0),typeof v.secure=="boolean"&&(v.scheme=v.secure?"wss":"ws",v.secure=void 0),v.resourceName){var R=v.resourceName.split("?"),O=y(R,2),G=O[0],B=O[1];v.path=G&&G!=="/"?G:void 0,v.query=B,v.resourceName=void 0}return v.fragment=void 0,v}},sa={scheme:"wss",domainHost:nn.domainHost,parse:nn.parse,serialize:nn.serialize},Ds={},la="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Be="[0-9A-Fa-f]",Is=i(i("%[EFef]"+Be+"%"+Be+Be+"%"+Be+Be)+"|"+i("%[89A-Fa-f]"+Be+"%"+Be+Be)+"|"+i("%"+Be+Be)),js="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",zs="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Vs=r(zs,'[\\"\\\\]'),Fs="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Ls=new RegExp(la,"g"),Mt=new RegExp(Is,"g"),qs=new RegExp(r("[^]",js,"[\\.]",'[\\"]',Vs),"g"),ua=new RegExp(r("[^]",la,Fs),"g"),Us=ua;function Pr(E){var v=te(E);return v.match(Ls)?v:E}var ca={scheme:"mailto",parse:function(v,N){var R=v,O=R.to=R.path?R.path.split(","):[];if(R.path=void 0,R.query){for(var G=!1,B={},oe=R.query.split("&"),ue=0,ye=oe.length;ue<ye;++ue){var ie=oe[ue].split("=");switch(ie[0]){case"to":for(var le=ie[1].split(","),ge=0,Q=le.length;ge<Q;++ge)O.push(le[ge]);break;case"subject":R.subject=Ie(ie[1],N);break;case"body":R.body=Ie(ie[1],N);break;default:G=!0,B[Ie(ie[0],N)]=Ie(ie[1],N);break}}G&&(R.headers=B)}R.query=void 0;for(var de=0,_e=O.length;de<_e;++de){var he=O[de].split("@");if(he[0]=Ie(he[0]),N.unicodeSupport)he[1]=Ie(he[1],N).toLowerCase();else try{he[1]=D.toASCII(Ie(he[1],N).toLowerCase())}catch(ct){R.error=R.error||"Email address's domain name can not be converted to ASCII via punycode: "+ct}O[de]=he.join("@")}return R},serialize:function(v,N){var R=v,O=s(v.to);if(O){for(var G=0,B=O.length;G<B;++G){var oe=String(O[G]),ue=oe.lastIndexOf("@"),ye=oe.slice(0,ue).replace(Mt,Pr).replace(Mt,o).replace(qs,q),ie=oe.slice(ue+1);try{ie=N.iri?D.toUnicode(ie):D.toASCII(Ie(ie,N).toLowerCase())}catch(de){R.error=R.error||"Email address's domain name can not be converted to "+(N.iri?"Unicode":"ASCII")+" via punycode: "+de}O[G]=ye+"@"+ie}R.path=O.join(",")}var le=v.headers=v.headers||{};v.subject&&(le.subject=v.subject),v.body&&(le.body=v.body);var ge=[];for(var Q in le)le[Q]!==Ds[Q]&&ge.push(Q.replace(Mt,Pr).replace(Mt,o).replace(ua,q)+"="+le[Q].replace(Mt,Pr).replace(Mt,o).replace(Us,q));return ge.length&&(R.query=ge.join("&")),R}},Hs=/^([^\:]+)\:(.*)/,fa={scheme:"urn",parse:function(v,N){var R=v.path&&v.path.match(Hs),O=v;if(R){var G=N.scheme||O.scheme||"urn",B=R[1].toLowerCase(),oe=R[2],ue=G+":"+(N.nid||B),ye=F[ue];O.nid=B,O.nss=oe,O.path=void 0,ye&&(O=ye.parse(O,N))}else O.error=O.error||"URN can not be parsed.";return O},serialize:function(v,N){var R=N.scheme||v.scheme||"urn",O=v.nid,G=R+":"+(N.nid||O),B=F[G];B&&(v=B.serialize(v,N));var oe=v,ue=v.nss;return oe.path=(O||N.nid)+":"+ue,oe}},Ks=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,da={scheme:"urn:uuid",parse:function(v,N){var R=v;return R.uuid=R.nss,R.nss=void 0,!N.tolerant&&(!R.uuid||!R.uuid.match(Ks))&&(R.error=R.error||"UUID is not valid."),R},serialize:function(v,N){var R=v;return R.nss=(v.uuid||"").toLowerCase(),R}};F[gt.scheme]=gt,F[aa.scheme]=aa,F[nn.scheme]=nn,F[sa.scheme]=sa,F[ca.scheme]=ca,F[fa.scheme]=fa,F[da.scheme]=da,n.SCHEMES=F,n.pctEncChar=q,n.pctDecChars=te,n.parse=Re,n.removeDotSegments=Ge,n.serialize=Pe,n.resolveComponents=Rt,n.resolve=en,n.normalize=yt,n.equal=tn,n.escapeComponent=Rn,n.unescapeComponent=Ie,Object.defineProperty(n,"__esModule",{value:!0})})})(Yr,Yr.exports);Object.defineProperty(bi,"__esModule",{value:!0});const hs=Yr.exports;hs.code='require("ajv/dist/runtime/uri").default';bi.default=hs;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Ue;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var n=re;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=Cn,i=An,a=kt,o=Ce,s=re,l=we,u=Tn,c=se,d=Dh,y=bi,p=(j,P)=>new RegExp(j,P);p.code="new RegExp";const $=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},f={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},w=200;function x(j){var P,I,A,h,b,D,F,q,te,ae,me,Ke,Tt,Yt,Jt,Re,Wt,Ct,At,Ot,Qt,Ge,Pe,Rt,en;const yt=j.strict,tn=(P=j.code)===null||P===void 0?void 0:P.optimize,Rn=tn===!0||tn===void 0?1:tn||0,Ie=(A=(I=j.code)===null||I===void 0?void 0:I.regExp)!==null&&A!==void 0?A:p,gt=(h=j.uriResolver)!==null&&h!==void 0?h:y.default;return{strictSchema:(D=(b=j.strictSchema)!==null&&b!==void 0?b:yt)!==null&&D!==void 0?D:!0,strictNumbers:(q=(F=j.strictNumbers)!==null&&F!==void 0?F:yt)!==null&&q!==void 0?q:!0,strictTypes:(ae=(te=j.strictTypes)!==null&&te!==void 0?te:yt)!==null&&ae!==void 0?ae:"log",strictTuples:(Ke=(me=j.strictTuples)!==null&&me!==void 0?me:yt)!==null&&Ke!==void 0?Ke:"log",strictRequired:(Yt=(Tt=j.strictRequired)!==null&&Tt!==void 0?Tt:yt)!==null&&Yt!==void 0?Yt:!1,code:j.code?{...j.code,optimize:Rn,regExp:Ie}:{optimize:Rn,regExp:Ie},loopRequired:(Jt=j.loopRequired)!==null&&Jt!==void 0?Jt:w,loopEnum:(Re=j.loopEnum)!==null&&Re!==void 0?Re:w,meta:(Wt=j.meta)!==null&&Wt!==void 0?Wt:!0,messages:(Ct=j.messages)!==null&&Ct!==void 0?Ct:!0,inlineRefs:(At=j.inlineRefs)!==null&&At!==void 0?At:!0,schemaId:(Ot=j.schemaId)!==null&&Ot!==void 0?Ot:"$id",addUsedSchema:(Qt=j.addUsedSchema)!==null&&Qt!==void 0?Qt:!0,validateSchema:(Ge=j.validateSchema)!==null&&Ge!==void 0?Ge:!0,validateFormats:(Pe=j.validateFormats)!==null&&Pe!==void 0?Pe:!0,unicodeRegExp:(Rt=j.unicodeRegExp)!==null&&Rt!==void 0?Rt:!0,int32range:(en=j.int32range)!==null&&en!==void 0?en:!0,uriResolver:gt}}class g{constructor(P={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,P=this.opts={...P,...x(P)};const{es5:I,lines:A}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:_,es5:I,lines:A}),this.logger=Z(P.logger);const h=P.validateFormats;P.validateFormats=!1,this.RULES=(0,a.getRules)(),C.call(this,m,P,"NOT SUPPORTED"),C.call(this,f,P,"DEPRECATED","warn"),this._metaOpts=H.call(this),P.formats&&M.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),P.keywords&&L.call(this,P.keywords),typeof P.meta=="object"&&this.addMetaSchema(P.meta),k.call(this),P.validateFormats=h}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:P,meta:I,schemaId:A}=this.opts;let h=d;A==="id"&&(h={...d},h.id=h.$id,delete h.$id),I&&P&&this.addMetaSchema(h,h[A],!1)}defaultMeta(){const{meta:P,schemaId:I}=this.opts;return this.opts.defaultMeta=typeof P=="object"?P[I]||P:void 0}validate(P,I){let A;if(typeof P=="string"){if(A=this.getSchema(P),!A)throw new Error(`no schema with key or ref "${P}"`)}else A=this.compile(P);const h=A(I);return"$async"in A||(this.errors=A.errors),h}compile(P,I){const A=this._addSchema(P,I);return A.validate||this._compileSchemaEnv(A)}compileAsync(P,I){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:A}=this.opts;return h.call(this,P,I);async function h(ae,me){await b.call(this,ae.$schema);const Ke=this._addSchema(ae,me);return Ke.validate||D.call(this,Ke)}async function b(ae){ae&&!this.getSchema(ae)&&await h.call(this,{$ref:ae},!0)}async function D(ae){try{return this._compileSchemaEnv(ae)}catch(me){if(!(me instanceof i.default))throw me;return F.call(this,me),await q.call(this,me.missingSchema),D.call(this,ae)}}function F({missingSchema:ae,missingRef:me}){if(this.refs[ae])throw new Error(`AnySchema ${ae} is loaded but ${me} cannot be resolved`)}async function q(ae){const me=await te.call(this,ae);this.refs[ae]||await b.call(this,me.$schema),this.refs[ae]||this.addSchema(me,ae,I)}async function te(ae){const me=this._loading[ae];if(me)return me;try{return await(this._loading[ae]=A(ae))}finally{delete this._loading[ae]}}}addSchema(P,I,A,h=this.opts.validateSchema){if(Array.isArray(P)){for(const D of P)this.addSchema(D,void 0,A,h);return this}let b;if(typeof P=="object"){const{schemaId:D}=this.opts;if(b=P[D],b!==void 0&&typeof b!="string")throw new Error(`schema ${D} must be string`)}return I=(0,l.normalizeId)(I||b),this._checkUnique(I),this.schemas[I]=this._addSchema(P,A,I,h,!0),this}addMetaSchema(P,I,A=this.opts.validateSchema){return this.addSchema(P,I,!0,A),this}validateSchema(P,I){if(typeof P=="boolean")return!0;let A;if(A=P.$schema,A!==void 0&&typeof A!="string")throw new Error("$schema must be a string");if(A=A||this.opts.defaultMeta||this.defaultMeta(),!A)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const h=this.validate(A,P);if(!h&&I){const b="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(b);else throw new Error(b)}return h}getSchema(P){let I;for(;typeof(I=S.call(this,P))=="string";)P=I;if(I===void 0){const{schemaId:A}=this.opts,h=new o.SchemaEnv({schema:{},schemaId:A});if(I=o.resolveSchema.call(this,h,P),!I)return;this.refs[P]=I}return I.validate||this._compileSchemaEnv(I)}removeSchema(P){if(P instanceof RegExp)return this._removeAllSchemas(this.schemas,P),this._removeAllSchemas(this.refs,P),this;switch(typeof P){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const I=S.call(this,P);return typeof I=="object"&&this._cache.delete(I.schema),delete this.schemas[P],delete this.refs[P],this}case"object":{const I=P;this._cache.delete(I);let A=P[this.opts.schemaId];return A&&(A=(0,l.normalizeId)(A),delete this.schemas[A],delete this.refs[A]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(P){for(const I of P)this.addKeyword(I);return this}addKeyword(P,I){let A;if(typeof P=="string")A=P,typeof I=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),I.keyword=A);else if(typeof P=="object"&&I===void 0){if(I=P,A=I.keyword,Array.isArray(A)&&!A.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(T.call(this,A,I),!I)return(0,c.eachItem)(A,b=>V.call(this,b)),this;U.call(this,I);const h={...I,type:(0,u.getJSONTypes)(I.type),schemaType:(0,u.getJSONTypes)(I.schemaType)};return(0,c.eachItem)(A,h.type.length===0?b=>V.call(this,b,h):b=>h.type.forEach(D=>V.call(this,b,h,D))),this}getKeyword(P){const I=this.RULES.all[P];return typeof I=="object"?I.definition:!!I}removeKeyword(P){const{RULES:I}=this;delete I.keywords[P],delete I.all[P];for(const A of I.rules){const h=A.rules.findIndex(b=>b.keyword===P);h>=0&&A.rules.splice(h,1)}return this}addFormat(P,I){return typeof I=="string"&&(I=new RegExp(I)),this.formats[P]=I,this}errorsText(P=this.errors,{separator:I=", ",dataVar:A="data"}={}){return!P||P.length===0?"No errors":P.map(h=>`${A}${h.instancePath} ${h.message}`).reduce((h,b)=>h+I+b)}$dataMetaSchema(P,I){const A=this.RULES.all;P=JSON.parse(JSON.stringify(P));for(const h of I){const b=h.split("/").slice(1);let D=P;for(const F of b)D=D[F];for(const F in A){const q=A[F];if(typeof q!="object")continue;const{$data:te}=q.definition,ae=D[F];te&&ae&&(D[F]=J(ae))}}return P}_removeAllSchemas(P,I){for(const A in P){const h=P[A];(!I||I.test(A))&&(typeof h=="string"?delete P[A]:h&&!h.meta&&(this._cache.delete(h.schema),delete P[A]))}}_addSchema(P,I,A,h=this.opts.validateSchema,b=this.opts.addUsedSchema){let D;const{schemaId:F}=this.opts;if(typeof P=="object")D=P[F];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof P!="boolean")throw new Error("schema must be object or boolean")}let q=this._cache.get(P);if(q!==void 0)return q;A=(0,l.normalizeId)(D||A);const te=l.getSchemaRefs.call(this,P,A);return q=new o.SchemaEnv({schema:P,schemaId:F,meta:I,baseId:A,localRefs:te}),this._cache.set(q.schema,q),b&&!A.startsWith("#")&&(A&&this._checkUnique(A),this.refs[A]=q),h&&this.validateSchema(P,!0),q}_checkUnique(P){if(this.schemas[P]||this.refs[P])throw new Error(`schema with key or id "${P}" already exists`)}_compileSchemaEnv(P){if(P.meta?this._compileMetaSchema(P):o.compileSchema.call(this,P),!P.validate)throw new Error("ajv implementation error");return P.validate}_compileMetaSchema(P){const I=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,P)}finally{this.opts=I}}}e.default=g,g.ValidationError=r.default,g.MissingRefError=i.default;function C(j,P,I,A="error"){for(const h in j){const b=h;b in P&&this.logger[A](`${I}: option ${h}. ${j[b]}`)}}function S(j){return j=(0,l.normalizeId)(j),this.schemas[j]||this.refs[j]}function k(){const j=this.opts.schemas;if(!!j)if(Array.isArray(j))this.addSchema(j);else for(const P in j)this.addSchema(j[P],P)}function M(){for(const j in this.opts.formats){const P=this.opts.formats[j];P&&this.addFormat(j,P)}}function L(j){if(Array.isArray(j)){this.addVocabulary(j);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const P in j){const I=j[P];I.keyword||(I.keyword=P),this.addKeyword(I)}}function H(){const j={...this.opts};for(const P of $)delete j[P];return j}const Y={log(){},warn(){},error(){}};function Z(j){if(j===!1)return Y;if(j===void 0)return console;if(j.log&&j.warn&&j.error)return j;throw new Error("logger must implement log, warn and error methods")}const ee=/^[a-z_$][a-z0-9_$:-]*$/i;function T(j,P){const{RULES:I}=this;if((0,c.eachItem)(j,A=>{if(I.keywords[A])throw new Error(`Keyword ${A} is already defined`);if(!ee.test(A))throw new Error(`Keyword ${A} has invalid name`)}),!!P&&P.$data&&!("code"in P||"validate"in P))throw new Error('$data keyword must have "code" or "validate" function')}function V(j,P,I){var A;const h=P==null?void 0:P.post;if(I&&h)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:b}=this;let D=h?b.post:b.rules.find(({type:q})=>q===I);if(D||(D={type:I,rules:[]},b.rules.push(D)),b.keywords[j]=!0,!P)return;const F={keyword:j,definition:{...P,type:(0,u.getJSONTypes)(P.type),schemaType:(0,u.getJSONTypes)(P.schemaType)}};P.before?z.call(this,D,F,P.before):D.rules.push(F),b.all[j]=F,(A=P.implements)===null||A===void 0||A.forEach(q=>this.addKeyword(q))}function z(j,P,I){const A=j.rules.findIndex(h=>h.keyword===I);A>=0?j.rules.splice(A,0,P):(j.rules.push(P),this.logger.warn(`rule ${I} is not defined`))}function U(j){let{metaSchema:P}=j;P!==void 0&&(j.$data&&this.opts.$data&&(P=J(P)),j.validateSchema=this.compile(P,!0))}const X={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function J(j){return{anyOf:[j,X]}}})(Uo);var Ei={},Si={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});const Ih={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};xi.default=Ih;var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.callRef=Pt.getValidate=void 0;const jh=An,Ba=ne,Te=re,jt=tt,Xa=Ce,qn=se,zh={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:r}=e,{baseId:i,schemaEnv:a,validateName:o,opts:s,self:l}=r,{root:u}=a;if((n==="#"||n==="#/")&&i===u.baseId)return d();const c=Xa.resolveRef.call(l,u,i,n);if(c===void 0)throw new jh.default(r.opts.uriResolver,i,n);if(c instanceof Xa.SchemaEnv)return y(c);return p(c);function d(){if(a===u)return Wn(e,o,a,a.$async);const $=t.scopeValue("root",{ref:u});return Wn(e,(0,Te._)`${$}.validate`,u,u.$async)}function y($){const _=ps(e,$);Wn(e,_,$,$.$async)}function p($){const _=t.scopeValue("schema",s.code.source===!0?{ref:$,code:(0,Te.stringify)($)}:{ref:$}),m=t.name("valid"),f=e.subschema({schema:$,dataTypes:[],schemaPath:Te.nil,topSchemaRef:_,errSchemaPath:n},m);e.mergeEvaluated(f),e.ok(m)}}};function ps(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,Te._)`${n.scopeValue("wrapper",{ref:t})}.validate`}Pt.getValidate=ps;function Wn(e,t,n,r){const{gen:i,it:a}=e,{allErrors:o,schemaEnv:s,opts:l}=a,u=l.passContext?jt.default.this:Te.nil;r?c():d();function c(){if(!s.$async)throw new Error("async schema referenced by sync schema");const $=i.let("valid");i.try(()=>{i.code((0,Te._)`await ${(0,Ba.callValidateCode)(e,t,u)}`),p(t),o||i.assign($,!0)},_=>{i.if((0,Te._)`!(${_} instanceof ${a.ValidationError})`,()=>i.throw(_)),y(_),o||i.assign($,!1)}),e.ok($)}function d(){e.result((0,Ba.callValidateCode)(e,t,u),()=>p(t),()=>y(t))}function y($){const _=(0,Te._)`${$}.errors`;i.assign(jt.default.vErrors,(0,Te._)`${jt.default.vErrors} === null ? ${_} : ${jt.default.vErrors}.concat(${_})`),i.assign(jt.default.errors,(0,Te._)`${jt.default.vErrors}.length`)}function p($){var _;if(!a.opts.unevaluated)return;const m=(_=n==null?void 0:n.validate)===null||_===void 0?void 0:_.evaluated;if(a.props!==!0)if(m&&!m.dynamicProps)m.props!==void 0&&(a.props=qn.mergeEvaluated.props(i,m.props,a.props));else{const f=i.var("props",(0,Te._)`${$}.evaluated.props`);a.props=qn.mergeEvaluated.props(i,f,a.props,Te.Name)}if(a.items!==!0)if(m&&!m.dynamicItems)m.items!==void 0&&(a.items=qn.mergeEvaluated.items(i,m.items,a.items));else{const f=i.var("items",(0,Te._)`${$}.evaluated.items`);a.items=qn.mergeEvaluated.items(i,f,a.items,Te.Name)}}}Pt.callRef=Wn;Pt.default=zh;Object.defineProperty(Si,"__esModule",{value:!0});const Vh=xi,Fh=Pt,Lh=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Vh.default,Fh.default];Si.default=Lh;var Ni={},ki={};Object.defineProperty(ki,"__esModule",{value:!0});const cr=re,dt=cr.operators,fr={maximum:{okStr:"<=",ok:dt.LTE,fail:dt.GT},minimum:{okStr:">=",ok:dt.GTE,fail:dt.LT},exclusiveMaximum:{okStr:"<",ok:dt.LT,fail:dt.GTE},exclusiveMinimum:{okStr:">",ok:dt.GT,fail:dt.LTE}},qh={message:({keyword:e,schemaCode:t})=>(0,cr.str)`must be ${fr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,cr._)`{comparison: ${fr[e].okStr}, limit: ${t}}`},Uh={keyword:Object.keys(fr),type:"number",schemaType:"number",$data:!0,error:qh,code(e){const{keyword:t,data:n,schemaCode:r}=e;e.fail$data((0,cr._)`${n} ${fr[t].fail} ${r} || isNaN(${n})`)}};ki.default=Uh;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});const mn=re,Hh={message:({schemaCode:e})=>(0,mn.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,mn._)`{multipleOf: ${e}}`},Kh={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Hh,code(e){const{gen:t,data:n,schemaCode:r,it:i}=e,a=i.opts.multipleOfPrecision,o=t.let("res"),s=a?(0,mn._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${a}`:(0,mn._)`${o} !== parseInt(${o})`;e.fail$data((0,mn._)`(${r} === 0 || (${o} = ${n}/${r}, ${s}))`)}};Pi.default=Kh;var Ti={},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});function ms(e){const t=e.length;let n=0,r=0,i;for(;r<t;)n++,i=e.charCodeAt(r++),i>=55296&&i<=56319&&r<t&&(i=e.charCodeAt(r),(i&64512)===56320&&r++);return n}Ci.default=ms;ms.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Ti,"__esModule",{value:!0});const bt=re,Gh=se,Bh=Ci,Xh={message({keyword:e,schemaCode:t}){const n=e==="maxLength"?"more":"fewer";return(0,bt.str)`must NOT have ${n} than ${t} characters`},params:({schemaCode:e})=>(0,bt._)`{limit: ${e}}`},Zh={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Xh,code(e){const{keyword:t,data:n,schemaCode:r,it:i}=e,a=t==="maxLength"?bt.operators.GT:bt.operators.LT,o=i.opts.unicode===!1?(0,bt._)`${n}.length`:(0,bt._)`${(0,Gh.useFunc)(e.gen,Bh.default)}(${n})`;e.fail$data((0,bt._)`${o} ${a} ${r}`)}};Ti.default=Zh;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});const Yh=ne,dr=re,Jh={message:({schemaCode:e})=>(0,dr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,dr._)`{pattern: ${e}}`},Wh={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Jh,code(e){const{data:t,$data:n,schema:r,schemaCode:i,it:a}=e,o=a.opts.unicodeRegExp?"u":"",s=n?(0,dr._)`(new RegExp(${i}, ${o}))`:(0,Yh.usePattern)(e,r);e.fail$data((0,dr._)`!${s}.test(${t})`)}};Ai.default=Wh;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});const yn=re,Qh={message({keyword:e,schemaCode:t}){const n=e==="maxProperties"?"more":"fewer";return(0,yn.str)`must NOT have ${n} than ${t} properties`},params:({schemaCode:e})=>(0,yn._)`{limit: ${e}}`},ep={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Qh,code(e){const{keyword:t,data:n,schemaCode:r}=e,i=t==="maxProperties"?yn.operators.GT:yn.operators.LT;e.fail$data((0,yn._)`Object.keys(${n}).length ${i} ${r}`)}};Oi.default=ep;var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});const un=ne,gn=re,tp=se,np={message:({params:{missingProperty:e}})=>(0,gn.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,gn._)`{missingProperty: ${e}}`},rp={keyword:"required",type:"object",schemaType:"array",$data:!0,error:np,code(e){const{gen:t,schema:n,schemaCode:r,data:i,$data:a,it:o}=e,{opts:s}=o;if(!a&&n.length===0)return;const l=n.length>=s.loopRequired;if(o.allErrors?u():c(),s.strictRequired){const p=e.parentSchema.properties,{definedProperties:$}=e.it;for(const _ of n)if((p==null?void 0:p[_])===void 0&&!$.has(_)){const m=o.schemaEnv.baseId+o.errSchemaPath,f=`required property "${_}" is not defined at "${m}" (strictRequired)`;(0,tp.checkStrictMode)(o,f,o.opts.strictRequired)}}function u(){if(l||a)e.block$data(gn.nil,d);else for(const p of n)(0,un.checkReportMissingProp)(e,p)}function c(){const p=t.let("missing");if(l||a){const $=t.let("valid",!0);e.block$data($,()=>y(p,$)),e.ok($)}else t.if((0,un.checkMissingProp)(e,n,p)),(0,un.reportMissingProp)(e,p),t.else()}function d(){t.forOf("prop",r,p=>{e.setParams({missingProperty:p}),t.if((0,un.noPropertyInData)(t,i,p,s.ownProperties),()=>e.error())})}function y(p,$){e.setParams({missingProperty:p}),t.forOf(p,r,()=>{t.assign($,(0,un.propertyInData)(t,i,p,s.ownProperties)),t.if((0,gn.not)($),()=>{e.error(),t.break()})},gn.nil)}}};Ri.default=rp;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});const vn=re,ip={message({keyword:e,schemaCode:t}){const n=e==="maxItems"?"more":"fewer";return(0,vn.str)`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>(0,vn._)`{limit: ${e}}`},ap={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:ip,code(e){const{keyword:t,data:n,schemaCode:r}=e,i=t==="maxItems"?vn.operators.GT:vn.operators.LT;e.fail$data((0,vn._)`${n}.length ${i} ${r}`)}};Mi.default=ap;var Di={},On={};Object.defineProperty(On,"__esModule",{value:!0});const ys=Jo;ys.code='require("ajv/dist/runtime/equal").default';On.default=ys;Object.defineProperty(Di,"__esModule",{value:!0});const Ir=Tn,$e=re,op=se,sp=On,lp={message:({params:{i:e,j:t}})=>(0,$e.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,$e._)`{i: ${e}, j: ${t}}`},up={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:lp,code(e){const{gen:t,data:n,$data:r,schema:i,parentSchema:a,schemaCode:o,it:s}=e;if(!r&&!i)return;const l=t.let("valid"),u=a.items?(0,Ir.getSchemaTypes)(a.items):[];e.block$data(l,c,(0,$e._)`${o} === false`),e.ok(l);function c(){const $=t.let("i",(0,$e._)`${n}.length`),_=t.let("j");e.setParams({i:$,j:_}),t.assign(l,!0),t.if((0,$e._)`${$} > 1`,()=>(d()?y:p)($,_))}function d(){return u.length>0&&!u.some($=>$==="object"||$==="array")}function y($,_){const m=t.name("item"),f=(0,Ir.checkDataTypes)(u,m,s.opts.strictNumbers,Ir.DataType.Wrong),w=t.const("indices",(0,$e._)`{}`);t.for((0,$e._)`;${$}--;`,()=>{t.let(m,(0,$e._)`${n}[${$}]`),t.if(f,(0,$e._)`continue`),u.length>1&&t.if((0,$e._)`typeof ${m} == "string"`,(0,$e._)`${m} += "_"`),t.if((0,$e._)`typeof ${w}[${m}] == "number"`,()=>{t.assign(_,(0,$e._)`${w}[${m}]`),e.error(),t.assign(l,!1).break()}).code((0,$e._)`${w}[${m}] = ${$}`)})}function p($,_){const m=(0,op.useFunc)(t,sp.default),f=t.name("outer");t.label(f).for((0,$e._)`;${$}--;`,()=>t.for((0,$e._)`${_} = ${$}; ${_}--;`,()=>t.if((0,$e._)`${m}(${n}[${$}], ${n}[${_}])`,()=>{e.error(),t.assign(l,!1).break(f)})))}}};Di.default=up;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});const Jr=re,cp=se,fp=On,dp={message:"must be equal to constant",params:({schemaCode:e})=>(0,Jr._)`{allowedValue: ${e}}`},hp={keyword:"const",$data:!0,error:dp,code(e){const{gen:t,data:n,$data:r,schemaCode:i,schema:a}=e;r||a&&typeof a=="object"?e.fail$data((0,Jr._)`!${(0,cp.useFunc)(t,fp.default)}(${n}, ${i})`):e.fail((0,Jr._)`${a} !== ${n}`)}};Ii.default=hp;var ji={};Object.defineProperty(ji,"__esModule",{value:!0});const dn=re,pp=se,mp=On,yp={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,dn._)`{allowedValues: ${e}}`},gp={keyword:"enum",schemaType:"array",$data:!0,error:yp,code(e){const{gen:t,data:n,$data:r,schema:i,schemaCode:a,it:o}=e;if(!r&&i.length===0)throw new Error("enum must have non-empty array");const s=i.length>=o.opts.loopEnum;let l;const u=()=>l!=null?l:l=(0,pp.useFunc)(t,mp.default);let c;if(s||r)c=t.let("valid"),e.block$data(c,d);else{if(!Array.isArray(i))throw new Error("ajv implementation error");const p=t.const("vSchema",a);c=(0,dn.or)(...i.map(($,_)=>y(p,_)))}e.pass(c);function d(){t.assign(c,!1),t.forOf("v",a,p=>t.if((0,dn._)`${u()}(${n}, ${p})`,()=>t.assign(c,!0).break()))}function y(p,$){const _=i[$];return typeof _=="object"&&_!==null?(0,dn._)`${u()}(${n}, ${p}[${$}])`:(0,dn._)`${n} === ${_}`}}};ji.default=gp;Object.defineProperty(Ni,"__esModule",{value:!0});const vp=ki,_p=Pi,$p=Ti,wp=Ai,bp=Oi,Ep=Ri,Sp=Mi,xp=Di,Np=Ii,kp=ji,Pp=[vp.default,_p.default,$p.default,wp.default,bp.default,Ep.default,Sp.default,xp.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Np.default,kp.default];Ni.default=Pp;var zi={},Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.validateAdditionalItems=void 0;const Et=re,Wr=se,Tp={message:({params:{len:e}})=>(0,Et.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Et._)`{limit: ${e}}`},Cp={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Tp,code(e){const{parentSchema:t,it:n}=e,{items:r}=t;if(!Array.isArray(r)){(0,Wr.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}gs(e,r)}};function gs(e,t){const{gen:n,schema:r,data:i,keyword:a,it:o}=e;o.items=!0;const s=n.const("len",(0,Et._)`${i}.length`);if(r===!1)e.setParams({len:t.length}),e.pass((0,Et._)`${s} <= ${t.length}`);else if(typeof r=="object"&&!(0,Wr.alwaysValidSchema)(o,r)){const u=n.var("valid",(0,Et._)`${s} <= ${t.length}`);n.if((0,Et.not)(u),()=>l(u)),e.ok(u)}function l(u){n.forRange("i",t.length,s,c=>{e.subschema({keyword:a,dataProp:c,dataPropType:Wr.Type.Num},u),o.allErrors||n.if((0,Et.not)(u),()=>n.break())})}}Xt.validateAdditionalItems=gs;Xt.default=Cp;var Vi={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.validateTuple=void 0;const Za=re,Qn=se,Ap=ne,Op={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return vs(e,"additionalItems",t);n.items=!0,!(0,Qn.alwaysValidSchema)(n,t)&&e.ok((0,Ap.validateArray)(e))}};function vs(e,t,n=e.schema){const{gen:r,parentSchema:i,data:a,keyword:o,it:s}=e;c(i),s.opts.unevaluated&&n.length&&s.items!==!0&&(s.items=Qn.mergeEvaluated.items(r,n.length,s.items));const l=r.name("valid"),u=r.const("len",(0,Za._)`${a}.length`);n.forEach((d,y)=>{(0,Qn.alwaysValidSchema)(s,d)||(r.if((0,Za._)`${u} > ${y}`,()=>e.subschema({keyword:o,schemaProp:y,dataProp:y},l)),e.ok(l))});function c(d){const{opts:y,errSchemaPath:p}=s,$=n.length,_=$===d.minItems&&($===d.maxItems||d[t]===!1);if(y.strictTuples&&!_){const m=`"${o}" is ${$}-tuple, but minItems or maxItems/${t} are not specified or different at path "${p}"`;(0,Qn.checkStrictMode)(s,m,y.strictTuples)}}}Zt.validateTuple=vs;Zt.default=Op;Object.defineProperty(Vi,"__esModule",{value:!0});const Rp=Zt,Mp={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Rp.validateTuple)(e,"items")};Vi.default=Mp;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});const Ya=re,Dp=se,Ip=ne,jp=Xt,zp={message:({params:{len:e}})=>(0,Ya.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Ya._)`{limit: ${e}}`},Vp={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:zp,code(e){const{schema:t,parentSchema:n,it:r}=e,{prefixItems:i}=n;r.items=!0,!(0,Dp.alwaysValidSchema)(r,t)&&(i?(0,jp.validateAdditionalItems)(e,i):e.ok((0,Ip.validateArray)(e)))}};Fi.default=Vp;var Li={};Object.defineProperty(Li,"__esModule",{value:!0});const ze=re,Un=se,Fp={message:({params:{min:e,max:t}})=>t===void 0?(0,ze.str)`must contain at least ${e} valid item(s)`:(0,ze.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,ze._)`{minContains: ${e}}`:(0,ze._)`{minContains: ${e}, maxContains: ${t}}`},Lp={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Fp,code(e){const{gen:t,schema:n,parentSchema:r,data:i,it:a}=e;let o,s;const{minContains:l,maxContains:u}=r;a.opts.next?(o=l===void 0?1:l,s=u):o=1;const c=t.const("len",(0,ze._)`${i}.length`);if(e.setParams({min:o,max:s}),s===void 0&&o===0){(0,Un.checkStrictMode)(a,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(s!==void 0&&o>s){(0,Un.checkStrictMode)(a,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,Un.alwaysValidSchema)(a,n)){let _=(0,ze._)`${c} >= ${o}`;s!==void 0&&(_=(0,ze._)`${_} && ${c} <= ${s}`),e.pass(_);return}a.items=!0;const d=t.name("valid");s===void 0&&o===1?p(d,()=>t.if(d,()=>t.break())):o===0?(t.let(d,!0),s!==void 0&&t.if((0,ze._)`${i}.length > 0`,y)):(t.let(d,!1),y()),e.result(d,()=>e.reset());function y(){const _=t.name("_valid"),m=t.let("count",0);p(_,()=>t.if(_,()=>$(m)))}function p(_,m){t.forRange("i",0,c,f=>{e.subschema({keyword:"contains",dataProp:f,dataPropType:Un.Type.Num,compositeRule:!0},_),m()})}function $(_){t.code((0,ze._)`${_}++`),s===void 0?t.if((0,ze._)`${_} >= ${o}`,()=>t.assign(d,!0).break()):(t.if((0,ze._)`${_} > ${s}`,()=>t.assign(d,!1).break()),o===1?t.assign(d,!0):t.if((0,ze._)`${_} >= ${o}`,()=>t.assign(d,!0)))}}};Li.default=Lp;var _s={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=re,n=se,r=ne;e.error={message:({params:{property:l,depsCount:u,deps:c}})=>{const d=u===1?"property":"properties";return(0,t.str)`must have ${d} ${c} when property ${l} is present`},params:({params:{property:l,depsCount:u,deps:c,missingProperty:d}})=>(0,t._)`{property: ${l},
    missingProperty: ${d},
    depsCount: ${u},
    deps: ${c}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(l){const[u,c]=a(l);o(l,u),s(l,c)}};function a({schema:l}){const u={},c={};for(const d in l){if(d==="__proto__")continue;const y=Array.isArray(l[d])?u:c;y[d]=l[d]}return[u,c]}function o(l,u=l.schema){const{gen:c,data:d,it:y}=l;if(Object.keys(u).length===0)return;const p=c.let("missing");for(const $ in u){const _=u[$];if(_.length===0)continue;const m=(0,r.propertyInData)(c,d,$,y.opts.ownProperties);l.setParams({property:$,depsCount:_.length,deps:_.join(", ")}),y.allErrors?c.if(m,()=>{for(const f of _)(0,r.checkReportMissingProp)(l,f)}):(c.if((0,t._)`${m} && (${(0,r.checkMissingProp)(l,_,p)})`),(0,r.reportMissingProp)(l,p),c.else())}}e.validatePropertyDeps=o;function s(l,u=l.schema){const{gen:c,data:d,keyword:y,it:p}=l,$=c.name("valid");for(const _ in u)(0,n.alwaysValidSchema)(p,u[_])||(c.if((0,r.propertyInData)(c,d,_,p.opts.ownProperties),()=>{const m=l.subschema({keyword:y,schemaProp:_},$);l.mergeValidEvaluated(m,$)},()=>c.var($,!0)),l.ok($))}e.validateSchemaDeps=s,e.default=i})(_s);var qi={};Object.defineProperty(qi,"__esModule",{value:!0});const $s=re,qp=se,Up={message:"property name must be valid",params:({params:e})=>(0,$s._)`{propertyName: ${e.propertyName}}`},Hp={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Up,code(e){const{gen:t,schema:n,data:r,it:i}=e;if((0,qp.alwaysValidSchema)(i,n))return;const a=t.name("valid");t.forIn("key",r,o=>{e.setParams({propertyName:o}),e.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},a),t.if((0,$s.not)(a),()=>{e.error(!0),i.allErrors||t.break()})}),e.ok(a)}};qi.default=Hp;var Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});const Hn=ne,Fe=re,Kp=tt,Kn=se,Gp={message:"must NOT have additional properties",params:({params:e})=>(0,Fe._)`{additionalProperty: ${e.additionalProperty}}`},Bp={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Gp,code(e){const{gen:t,schema:n,parentSchema:r,data:i,errsCount:a,it:o}=e;if(!a)throw new Error("ajv implementation error");const{allErrors:s,opts:l}=o;if(o.props=!0,l.removeAdditional!=="all"&&(0,Kn.alwaysValidSchema)(o,n))return;const u=(0,Hn.allSchemaProperties)(r.properties),c=(0,Hn.allSchemaProperties)(r.patternProperties);d(),e.ok((0,Fe._)`${a} === ${Kp.default.errors}`);function d(){t.forIn("key",i,m=>{!u.length&&!c.length?$(m):t.if(y(m),()=>$(m))})}function y(m){let f;if(u.length>8){const w=(0,Kn.schemaRefOrVal)(o,r.properties,"properties");f=(0,Hn.isOwnProperty)(t,w,m)}else u.length?f=(0,Fe.or)(...u.map(w=>(0,Fe._)`${m} === ${w}`)):f=Fe.nil;return c.length&&(f=(0,Fe.or)(f,...c.map(w=>(0,Fe._)`${(0,Hn.usePattern)(e,w)}.test(${m})`))),(0,Fe.not)(f)}function p(m){t.code((0,Fe._)`delete ${i}[${m}]`)}function $(m){if(l.removeAdditional==="all"||l.removeAdditional&&n===!1){p(m);return}if(n===!1){e.setParams({additionalProperty:m}),e.error(),s||t.break();return}if(typeof n=="object"&&!(0,Kn.alwaysValidSchema)(o,n)){const f=t.name("valid");l.removeAdditional==="failing"?(_(m,f,!1),t.if((0,Fe.not)(f),()=>{e.reset(),p(m)})):(_(m,f),s||t.if((0,Fe.not)(f),()=>t.break()))}}function _(m,f,w){const x={keyword:"additionalProperties",dataProp:m,dataPropType:Kn.Type.Str};w===!1&&Object.assign(x,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(x,f)}}};Nr.default=Bp;var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});const Xp=Ue,Ja=ne,jr=se,Wa=Nr,Zp={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:r,data:i,it:a}=e;a.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&Wa.default.code(new Xp.KeywordCxt(a,Wa.default,"additionalProperties"));const o=(0,Ja.allSchemaProperties)(n);for(const d of o)a.definedProperties.add(d);a.opts.unevaluated&&o.length&&a.props!==!0&&(a.props=jr.mergeEvaluated.props(t,(0,jr.toHash)(o),a.props));const s=o.filter(d=>!(0,jr.alwaysValidSchema)(a,n[d]));if(s.length===0)return;const l=t.name("valid");for(const d of s)u(d)?c(d):(t.if((0,Ja.propertyInData)(t,i,d,a.opts.ownProperties)),c(d),a.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(d),e.ok(l);function u(d){return a.opts.useDefaults&&!a.compositeRule&&n[d].default!==void 0}function c(d){e.subschema({keyword:"properties",schemaProp:d,dataProp:d},l)}}};Ui.default=Zp;var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});const Qa=ne,Gn=re,eo=se,to=se,Yp={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:r,parentSchema:i,it:a}=e,{opts:o}=a,s=(0,Qa.allSchemaProperties)(n),l=s.filter(_=>(0,eo.alwaysValidSchema)(a,n[_]));if(s.length===0||l.length===s.length&&(!a.opts.unevaluated||a.props===!0))return;const u=o.strictSchema&&!o.allowMatchingProperties&&i.properties,c=t.name("valid");a.props!==!0&&!(a.props instanceof Gn.Name)&&(a.props=(0,to.evaluatedPropsToName)(t,a.props));const{props:d}=a;y();function y(){for(const _ of s)u&&p(_),a.allErrors?$(_):(t.var(c,!0),$(_),t.if(c))}function p(_){for(const m in u)new RegExp(_).test(m)&&(0,eo.checkStrictMode)(a,`property ${m} matches pattern ${_} (use allowMatchingProperties)`)}function $(_){t.forIn("key",r,m=>{t.if((0,Gn._)`${(0,Qa.usePattern)(e,_)}.test(${m})`,()=>{const f=l.includes(_);f||e.subschema({keyword:"patternProperties",schemaProp:_,dataProp:m,dataPropType:to.Type.Str},c),a.opts.unevaluated&&d!==!0?t.assign((0,Gn._)`${d}[${m}]`,!0):!f&&!a.allErrors&&t.if((0,Gn.not)(c),()=>t.break())})})}}};Hi.default=Yp;var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});const Jp=se,Wp={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:r}=e;if((0,Jp.alwaysValidSchema)(r,n)){e.fail();return}const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.failResult(i,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Ki.default=Wp;var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});const Qp=ne,em={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Qp.validateUnion,error:{message:"must match a schema in anyOf"}};Gi.default=em;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});const er=re,tm=se,nm={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,er._)`{passingSchemas: ${e.passing}}`},rm={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:nm,code(e){const{gen:t,schema:n,parentSchema:r,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(i.opts.discriminator&&r.discriminator)return;const a=n,o=t.let("valid",!1),s=t.let("passing",null),l=t.name("_valid");e.setParams({passing:s}),t.block(u),e.result(o,()=>e.reset(),()=>e.error(!0));function u(){a.forEach((c,d)=>{let y;(0,tm.alwaysValidSchema)(i,c)?t.var(l,!0):y=e.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},l),d>0&&t.if((0,er._)`${l} && ${o}`).assign(o,!1).assign(s,(0,er._)`[${s}, ${d}]`).else(),t.if(l,()=>{t.assign(o,!0),t.assign(s,d),y&&e.mergeEvaluated(y,er.Name)})})}}};Bi.default=rm;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});const im=se,am={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:r}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const i=t.name("valid");n.forEach((a,o)=>{if((0,im.alwaysValidSchema)(r,a))return;const s=e.subschema({keyword:"allOf",schemaProp:o},i);e.ok(i),e.mergeEvaluated(s)})}};Xi.default=am;var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});const hr=re,ws=se,om={message:({params:e})=>(0,hr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,hr._)`{failingKeyword: ${e.ifClause}}`},sm={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:om,code(e){const{gen:t,parentSchema:n,it:r}=e;n.then===void 0&&n.else===void 0&&(0,ws.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const i=no(r,"then"),a=no(r,"else");if(!i&&!a)return;const o=t.let("valid",!0),s=t.name("_valid");if(l(),e.reset(),i&&a){const c=t.let("ifClause");e.setParams({ifClause:c}),t.if(s,u("then",c),u("else",c))}else i?t.if(s,u("then")):t.if((0,hr.not)(s),u("else"));e.pass(o,()=>e.error(!0));function l(){const c=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},s);e.mergeEvaluated(c)}function u(c,d){return()=>{const y=e.subschema({keyword:c},s);t.assign(o,s),e.mergeValidEvaluated(y,o),d?t.assign(d,(0,hr._)`${c}`):e.setParams({ifClause:c})}}}};function no(e,t){const n=e.schema[t];return n!==void 0&&!(0,ws.alwaysValidSchema)(e,n)}Zi.default=sm;var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});const lm=se,um={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:n}){t.if===void 0&&(0,lm.checkStrictMode)(n,`"${e}" without "if" is ignored`)}};Yi.default=um;Object.defineProperty(zi,"__esModule",{value:!0});const cm=Xt,fm=Vi,dm=Zt,hm=Fi,pm=Li,mm=_s,ym=qi,gm=Nr,vm=Ui,_m=Hi,$m=Ki,wm=Gi,bm=Bi,Em=Xi,Sm=Zi,xm=Yi;function Nm(e=!1){const t=[$m.default,wm.default,bm.default,Em.default,Sm.default,xm.default,ym.default,gm.default,mm.default,vm.default,_m.default];return e?t.push(fm.default,hm.default):t.push(cm.default,dm.default),t.push(pm.default),t}zi.default=Nm;var Ji={},Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});const ve=re,km={message:({schemaCode:e})=>(0,ve.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,ve._)`{format: ${e}}`},Pm={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:km,code(e,t){const{gen:n,data:r,$data:i,schema:a,schemaCode:o,it:s}=e,{opts:l,errSchemaPath:u,schemaEnv:c,self:d}=s;if(!l.validateFormats)return;i?y():p();function y(){const $=n.scopeValue("formats",{ref:d.formats,code:l.code.formats}),_=n.const("fDef",(0,ve._)`${$}[${o}]`),m=n.let("fType"),f=n.let("format");n.if((0,ve._)`typeof ${_} == "object" && !(${_} instanceof RegExp)`,()=>n.assign(m,(0,ve._)`${_}.type || "string"`).assign(f,(0,ve._)`${_}.validate`),()=>n.assign(m,(0,ve._)`"string"`).assign(f,_)),e.fail$data((0,ve.or)(w(),x()));function w(){return l.strictSchema===!1?ve.nil:(0,ve._)`${o} && !${f}`}function x(){const g=c.$async?(0,ve._)`(${_}.async ? await ${f}(${r}) : ${f}(${r}))`:(0,ve._)`${f}(${r})`,C=(0,ve._)`(typeof ${f} == "function" ? ${g} : ${f}.test(${r}))`;return(0,ve._)`${f} && ${f} !== true && ${m} === ${t} && !${C}`}}function p(){const $=d.formats[a];if(!$){w();return}if($===!0)return;const[_,m,f]=x($);_===t&&e.pass(g());function w(){if(l.strictSchema===!1){d.logger.warn(C());return}throw new Error(C());function C(){return`unknown format "${a}" ignored in schema at path "${u}"`}}function x(C){const S=C instanceof RegExp?(0,ve.regexpCode)(C):l.code.formats?(0,ve._)`${l.code.formats}${(0,ve.getProperty)(a)}`:void 0,k=n.scopeValue("formats",{key:a,ref:C,code:S});return typeof C=="object"&&!(C instanceof RegExp)?[C.type||"string",C.validate,(0,ve._)`${k}.validate`]:["string",C,k]}function g(){if(typeof $=="object"&&!($ instanceof RegExp)&&$.async){if(!c.$async)throw new Error("async format in sync schema");return(0,ve._)`await ${f}(${r})`}return typeof m=="function"?(0,ve._)`${f}(${r})`:(0,ve._)`${f}.test(${r})`}}}};Wi.default=Pm;Object.defineProperty(Ji,"__esModule",{value:!0});const Tm=Wi,Cm=[Tm.default];Ji.default=Cm;var Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.contentVocabulary=Bt.metadataVocabulary=void 0;Bt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Bt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(Ei,"__esModule",{value:!0});const Am=Si,Om=Ni,Rm=zi,Mm=Ji,ro=Bt,Dm=[Am.default,Om.default,(0,Rm.default)(),Mm.default,ro.metadataVocabulary,ro.contentVocabulary];Ei.default=Dm;var Qi={},bs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(bs);Object.defineProperty(Qi,"__esModule",{value:!0});const zt=re,Qr=bs,io=Ce,Im=se,jm={message:({params:{discrError:e,tagName:t}})=>e===Qr.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:n}})=>(0,zt._)`{error: ${e}, tag: ${n}, tagValue: ${t}}`},zm={keyword:"discriminator",type:"object",schemaType:"object",error:jm,code(e){const{gen:t,data:n,schema:r,parentSchema:i,it:a}=e,{oneOf:o}=i;if(!a.opts.discriminator)throw new Error("discriminator: requires discriminator option");const s=r.propertyName;if(typeof s!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),u=t.const("tag",(0,zt._)`${n}${(0,zt.getProperty)(s)}`);t.if((0,zt._)`typeof ${u} == "string"`,()=>c(),()=>e.error(!1,{discrError:Qr.DiscrError.Tag,tag:u,tagName:s})),e.ok(l);function c(){const p=y();t.if(!1);for(const $ in p)t.elseIf((0,zt._)`${u} === ${$}`),t.assign(l,d(p[$]));t.else(),e.error(!1,{discrError:Qr.DiscrError.Mapping,tag:u,tagName:s}),t.endIf()}function d(p){const $=t.name("valid"),_=e.subschema({keyword:"oneOf",schemaProp:p},$);return e.mergeEvaluated(_,zt.Name),$}function y(){var p;const $={},_=f(i);let m=!0;for(let g=0;g<o.length;g++){let C=o[g];(C==null?void 0:C.$ref)&&!(0,Im.schemaHasRulesButRef)(C,a.self.RULES)&&(C=io.resolveRef.call(a.self,a.schemaEnv.root,a.baseId,C==null?void 0:C.$ref),C instanceof io.SchemaEnv&&(C=C.schema));const S=(p=C==null?void 0:C.properties)===null||p===void 0?void 0:p[s];if(typeof S!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${s}"`);m=m&&(_||f(C)),w(S,g)}if(!m)throw new Error(`discriminator: "${s}" must be required`);return $;function f({required:g}){return Array.isArray(g)&&g.includes(s)}function w(g,C){if(g.const)x(g.const,C);else if(g.enum)for(const S of g.enum)x(S,C);else throw new Error(`discriminator: "properties/${s}" must have "const" or "enum"`)}function x(g,C){if(typeof g!="string"||g in $)throw new Error(`discriminator: "${s}" values must be unique strings`);$[g]=C}}}};Qi.default=zm;const Vm="http://json-schema.org/draft-07/schema#",Fm="http://json-schema.org/draft-07/schema#",Lm="Core schema meta-schema",qm={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},Um=["object","boolean"],Hm={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Km={$schema:Vm,$id:Fm,title:Lm,definitions:qm,type:Um,properties:Hm,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=Uo,r=Ei,i=Qi,a=Km,o=["/properties"],s="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach($=>this.addVocabulary($)),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const $=this.opts.$data?this.$dataMetaSchema(a,o):a;this.addMetaSchema($,s,!1),this.refs["http://json-schema.org/schema"]=s}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var u=Ue;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var c=re;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return c._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return c.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return c.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return c.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return c.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return c.CodeGen}});var d=Cn;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return d.default}});var y=An;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return y.default}})})(Br,Br.exports);const Gm=id(Br.exports);var Bm=Object.defineProperty,Xm=(e,t,n)=>t in e?Bm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pe=(e,t,n)=>(Xm(e,typeof t!="symbol"?t+"":t,n),n);function Es(e,t){if(!document.getElementById("PRERENDER_SVG")){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id","PRERENDER_SVG"),r.setAttribute("pointer-events","none"),r.setAttribute("width","0"),r.setAttribute("height","0"),r.setAttribute("style","opacity: 0; position: absolute; top: 0; left: 0; width: 0; height: 0;"),document.body.appendChild(r)}let n=document.getElementById("PRERENDER_SVG");n.innerHTML=e.html(),t(n.children[0]),n.innerHTML=""}function lt(e){let t={x:0,y:0,width:0,height:0};return Es(e,n=>{t=n.getBBox()}),t}function Oe(e){return xe(document.createElementNS("http://www.w3.org/2000/svg",e))}function tr(e,t){const n=lt(e),r=t/Math.max(n.width,n.height),i={x:-n.width*r/2||0,y:-n.height*r/2||0};return e.attr("transform",`translate(${i.x}, ${i.y}) scale(${r||1})`),{scale:r,translate:i}}function Ss(e){const t=Oe("g"),n=Oe("circle");return n.attr("r",e),n.attr("transform",`translate(${e}, ${e})`),t.append(()=>n.node()),t}function Zm(e,t,n=0){const r=Oe("g"),i=Oe("path");return i.attr("d",`M ${0} ${-(t/2)} L ${e/2-n} ${-(t/2)} A ${n} ${n} 0 0 1 ${e/2} ${-(t/2)+n} L ${e/2} ${t/2-n} A ${n} ${n} 0 0 1 ${e/2-n} ${t/2} L ${-(e/2)+n} ${t/2} A ${n} ${n} 0 0 1 ${-(e/2)} ${t/2-n} L ${-(e/2)} ${-(t/2)+n} A ${n} ${n} 0 0 1 ${-(e/2)+n} ${-(t/2)} Z`),i.attr("transform",`translate(${e/2}, ${t/2})`),r.append(()=>i.node()),r}function Ym(e,t,n=0){const r=Ss(t);r.select("circle").attr("fill","none"),r.select("circle").attr("stroke","none");const i=Oe("path"),a=[];for(let o=0;o<e;o++){const s=o/e*2*Math.PI-Math.PI/2,l=Math.cos(s)*t,u=Math.sin(s)*t;a.push({x:l,y:u})}return i.attr("d",Jm(a,n)),i.attr("transform",`translate(${t}, ${t})`),r.append(()=>i.node()),r}function Jm(e,t){const n=[];e=e.slice();for(let r=0;r<e.length;r++){const i=r+1>e.length-1?(r+1)%e.length:r+1,a=r+2>e.length-1?(r+2)%e.length:r+2,o=e[r],s=e[i],l=e[a],u=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2)),c=(u-t)/u,d=[((1-c)*o.x+c*s.x).toFixed(1),((1-c)*o.y+c*s.y).toFixed(1)],y=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)),p=t/y,$=[((1-p)*s.x+p*l.x).toFixed(1),((1-p)*s.y+p*l.y).toFixed(1)];r===e.length-1&&n.unshift("M"+$.join(",")),n.push("L"+d.join(",")),n.push("Q"+s.x+","+s.y+","+$.join(","))}return n.push("Z"),n.join(" ")}const Wm=Object.freeze(Object.defineProperty({__proto__:null,prerender:Es,getBBox:lt,create:Oe,transform:tr,Circle:Ss,Rectangle:Zm,Polygon:Ym},Symbol.toStringTag,{value:"Module"}));function Ut(e,t,n){return{key:e,value:t,condition:n!=null?n:!0}}function Qm(e,t,n,r){return{shape:e,key:t,value:n,condition:r!=null?r:!0}}function pr(e,t){t.forEach(n=>{n.key==="class"&&n.value.split(".").forEach(r=>{e.classed(r,typeof n.condition=="function"?n.condition():n.condition)}),(typeof n.condition=="function"?n.condition():n.condition)&&e.style(n.key,n.value)})}function xs(e,t){t.forEach(n=>{n.key==="class"&&n.value.split(".").forEach(r=>{n.shape.classed(r,typeof n.condition=="function"?n.condition(e):n.condition)}),(typeof n.condition=="function"?n.condition(e):n.condition)&&n.shape.style(n.key,n.value)})}function e0(e){const t=Oe("path");return t.attr("d",e),t}function Ns(e){const t=Oe("g");return t.html(e),t}function t0(e,t=[],n=[],r=0){let i={top:0,right:0,bottom:0,left:0};return typeof e=="number"?i={top:e,right:e,bottom:e,left:e}:Array.isArray(e)&&e.length===2?i={top:e[0],right:e[1],bottom:e[0],left:e[1]}:Array.isArray(e)&&e.length===4&&(i={top:e[0],right:e[1],bottom:e[2],left:e[3]}),{padding:i,textStyles:t,backgroundStyles:n,cornerRadius:r}}function ei(e,t){const n=Oe("g").classed("tag",!0),r=n.append("text").text(e).attr("dy","0.35em").attr("text-anchor","middle");pr(r,t.textStyles);const i=lt(n),a=i.width,o=i.height,s=t.padding.top,l=t.padding.right,u=t.padding.bottom,c=t.padding.left,d=t.cornerRadius,y=n.append("path").attr("d",`M ${0} ${-(o/2)-s} L ${a/2+l-d} ${-(o/2)-s} A ${d} ${d} 0 0 1 ${a/2+l} ${-(o/2)-s+d} L ${a/2+l} ${o/2+u-d} A ${d} ${d} 0 0 1 ${a/2+l-d} ${o/2+u} L ${-(a/2)-c+d} ${o/2+u} A ${d} ${d} 0 0 1 ${-(a/2)-c} ${o/2+u-d} L ${-(a/2)-c} ${-(o/2)-s+d} A ${d} ${d} 0 0 1 ${-(a/2)-c+d} ${-(o/2)-s} Z`);return pr(y,t.backgroundStyles),r.remove(),n.append(()=>r.node()),n}function zr(e,t=[]){const n=Oe("g").classed("text",!0),r=n.append("text").text(e);return pr(r,t),n.attr("text-anchor","middle"),n}function ks(){return"break-line"}var ea=(e=>(e.Left="left",e.Center="center",e.Right="right",e))(ea||{});function ta(e,t,n,r,i,a,o,s="center",l=[]){return{height:e,width:t,x:n,y:r,dx:i,dy:a,rowCount:o,align:s,rowMargins:l}}function na(e,t,n=null){const r=Oe("g").classed("collection",!0).attr("transform",`translate(${t.x}, ${t.y})`);return n0(e,t,n,r),r}function n0(e,t,n=null,r){const i=(t.height-t.dy*(t.rowCount-1))/t.rowCount;let a=0,o=[];for(let s=0;s<t.rowCount;s++){if(a>e.length-1)return;const l=t.rowMargins[s]||0,u=t.width-l*2,c=r.append("g").attr("id",`row-${s}`).attr("transform",`translate(${l}, ${(i+t.dy)*s})`);a=r0(e,t,n,c,u,a,o,s==t.rowCount-1)}}function r0(e,t,n=null,r,i,a,o,s){const l=[];let u=0,c=a;for(;u<i&&c<e.length;){const y=e[c];if(!y)break;if(typeof y=="string"){c++;break}if(typeof y=="string")break;const p=lt(y).width;if(p>i){o.push(y),c++;continue}if(u+p<i)l.push(y),u+=p+t.dx,c++;else{s&&o.push(y);break}}n&&o.length>0&&(c>=e.length||s)&&(l.push(n),u+=lt(n).width+t.dx),u-=t.dx;let d=0;return l.forEach(y=>{const p=lt(y).width;let $=0;switch(t.align){case"left":$=d+p/2;break;case"center":$=d+p/2+(i-u)/2;break;case"right":$=d+p/2+(i-u);break}y.attr("transform",`translate(${$}, 0)`),r.append(()=>y.node()),d+=p+t.dx}),c}function ra(e,t,n=[]){const r=[];e.split(" ").forEach(a=>{a.includes(`
`)?(a.split(`
`).forEach(o=>{r.push(zr(o,n)),r.push(ks())}),r.pop()):r.push(zr(a,n))});const i=zr("...",n);return na(r,t,i)}function i0(e,t,n){const r=[];e.forEach(a=>{const o=ei(a,n);r.push(o)});const i=ei("...",n);return na(r,t,i)}function a0(e,t,n=[]){Array.isArray(t)?t.forEach(r=>ao(e,r,n)):ao(e,t,n)}function ao(e,t,n=[]){const r=`${e.id}-${t}`,i=t/(isNaN(e.shape.scale)?1:e.shape.scale);e.forceSimulation.registerOnZoom(r,i,a=>{if(xe("[data-id='"+e.id+"']").size()===0)return e.forceSimulation.deregisterOnZoom(r);const o=a*(isNaN(e.shape.scale)?1:e.shape.scale);xs(o,n)})}function o0(e,t,n,...r){!t.forceSimulation||t.forceSimulation.eventStore.emit(`template:${t.shape.type}:${e}`,t,n,...r)}const oo=Object.freeze(Object.defineProperty({__proto__:null,Shape:Wm,ShapeStyle:Ut,LODStyle:Qm,applyStyles:pr,applyLODStyles:xs,PathShape:e0,SVGShape:Ns,TagStyle:t0,TagShape:ei,BreakLine:ks,Alignment:ea,CollectionStyle:ta,ShapeCollection:na,TextCollection:ra,TagCollection:i0,OnZoom:a0,EmitEvent:o0},Symbol.toStringTag,{value:"Module"})),s0={shapeSize:200,shapeBuilder:l0};function l0(e){const t=Oe("g"),{icon_large:n}=u0(t);return n.classed("hidden",!0),c0(t),f0(e,t),t}function u0(e){const t=Ns(`
		<g>
			<path id="border" d="M8.373,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c39.417,-68.271 132.833,-230.073 172.249,-298.344c11.165,-19.338 31.798,-31.25 54.127,-31.25l344.498,0c22.329,-0 42.962,11.912 54.126,31.25c39.417,68.271 132.833,230.073 172.249,298.344c11.165,19.337 11.165,43.162 0,62.5c-39.416,68.271 -132.832,230.073 -172.249,298.344c-11.164,19.337 -31.797,31.25 -54.126,31.25l-344.498,-0c-22.329,-0 -42.962,-11.913 -54.127,-31.25c-39.416,-68.271 -132.832,-230.073 -172.249,-298.344Zm41.667,-0c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" style="fill:#e57373;" />
			<path id="body" d="M50.04,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" />
			<path id="icon" d="M392.598,301.417c-0,7.953 6.447,14.4 14.4,14.4c0.003,-0 0.005,-0 0.008,-0c3.817,-0 7.478,-1.516 10.177,-4.215c2.699,-2.699 4.215,-6.36 4.215,-10.177c-0,-1.135 -0,-2.281 -0,-3.416c-0,-3.817 -1.516,-7.478 -4.215,-10.177c-2.699,-2.699 -6.36,-4.215 -10.177,-4.215c-0.003,-0 -0.005,-0 -0.008,-0c-7.953,-0 -14.4,6.447 -14.4,14.4c-0,1.129 -0,2.27 -0,3.4Zm2.242,-47.423c0.2,6.587 5.597,11.823 12.187,11.823c0.003,-0 0.007,-0 0.01,-0c6.556,-0 11.93,-5.202 12.144,-11.755c0.506,-15.54 1.397,-42.915 1.944,-59.729c0.124,-3.806 -1.301,-7.499 -3.949,-10.235c-2.649,-2.736 -6.294,-4.281 -10.102,-4.281c-0.004,-0 -0.008,-0 -0.012,-0c-3.795,-0 -7.429,1.537 -10.072,4.261c-2.643,2.724 -4.07,6.403 -3.955,10.196c0.507,16.785 1.335,44.149 1.805,59.72Z" style="fill:#e57373;fill-rule:nonzero;" />
			<path id="icon_large" d="M371.559,477.859c-0,19.491 15.8,35.291 35.291,35.291c0.002,0 0.004,0 0.005,0c19.491,0 35.292,-15.8 35.292,-35.291c-0,-2.771 -0,-5.568 -0,-8.339c-0,-19.491 -15.801,-35.291 -35.292,-35.291c-0.001,-0 -0.003,-0 -0.005,-0c-19.491,-0 -35.291,15.8 -35.291,35.291c-0,2.771 -0,5.568 -0,8.339Zm5.494,-116.303c0.489,16.181 13.748,29.045 29.936,29.045l0.012,0c16.041,0 29.188,-12.726 29.71,-28.758c1.239,-38.08 3.425,-105.217 4.768,-146.446c0.303,-9.329 -3.19,-18.381 -9.681,-25.088c-6.492,-6.706 -15.426,-10.492 -24.759,-10.492c-0.003,-0 -0.005,-0 -0.007,-0c-9.309,-0 -18.22,3.77 -24.702,10.451c-6.481,6.68 -9.981,15.702 -9.699,25.006c1.243,41.116 3.268,108.114 4.422,146.282Z" style="fill:#e57373;fill-rule:nonzero;" />
		</g>
	`);return e.append(()=>t.node()),e.classed("gly_animated",!0),{border:t.select("#border"),body:t.select("#body"),icon:t.select("#icon"),icon_large:t.select("#icon_large")}}function c0(e){const t=lt(e),n=ra("Template Error",ta(100,t.width,0,140,20,20,1),[Ut("class","gly_text.dark"),Ut("font-weight","bold"),Ut("font-size","44pt")]);return e.append(()=>n.node()),n}function f0(e,t){var n;const r=lt(t),i=ra((n=e==null?void 0:e.errorMessage)!=null?n:"Something went wrong while rendering the template!",ta(250,r.width,0,r.height*.6,15,20,4,ea.Center,[80,130,180,230]),[Ut("class","gly_text.dark"),Ut("font-size","32pt")]);return t.append(()=>i.node()),i}class d0{constructor(){pe(this,"_errorTemplate",s0),pe(this,"_templates",{}),pe(this,"failed",[]),pe(this,"remoteOrigin","")}get errorTemplate(){return this._errorTemplate}get templates(){return this._templates}add(t,n){this._templates[t]=n}async get(t){var n;const r=t.shape.type;return this.templates[r]?this.templates[r]:this.failed.includes(r)?this.errorTemplate:await this.load((n=t.shape.url)!=null?n:this.remoteOrigin+r+".js",r).then(()=>{if(this.templates[r])return this.templates[r]})}async load(t,n){this.failed.includes(n)||origin!=""&&await Gs(()=>import(t),[]).then(({default:r})=>{this.add(n,r)}).catch(r=>{console.error(`Template "${n}" not founnd \u2013 Fetched from "${t}"`),console.error(r),this.failed.push(n)}).finally(()=>{})}}class h0{constructor(){pe(this,"nodes",{})}clear(){this.nodes={}}add(t,n){this.nodes[t]=this.storeNode(n)}remove(t){delete this.nodes[t]}hasNode(t){return this.nodes[t]!==void 0}hasTemplateChange(t,n){const r=this.nodes[t];return r===void 0?!1:r.shape.type!==n.shape.type||r.shape.template!==n.shape.template}hasPayloadChanges(t,n){var r,i;const a=this.nodes[t];return a?JSON.stringify((r=a.payload)!=null?r:"")!==JSON.stringify((i=n.payload)!=null?i:""):!0}storeNode(t){return{shape:{type:Object.assign({},t.shape).type,template:Object.assign({},t.shape).template},payload:t.payload?this.deepCopy(t.payload):void 0}}deepCopy(t){if(t==null)return t;if(t instanceof Array){var n=[];return t.forEach(a=>{n.push(a)}),n.map(a=>this.deepCopy(a))}if(t instanceof Object){var r={...t};for(var i in t)t.hasOwnProperty(i)&&(r[i]=this.deepCopy(t[i]));return r}return t}}var mr=(e=>(e.Soft="soft",e.Hard="hard",e))(mr||{}),Ee=(e=>(e.Solid="solid",e.Dashed="dashed",e.Dotted="dotted",e.Hidden="hidden",e))(Ee||{}),nr=(e=>(e.Strong="strong",e.Weak="weak",e.Loose="loose",e))(nr||{});const p0=new Gm({allErrors:!0});function so(e){var t,n,r,i,a,o,s,l,u,c;if(!e.forceSimulation)return e.shape.failed=!0,null;const d=e.forceSimulation.nodeDataStore.hasNode(e.id)?xe(this):Oe("g"),y=e.forceSimulation.nodeDataStore.hasPayloadChanges(e.id,e),p=e.forceSimulation.nodeDataStore.hasTemplateChange(e.id,e);if(e.forceSimulation.nodeDataStore.add(e.id,e),!y&&!p&&!e.shape.failed)return tr(d.select("[data-object=shape]"),e.shape.scale*((n=(t=e.shape.template)==null?void 0:t.shapeSize)!=null?n:300)),d.node();if(d.selectAll("*").remove(),d.classed("gly-node",!0).attr("data-id",e.id),!e.shape.template)return x(`Template "${e.shape.type}" not found!`);if((i=(r=e.shape)==null?void 0:r.template)!=null&&i.shapePayload){const g=p0.compile(e.shape.template.shapePayload);if(!g(e.payload))return console.error(`[graphly-d3] ${e.shape.type} 
 \u2022 ${(a=g.errors)==null?void 0:a.map(C=>`${C.instancePath} ${C.message}`).join(`
 \u2022 `)}`),x(`"${e.shape.type}" ${(o=g.errors)==null?void 0:o[0].instancePath} ${(s=g.errors)==null?void 0:s[0].message}`)}else console.warn(`[graphly-d3] "${e.shape.type}" has no payload schema defined!`);try{d.append(()=>e.shape.template.shapeBuilder.bind(this)(e,oo).node()).attr("data-object","shape")}catch(g){return console.error(`[graphly-d3] ${g}`),x(g.message)}const $=lt(d),_=e.shape.scale*((u=(l=e.shape.template)==null?void 0:l.shapeSize)!=null?u:300);e.shape.bodyPoints=[];const m=d.select(".gly-body").node(),f=[];if(m&&m.getTotalLength){let g=((c=e.shape)==null?void 0:c.bodyResolution)||32;const C=m.getTotalLength();for(let ee=0;ee<g;ee++){const T=m.getPointAtLength(ee/g*C);T.x=Math.round(T.x),T.y=Math.round(T.y),f.push(T)}const S=Math.min(...f.map(ee=>ee.x)),k=Math.max(...f.map(ee=>ee.x)),M=Math.min(...f.map(ee=>ee.y)),L=Math.max(...f.map(ee=>ee.y)),H=k-S,Y=L-M,Z={x:$.width/H,y:$.height/Y};f.forEach(ee=>{var T,V,z,U,X,J,j,P;ee.x=(ee.x-S)*Z.x+$.x-H*Z.x/2+_,ee.y=(ee.y-M)*Z.y+$.y-Y*Z.y/2+_,((V=(T=e.forceSimulation)==null?void 0:T.debug)==null?void 0:V.enabled)&&((X=(U=(z=e.forceSimulation)==null?void 0:z.debug)==null?void 0:U.bodyPoints)==null?void 0:X.enabled)&&d.select("[data-object=shape]").append("circle").classed("gly-body-points",!0).attr("cx",ee.x+H*Z.x/2-_).attr("cy",ee.y+Y*Z.y/2-_).attr("r",Math.max($.height,$.width)/_*5).attr("fill",(P=(j=(J=e.forceSimulation)==null?void 0:J.debug)==null?void 0:j.bodyPoints)==null?void 0:P.color).attr("stroke","none")}),e.shape.bodyPoints=f}e.shape.failed=!1;const w=tr(d.select("[data-object=shape]"),_);for(let g of f)g.x=(g.x-_)*w.scale,g.y=(g.y-_)*w.scale;return d.node();function x(g){var C,S,k,M;return e.shape.failed=!0,e.errorMessage=g,d.append(()=>e.forceSimulation?e.forceSimulation.templateStore.errorTemplate.shapeBuilder.bind(this)(e,oo).node():null).attr("data-object","shape"),tr(d.select("[data-object=shape]"),e.shape.scale*((M=(k=(S=(C=e.forceSimulation)==null?void 0:C.templateStore)==null?void 0:S.errorTemplate)==null?void 0:k.shapeSize)!=null?M:300)),d.node()}}var ce=(e=>(e.NodeClick="node:click",e.NodeDoubleClick="node:doubleclick",e.NodeContextMenu="node:contextmenu",e.NodeDragStart="node:dragstart",e.NodeDragMove="node:dragmove",e.NodeDragEnd="node:dragend",e.LinkClick="link:click",e.LinkDoubleClick="link:doubleclick",e.LinkContextMenu="link:contextmenu",e.LinkDragStart="link:dragstart",e.LinkDragMove="link:dragmove",e.LinkDragEnd="link:dragend",e.EnvironmentClick="environment:click",e.EnvironmentDoubleClick="environment:doubleclick",e.EnvironmentContextMenu="environment:contextmenu",e.EnvironmentMove="environment:move",e.SimulationTick="simulation:tick",e.SimulationTickEnd="simulation:tickend",e))(ce||{});const m0={["node:click"]:{event:e=>e,node:e=>e},["node:doubleclick"]:{event:e=>e,node:e=>e},["node:contextmenu"]:{event:e=>e,node:e=>e},["node:dragstart"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragmove"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragend"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["link:click"]:{event:e=>e,link:e=>e},["link:doubleclick"]:{event:e=>e,link:e=>e},["link:contextmenu"]:{event:e=>e,link:e=>e},["link:dragstart"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragmove"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragend"]:{event:e=>e,source:e=>e,target:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:click"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:doubleclick"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:contextmenu"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:move"]:{pos:e=>e},["simulation:tick"]:{},["simulation:tickend"]:{}};class Ps{constructor(){pe(this,"register",{})}on(t,n){this.register[t]||(this.register[t]={}),this.register[t][n.name]=n}off(t,n){!this.register[t]||delete this.register[t][n.name]}emit(t,...n){if(this.register[t])for(const r in this.register[t])return this.register[t][r](...n)}}pe(Ps,"events",m0);let kr=!1,yr,ti={x:0,y:0};function y0(){return Du().on("start",(e,t)=>g0.bind(this)(e,t)).on("drag",(e,t)=>v0.bind(this)(e,t)).on("end",(e,t)=>_0.bind(this)(e,t))}function g0(e,t){if(this.eventStore.emit(ce.NodeDragStart,e,t,{x:e.x,y:e.y})=="newlink")return $0.bind(this)(e,t);!this.draggableNodes||(this.simulation.alphaTarget(.05).restart(),t.isDraged=!0,t.fx=e.x,t.fy=e.y)}function v0(e,t){if(kr)return w0.bind(this)(e,t);!this.draggableNodes||(t.fx=e.x,t.fy=e.y,this.eventStore.emit(ce.NodeDragMove,e,t,{x:e.x,y:e.y}))}function _0(e,t){if(kr)return lo.bind(this)(e,t);if(!this.draggableNodes)return lo.bind(this)(e,t);!this.draggableNodes||(this.simulation.alphaTarget(0),t.isDraged=!1,t.fx=null,t.fy=null,this.eventStore.emit(ce.NodeDragEnd,e,t,{x:e.x,y:e.y}))}function $0(e,t){var n,r,i,a;ti={x:e.sourceEvent.offsetX/this.worldTransform.k-this.worldTransform.x/this.worldTransform.k-((n=t.x)!=null?n:0),y:e.sourceEvent.offsetY/this.worldTransform.k-this.worldTransform.y/this.worldTransform.k-((r=t.y)!=null?r:0)},kr=!0,yr=this.selectionGroups.links.append("g").attr("data-object","prelink").classed("gly-prelink",!0),yr.append("line").attr("data-object","prelink-link-line").classed("gly-link-line",!0).attr("x1",(i=t.x)!=null?i:0).attr("y1",(a=t.y)!=null?a:0).attr("x2",e.x).attr("y2",e.y),this.eventStore.emit(ce.LinkDragStart,e,t,{x:e.x,y:e.y})}function w0(e,t){const n={x:e.x+ti.x,y:e.y+ti.y};yr.select("[data-object='prelink-link-line']").attr("x2",n.x).attr("y2",n.y),this.eventStore.emit(ce.LinkDragMove,e,t,{x:e.x,y:e.y})}function lo(e,t){yr.remove(),kr=!1;let n=e.sourceEvent.target;if(n==this.svgElement)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y});for(;n.attributes["data-object"]==null;){if(n==null)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(n=n.parentElement,!n)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y})}if(n=n.parentElement,!n)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y});const r=this.graph.nodes.find(i=>{var a;return i.id==((a=n.attributes["data-id"])==null?void 0:a.value)});if(!r)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(r.id==t.id)return this.eventStore.emit(ce.LinkDragEnd,e,t,null,{x:e.x,y:e.y});this.eventStore.emit(ce.LinkDragEnd,e,t,r,{x:e.x,y:e.y})}function b0(e){e.links=e.links.filter(t=>{const n=typeof t.source=="string"?e.nodes.find(i=>i.id===t.source):e.nodes.find(i=>i.id===t.source.id),r=typeof t.target=="string"?e.nodes.find(i=>i.id===t.target):e.nodes.find(i=>i.id===t.target.id);return!(!n||!r)}),e.nodes.forEach(t=>{const n=[];e.links.forEach(i=>{(i.source==t.id||i.source.id==t.id)&&n.push(i)});const r={};n.forEach(i=>{if(typeof i.target=="object"){const a=typeof i.target=="string"?i.target:i.target.id;r[a]||(r[a]=[]),r[a].push(i)}else r[i.target]||(r[i.target]=[]),r[i.target].push(i)}),Object.keys(r).forEach(i=>{r[i].forEach((a,o)=>{a.i=o}),r[i].sort((a,o)=>{var s,l;return((s=a.index)!=null?s:0)-((l=o.index)!=null?l:0)})})})}async function E0(e){await x0.bind(this)(e),e.nodes.forEach(n=>{n.forceSimulation=this}),N0(e.nodes);const t=this.selectionGroups.nodes.selectAll("[data-object='node']").data(e.nodes,n=>n.id);t.enter().append(so.bind(this)).attr("data-object","node").style("pointer-events","fill").call(y0.bind(this)()).on("click",(n,r)=>{this.eventStore.emit(ce.NodeClick,n,r),n.stopPropagation()}).on("dblclick",(n,r)=>{this.eventStore.emit(ce.NodeDoubleClick,n,r),n.stopPropagation()}).on("contextmenu",(n,r)=>{this.eventStore.emit(ce.NodeContextMenu,n,r),n.stopPropagation()}).attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).each(n=>{this.nodeDataStore.remove(n.id)}).remove(),t.each(n=>{t.filter(r=>r.id===n.id).select(so)}).attr("opacity",1)}function S0(e){const t=this.selectionGroups.links.selectAll("[data-object='link']").data(e.links,r=>hn(r)),n=t.enter().append("g").attr("data-object","link").attr("data-id",r=>hn(r)).classed("gly-link",!0).on("click",(r,i)=>{this.eventStore.emit(ce.LinkClick,r,i),r.stopPropagation()}).on("dblclick",(r,i)=>{this.eventStore.emit(ce.LinkDoubleClick,r,i),r.stopPropagation()}).on("contextmenu",(r,i)=>{this.eventStore.emit(ce.LinkContextMenu,r,i),r.stopPropagation()});n.append("path").attr("data-object","link-line-full").attr("fill","none").attr("stroke","none"),n.append("path").attr("id",r=>`link-path-${hn(r)}`).attr("data-object","link-line").classed("gly-link-line",!0).classed("solid",r=>r.type?r.type===Ee.Solid:!0).classed("dashed",r=>r.type===Ee.Dashed).classed("dotted",r=>r.type===Ee.Dotted).classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),n.append("path").attr("data-object","link-arrow-head").classed("gly-link-arrow",!0).classed("gly-link-arrow-head",!0).classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),n.append("path").attr("data-object","link-arrow-tail").classed("gly-link-arrow",!0).classed("gly-link-arrow-tail",!0).classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),n.append("text").attr("data-object","link-label").classed("gly-link-label",!0).attr("text-anchor","middle").attr("dy","-0.5em").attr("dominant-baseline","central").append("textPath").attr("data-object","link-label-path").attr("xlink:href",r=>`#link-path-${hn(r)}`).attr("startOffset","50%").text(r=>{var i;return r.type!==Ee.Hidden&&(i=r.label)!=null?i:""}),n.attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).remove(),t.attr("opacity",1),t.select("[data-object='link-line']").classed("solid",r=>r.type?r.type===Ee.Solid:!0).classed("dashed",r=>r.type===Ee.Dashed).classed("dotted",r=>r.type===Ee.Dotted).classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),t.select("[data-object='link-arrow-head']").classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),t.select("[data-object='link-arrow-tail']").classed("hidden",r=>r.type===Ee.Hidden).style("stroke-width",r=>{var i;return(i=r.width)!=null?i:null}),t.select("[data-object='link-label-path']").text(r=>{var i;return r.type!==Ee.Hidden&&(i=r.label)!=null?i:""})}async function x0(e){for(let t in e.nodes){const n=e.nodes[t];await this.templateStore.get(n).then(r=>{n.shape.template=r})}}function N0(e){var t,n,r,i,a,o,s,l,u,c,d,y;for(let p of e){if(p.x||p.y||p.fx||p.fy||((t=p.anchor)==null?void 0:t.x)||((n=p.anchor)==null?void 0:n.y)||((r=p.satellite)==null?void 0:r.x)||((i=p.satellite)==null?void 0:i.y))continue;if(p.spawn){const m=typeof p.spawn.source=="string"?p.spawn.source:p.spawn.source.id,f=e.find(S=>S.id===m),w={x:(l=(s=(a=f==null?void 0:f.x)!=null?a:f==null?void 0:f.fx)!=null?s:(o=f==null?void 0:f.anchor)==null?void 0:o.x)!=null?l:0,y:(y=(d=(u=f==null?void 0:f.y)!=null?u:f==null?void 0:f.fy)!=null?d:(c=f==null?void 0:f.anchor)==null?void 0:c.y)!=null?y:0},x=p.spawn.distance,g=p.spawn.angle,C={x:w.x+x*Math.cos(g*Math.PI/180-Math.PI/2),y:w.y+x*Math.sin(g*Math.PI/180-Math.PI/2)};p.x=C.x,p.y=C.y;continue}const{x:$,y:_}=Ts(e);p.x=$,p.y=_}}function Ts(e,t={x:0,y:0}){return e.find(n=>n.x===t.x&&n.y===t.y)?Ts(e,{x:t.x+1,y:t.y}):t}function hn(e){return e.id||(e.id=Math.random().toString(36).substring(2,34)+Math.random().toString(36).substring(2,34)),e.id?e.id:(typeof e.source=="string"?e.source:e.source.id)+(typeof e.target=="string"?e.target:e.target.id)+e.type+e.directed+e.label+e.strength}var ni=(e=>(e.Head="head",e.Tail="tail",e))(ni||{});function k0(e){const t=Cs(e),n=As(e),r=ri(t,n,ii(e,t,n,.1)),i={start:t,center:r,end:n};if(i)return`M ${i.start.x} ${i.start.y}Q ${i.center.x}, ${i.center.y} ${i.end.x} ${i.end.y}`}function P0(e){var t;const n=ia(e,(t=e.padding)!=null?t:10);if(!n)return;const r=n.start.x>n.end.x,i={x:r?n.end.x:n.start.x,y:r?n.end.y:n.start.y},a={x:r?n.start.x:n.end.x,y:r?n.start.y:n.end.y};return`M ${i.x} ${i.y}Q ${n.center.x}, ${n.center.y} ${a.x} ${a.y}`}function uo(e,t="head"){var n;if(!e.directed)return"";const r=ia(e,(n=e.padding)!=null?n:10);if(!r)return;const i=Math.atan2(r.end.y-r.center.y,r.end.x-r.center.x),a=10,o={x:r.end.x+a*Math.cos(i+Math.PI/2),y:r.end.y+a*Math.sin(i+Math.PI/2)},s={x:r.end.x+a*Math.cos(i),y:r.end.y+a*Math.sin(i)},l={x:r.end.x+a*Math.cos(i-Math.PI/2),y:r.end.y+a*Math.sin(i-Math.PI/2)};return`M ${o.x} ${o.y}L ${s.x} ${s.y}L ${l.x} ${l.y}`}function T0(e){var t;const n=ia(e,(t=e.padding)!=null?t:10);if(n)return n.start.x>n.end.x?"0.5em":"-0.5em"}function Cs(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:Os(e.target,e.source)}function As(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:Os(e.source,e.target)}function C0(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ri(e,t,n){var r,i;const a=C0(e,t);return{x:a.x+((r=n==null?void 0:n.x)!=null?r:0),y:a.y-((i=n==null?void 0:n.y)!=null?i:0)}}function ii(e,t,n,r){var i;const a=A0(t,n),o=O0(t,n),s=R0(a,o),l=e.curvature!==void 0?e.curvature:r,u=e.curvature!==void 0?1:((i=e.i)!=null?i:0)+1,c=l*(o/s)*s*u,d=l*(a/s)*s*u;return{x:c,y:d}}function A0(e,t){return t.x-e.x}function O0(e,t){return t.y-e.y}function R0(e,t){return Math.sqrt(e*e+t*t)}function Os(e,t){var n,r,i,a,o,s,l,u;const c=((n=t.x)!=null?n:0)-((r=e.x)!=null?r:0),d=((i=t.y)!=null?i:0)-((a=e.y)!=null?a:0);return Math.sqrt(c*c+d*d)===0?{x:(o=e.x)!=null?o:0,y:(s=e.y)!=null?s:0}:{x:c+((l=e.x)!=null?l:0),y:d+((u=e.y)!=null?u:0)}}function ia(e,t=0){var n,r,i,a,o,s,l,u,c,d,y,p;const $=Cs(e),_=As(e),m=ii(e,$,_,.1);if(typeof e.source=="string"||typeof e.target=="string")return{start:$,end:_,center:m};const f=ri({x:(n=e.source.x)!=null?n:0,y:(r=e.source.y)!=null?r:0},{x:(i=e.target.x)!=null?i:0,y:(a=e.target.y)!=null?a:0},m),w=e.directed?20:0,x=Oe("g").append("path").attr("d",`M ${$.x} ${$.y}Q ${f.x}, ${f.y} ${_.x} ${_.y}`).node();if(!x)return{start:$,end:_,center:m};const g=e.source.shape.failed?(o=e.source.forceSimulation)==null?void 0:o.templateStore.errorTemplate.shapeSize:(l=(s=e.source.shape.template)==null?void 0:s.shapeSize)!=null?l:300,C=e.target.shape.failed?(u=e.target.forceSimulation)==null?void 0:u.templateStore.errorTemplate.shapeSize:(d=(c=e.target.shape.template)==null?void 0:c.shapeSize)!=null?d:300,S=co(e.source,e.target,e,!1),k=co(e.source,e.target,e,!0),M=S||((y=e.source.shape.scale)!=null?y:1)*((g!=null?g:300)/2),L=k||((p=e.target.shape.scale)!=null?p:1)*((C!=null?C:300)/2),H=x.getAttribute("d").includes("NaN")?0:x.getPointAtLength(M+t),Y=x.getAttribute("d").includes("NaN")?0:x.getPointAtLength(x.getTotalLength()-L-t-w),Z=ii(e,H,Y,.1),ee=ri(H,Y,Z);return{start:{x:H.x,y:H.y},center:{x:ee.x,y:ee.y},end:{x:Y.x,y:Y.y}}}function co(e,t,n,r=!1){var i,a,o,s,l,u,c,d,y,p,$,_,m,f,w,x,g,C,S,k,M,L;const H=xe("[data-id='"+hn(n)+"']").select("[data-object='link-line-full']").node();if(!H||!H.getPointAtLength||H.getAttribute("d").includes("NaN"))return 0;const Y=r?(i=t.shape.bodyPoints)!=null?i:[]:(a=e.shape.bodyPoints)!=null?a:[];if(Y.length===0)return 0;const Z=H.getTotalLength(),ee=r?-(((s=(o=t.shape.template)==null?void 0:o.shapeSize)!=null?s:300)*((l=t.shape.scale)!=null?l:1))/20:((c=(u=e.shape.template)==null?void 0:u.shapeSize)!=null?c:300)*((d=e.shape.scale)!=null?d:1)/20;let T=r?Z:0,V=H.getPointAtLength(T),z={x:0,y:0};r?z={x:V.x-(($=t.x)!=null?$:0),y:V.y-((_=t.y)!=null?_:0)}:z={x:V.x-((y=e.x)!=null?y:0),y:V.y-((p=e.y)!=null?p:0)};let U=0;for(;ai(z,Y)&&T<=Z&&U<30;)U++,T+=ee,V=H.getPointAtLength(T),r?z={x:V.x-((w=t.x)!=null?w:0),y:V.y-((x=t.y)!=null?x:0)}:z={x:V.x-((m=e.x)!=null?m:0),y:V.y-((f=e.y)!=null?f:0)};for(U=0;!ai(z,Y)&&T>=0&&U<30;)U++,T=r?T+1:T-1,V=H.getPointAtLength(T),r?z={x:V.x-((S=t.x)!=null?S:0),y:V.y-((k=t.y)!=null?k:0)}:z={x:V.x-((g=e.x)!=null?g:0),y:V.y-((C=e.y)!=null?C:0)};const X=r?((M=t.shape.scale)!=null?M:1)/((L=e.shape.scale)!=null?L:1):1;return(r?Z-T:T)*X}function ai(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var a=t[r].x,o=t[r].y,s=t[i].x,l=t[i].y,u=o>e.y!=l>e.y&&e.x<(s-a)*(e.y-o)/(l-o)+a;u&&(n=!n)}return n}function fo(e){return zf().id(t=>t.id).strength(t=>{if(t.strength===void 0)return .3;if(typeof t.strength=="number")return t.strength;switch(t.strength){case nr.Strong:return .5;case nr.Weak:return .3;case nr.Loose:return 0;default:return .3}}).distance(e)}function M0(){return Xf().x(e=>gr(e).x).strength(e=>vr(e))}function D0(){return Zf().y(e=>gr(e).y).strength(e=>vr(e))}function ho(e){return Bf().strength(t=>t.gravity?t.gravity:e)}function gr(e){var t,n,r,i;return e.satellite?{x:(t=e.satellite.x)!=null?t:0,y:(n=e.satellite.y)!=null?n:0}:e.anchor?{x:(r=e.anchor.x)!=null?r:0,y:(i=e.anchor.y)!=null?i:0}:{x:0,y:0}}function vr(e){if(e.satellite)return 6;if(e.anchor)switch(e.anchor.type){case mr.Hard:case mr.Soft:return 2;default:return 0}return 0}function I0(e){const t=this.graph.nodes;var n=pi().x(r=>r.x).y(r=>r.y).addAll(t);t.forEach(r=>{var i,a;r.x=r.x||0,r.y=r.y||0;var o=((a=(i=r.shape.template)==null?void 0:i.shapeSize)!=null?a:300)*r.shape.scale,s=r.x-o,l=r.x+o,u=r.y-o,c=r.y+o;n.visit((d,y,p,$,_)=>{var m,f,w,x,g,C;if(d.data&&d.data!==r){var S=((m=r.x)!=null?m:0)-d.data.x,k=((f=r.y)!=null?f:0)-d.data.y,M=Math.sqrt(S*S+k*k);const L=((x=(w=r.shape.template)==null?void 0:w.shapeSize)!=null?x:300)*r.shape.scale;j0(r,d.data)&&(((g=r.shape.bodyPoints)==null?void 0:g.length)==0||((C=d.data.shape.bodyPoints)==null?void 0:C.length)==0?M<L&&(M=(M-L)/M*e,r.x=r.x||0,r.y=r.y||0,r.x-=S*=M,r.y-=k*=M,d.data.x+=S,d.data.y+=k):z0(r,d.data)&&(M=(M-L)/M*e,r.x=r.x||0,r.y=r.y||0,r.x-=S*=M,r.y-=k*=M,d.data.x+=S,d.data.y+=k))}return y>l||$<s||p>c||_<u})})}function j0(e,t){var n,r,i,a,o,s,l,u,c,d;const y={x:(n=e.x)!=null?n:0,y:(r=e.y)!=null?r:0},p=((o=(a=(i=e.shape)==null?void 0:i.template)==null?void 0:a.shapeSize)!=null?o:300)/2*(e.shape.scale*1.5),$={x:(s=t.x)!=null?s:0,y:(l=t.y)!=null?l:0},_=((d=(c=(u=t.shape)==null?void 0:u.template)==null?void 0:c.shapeSize)!=null?d:300)/2*(t.shape.scale*1.5);return Math.sqrt(Math.pow(y.x-$.x,2)+Math.pow(y.y-$.y,2))<p+_}function z0(e,t){var n,r;const i=((n=e.shape.bodyPoints)!=null?n:[]).map(o=>{var s,l;return{x:o.x-((s=e.x)!=null?s:0),y:o.y-((l=e.y)!=null?l:0)}}),a=((r=t.shape.bodyPoints)!=null?r:[]).map(o=>{var s,l;return{x:o.x-((s=t.x)!=null?s:0),y:o.y-((l=t.y)!=null?l:0)}});for(let o=0;o<i.length;o++){const s={x:i[o].x,y:i[o].y};if(ai(s,a))return!0}return!1}function V0(){for(let e in this.graph.nodes)this.graph.nodes[e].isDraged||(F0(this.graph,this.graph.nodes[e]),L0(this.graph.nodes[e]));this.selectionGroups.nodes.selectAll("[data-object='node']").attr("transform",e=>{var t,n;return`translate(${(t=e.x)!=null?t:0},${(n=e.y)!=null?n:0})`}),this.selectionGroups.links.selectAll("[data-object='link']").call(e=>{e.select("[data-object='link-line-full']").attr("d",k0),e.select("[data-object='link-line']").attr("d",P0),e.select("[data-object='link-arrow-head']").attr("d",t=>uo(t,ni.Head)),e.select("[data-object='link-arrow-tail']").attr("d",t=>uo(t,ni.Tail)),e.select("[data-object='link-label']").attr("dy",T0)}),this.simulation.force("forceX").x(e=>gr(e).x).strength(e=>vr(e)),this.simulation.force("forceY").y(e=>gr(e).y).strength(e=>vr(e)),this.eventStore.emit(ce.SimulationTick)}function F0(e,t){var n,r,i,a,o,s,l,u;if(!t.satellite)return;if(typeof t.satellite.source=="string"){const p=e.nodes.find($=>$.id===t.satellite.source);if(!p)return;t.satellite.source=p}const c=(n=t.satellite.distance)!=null?n:400,d=(r=t.satellite.angle)!=null?r:0,y={x:((o=(a=(i=t.satellite)==null?void 0:i.source)==null?void 0:a.x)!=null?o:0)+c*Math.cos(d*Math.PI/180-Math.PI/2),y:((u=(l=(s=t.satellite)==null?void 0:s.source)==null?void 0:l.y)!=null?u:0)+c*Math.sin(d*Math.PI/180-Math.PI/2)};t.satellite.x=y.x,t.satellite.y=y.y}function L0(e){e.satellite||!e.anchor||(e.fx=null,e.fy=null,e.anchor.type===mr.Hard&&(e.fx=e.anchor.x,e.fy=e.anchor.y))}function po(){const e=nd().extent([[0,0],[this.svgElement.clientWidth,this.svgElement.clientHeight]]).scaleExtent([.1,3]).on("zoom",({transform:t})=>Rs.bind(this)(t));return this.svgSelection.call(e).call(e.transform,br.translate(this.worldTransform.x,this.worldTransform.y).scale(this.worldTransform.k)),this.svgSelection.on("dblclick.zoom",null),e}function Rs(e){if(this.selectionGroups.world.attr("transform",`translate(${e.x}, ${e.y}) scale(${e.k})`),this.worldTransform.k!=e.k){const t=[this.worldTransform.k,e.k].sort();Object.keys(this.onZoomRoutines).forEach(n=>{const r=parseFloat(n);r>t[0]&&r<t[1]&&this.onZoomRoutines[r].forEach(i=>i(e.k))})}this.worldTransform=e,this.eventStore.emit(ce.EnvironmentMove,e)}function q0(e,t){if(e.transform)return Ms.bind(this)(e.transform,t,e.duration);const n=[];e.boundaries&&n.push(mo(e.boundaries)),e.nodes&&n.push(U0(e.nodes)),H0.bind(this)(mo(n),t,e.duration,e.padding)}function mo(e){let t=e.reduce((a,o)=>Math.min(a,o.x),1/0),n=e.reduce((a,o)=>Math.min(a,o.y),1/0),r=e.reduce((a,o)=>Math.max(a,o.x+o.width),-1/0),i=e.reduce((a,o)=>Math.max(a,o.y+o.height),-1/0);return{x:t,y:n,width:r-t,height:i-n}}function U0(e){var t,n,r,i,a,o,s;const l=ga(e,p=>p.x),u=ga(e,p=>p.y),c=((t=l[1])!=null?t:0)-((n=l[0])!=null?n:0),d=((r=u[1])!=null?r:0)-((i=u[0])!=null?i:0),y=(a=Bs(e.map(p=>{var $,_;return p.shape.scale*((_=($=p.shape.template)==null?void 0:$.shapeSize)!=null?_:300)})))!=null?a:0;return{x:((o=l[0])!=null?o:0)-y/2,y:((s=u[0])!=null?s:0)-y/2,width:c+y,height:d+y}}function Ms(e,t,n){const r=this.svgElement.clientWidth,i=this.svgElement.clientHeight,a={x:r/2,y:i/2},o={x:-e.x+r/2*(1-e.k)*(e.x/(r/2))+a.x,y:-e.y+i/2*(1-e.k)*(e.y/(i/2))+a.y,k:e.k};K0.bind(this)(o,t,n)}function H0(e,t,n,r){const i=this.svgElement.clientWidth,a=this.svgElement.clientHeight,o=i/a,s=(e.width+(r!=null?r:0)*2)/(e.height+(r!=null?r:0)*2),l=o<s?i/(e.width+(r!=null?r:0)*2):a/(e.height+(r!=null?r:0)*2),u={x:e.x+e.width/2,y:e.y+e.height/2,k:l};Ms.bind(this)(u,t,n)}function K0(e,t,n){isNaN(e.x)||isNaN(e.y)||isNaN(e.k)||this.selectionGroups.world.transition().duration(n!=null?n:1e3).ease(gf).attr("transform",`translate(${e.x},${e.y}) scale(${e.k})`).on("end",()=>{t(e)})}function G0(){const e=[],t=[];return this.graph.nodes.forEach(n=>{var r,i,a,o,s,l,u,c;const d={id:n.id,x:n.x,y:n.y,shape:{type:n.shape.type,scale:n.shape.scale,url:n.shape.url},gravity:n.gravity,anchor:{type:((r=n.anchor)==null?void 0:r.type)||"",x:((i=n.anchor)==null?void 0:i.x)||0,y:((a=n.anchor)==null?void 0:a.y)||0},satellite:{source:typeof((o=n.satellite)==null?void 0:o.source)=="string"?n.satellite.source:((l=(s=n.satellite)==null?void 0:s.source)==null?void 0:l.id)||"",angle:((u=n.satellite)==null?void 0:u.angle)||0,distance:((c=n.satellite)==null?void 0:c.distance)||0},payload:n.payload};e.push(d)}),this.graph.links.forEach(n=>{const r={source:typeof n.source=="string"?n.source:n.source.id,target:typeof n.target=="string"?n.target:n.target.id,id:n.id,type:n.type,directed:n.directed,label:n.label,strength:n.strength,padding:n.padding,width:n.width,curvature:n.curvature,payload:n.payload};t.push(r)}),{nodes:e,links:t}}class X0{constructor(t){pe(this,"debug",{enabled:!1,bodyPoints:{enabled:!0,color:"#00ffff"}}),pe(this,"_svgElement"),pe(this,"_svgSelection"),pe(this,"_simulation"),pe(this,"_selectedNodes",[]),pe(this,"_zoom"),pe(this,"worldTransform",{x:0,y:0,k:1}),pe(this,"_onZoomRegister",[]),pe(this,"_onZoomRoutines",{}),pe(this,"animationDuration",300),pe(this,"draggableNodes",!0),pe(this,"selectionGroups"),pe(this,"graph",{nodes:[],links:[]}),pe(this,"templateStore",new d0),pe(this,"nodeDataStore",new h0),pe(this,"eventStore",new Ps),t instanceof SVGElement?(this._svgElement=t,this._svgSelection=xe(t)):(this._svgSelection=t,this._svgElement=t.node()),this.worldTransform={x:this.svgElement.clientWidth/2,y:this.svgElement.clientHeight/2,k:1},this._simulation=this.createSimulation(),this.selectionGroups=this.createWorld(),this._zoom=po.bind(this)(),this.setEvents()}get svgElement(){return this._svgElement}set svgElement(t){this._svgElement=t,this._svgSelection=xe(t),this.selectionGroups=this.createWorld(),this._zoom=po.bind(this)(),this.setEvents(),this.render(this.graph)}get svgSelection(){return this._svgSelection}get simulation(){return this._simulation}get selectedNodes(){return this._selectedNodes}set selectedNodes(t){this._selectedNodes=t,this.selectNodes()}get worldBounds(){const{x:t,y:n,k:r}=this.worldTransform;return{x:-(t/r),y:-(n/r),width:this.svgElement.clientWidth/r,height:this.svgElement.clientHeight/r}}set zoomScaleExtent(t){this._zoom.scaleExtent(t)}set zoomEnabled(t){this._zoom.on("zoom",null),t&&this._zoom.on("zoom",({transform:n})=>Rs.bind(this)(n))}get onZoomRegister(){return this._onZoomRegister}get onZoomRoutines(){return this._onZoomRoutines}set envGravity(t){this.simulation.force("gravity",ho(t))}set linkDistance(t){this.simulation.force("link",fo(t))}createSimulation(){return Gf().force("link",fo(400)).force("forceX",M0()).force("forceY",D0()).force("gravity",ho(-1e4)).force("shapeCollide",I0.bind(this)).on("tick",V0.bind(this)).on("end",()=>{this.eventStore.emit(ce.SimulationTickEnd)})}createWorld(){const t=this.svgSelection.append("g").attr("data-object","world"),n=t.append("g").attr("data-object","links"),r=t.append("g").attr("data-object","nodes");return{world:t,nodes:r,links:n}}setEvents(){function t(n){return{x:this.worldBounds.x+n.offsetX/this.worldTransform.k,y:this.worldBounds.y+n.offsetY/this.worldTransform.k}}this.svgSelection.on("click",n=>this.eventStore.emit(ce.EnvironmentClick,n,t.bind(this)(n))),this.svgSelection.on("dblclick",n=>this.eventStore.emit(ce.EnvironmentDoubleClick,n,t.bind(this)(n))),this.svgSelection.on("contextmenu",n=>this.eventStore.emit(ce.EnvironmentContextMenu,n,t.bind(this)(n)))}registerOnZoom(t,n,r){this.deregisterOnZoom(t),this._onZoomRegister.push({id:t,threshold:n,callback:r}),this.createOnZoomRoutines()}deregisterOnZoom(t){this._onZoomRegister=this._onZoomRegister.filter(({id:n})=>n!==t)}createOnZoomRoutines(){this._onZoomRoutines={},this._onZoomRegister.forEach(t=>{this._onZoomRoutines[t.threshold]||(this._onZoomRoutines[t.threshold]=[]),this._onZoomRoutines[t.threshold].push(t.callback)})}selectNodes(){this.selectionGroups.nodes.selectAll(".gly-selectable").classed("gly-selected",!1),this.selectionGroups.nodes.selectAll("[data-object='node']").filter(t=>this.selectedNodes.includes(t.id)).selectAll(".gly-selectable").classed("gly-selected",!0)}async render(t,n=.05,r=!1){r&&(this.nodeDataStore.clear(),this.selectionGroups.nodes.selectAll("*").remove(),this.selectionGroups.links.selectAll("*").remove()),this.graph=t,await E0.bind(this)(this.graph).then(()=>{b0(t),S0.bind(this)(this.graph),this.simulation.nodes(this.graph.nodes),this.simulation.force("link").links(t.links),this.simulation.alphaTarget(n).restart(),setTimeout(()=>{this.simulation.alphaTarget(0)},100),this._onZoomRegister.forEach(i=>i.callback(this.worldTransform.k)),this.selectNodes()})}exportGraph(){return G0.bind(this)()}moveTo(t){q0.bind(this)(t,n=>{this.svgSelection.call(this._zoom.transform,br.translate(n.x,n.y).scale(n.k))})}on(t,n){this.eventStore.on(t,n)}}export{mr as AnchorType,ce as Event,X0 as ForceSimulation,nr as LinkStrength,Ee as LinkType,oo as TemplateAPI};
