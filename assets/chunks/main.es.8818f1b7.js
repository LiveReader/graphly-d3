import{e as Ks}from"../app.c9c0b13e.js";function gi(e,t){let n,r;if(t===void 0)for(const o of e)o!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)));else{let o=-1;for(let i of e)(i=t(i,++o,e))!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}function Gs(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}var Bs={value:()=>{}};function En(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Bn(n)}function Bn(e){this._=e}function Zs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Bn.prototype=En.prototype={constructor:Bn,on:function(e,t){var n=this._,r=Zs(e+"",n),o,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((o=(e=r[i]).type)&&(o=Js(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(o=(e=r[i]).type)n[o]=vi(n[o],e.name,t);else if(t==null)for(o in n)n[o]=vi(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Bn(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function Js(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function vi(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Bs,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Vr="http://www.w3.org/1999/xhtml";const _i={svg:"http://www.w3.org/2000/svg",xhtml:Vr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _r(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_i.hasOwnProperty(t)?{space:_i[t],local:e}:e}function Xs(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Vr&&t.documentElement.namespaceURI===Vr?t.createElement(e):t.createElementNS(n,e)}}function Ys(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ma(e){var t=_r(e);return(t.local?Ys:Xs)(t)}function Ws(){}function ao(e){return e==null?Ws:function(){return this.querySelector(e)}}function Qs(e){typeof e!="function"&&(e=ao(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,s=r[o]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),s[u]=c);return new Me(r,this._parents)}function el(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function tl(){return[]}function ya(e){return e==null?tl:function(){return this.querySelectorAll(e)}}function nl(e){return function(){return el(e.apply(this,arguments))}}function rl(e){typeof e=="function"?e=nl(e):e=ya(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a=t[i],s=a.length,l,c=0;c<s;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),o.push(l));return new Me(r,o)}function ga(e){return function(){return this.matches(e)}}function va(e){return function(t){return t.matches(e)}}var ol=Array.prototype.find;function il(e){return function(){return ol.call(this.children,e)}}function al(){return this.firstElementChild}function sl(e){return this.select(e==null?al:il(typeof e=="function"?e:va(e)))}var ll=Array.prototype.filter;function cl(){return Array.from(this.children)}function ul(e){return function(){return ll.call(this.children,e)}}function hl(e){return this.selectAll(e==null?cl:ul(typeof e=="function"?e:va(e)))}function fl(e){typeof e!="function"&&(e=ga(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,s=r[o]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&s.push(l);return new Me(r,this._parents)}function _a(e){return new Array(e.length)}function dl(){return new Me(this._enter||this._groups.map(_a),this._parents)}function rr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rr.prototype={constructor:rr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function pl(e){return function(){return e}}function ml(e,t,n,r,o,i){for(var a=0,s,l=t.length,c=i.length;a<c;++a)(s=t[a])?(s.__data__=i[a],r[a]=s):n[a]=new rr(e,i[a]);for(;a<l;++a)(s=t[a])&&(o[a]=s)}function yl(e,t,n,r,o,i,a){var s,l,c=new Map,u=t.length,f=i.length,y=new Array(u),m;for(s=0;s<u;++s)(l=t[s])&&(y[s]=m=a.call(l,l.__data__,s,t)+"",c.has(m)?o[s]=l:c.set(m,l));for(s=0;s<f;++s)m=a.call(e,i[s],s,i)+"",(l=c.get(m))?(r[s]=l,l.__data__=i[s],c.delete(m)):n[s]=new rr(e,i[s]);for(s=0;s<u;++s)(l=t[s])&&c.get(y[s])===l&&(o[s]=l)}function gl(e){return e.__data__}function vl(e,t){if(!arguments.length)return Array.from(this,gl);var n=t?yl:ml,r=this._parents,o=this._groups;typeof e!="function"&&(e=pl(e));for(var i=o.length,a=new Array(i),s=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],f=o[c],y=f.length,m=_l(e.call(u,u&&u.__data__,c,r)),w=m.length,_=s[c]=new Array(w),g=a[c]=new Array(w),h=l[c]=new Array(y);n(u,f,_,g,h,m,t);for(var x=0,S=0,v,A;x<w;++x)if(v=_[x]){for(x>=S&&(S=x+1);!(A=g[S])&&++S<w;);v._next=A||null}}return a=new Me(a,r),a._enter=s,a._exit=l,a}function _l(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wl(){return new Me(this._exit||this._groups.map(_a),this._parents)}function $l(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function xl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,a=Math.min(o,i),s=new Array(o),l=0;l<a;++l)for(var c=n[l],u=r[l],f=c.length,y=s[l]=new Array(f),m,w=0;w<f;++w)(m=c[w]||u[w])&&(y[w]=m);for(;l<o;++l)s[l]=n[l];return new Me(s,this._parents)}function bl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],a;--o>=0;)(a=r[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function El(e){e||(e=kl);function t(f,y){return f&&y?e(f.__data__,y.__data__):!f-!y}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a=n[i],s=a.length,l=o[i]=new Array(s),c,u=0;u<s;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new Me(o,this._parents).order()}function kl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Sl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Pl(){return Array.from(this)}function Nl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null}function Cl(){let e=0;for(const t of this)++e;return e}function Tl(){return!this.node()}function Al(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,a=o.length,s;i<a;++i)(s=o[i])&&e.call(s,s.__data__,i,o);return this}function jl(e){return function(){this.removeAttribute(e)}}function Ol(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ml(e,t){return function(){this.setAttribute(e,t)}}function Rl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Dl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Il(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function zl(e,t){var n=_r(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Ol:jl:typeof t=="function"?n.local?Il:Dl:n.local?Rl:Ml)(n,t))}function wa(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Vl(e){return function(){this.style.removeProperty(e)}}function Fl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ll(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ql(e,t,n){return arguments.length>1?this.each((t==null?Vl:typeof t=="function"?Ll:Fl)(e,t,n==null?"":n)):Ut(this.node(),e)}function Ut(e,t){return e.style.getPropertyValue(t)||wa(e).getComputedStyle(e,null).getPropertyValue(t)}function Hl(e){return function(){delete this[e]}}function Ul(e,t){return function(){this[e]=t}}function Kl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Gl(e,t){return arguments.length>1?this.each((t==null?Hl:typeof t=="function"?Kl:Ul)(e,t)):this.node()[e]}function $a(e){return e.trim().split(/^|\s+/)}function so(e){return e.classList||new xa(e)}function xa(e){this._node=e,this._names=$a(e.getAttribute("class")||"")}xa.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ba(e,t){for(var n=so(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Ea(e,t){for(var n=so(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Bl(e){return function(){ba(this,e)}}function Zl(e){return function(){Ea(this,e)}}function Jl(e,t){return function(){(t.apply(this,arguments)?ba:Ea)(this,e)}}function Xl(e,t){var n=$a(e+"");if(arguments.length<2){for(var r=so(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Jl:t?Bl:Zl)(n,t))}function Yl(){this.textContent=""}function Wl(e){return function(){this.textContent=e}}function Ql(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function ec(e){return arguments.length?this.each(e==null?Yl:(typeof e=="function"?Ql:Wl)(e)):this.node().textContent}function tc(){this.innerHTML=""}function nc(e){return function(){this.innerHTML=e}}function rc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function oc(e){return arguments.length?this.each(e==null?tc:(typeof e=="function"?rc:nc)(e)):this.node().innerHTML}function ic(){this.nextSibling&&this.parentNode.appendChild(this)}function ac(){return this.each(ic)}function sc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lc(){return this.each(sc)}function cc(e){var t=typeof e=="function"?e:ma(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function uc(){return null}function hc(e,t){var n=typeof e=="function"?e:ma(e),r=t==null?uc:typeof t=="function"?t:ao(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function fc(){var e=this.parentNode;e&&e.removeChild(this)}function dc(){return this.each(fc)}function pc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function mc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yc(e){return this.select(e?mc:pc)}function gc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function vc(e){return function(t){e.call(this,t,this.__data__)}}function _c(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function wc(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function $c(e,t,n){return function(){var r=this.__on,o,i=vc(t);if(r){for(var a=0,s=r.length;a<s;++a)if((o=r[a]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function xc(e,t,n){var r=_c(e+""),o,i=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,c=s.length,u;l<c;++l)for(o=0,u=s[l];o<i;++o)if((a=r[o]).type===u.type&&a.name===u.name)return u.value}return}for(s=t?$c:wc,o=0;o<i;++o)this.each(s(r[o],t,n));return this}function ka(e,t,n){var r=wa(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function bc(e,t){return function(){return ka(this,e,t)}}function Ec(e,t){return function(){return ka(this,e,t.apply(this,arguments))}}function kc(e,t){return this.each((typeof t=="function"?Ec:bc)(e,t))}function*Sc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,a;o<i;++o)(a=r[o])&&(yield a)}var Sa=[null];function Me(e,t){this._groups=e,this._parents=t}function kn(){return new Me([[document.documentElement]],Sa)}function Pc(){return this}Me.prototype=kn.prototype={constructor:Me,select:Qs,selectAll:rl,selectChild:sl,selectChildren:hl,filter:fl,data:vl,enter:dl,exit:wl,join:$l,merge:xl,selection:Pc,order:bl,sort:El,call:Sl,nodes:Pl,node:Nl,size:Cl,empty:Tl,each:Al,attr:zl,style:ql,property:Gl,classed:Xl,text:ec,html:oc,raise:ac,lower:lc,append:cc,insert:hc,remove:dc,clone:yc,datum:gc,on:xc,dispatch:kc,[Symbol.iterator]:Sc};function Ee(e){return typeof e=="string"?new Me([[document.querySelector(e)]],[document.documentElement]):new Me([[e]],Sa)}function Nc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ot(e,t){if(e=Nc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Cc={passive:!1},vn={capture:!0,passive:!1};function Cr(e){e.stopImmediatePropagation()}function Ft(e){e.preventDefault(),e.stopImmediatePropagation()}function Pa(e){var t=e.document.documentElement,n=Ee(e).on("dragstart.drag",Ft,vn);"onselectstart"in t?n.on("selectstart.drag",Ft,vn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Na(e,t){var n=e.document.documentElement,r=Ee(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ft,vn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const In=e=>()=>e;function Fr(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:a,y:s,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Fr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Tc(e){return!e.ctrlKey&&!e.button}function Ac(){return this.parentNode}function jc(e,t){return t==null?{x:e.x,y:e.y}:t}function Oc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mc(){var e=Tc,t=Ac,n=jc,r=Oc,o={},i=En("start","drag","end"),a=0,s,l,c,u,f=0;function y(v){v.on("mousedown.drag",m).filter(r).on("touchstart.drag",g).on("touchmove.drag",h,Cc).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(v,A){if(!(u||!e.call(this,v,A))){var E=S(this,t.call(this,v,A),v,A,"mouse");!E||(Ee(v.view).on("mousemove.drag",w,vn).on("mouseup.drag",_,vn),Pa(v.view),Cr(v),c=!1,s=v.clientX,l=v.clientY,E("start",v))}}function w(v){if(Ft(v),!c){var A=v.clientX-s,E=v.clientY-l;c=A*A+E*E>f}o.mouse("drag",v)}function _(v){Ee(v.view).on("mousemove.drag mouseup.drag",null),Na(v.view,c),Ft(v),o.mouse("end",v)}function g(v,A){if(!!e.call(this,v,A)){var E=v.changedTouches,P=t.call(this,v,A),j=E.length,L,U;for(L=0;L<j;++L)(U=S(this,P,v,A,E[L].identifier,E[L]))&&(Cr(v),U("start",v,E[L]))}}function h(v){var A=v.changedTouches,E=A.length,P,j;for(P=0;P<E;++P)(j=o[A[P].identifier])&&(Ft(v),j("drag",v,A[P]))}function x(v){var A=v.changedTouches,E=A.length,P,j;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),P=0;P<E;++P)(j=o[A[P].identifier])&&(Cr(v),j("end",v,A[P]))}function S(v,A,E,P,j,L){var U=i.copy(),X=ot(L||E,A),Z,ee,C;if((C=n.call(v,new Fr("beforestart",{sourceEvent:E,target:y,identifier:j,active:a,x:X[0],y:X[1],dx:0,dy:0,dispatch:U}),P))!=null)return Z=C.x-X[0]||0,ee=C.y-X[1]||0,function V(z,H,G){var Y=X,I;switch(z){case"start":o[j]=V,I=a++;break;case"end":delete o[j],--a;case"drag":X=ot(G||H,A),I=a;break}U.call(z,v,new Fr(z,{sourceEvent:H,subject:C,target:y,identifier:j,active:I,x:X[0]+Z,y:X[1]+ee,dx:X[0]-Y[0],dy:X[1]-Y[1],dispatch:U}),P)}}return y.filter=function(v){return arguments.length?(e=typeof v=="function"?v:In(!!v),y):e},y.container=function(v){return arguments.length?(t=typeof v=="function"?v:In(v),y):t},y.subject=function(v){return arguments.length?(n=typeof v=="function"?v:In(v),y):n},y.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:In(!!v),y):r},y.on=function(){var v=i.on.apply(i,arguments);return v===i?y:v},y.clickDistance=function(v){return arguments.length?(f=(v=+v)*v,y):Math.sqrt(f)},y}function lo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ca(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Sn(){}var _n=.7,or=1/_n,Lt="\\s*([+-]?\\d+)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",We="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rc=/^#([0-9a-f]{3,8})$/,Dc=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),Ic=new RegExp(`^rgb\\(${We},${We},${We}\\)$`),zc=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${wn}\\)$`),Vc=new RegExp(`^rgba\\(${We},${We},${We},${wn}\\)$`),Fc=new RegExp(`^hsl\\(${wn},${We},${We}\\)$`),Lc=new RegExp(`^hsla\\(${wn},${We},${We},${wn}\\)$`),wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lo(Sn,$n,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$i,formatHex:$i,formatHex8:qc,formatHsl:Hc,formatRgb:xi,toString:xi});function $i(){return this.rgb().formatHex()}function qc(){return this.rgb().formatHex8()}function Hc(){return Ta(this).formatHsl()}function xi(){return this.rgb().formatRgb()}function $n(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Rc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?bi(t):n===3?new Te(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?zn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?zn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Dc.exec(e))?new Te(t[1],t[2],t[3],1):(t=Ic.exec(e))?new Te(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=zc.exec(e))?zn(t[1],t[2],t[3],t[4]):(t=Vc.exec(e))?zn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Fc.exec(e))?Si(t[1],t[2]/100,t[3]/100,1):(t=Lc.exec(e))?Si(t[1],t[2]/100,t[3]/100,t[4]):wi.hasOwnProperty(e)?bi(wi[e]):e==="transparent"?new Te(NaN,NaN,NaN,0):null}function bi(e){return new Te(e>>16&255,e>>8&255,e&255,1)}function zn(e,t,n,r){return r<=0&&(e=t=n=NaN),new Te(e,t,n,r)}function Uc(e){return e instanceof Sn||(e=$n(e)),e?(e=e.rgb(),new Te(e.r,e.g,e.b,e.opacity)):new Te}function Lr(e,t,n,r){return arguments.length===1?Uc(e):new Te(e,t,n,r==null?1:r)}function Te(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}lo(Te,Lr,Ca(Sn,{brighter(e){return e=e==null?or:Math.pow(or,e),new Te(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_n:Math.pow(_n,e),new Te(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Te(kt(this.r),kt(this.g),kt(this.b),ir(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ei,formatHex:Ei,formatHex8:Kc,formatRgb:ki,toString:ki}));function Ei(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}`}function Kc(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}${Et((isNaN(this.opacity)?1:this.opacity)*255)}`}function ki(){const e=ir(this.opacity);return`${e===1?"rgb(":"rgba("}${kt(this.r)}, ${kt(this.g)}, ${kt(this.b)}${e===1?")":`, ${e})`}`}function ir(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function kt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Et(e){return e=kt(e),(e<16?"0":"")+e.toString(16)}function Si(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new qe(e,t,n,r)}function Ta(e){if(e instanceof qe)return new qe(e.h,e.s,e.l,e.opacity);if(e instanceof Sn||(e=$n(e)),!e)return new qe;if(e instanceof qe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,s=i-o,l=(i+o)/2;return s?(t===i?a=(n-r)/s+(n<r)*6:n===i?a=(r-t)/s+2:a=(t-n)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new qe(a,s,l,e.opacity)}function Gc(e,t,n,r){return arguments.length===1?Ta(e):new qe(e,t,n,r==null?1:r)}function qe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}lo(qe,Gc,Ca(Sn,{brighter(e){return e=e==null?or:Math.pow(or,e),new qe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_n:Math.pow(_n,e),new qe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Te(Tr(e>=240?e-240:e+120,o,r),Tr(e,o,r),Tr(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new qe(Pi(this.h),Vn(this.s),Vn(this.l),ir(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ir(this.opacity);return`${e===1?"hsl(":"hsla("}${Pi(this.h)}, ${Vn(this.s)*100}%, ${Vn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Pi(e){return e=(e||0)%360,e<0?e+360:e}function Vn(e){return Math.max(0,Math.min(1,e||0))}function Tr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Aa=e=>()=>e;function Bc(e,t){return function(n){return e+n*t}}function Zc(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Jc(e){return(e=+e)==1?ja:function(t,n){return n-t?Zc(t,n,e):Aa(isNaN(t)?n:t)}}function ja(e,t){var n=t-e;return n?Bc(e,n):Aa(isNaN(e)?t:e)}const Ni=function e(t){var n=Jc(t);function r(o,i){var a=n((o=Lr(o)).r,(i=Lr(i)).r),s=n(o.g,i.g),l=n(o.b,i.b),c=ja(o.opacity,i.opacity);return function(u){return o.r=a(u),o.g=s(u),o.b=l(u),o.opacity=c(u),o+""}}return r.gamma=e,r}(1);function ft(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var qr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ar=new RegExp(qr.source,"g");function Xc(e){return function(){return e}}function Yc(e){return function(t){return e(t)+""}}function Wc(e,t){var n=qr.lastIndex=Ar.lastIndex=0,r,o,i,a=-1,s=[],l=[];for(e=e+"",t=t+"";(r=qr.exec(e))&&(o=Ar.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),s[a]?s[a]+=i:s[++a]=i),(r=r[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,l.push({i:a,x:ft(r,o)})),n=Ar.lastIndex;return n<t.length&&(i=t.slice(n),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?Yc(l[0].x):Xc(t):(t=l.length,function(c){for(var u=0,f;u<t;++u)s[(f=l[u]).i]=f.x(c);return s.join("")})}var Ci=180/Math.PI,Hr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Oa(e,t,n,r,o,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Ci,skewX:Math.atan(l)*Ci,scaleX:a,scaleY:s}}var Fn;function Qc(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Hr:Oa(t.a,t.b,t.c,t.d,t.e,t.f)}function eu(e){return e==null||(Fn||(Fn=document.createElementNS("http://www.w3.org/2000/svg","g")),Fn.setAttribute("transform",e),!(e=Fn.transform.baseVal.consolidate()))?Hr:(e=e.matrix,Oa(e.a,e.b,e.c,e.d,e.e,e.f))}function Ma(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,u,f,y,m,w){if(c!==f||u!==y){var _=m.push("translate(",null,t,null,n);w.push({i:_-4,x:ft(c,f)},{i:_-2,x:ft(u,y)})}else(f||y)&&m.push("translate("+f+t+y+n)}function a(c,u,f,y){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),y.push({i:f.push(o(f)+"rotate(",null,r)-2,x:ft(c,u)})):u&&f.push(o(f)+"rotate("+u+r)}function s(c,u,f,y){c!==u?y.push({i:f.push(o(f)+"skewX(",null,r)-2,x:ft(c,u)}):u&&f.push(o(f)+"skewX("+u+r)}function l(c,u,f,y,m,w){if(c!==f||u!==y){var _=m.push(o(m)+"scale(",null,",",null,")");w.push({i:_-4,x:ft(c,f)},{i:_-2,x:ft(u,y)})}else(f!==1||y!==1)&&m.push(o(m)+"scale("+f+","+y+")")}return function(c,u){var f=[],y=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,f,y),a(c.rotate,u.rotate,f,y),s(c.skewX,u.skewX,f,y),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,y),c=u=null,function(m){for(var w=-1,_=y.length,g;++w<_;)f[(g=y[w]).i]=g.x(m);return f.join("")}}}var tu=Ma(Qc,"px, ","px)","deg)"),nu=Ma(eu,", ",")",")"),ru=1e-12;function Ti(e){return((e=Math.exp(e))+1/e)/2}function ou(e){return((e=Math.exp(e))-1/e)/2}function iu(e){return((e=Math.exp(2*e))-1)/(e+1)}const au=function e(t,n,r){function o(i,a){var s=i[0],l=i[1],c=i[2],u=a[0],f=a[1],y=a[2],m=u-s,w=f-l,_=m*m+w*w,g,h;if(_<ru)h=Math.log(y/c)/t,g=function(P){return[s+P*m,l+P*w,c*Math.exp(t*P*h)]};else{var x=Math.sqrt(_),S=(y*y-c*c+r*_)/(2*c*n*x),v=(y*y-c*c-r*_)/(2*y*n*x),A=Math.log(Math.sqrt(S*S+1)-S),E=Math.log(Math.sqrt(v*v+1)-v);h=(E-A)/t,g=function(P){var j=P*h,L=Ti(A),U=c/(n*x)*(L*iu(t*j+A)-ou(A));return[s+U*m,l+U*w,c*L/Ti(t*j+A)]}}return g.duration=h*1e3*t/Math.SQRT2,g}return o.rho=function(i){var a=Math.max(.001,+i),s=a*a,l=s*s;return e(a,s,l)},o}(Math.SQRT2,2,4);var Kt=0,cn=0,on=0,Ra=1e3,ar,un,sr=0,St=0,wr=0,xn=typeof performance=="object"&&performance.now?performance:Date,Da=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function co(){return St||(Da(su),St=xn.now()+wr)}function su(){St=0}function lr(){this._call=this._time=this._next=null}lr.prototype=uo.prototype={constructor:lr,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?co():+n)+(t==null?0:+t),!this._next&&un!==this&&(un?un._next=this:ar=this,un=this),this._call=e,this._time=n,Ur()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ur())}};function uo(e,t,n){var r=new lr;return r.restart(e,t,n),r}function lu(){co(),++Kt;for(var e=ar,t;e;)(t=St-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Kt}function Ai(){St=(sr=xn.now())+wr,Kt=cn=0;try{lu()}finally{Kt=0,uu(),St=0}}function cu(){var e=xn.now(),t=e-sr;t>Ra&&(wr-=t,sr=e)}function uu(){for(var e,t=ar,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ar=n);un=e,Ur(r)}function Ur(e){if(!Kt){cn&&(cn=clearTimeout(cn));var t=e-St;t>24?(e<1/0&&(cn=setTimeout(Ai,e-xn.now()-wr)),on&&(on=clearInterval(on))):(on||(sr=xn.now(),on=setInterval(cu,Ra)),Kt=1,Da(Ai))}}function ji(e,t,n){var r=new lr;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var hu=En("start","end","cancel","interrupt"),fu=[],Ia=0,Oi=1,Kr=2,Zn=3,Mi=4,Gr=5,Jn=6;function $r(e,t,n,r,o,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;du(e,n,{name:t,index:r,group:o,on:hu,tween:fu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Ia})}function ho(e,t){var n=Ke(e,t);if(n.state>Ia)throw new Error("too late; already scheduled");return n}function Qe(e,t){var n=Ke(e,t);if(n.state>Zn)throw new Error("too late; already running");return n}function Ke(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function du(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=uo(i,0,n.time);function i(c){n.state=Oi,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,f,y,m;if(n.state!==Oi)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===Zn)return ji(a);m.state===Mi?(m.state=Jn,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=Jn,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(ji(function(){n.state===Zn&&(n.state=Mi,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=Kr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Kr){for(n.state=Zn,o=new Array(y=n.tween.length),u=0,f=-1;u<y;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=m);o.length=f+1}}function s(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Gr,1),f=-1,y=o.length;++f<y;)o[f].call(e,u);n.state===Gr&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Jn,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Xn(e,t){var n=e.__transition,r,o,i=!0,a;if(!!n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}o=r.state>Kr&&r.state<Gr,r.state=Jn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function pu(e){return this.each(function(){Xn(this,e)})}function mu(e,t){var n,r;return function(){var o=Qe(this,e),i=o.tween;if(i!==n){r=n=i;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}o.tween=r}}function yu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Qe(this,e),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=s;break}l===c&&o.push(s)}i.tween=o}}function gu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ke(this.node(),n).tween,o=0,i=r.length,a;o<i;++o)if((a=r[o]).name===e)return a.value;return null}return this.each((t==null?mu:yu)(n,e,t))}function fo(e,t,n){var r=e._id;return e.each(function(){var o=Qe(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ke(o,r).value[t]}}function za(e,t){var n;return(typeof t=="number"?ft:t instanceof $n?Ni:(n=$n(t))?(t=n,Ni):Wc)(e,t)}function vu(e){return function(){this.removeAttribute(e)}}function _u(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wu(e,t,n){var r,o=n+"",i;return function(){var a=this.getAttribute(e);return a===o?null:a===r?i:i=t(r=a,n)}}function $u(e,t,n){var r,o=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===r?i:i=t(r=a,n)}}function xu(e,t,n){var r,o,i;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=s+"",a===l?null:a===r&&l===o?i:(o=l,i=t(r=a,s)))}}function bu(e,t,n){var r,o,i;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=s+"",a===l?null:a===r&&l===o?i:(o=l,i=t(r=a,s)))}}function Eu(e,t){var n=_r(e),r=n==="transform"?nu:za;return this.attrTween(e,typeof t=="function"?(n.local?bu:xu)(n,r,fo(this,"attr."+e,t)):t==null?(n.local?_u:vu)(n):(n.local?$u:wu)(n,r,t))}function ku(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Su(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Pu(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Su(e,i)),n}return o._value=t,o}function Nu(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ku(e,i)),n}return o._value=t,o}function Cu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=_r(e);return this.tween(n,(r.local?Pu:Nu)(r,t))}function Tu(e,t){return function(){ho(this,e).delay=+t.apply(this,arguments)}}function Au(e,t){return t=+t,function(){ho(this,e).delay=t}}function ju(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Tu:Au)(t,e)):Ke(this.node(),t).delay}function Ou(e,t){return function(){Qe(this,e).duration=+t.apply(this,arguments)}}function Mu(e,t){return t=+t,function(){Qe(this,e).duration=t}}function Ru(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ou:Mu)(t,e)):Ke(this.node(),t).duration}function Du(e,t){if(typeof t!="function")throw new Error;return function(){Qe(this,e).ease=t}}function Iu(e){var t=this._id;return arguments.length?this.each(Du(t,e)):Ke(this.node(),t).ease}function zu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Qe(this,e).ease=n}}function Vu(e){if(typeof e!="function")throw new Error;return this.each(zu(this._id,e))}function Fu(e){typeof e!="function"&&(e=ga(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,s=r[o]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&s.push(l);return new ct(r,this._parents,this._name,this._id)}function Lu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var l=t[s],c=n[s],u=l.length,f=a[s]=new Array(u),y,m=0;m<u;++m)(y=l[m]||c[m])&&(f[m]=y);for(;s<r;++s)a[s]=t[s];return new ct(a,this._parents,this._name,this._id)}function qu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Hu(e,t,n){var r,o,i=qu(t)?ho:Qe;return function(){var a=i(this,e),s=a.on;s!==r&&(o=(r=s).copy()).on(t,n),a.on=o}}function Uu(e,t){var n=this._id;return arguments.length<2?Ke(this.node(),n).on.on(e):this.each(Hu(n,e,t))}function Ku(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Gu(){return this.on("end.remove",Ku(this._id))}function Bu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ao(e));for(var r=this._groups,o=r.length,i=new Array(o),a=0;a<o;++a)for(var s=r[a],l=s.length,c=i[a]=new Array(l),u,f,y=0;y<l;++y)(u=s[y])&&(f=e.call(u,u.__data__,y,s))&&("__data__"in u&&(f.__data__=u.__data__),c[y]=f,$r(c[y],t,n,y,c,Ke(u,n)));return new ct(i,this._parents,t,n)}function Zu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ya(e));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var l=r[s],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var y=e.call(u,u.__data__,f,l),m,w=Ke(u,n),_=0,g=y.length;_<g;++_)(m=y[_])&&$r(m,t,n,_,y,w);i.push(y),a.push(u)}return new ct(i,a,t,n)}var Ju=kn.prototype.constructor;function Xu(){return new Ju(this._groups,this._parents)}function Yu(e,t){var n,r,o;return function(){var i=Ut(this,e),a=(this.style.removeProperty(e),Ut(this,e));return i===a?null:i===n&&a===r?o:o=t(n=i,r=a)}}function Va(e){return function(){this.style.removeProperty(e)}}function Wu(e,t,n){var r,o=n+"",i;return function(){var a=Ut(this,e);return a===o?null:a===r?i:i=t(r=a,n)}}function Qu(e,t,n){var r,o,i;return function(){var a=Ut(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),Ut(this,e))),a===l?null:a===r&&l===o?i:(o=l,i=t(r=a,s))}}function eh(e,t){var n,r,o,i="style."+t,a="end."+i,s;return function(){var l=Qe(this,e),c=l.on,u=l.value[i]==null?s||(s=Va(t)):void 0;(c!==n||o!==u)&&(r=(n=c).copy()).on(a,o=u),l.on=r}}function th(e,t,n){var r=(e+="")=="transform"?tu:za;return t==null?this.styleTween(e,Yu(e,r)).on("end.style."+e,Va(e)):typeof t=="function"?this.styleTween(e,Qu(e,r,fo(this,"style."+e,t))).each(eh(this._id,e)):this.styleTween(e,Wu(e,r,t),n).on("end.style."+e,null)}function nh(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function rh(e,t,n){var r,o;function i(){var a=t.apply(this,arguments);return a!==o&&(r=(o=a)&&nh(e,a,n)),r}return i._value=t,i}function oh(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,rh(e,t,n==null?"":n))}function ih(e){return function(){this.textContent=e}}function ah(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function sh(e){return this.tween("text",typeof e=="function"?ah(fo(this,"text",e)):ih(e==null?"":e+""))}function lh(e){return function(t){this.textContent=e.call(this,t)}}function ch(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&lh(o)),t}return r._value=e,r}function uh(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ch(e))}function hh(){for(var e=this._name,t=this._id,n=Fa(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a=r[i],s=a.length,l,c=0;c<s;++c)if(l=a[c]){var u=Ke(l,t);$r(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ct(r,this._parents,e,n)}function fh(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,a){var s={value:a},l={value:function(){--o===0&&i()}};n.each(function(){var c=Qe(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),c.on=t}),o===0&&i()})}var dh=0;function ct(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Fa(){return++dh}var rt=kn.prototype;ct.prototype={constructor:ct,select:Bu,selectAll:Zu,selectChild:rt.selectChild,selectChildren:rt.selectChildren,filter:Fu,merge:Lu,selection:Xu,transition:hh,call:rt.call,nodes:rt.nodes,node:rt.node,size:rt.size,empty:rt.empty,each:rt.each,on:Uu,attr:Eu,attrTween:Cu,style:th,styleTween:oh,text:sh,textTween:uh,remove:Gu,tween:gu,delay:ju,duration:Ru,ease:Iu,easeVarying:Vu,end:fh,[Symbol.iterator]:rt[Symbol.iterator]};function ph(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var po=3;(function e(t){t=+t;function n(r){return Math.pow(r,t)}return n.exponent=e,n})(po);(function e(t){t=+t;function n(r){return 1-Math.pow(1-r,t)}return n.exponent=e,n})(po);var mh=function e(t){t=+t;function n(r){return((r*=2)<=1?Math.pow(r,t):2-Math.pow(2-r,t))/2}return n.exponent=e,n}(po),yh={time:null,delay:0,duration:250,ease:ph};function gh(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function vh(e){var t,n;e instanceof ct?(t=e._id,e=e._name):(t=Fa(),(n=yh).time=co(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a=r[i],s=a.length,l,c=0;c<s;++c)(l=a[c])&&$r(l,e,t,c,a,n||gh(l,t));return new ct(r,this._parents,e,t)}kn.prototype.interrupt=pu;kn.prototype.transition=vh;function _h(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return La(this.cover(t,n),t,n,e)}function La(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var o,i=e._root,a={data:r},s=e._x0,l=e._y0,c=e._x1,u=e._y1,f,y,m,w,_,g,h,x;if(!i)return e._root=a,e;for(;i.length;)if((_=t>=(f=(s+c)/2))?s=f:c=f,(g=n>=(y=(l+u)/2))?l=y:u=y,o=i,!(i=i[h=g<<1|_]))return o[h]=a,e;if(m=+e._x.call(null,i.data),w=+e._y.call(null,i.data),t===m&&n===w)return a.next=i,o?o[h]=a:e._root=a,e;do o=o?o[h]=new Array(4):e._root=new Array(4),(_=t>=(f=(s+c)/2))?s=f:c=f,(g=n>=(y=(l+u)/2))?l=y:u=y;while((h=g<<1|_)===(x=(w>=y)<<1|m>=f));return o[x]=i,o[h]=a,e}function wh(e){var t,n,r=e.length,o,i,a=new Array(r),s=new Array(r),l=1/0,c=1/0,u=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(o=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=o,s[n]=i,o<l&&(l=o),o>u&&(u=o),i<c&&(c=i),i>f&&(f=i));if(l>u||c>f)return this;for(this.cover(l,c).cover(u,f),n=0;n<r;++n)La(this,a[n],s[n],e[n]);return this}function $h(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,o=this._x1,i=this._y1;if(isNaN(n))o=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var a=o-n||1,s=this._root,l,c;n>e||e>=o||r>t||t>=i;)switch(c=(t<r)<<1|e<n,l=new Array(4),l[c]=s,s=l,a*=2,c){case 0:o=n+a,i=r+a;break;case 1:n=o-a,i=r+a;break;case 2:o=n+a,r=i-a;break;case 3:n=o-a,r=i-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=o,this._y1=i,this}function xh(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function bh(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ke(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o}function Eh(e,t,n){var r,o=this._x0,i=this._y0,a,s,l,c,u=this._x1,f=this._y1,y=[],m=this._root,w,_;for(m&&y.push(new ke(m,o,i,u,f)),n==null?n=1/0:(o=e-n,i=t-n,u=e+n,f=t+n,n*=n);w=y.pop();)if(!(!(m=w.node)||(a=w.x0)>u||(s=w.y0)>f||(l=w.x1)<o||(c=w.y1)<i))if(m.length){var g=(a+l)/2,h=(s+c)/2;y.push(new ke(m[3],g,h,l,c),new ke(m[2],a,h,g,c),new ke(m[1],g,s,l,h),new ke(m[0],a,s,g,h)),(_=(t>=h)<<1|e>=g)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-_],y[y.length-1-_]=w)}else{var x=e-+this._x.call(null,m.data),S=t-+this._y.call(null,m.data),v=x*x+S*S;if(v<n){var A=Math.sqrt(n=v);o=e-A,i=t-A,u=e+A,f=t+A,r=m.data}}return r}function kh(e){if(isNaN(u=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,o,i,a=this._x0,s=this._y0,l=this._x1,c=this._y1,u,f,y,m,w,_,g,h;if(!n)return this;if(n.length)for(;;){if((w=u>=(y=(a+l)/2))?a=y:l=y,(_=f>=(m=(s+c)/2))?s=m:c=m,t=n,!(n=n[g=_<<1|w]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,h=g)}for(;n.data!==e;)if(o=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,o?(i?o.next=i:delete o.next,this):t?(i?t[g]=i:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[h]=n:this._root=n),this):(this._root=i,this)}function Sh(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Ph(){return this._root}function Nh(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Ch(e){var t=[],n,r=this._root,o,i,a,s,l;for(r&&t.push(new ke(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,i=n.x0,a=n.y0,s=n.x1,l=n.y1)&&r.length){var c=(i+s)/2,u=(a+l)/2;(o=r[3])&&t.push(new ke(o,c,u,s,l)),(o=r[2])&&t.push(new ke(o,i,u,c,l)),(o=r[1])&&t.push(new ke(o,c,a,s,u)),(o=r[0])&&t.push(new ke(o,i,a,c,u))}return this}function Th(e){var t=[],n=[],r;for(this._root&&t.push(new ke(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var o=r.node;if(o.length){var i,a=r.x0,s=r.y0,l=r.x1,c=r.y1,u=(a+l)/2,f=(s+c)/2;(i=o[0])&&t.push(new ke(i,a,s,u,f)),(i=o[1])&&t.push(new ke(i,u,s,l,f)),(i=o[2])&&t.push(new ke(i,a,f,u,c)),(i=o[3])&&t.push(new ke(i,u,f,l,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Ah(e){return e[0]}function jh(e){return arguments.length?(this._x=e,this):this._x}function Oh(e){return e[1]}function Mh(e){return arguments.length?(this._y=e,this):this._y}function mo(e,t,n){var r=new yo(t==null?Ah:t,n==null?Oh:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function yo(e,t,n,r,o,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function Ri(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Se=mo.prototype=yo.prototype;Se.copy=function(){var e=new yo(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Ri(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var o=0;o<4;++o)(r=t.source[o])&&(r.length?n.push({source:r,target:t.target[o]=new Array(4)}):t.target[o]=Ri(r));return e};Se.add=_h;Se.addAll=wh;Se.cover=$h;Se.data=xh;Se.extent=bh;Se.find=Eh;Se.remove=kh;Se.removeAll=Sh;Se.root=Ph;Se.size=Nh;Se.visit=Ch;Se.visitAfter=Th;Se.x=jh;Se.y=Mh;function Oe(e){return function(){return e}}function Vt(e){return(e()-.5)*1e-6}function Rh(e){return e.index}function Di(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Dh(e){var t=Rh,n=f,r,o=Oe(30),i,a,s,l,c,u=1;e==null&&(e=[]);function f(g){return 1/Math.min(s[g.source.index],s[g.target.index])}function y(g){for(var h=0,x=e.length;h<u;++h)for(var S=0,v,A,E,P,j,L,U;S<x;++S)v=e[S],A=v.source,E=v.target,P=E.x+E.vx-A.x-A.vx||Vt(c),j=E.y+E.vy-A.y-A.vy||Vt(c),L=Math.sqrt(P*P+j*j),L=(L-i[S])/L*g*r[S],P*=L,j*=L,E.vx-=P*(U=l[S]),E.vy-=j*U,A.vx+=P*(U=1-U),A.vy+=j*U}function m(){if(!!a){var g,h=a.length,x=e.length,S=new Map(a.map((A,E)=>[t(A,E,a),A])),v;for(g=0,s=new Array(h);g<x;++g)v=e[g],v.index=g,typeof v.source!="object"&&(v.source=Di(S,v.source)),typeof v.target!="object"&&(v.target=Di(S,v.target)),s[v.source.index]=(s[v.source.index]||0)+1,s[v.target.index]=(s[v.target.index]||0)+1;for(g=0,l=new Array(x);g<x;++g)v=e[g],l[g]=s[v.source.index]/(s[v.source.index]+s[v.target.index]);r=new Array(x),w(),i=new Array(x),_()}}function w(){if(!!a)for(var g=0,h=e.length;g<h;++g)r[g]=+n(e[g],g,e)}function _(){if(!!a)for(var g=0,h=e.length;g<h;++g)i[g]=+o(e[g],g,e)}return y.initialize=function(g,h){a=g,c=h,m()},y.links=function(g){return arguments.length?(e=g,m(),y):e},y.id=function(g){return arguments.length?(t=g,y):t},y.iterations=function(g){return arguments.length?(u=+g,y):u},y.strength=function(g){return arguments.length?(n=typeof g=="function"?g:Oe(+g),w(),y):n},y.distance=function(g){return arguments.length?(o=typeof g=="function"?g:Oe(+g),_(),y):o},y}const Ih=1664525,zh=1013904223,Ii=4294967296;function Vh(){let e=1;return()=>(e=(Ih*e+zh)%Ii)/Ii}function Fh(e){return e.x}function Lh(e){return e.y}var qh=10,Hh=Math.PI*(3-Math.sqrt(5));function Uh(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),i=0,a=.6,s=new Map,l=uo(f),c=En("tick","end"),u=Vh();e==null&&(e=[]);function f(){y(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function y(_){var g,h=e.length,x;_===void 0&&(_=1);for(var S=0;S<_;++S)for(n+=(i-n)*o,s.forEach(function(v){v(n)}),g=0;g<h;++g)x=e[g],x.fx==null?x.x+=x.vx*=a:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=a:(x.y=x.fy,x.vy=0);return t}function m(){for(var _=0,g=e.length,h;_<g;++_){if(h=e[_],h.index=_,h.fx!=null&&(h.x=h.fx),h.fy!=null&&(h.y=h.fy),isNaN(h.x)||isNaN(h.y)){var x=qh*Math.sqrt(.5+_),S=_*Hh;h.x=x*Math.cos(S),h.y=x*Math.sin(S)}(isNaN(h.vx)||isNaN(h.vy))&&(h.vx=h.vy=0)}}function w(_){return _.initialize&&_.initialize(e,u),_}return m(),t={tick:y,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(_){return arguments.length?(e=_,m(),s.forEach(w),t):e},alpha:function(_){return arguments.length?(n=+_,t):n},alphaMin:function(_){return arguments.length?(r=+_,t):r},alphaDecay:function(_){return arguments.length?(o=+_,t):+o},alphaTarget:function(_){return arguments.length?(i=+_,t):i},velocityDecay:function(_){return arguments.length?(a=1-_,t):1-a},randomSource:function(_){return arguments.length?(u=_,s.forEach(w),t):u},force:function(_,g){return arguments.length>1?(g==null?s.delete(_):s.set(_,w(g)),t):s.get(_)},find:function(_,g,h){var x=0,S=e.length,v,A,E,P,j;for(h==null?h=1/0:h*=h,x=0;x<S;++x)P=e[x],v=_-P.x,A=g-P.y,E=v*v+A*A,E<h&&(j=P,h=E);return j},on:function(_,g){return arguments.length>1?(c.on(_,g),t):c.on(_)}}}function Kh(){var e,t,n,r,o=Oe(-30),i,a=1,s=1/0,l=.81;function c(m){var w,_=e.length,g=mo(e,Fh,Lh).visitAfter(f);for(r=m,w=0;w<_;++w)t=e[w],g.visit(y)}function u(){if(!!e){var m,w=e.length,_;for(i=new Array(w),m=0;m<w;++m)_=e[m],i[_.index]=+o(_,m,e)}}function f(m){var w=0,_,g,h=0,x,S,v;if(m.length){for(x=S=v=0;v<4;++v)(_=m[v])&&(g=Math.abs(_.value))&&(w+=_.value,h+=g,x+=g*_.x,S+=g*_.y);m.x=x/h,m.y=S/h}else{_=m,_.x=_.data.x,_.y=_.data.y;do w+=i[_.data.index];while(_=_.next)}m.value=w}function y(m,w,_,g){if(!m.value)return!0;var h=m.x-t.x,x=m.y-t.y,S=g-w,v=h*h+x*x;if(S*S/l<v)return v<s&&(h===0&&(h=Vt(n),v+=h*h),x===0&&(x=Vt(n),v+=x*x),v<a&&(v=Math.sqrt(a*v)),t.vx+=h*m.value*r/v,t.vy+=x*m.value*r/v),!0;if(m.length||v>=s)return;(m.data!==t||m.next)&&(h===0&&(h=Vt(n),v+=h*h),x===0&&(x=Vt(n),v+=x*x),v<a&&(v=Math.sqrt(a*v)));do m.data!==t&&(S=i[m.data.index]*r/v,t.vx+=h*S,t.vy+=x*S);while(m=m.next)}return c.initialize=function(m,w){e=m,n=w,u()},c.strength=function(m){return arguments.length?(o=typeof m=="function"?m:Oe(+m),u(),c):o},c.distanceMin=function(m){return arguments.length?(a=m*m,c):Math.sqrt(a)},c.distanceMax=function(m){return arguments.length?(s=m*m,c):Math.sqrt(s)},c.theta=function(m){return arguments.length?(l=m*m,c):Math.sqrt(l)},c}function Gh(e){var t=Oe(.1),n,r,o;typeof e!="function"&&(e=Oe(e==null?0:+e));function i(s){for(var l=0,c=n.length,u;l<c;++l)u=n[l],u.vx+=(o[l]-u.x)*r[l]*s}function a(){if(!!n){var s,l=n.length;for(r=new Array(l),o=new Array(l),s=0;s<l;++s)r[s]=isNaN(o[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return i.initialize=function(s){n=s,a()},i.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Oe(+s),a(),i):t},i.x=function(s){return arguments.length?(e=typeof s=="function"?s:Oe(+s),a(),i):e},i}function Bh(e){var t=Oe(.1),n,r,o;typeof e!="function"&&(e=Oe(e==null?0:+e));function i(s){for(var l=0,c=n.length,u;l<c;++l)u=n[l],u.vy+=(o[l]-u.y)*r[l]*s}function a(){if(!!n){var s,l=n.length;for(r=new Array(l),o=new Array(l),s=0;s<l;++s)r[s]=isNaN(o[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return i.initialize=function(s){n=s,a()},i.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Oe(+s),a(),i):t},i.y=function(s){return arguments.length?(e=typeof s=="function"?s:Oe(+s),a(),i):e},i}const Ln=e=>()=>e;function Zh(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function it(e,t,n){this.k=e,this.x=t,this.y=n}it.prototype={constructor:it,scale:function(e){return e===1?this:new it(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new it(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var xr=new it(1,0,0);it.prototype;function jr(e){e.stopImmediatePropagation()}function an(e){e.preventDefault(),e.stopImmediatePropagation()}function Jh(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Xh(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function zi(){return this.__zoom||xr}function Yh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Wh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qh(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function ef(){var e=Jh,t=Xh,n=Qh,r=Yh,o=Wh,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,l=au,c=En("start","zoom","end"),u,f,y,m=500,w=150,_=0,g=10;function h(C){C.property("__zoom",zi).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",U).filter(o).on("touchstart.zoom",X).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",ee).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(C,V,z,H){var G=C.selection?C.selection():C;G.property("__zoom",zi),C!==G?A(C,V,z,H):G.interrupt().each(function(){E(this,arguments).event(H).start().zoom(null,typeof V=="function"?V.apply(this,arguments):V).end()})},h.scaleBy=function(C,V,z,H){h.scaleTo(C,function(){var G=this.__zoom.k,Y=typeof V=="function"?V.apply(this,arguments):V;return G*Y},z,H)},h.scaleTo=function(C,V,z,H){h.transform(C,function(){var G=t.apply(this,arguments),Y=this.__zoom,I=z==null?v(G):typeof z=="function"?z.apply(this,arguments):z,N=Y.invert(I),D=typeof V=="function"?V.apply(this,arguments):V;return n(S(x(Y,D),I,N),G,a)},z,H)},h.translateBy=function(C,V,z,H){h.transform(C,function(){return n(this.__zoom.translate(typeof V=="function"?V.apply(this,arguments):V,typeof z=="function"?z.apply(this,arguments):z),t.apply(this,arguments),a)},null,H)},h.translateTo=function(C,V,z,H,G){h.transform(C,function(){var Y=t.apply(this,arguments),I=this.__zoom,N=H==null?v(Y):typeof H=="function"?H.apply(this,arguments):H;return n(xr.translate(N[0],N[1]).scale(I.k).translate(typeof V=="function"?-V.apply(this,arguments):-V,typeof z=="function"?-z.apply(this,arguments):-z),Y,a)},H,G)};function x(C,V){return V=Math.max(i[0],Math.min(i[1],V)),V===C.k?C:new it(V,C.x,C.y)}function S(C,V,z){var H=V[0]-z[0]*C.k,G=V[1]-z[1]*C.k;return H===C.x&&G===C.y?C:new it(C.k,H,G)}function v(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function A(C,V,z,H){C.on("start.zoom",function(){E(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(H).end()}).tween("zoom",function(){var G=this,Y=arguments,I=E(G,Y).event(H),N=t.apply(G,Y),D=z==null?v(N):typeof z=="function"?z.apply(G,Y):z,T=Math.max(N[1][0]-N[0][0],N[1][1]-N[0][1]),d=G.__zoom,b=typeof V=="function"?V.apply(G,Y):V,O=l(d.invert(D).concat(T/d.k),b.invert(D).concat(T/b.k));return function(F){if(F===1)F=b;else{var q=O(F),te=T/q[2];F=new it(te,D[0]-q[0]*te,D[1]-q[1]*te)}I.zoom(null,F)}})}function E(C,V,z){return!z&&C.__zooming||new P(C,V)}function P(C,V){this.that=C,this.args=V,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,V),this.taps=0}P.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,V){return this.mouse&&C!=="mouse"&&(this.mouse[1]=V.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=V.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=V.invert(this.touch1[0])),this.that.__zoom=V,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var V=Ee(this.that).datum();c.call(C,this.that,new Zh(C,{sourceEvent:this.sourceEvent,target:h,type:C,transform:this.that.__zoom,dispatch:c}),V)}};function j(C,...V){if(!e.apply(this,arguments))return;var z=E(this,V).event(C),H=this.__zoom,G=Math.max(i[0],Math.min(i[1],H.k*Math.pow(2,r.apply(this,arguments)))),Y=ot(C);if(z.wheel)(z.mouse[0][0]!==Y[0]||z.mouse[0][1]!==Y[1])&&(z.mouse[1]=H.invert(z.mouse[0]=Y)),clearTimeout(z.wheel);else{if(H.k===G)return;z.mouse=[Y,H.invert(Y)],Xn(this),z.start()}an(C),z.wheel=setTimeout(I,w),z.zoom("mouse",n(S(x(H,G),z.mouse[0],z.mouse[1]),z.extent,a));function I(){z.wheel=null,z.end()}}function L(C,...V){if(y||!e.apply(this,arguments))return;var z=C.currentTarget,H=E(this,V,!0).event(C),G=Ee(C.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",T,!0),Y=ot(C,z),I=C.clientX,N=C.clientY;Pa(C.view),jr(C),H.mouse=[Y,this.__zoom.invert(Y)],Xn(this),H.start();function D(d){if(an(d),!H.moved){var b=d.clientX-I,O=d.clientY-N;H.moved=b*b+O*O>_}H.event(d).zoom("mouse",n(S(H.that.__zoom,H.mouse[0]=ot(d,z),H.mouse[1]),H.extent,a))}function T(d){G.on("mousemove.zoom mouseup.zoom",null),Na(d.view,H.moved),an(d),H.event(d).end()}}function U(C,...V){if(!!e.apply(this,arguments)){var z=this.__zoom,H=ot(C.changedTouches?C.changedTouches[0]:C,this),G=z.invert(H),Y=z.k*(C.shiftKey?.5:2),I=n(S(x(z,Y),H,G),t.apply(this,V),a);an(C),s>0?Ee(this).transition().duration(s).call(A,I,H,C):Ee(this).call(h.transform,I,H,C)}}function X(C,...V){if(!!e.apply(this,arguments)){var z=C.touches,H=z.length,G=E(this,V,C.changedTouches.length===H).event(C),Y,I,N,D;for(jr(C),I=0;I<H;++I)N=z[I],D=ot(N,this),D=[D,this.__zoom.invert(D),N.identifier],G.touch0?!G.touch1&&G.touch0[2]!==D[2]&&(G.touch1=D,G.taps=0):(G.touch0=D,Y=!0,G.taps=1+!!u);u&&(u=clearTimeout(u)),Y&&(G.taps<2&&(f=D[0],u=setTimeout(function(){u=null},m)),Xn(this),G.start())}}function Z(C,...V){if(!!this.__zooming){var z=E(this,V).event(C),H=C.changedTouches,G=H.length,Y,I,N,D;for(an(C),Y=0;Y<G;++Y)I=H[Y],N=ot(I,this),z.touch0&&z.touch0[2]===I.identifier?z.touch0[0]=N:z.touch1&&z.touch1[2]===I.identifier&&(z.touch1[0]=N);if(I=z.that.__zoom,z.touch1){var T=z.touch0[0],d=z.touch0[1],b=z.touch1[0],O=z.touch1[1],F=(F=b[0]-T[0])*F+(F=b[1]-T[1])*F,q=(q=O[0]-d[0])*q+(q=O[1]-d[1])*q;I=x(I,Math.sqrt(F/q)),N=[(T[0]+b[0])/2,(T[1]+b[1])/2],D=[(d[0]+O[0])/2,(d[1]+O[1])/2]}else if(z.touch0)N=z.touch0[0],D=z.touch0[1];else return;z.zoom("touch",n(S(I,N,D),z.extent,a))}}function ee(C,...V){if(!!this.__zooming){var z=E(this,V).event(C),H=C.changedTouches,G=H.length,Y,I;for(jr(C),y&&clearTimeout(y),y=setTimeout(function(){y=null},m),Y=0;Y<G;++Y)I=H[Y],z.touch0&&z.touch0[2]===I.identifier?delete z.touch0:z.touch1&&z.touch1[2]===I.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(I=ot(I,this),Math.hypot(f[0]-I[0],f[1]-I[1])<g)){var N=Ee(this).on("dblclick.zoom");N&&N.apply(this,arguments)}}}return h.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:Ln(+C),h):r},h.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Ln(!!C),h):e},h.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:Ln(!!C),h):o},h.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Ln([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),h):t},h.scaleExtent=function(C){return arguments.length?(i[0]=+C[0],i[1]=+C[1],h):[i[0],i[1]]},h.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],h):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},h.constrain=function(C){return arguments.length?(n=C,h):n},h.duration=function(C){return arguments.length?(s=+C,h):s},h.interpolate=function(C){return arguments.length?(l=C,h):l},h.on=function(){var C=c.on.apply(c,arguments);return C===c?h:C},h.clickDistance=function(C){return arguments.length?(_=(C=+C)*C,h):Math.sqrt(_)},h.tapDistance=function(C){return arguments.length?(g=+C,h):g},h}var tf=Object.defineProperty,nf=(e,t,n)=>t in e?tf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,de=(e,t,n)=>(nf(e,typeof t!="symbol"?t+"":t,n),n);function qa(e,t){if(!document.getElementById("PRERENDER_SVG")){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id","PRERENDER_SVG"),r.setAttribute("pointer-events","none"),r.setAttribute("width","0"),r.setAttribute("height","0"),r.setAttribute("style","opacity: 0; position: absolute; top: 0; left: 0; width: 0; height: 0;"),document.body.appendChild(r)}let n=document.getElementById("PRERENDER_SVG");n.innerHTML=e.html(),t(n.children[0]),n.innerHTML=""}function at(e){let t={x:0,y:0,width:0,height:0};return qa(e,n=>{t=n.getBBox()}),t}function Ae(e){return Ee(document.createElementNS("http://www.w3.org/2000/svg",e))}function Yn(e,t){const n=at(e),r=t/Math.max(n.width,n.height),o={x:-n.width*r/2||0,y:-n.height*r/2||0};return e.attr("transform",`translate(${o.x}, ${o.y}) scale(${r||1})`),{scale:r,translate:o}}function Ha(e){const t=Ae("g"),n=Ae("circle");return n.attr("r",e),n.attr("transform",`translate(${e}, ${e})`),t.append(()=>n.node()),t}function rf(e,t,n=0){const r=Ae("g"),o=Ae("path");return o.attr("d",`M ${0} ${-(t/2)} L ${e/2-n} ${-(t/2)} A ${n} ${n} 0 0 1 ${e/2} ${-(t/2)+n} L ${e/2} ${t/2-n} A ${n} ${n} 0 0 1 ${e/2-n} ${t/2} L ${-(e/2)+n} ${t/2} A ${n} ${n} 0 0 1 ${-(e/2)} ${t/2-n} L ${-(e/2)} ${-(t/2)+n} A ${n} ${n} 0 0 1 ${-(e/2)+n} ${-(t/2)} Z`),o.attr("transform",`translate(${e/2}, ${t/2})`),r.append(()=>o.node()),r}function of(e,t,n=0){const r=Ha(t);r.select("circle").attr("fill","none"),r.select("circle").attr("stroke","none");const o=Ae("path"),i=[];for(let a=0;a<e;a++){const s=a/e*2*Math.PI-Math.PI/2,l=Math.cos(s)*t,c=Math.sin(s)*t;i.push({x:l,y:c})}return o.attr("d",af(i,n)),o.attr("transform",`translate(${t}, ${t})`),r.append(()=>o.node()),r}function af(e,t){const n=[];e=e.slice();for(let r=0;r<e.length;r++){const o=r+1>e.length-1?(r+1)%e.length:r+1,i=r+2>e.length-1?(r+2)%e.length:r+2,a=e[r],s=e[o],l=e[i],c=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)),u=(c-t)/c,f=[((1-u)*a.x+u*s.x).toFixed(1),((1-u)*a.y+u*s.y).toFixed(1)],y=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)),m=t/y,w=[((1-m)*s.x+m*l.x).toFixed(1),((1-m)*s.y+m*l.y).toFixed(1)];r===e.length-1&&n.unshift("M"+w.join(",")),n.push("L"+f.join(",")),n.push("Q"+s.x+","+s.y+","+w.join(","))}return n.push("Z"),n.join(" ")}const sf=Object.freeze(Object.defineProperty({__proto__:null,prerender:qa,getBBox:at,create:Ae,transform:Yn,Circle:Ha,Rectangle:rf,Polygon:of},Symbol.toStringTag,{value:"Module"}));function qt(e,t,n){return{key:e,value:t,condition:n!=null?n:!0}}function lf(e,t,n,r){return{shape:e,key:t,value:n,condition:r!=null?r:!0}}function cr(e,t){t.forEach(n=>{n.key==="class"&&n.value.split(".").forEach(r=>{e.classed(r,typeof n.condition=="function"?n.condition():n.condition)}),(typeof n.condition=="function"?n.condition():n.condition)&&e.style(n.key,n.value)})}function Ua(e,t){t.forEach(n=>{n.key==="class"&&n.value.split(".").forEach(r=>{n.shape.classed(r,typeof n.condition=="function"?n.condition(e):n.condition)}),(typeof n.condition=="function"?n.condition(e):n.condition)&&n.shape.style(n.key,n.value)})}function cf(e){const t=Ae("path");return t.attr("d",e),t}function Ka(e){const t=Ae("g");return t.html(e),t}function uf(e,t=[],n=[],r=0){let o={top:0,right:0,bottom:0,left:0};return typeof e=="number"?o={top:e,right:e,bottom:e,left:e}:Array.isArray(e)&&e.length===2?o={top:e[0],right:e[1],bottom:e[0],left:e[1]}:Array.isArray(e)&&e.length===4&&(o={top:e[0],right:e[1],bottom:e[2],left:e[3]}),{padding:o,textStyles:t,backgroundStyles:n,cornerRadius:r}}function Br(e,t){const n=Ae("g").classed("tag",!0),r=n.append("text").text(e).attr("dy","0.35em").attr("text-anchor","middle");cr(r,t.textStyles);const o=at(n),i=o.width,a=o.height,s=t.padding.top,l=t.padding.right,c=t.padding.bottom,u=t.padding.left,f=t.cornerRadius,y=n.append("path").attr("d",`M ${0} ${-(a/2)-s} L ${i/2+l-f} ${-(a/2)-s} A ${f} ${f} 0 0 1 ${i/2+l} ${-(a/2)-s+f} L ${i/2+l} ${a/2+c-f} A ${f} ${f} 0 0 1 ${i/2+l-f} ${a/2+c} L ${-(i/2)-u+f} ${a/2+c} A ${f} ${f} 0 0 1 ${-(i/2)-u} ${a/2+c-f} L ${-(i/2)-u} ${-(a/2)-s+f} A ${f} ${f} 0 0 1 ${-(i/2)-u+f} ${-(a/2)-s} Z`);return cr(y,t.backgroundStyles),r.remove(),n.append(()=>r.node()),n}function Or(e,t=[]){const n=Ae("g").classed("text",!0),r=n.append("text").text(e);return cr(r,t),n.attr("text-anchor","middle"),n}function Ga(){return"break-line"}var go=(e=>(e.Left="left",e.Center="center",e.Right="right",e))(go||{});function vo(e,t,n,r,o,i,a,s="center",l=[]){return{height:e,width:t,x:n,y:r,dx:o,dy:i,rowCount:a,align:s,rowMargins:l}}function _o(e,t,n=null){const r=Ae("g").classed("collection",!0).attr("transform",`translate(${t.x}, ${t.y})`);return hf(e,t,n,r),r}function hf(e,t,n=null,r){const o=(t.height-t.dy*(t.rowCount-1))/t.rowCount;let i=0,a=[];for(let s=0;s<t.rowCount;s++){if(i>e.length-1)return;const l=t.rowMargins[s]||0,c=t.width-l*2,u=r.append("g").attr("id",`row-${s}`).attr("transform",`translate(${l}, ${(o+t.dy)*s})`);i=ff(e,t,n,u,c,i,a,s==t.rowCount-1)}}function ff(e,t,n=null,r,o,i,a,s){const l=[];let c=0,u=i;for(;c<o&&u<e.length;){const y=e[u];if(!y)break;if(typeof y=="string"){u++;break}if(typeof y=="string")break;const m=at(y).width;if(m>o){a.push(y),u++;continue}if(c+m<o)l.push(y),c+=m+t.dx,u++;else{s&&a.push(y);break}}n&&a.length>0&&(u>=e.length||s)&&(l.push(n),c+=at(n).width+t.dx),c-=t.dx;let f=0;return l.forEach(y=>{const m=at(y).width;let w=0;switch(t.align){case"left":w=f+m/2;break;case"center":w=f+m/2+(o-c)/2;break;case"right":w=f+m/2+(o-c);break}y.attr("transform",`translate(${w}, 0)`),r.append(()=>y.node()),f+=m+t.dx}),u}function wo(e,t,n=[]){const r=[];e.split(" ").forEach(i=>{i.includes(`
`)?(i.split(`
`).forEach(a=>{r.push(Or(a,n)),r.push(Ga())}),r.pop()):r.push(Or(i,n))});const o=Or("...",n);return _o(r,t,o)}function df(e,t,n){const r=[];e.forEach(i=>{const a=Br(i,n);r.push(a)});const o=Br("...",n);return _o(r,t,o)}function pf(e,t,n=[]){Array.isArray(t)?t.forEach(r=>Vi(e,r,n)):Vi(e,t,n)}function Vi(e,t,n=[]){const r=`${e.id}-${t}`,o=t/(isNaN(e.shape.scale)?1:e.shape.scale);e.forceSimulation.registerOnZoom(r,o,i=>{if(Ee("[data-id='"+e.id+"']").size()===0)return e.forceSimulation.deregisterOnZoom(r);const a=i*(isNaN(e.shape.scale)?1:e.shape.scale);Ua(a,n)})}function mf(e,t,n,...r){!t.forceSimulation||t.forceSimulation.eventStore.emit(`template:${t.shape.type}:${e}`,t,n,...r)}const Fi=Object.freeze(Object.defineProperty({__proto__:null,Shape:sf,ShapeStyle:qt,LODStyle:lf,applyStyles:cr,applyLODStyles:Ua,PathShape:cf,SVGShape:Ka,TagStyle:uf,TagShape:Br,BreakLine:Ga,Alignment:go,CollectionStyle:vo,ShapeCollection:_o,TextCollection:wo,TagCollection:df,OnZoom:pf,EmitEvent:mf},Symbol.toStringTag,{value:"Module"})),yf={shapeSize:200,shapeBuilder:gf};function gf(e){const t=Ae("g"),{icon_large:n}=vf(t);return n.classed("hidden",!0),_f(t),wf(e,t),t}function vf(e){const t=Ka(`
		<g>
			<path id="border" d="M8.373,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c39.417,-68.271 132.833,-230.073 172.249,-298.344c11.165,-19.338 31.798,-31.25 54.127,-31.25l344.498,0c22.329,-0 42.962,11.912 54.126,31.25c39.417,68.271 132.833,230.073 172.249,298.344c11.165,19.337 11.165,43.162 0,62.5c-39.416,68.271 -132.832,230.073 -172.249,298.344c-11.164,19.337 -31.797,31.25 -54.126,31.25l-344.498,-0c-22.329,-0 -42.962,-11.913 -54.127,-31.25c-39.416,-68.271 -132.832,-230.073 -172.249,-298.344Zm41.667,-0c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" style="fill:#e57373;" />
			<path id="body" d="M50.04,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" />
			<path id="icon" d="M392.598,301.417c-0,7.953 6.447,14.4 14.4,14.4c0.003,-0 0.005,-0 0.008,-0c3.817,-0 7.478,-1.516 10.177,-4.215c2.699,-2.699 4.215,-6.36 4.215,-10.177c-0,-1.135 -0,-2.281 -0,-3.416c-0,-3.817 -1.516,-7.478 -4.215,-10.177c-2.699,-2.699 -6.36,-4.215 -10.177,-4.215c-0.003,-0 -0.005,-0 -0.008,-0c-7.953,-0 -14.4,6.447 -14.4,14.4c-0,1.129 -0,2.27 -0,3.4Zm2.242,-47.423c0.2,6.587 5.597,11.823 12.187,11.823c0.003,-0 0.007,-0 0.01,-0c6.556,-0 11.93,-5.202 12.144,-11.755c0.506,-15.54 1.397,-42.915 1.944,-59.729c0.124,-3.806 -1.301,-7.499 -3.949,-10.235c-2.649,-2.736 -6.294,-4.281 -10.102,-4.281c-0.004,-0 -0.008,-0 -0.012,-0c-3.795,-0 -7.429,1.537 -10.072,4.261c-2.643,2.724 -4.07,6.403 -3.955,10.196c0.507,16.785 1.335,44.149 1.805,59.72Z" style="fill:#e57373;fill-rule:nonzero;" />
			<path id="icon_large" d="M371.559,477.859c-0,19.491 15.8,35.291 35.291,35.291c0.002,0 0.004,0 0.005,0c19.491,0 35.292,-15.8 35.292,-35.291c-0,-2.771 -0,-5.568 -0,-8.339c-0,-19.491 -15.801,-35.291 -35.292,-35.291c-0.001,-0 -0.003,-0 -0.005,-0c-19.491,-0 -35.291,15.8 -35.291,35.291c-0,2.771 -0,5.568 -0,8.339Zm5.494,-116.303c0.489,16.181 13.748,29.045 29.936,29.045l0.012,0c16.041,0 29.188,-12.726 29.71,-28.758c1.239,-38.08 3.425,-105.217 4.768,-146.446c0.303,-9.329 -3.19,-18.381 -9.681,-25.088c-6.492,-6.706 -15.426,-10.492 -24.759,-10.492c-0.003,-0 -0.005,-0 -0.007,-0c-9.309,-0 -18.22,3.77 -24.702,10.451c-6.481,6.68 -9.981,15.702 -9.699,25.006c1.243,41.116 3.268,108.114 4.422,146.282Z" style="fill:#e57373;fill-rule:nonzero;" />
		</g>
	`);return e.append(()=>t.node()),e.classed("gly_animated",!0),{border:t.select("#border"),body:t.select("#body"),icon:t.select("#icon"),icon_large:t.select("#icon_large")}}function _f(e){const t=at(e),n=wo("Template Error",vo(100,t.width,0,140,20,20,1),[qt("class","gly_text.dark"),qt("font-weight","bold"),qt("font-size","44pt")]);return e.append(()=>n.node()),n}function wf(e,t){var n;const r=at(t),o=wo((n=e==null?void 0:e.errorMessage)!=null?n:"Something went wrong while rendering the template!",vo(250,r.width,0,r.height*.6,15,20,4,go.Center,[80,130,180,230]),[qt("class","gly_text.dark"),qt("font-size","32pt")]);return t.append(()=>o.node()),o}class $f{constructor(){de(this,"_errorTemplate",yf),de(this,"_templates",{}),de(this,"failed",[]),de(this,"remoteOrigin","")}get errorTemplate(){return this._errorTemplate}get templates(){return this._templates}add(t,n){this._templates[t]=n}async get(t){var n;const r=t.shape.type;return this.templates[r]?this.templates[r]:this.failed.includes(r)?this.errorTemplate:await this.load((n=t.shape.url)!=null?n:this.remoteOrigin+r+".js",r).then(()=>{if(this.templates[r])return this.templates[r]})}async load(t,n){this.failed.includes(n)||origin!=""&&await Ks(()=>import(t),[]).then(({default:r})=>{this.add(n,r)}).catch(r=>{console.error(`Template "${n}" not founnd \u2013 Fetched from "${t}"`),console.error(r),this.failed.push(n)}).finally(()=>{})}}class xf{constructor(){de(this,"nodes",{})}clear(){this.nodes={}}add(t,n){this.nodes[t]=this.storeNode(n)}remove(t){delete this.nodes[t]}hasNode(t){return this.nodes[t]!==void 0}hasTemplateChange(t,n){const r=this.nodes[t];return r===void 0?!1:r.shape.type!==n.shape.type||r.shape.template!==n.shape.template}hasPayloadChanges(t,n){var r,o;const i=this.nodes[t];return i?JSON.stringify((r=i.payload)!=null?r:"")!==JSON.stringify((o=n.payload)!=null?o:""):!0}storeNode(t){return{shape:{type:Object.assign({},t.shape).type,template:Object.assign({},t.shape).template},payload:t.payload?this.deepCopy(t.payload):void 0}}deepCopy(t){if(t==null)return t;if(t instanceof Array){var n=[];return t.forEach(i=>{n.push(i)}),n.map(i=>this.deepCopy(i))}if(t instanceof Object){var r={...t};for(var o in t)t.hasOwnProperty(o)&&(r[o]=this.deepCopy(t[o]));return r}return t}}var ur=(e=>(e.Soft="soft",e.Hard="hard",e))(ur||{}),xe=(e=>(e.Solid="solid",e.Dashed="dashed",e.Dotted="dotted",e.Hidden="hidden",e))(xe||{}),Wn=(e=>(e.Strong="strong",e.Weak="weak",e.Loose="loose",e))(Wn||{}),bf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ef(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zr={exports:{}},Ba={},Ue={},Gt={},Pn={},re={},bn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends t{constructor(x){if(super(),!e.IDENTIFIER.test(x))throw new Error("CodeGen: name must be a valid identifier");this.str=x}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class r extends t{constructor(x){super(),this._items=typeof x=="string"?[x]:x}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const x=this._items[0];return x===""||x==='""'}get str(){var x;return(x=this._str)!==null&&x!==void 0?x:this._str=this._items.reduce((S,v)=>`${S}${v}`,"")}get names(){var x;return(x=this._names)!==null&&x!==void 0?x:this._names=this._items.reduce((S,v)=>(v instanceof n&&(S[v.str]=(S[v.str]||0)+1),S),{})}}e._Code=r,e.nil=new r("");function o(h,...x){const S=[h[0]];let v=0;for(;v<x.length;)s(S,x[v]),S.push(h[++v]);return new r(S)}e._=o;const i=new r("+");function a(h,...x){const S=[m(h[0])];let v=0;for(;v<x.length;)S.push(i),s(S,x[v]),S.push(i,m(h[++v]));return l(S),new r(S)}e.str=a;function s(h,x){x instanceof r?h.push(...x._items):x instanceof n?h.push(x):h.push(f(x))}e.addCodeArg=s;function l(h){let x=1;for(;x<h.length-1;){if(h[x]===i){const S=c(h[x-1],h[x+1]);if(S!==void 0){h.splice(x-1,3,S);continue}h[x++]="+"}x++}}function c(h,x){if(x==='""')return h;if(h==='""')return x;if(typeof h=="string")return x instanceof n||h[h.length-1]!=='"'?void 0:typeof x!="string"?`${h.slice(0,-1)}${x}"`:x[0]==='"'?h.slice(0,-1)+x.slice(1):void 0;if(typeof x=="string"&&x[0]==='"'&&!(h instanceof n))return`"${h}${x.slice(1)}`}function u(h,x){return x.emptyStr()?h:h.emptyStr()?x:a`${h}${x}`}e.strConcat=u;function f(h){return typeof h=="number"||typeof h=="boolean"||h===null?h:m(Array.isArray(h)?h.join(","):h)}function y(h){return new r(m(h))}e.stringify=y;function m(h){return JSON.stringify(h).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=m;function w(h){return typeof h=="string"&&e.IDENTIFIER.test(h)?new r(`.${h}`):o`[${h}]`}e.getProperty=w;function _(h){if(typeof h=="string"&&e.IDENTIFIER.test(h))return new r(`${h}`);throw new Error(`CodeGen: invalid export name: ${h}, use explicit $id name mapping`)}e.getEsmExportName=_;function g(h){return new r(h.toString())}e.regexpCode=g})(bn);var Jr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=bn;class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof t.Name?c:this.name(c)}name(c){return new t.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,f;if(((f=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||f===void 0?void 0:f.has(c))||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}e.Scope=o;class i extends t.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:f}){this.value=c,this.scopePath=(0,t._)`.${new t.Name(u)}[${f}]`}}e.ValueScopeName=i;const a=(0,t._)`\n`;class s extends o{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?a:t.nil}}get(){return this._scope}name(c){return new i(c,this._newName(c))}value(c,u){var f;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const y=this.toName(c),{prefix:m}=y,w=(f=u.key)!==null&&f!==void 0?f:u.ref;let _=this._values[m];if(_){const x=_.get(w);if(x)return x}else _=this._values[m]=new Map;_.set(w,y);const g=this._scope[m]||(this._scope[m]=[]),h=g.length;return g[h]=u.ref,y.setValue(u,{property:m,itemIndex:h}),y}getValue(c,u){const f=this._values[c];if(f)return f.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,f=>{if(f.scopePath===void 0)throw new Error(`CodeGen: name "${f}" has no value`);return(0,t._)`${c}${f.scopePath}`})}scopeCode(c=this._values,u,f){return this._reduceValues(c,y=>{if(y.value===void 0)throw new Error(`CodeGen: name "${y}" has no value`);return y.value.code},u,f)}_reduceValues(c,u,f={},y){let m=t.nil;for(const w in c){const _=c[w];if(!_)continue;const g=f[w]=f[w]||new Map;_.forEach(h=>{if(g.has(h))return;g.set(h,r.Started);let x=u(h);if(x){const S=this.opts.es5?e.varKinds.var:e.varKinds.const;m=(0,t._)`${m}${S} ${h} = ${x};${this.opts._n}`}else if(x=y==null?void 0:y(h))m=(0,t._)`${m}${x}${this.opts._n}`;else throw new n(h);g.set(h,r.Completed)})}return m}}e.ValueScope=s})(Jr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=bn,n=Jr;var r=bn;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var o=Jr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class i{optimizeNodes(){return this}optimizeNames(d,b){return this}}class a extends i{constructor(d,b,O){super(),this.varKind=d,this.name=b,this.rhs=O}render({es5:d,_n:b}){const O=d?n.varKinds.var:this.varKind,F=this.rhs===void 0?"":` = ${this.rhs}`;return`${O} ${this.name}${F};`+b}optimizeNames(d,b){if(d[this.name.str])return this.rhs&&(this.rhs=C(this.rhs,d,b)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class s extends i{constructor(d,b,O){super(),this.lhs=d,this.rhs=b,this.sideEffects=O}render({_n:d}){return`${this.lhs} = ${this.rhs};`+d}optimizeNames(d,b){if(!(this.lhs instanceof t.Name&&!d[this.lhs.str]&&!this.sideEffects))return this.rhs=C(this.rhs,d,b),this}get names(){const d=this.lhs instanceof t.Name?{}:{...this.lhs.names};return ee(d,this.rhs)}}class l extends s{constructor(d,b,O,F){super(d,O,F),this.op=b}render({_n:d}){return`${this.lhs} ${this.op}= ${this.rhs};`+d}}class c extends i{constructor(d){super(),this.label=d,this.names={}}render({_n:d}){return`${this.label}:`+d}}class u extends i{constructor(d){super(),this.label=d,this.names={}}render({_n:d}){return`break${this.label?` ${this.label}`:""};`+d}}class f extends i{constructor(d){super(),this.error=d}render({_n:d}){return`throw ${this.error};`+d}get names(){return this.error.names}}class y extends i{constructor(d){super(),this.code=d}render({_n:d}){return`${this.code};`+d}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(d,b){return this.code=C(this.code,d,b),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class m extends i{constructor(d=[]){super(),this.nodes=d}render(d){return this.nodes.reduce((b,O)=>b+O.render(d),"")}optimizeNodes(){const{nodes:d}=this;let b=d.length;for(;b--;){const O=d[b].optimizeNodes();Array.isArray(O)?d.splice(b,1,...O):O?d[b]=O:d.splice(b,1)}return d.length>0?this:void 0}optimizeNames(d,b){const{nodes:O}=this;let F=O.length;for(;F--;){const q=O[F];q.optimizeNames(d,b)||(V(d,q.names),O.splice(F,1))}return O.length>0?this:void 0}get names(){return this.nodes.reduce((d,b)=>Z(d,b.names),{})}}class w extends m{render(d){return"{"+d._n+super.render(d)+"}"+d._n}}class _ extends m{}class g extends w{}g.kind="else";class h extends w{constructor(d,b){super(b),this.condition=d}render(d){let b=`if(${this.condition})`+super.render(d);return this.else&&(b+="else "+this.else.render(d)),b}optimizeNodes(){super.optimizeNodes();const d=this.condition;if(d===!0)return this.nodes;let b=this.else;if(b){const O=b.optimizeNodes();b=this.else=Array.isArray(O)?new g(O):O}if(b)return d===!1?b instanceof h?b:b.nodes:this.nodes.length?this:new h(z(d),b instanceof h?[b]:b.nodes);if(!(d===!1||!this.nodes.length))return this}optimizeNames(d,b){var O;if(this.else=(O=this.else)===null||O===void 0?void 0:O.optimizeNames(d,b),!!(super.optimizeNames(d,b)||this.else))return this.condition=C(this.condition,d,b),this}get names(){const d=super.names;return ee(d,this.condition),this.else&&Z(d,this.else.names),d}}h.kind="if";class x extends w{}x.kind="for";class S extends x{constructor(d){super(),this.iteration=d}render(d){return`for(${this.iteration})`+super.render(d)}optimizeNames(d,b){if(super.optimizeNames(d,b))return this.iteration=C(this.iteration,d,b),this}get names(){return Z(super.names,this.iteration.names)}}class v extends x{constructor(d,b,O,F){super(),this.varKind=d,this.name=b,this.from=O,this.to=F}render(d){const b=d.es5?n.varKinds.var:this.varKind,{name:O,from:F,to:q}=this;return`for(${b} ${O}=${F}; ${O}<${q}; ${O}++)`+super.render(d)}get names(){const d=ee(super.names,this.from);return ee(d,this.to)}}class A extends x{constructor(d,b,O,F){super(),this.loop=d,this.varKind=b,this.name=O,this.iterable=F}render(d){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(d)}optimizeNames(d,b){if(super.optimizeNames(d,b))return this.iterable=C(this.iterable,d,b),this}get names(){return Z(super.names,this.iterable.names)}}class E extends w{constructor(d,b,O){super(),this.name=d,this.args=b,this.async=O}render(d){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(d)}}E.kind="func";class P extends m{render(d){return"return "+super.render(d)}}P.kind="return";class j extends w{render(d){let b="try"+super.render(d);return this.catch&&(b+=this.catch.render(d)),this.finally&&(b+=this.finally.render(d)),b}optimizeNodes(){var d,b;return super.optimizeNodes(),(d=this.catch)===null||d===void 0||d.optimizeNodes(),(b=this.finally)===null||b===void 0||b.optimizeNodes(),this}optimizeNames(d,b){var O,F;return super.optimizeNames(d,b),(O=this.catch)===null||O===void 0||O.optimizeNames(d,b),(F=this.finally)===null||F===void 0||F.optimizeNames(d,b),this}get names(){const d=super.names;return this.catch&&Z(d,this.catch.names),this.finally&&Z(d,this.finally.names),d}}class L extends w{constructor(d){super(),this.error=d}render(d){return`catch(${this.error})`+super.render(d)}}L.kind="catch";class U extends w{render(d){return"finally"+super.render(d)}}U.kind="finally";class X{constructor(d,b={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...b,_n:b.lines?`
`:""},this._extScope=d,this._scope=new n.Scope({parent:d}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(d){return this._scope.name(d)}scopeName(d){return this._extScope.name(d)}scopeValue(d,b){const O=this._extScope.value(d,b);return(this._values[O.prefix]||(this._values[O.prefix]=new Set)).add(O),O}getScopeValue(d,b){return this._extScope.getValue(d,b)}scopeRefs(d){return this._extScope.scopeRefs(d,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(d,b,O,F){const q=this._scope.toName(b);return O!==void 0&&F&&(this._constants[q.str]=O),this._leafNode(new a(d,q,O)),q}const(d,b,O){return this._def(n.varKinds.const,d,b,O)}let(d,b,O){return this._def(n.varKinds.let,d,b,O)}var(d,b,O){return this._def(n.varKinds.var,d,b,O)}assign(d,b,O){return this._leafNode(new s(d,b,O))}add(d,b){return this._leafNode(new l(d,e.operators.ADD,b))}code(d){return typeof d=="function"?d():d!==t.nil&&this._leafNode(new y(d)),this}object(...d){const b=["{"];for(const[O,F]of d)b.length>1&&b.push(","),b.push(O),(O!==F||this.opts.es5)&&(b.push(":"),(0,t.addCodeArg)(b,F));return b.push("}"),new t._Code(b)}if(d,b,O){if(this._blockNode(new h(d)),b&&O)this.code(b).else().code(O).endIf();else if(b)this.code(b).endIf();else if(O)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(d){return this._elseNode(new h(d))}else(){return this._elseNode(new g)}endIf(){return this._endBlockNode(h,g)}_for(d,b){return this._blockNode(d),b&&this.code(b).endFor(),this}for(d,b){return this._for(new S(d),b)}forRange(d,b,O,F,q=this.opts.es5?n.varKinds.var:n.varKinds.let){const te=this._scope.toName(d);return this._for(new v(q,te,b,O),()=>F(te))}forOf(d,b,O,F=n.varKinds.const){const q=this._scope.toName(d);if(this.opts.es5){const te=b instanceof t.Name?b:this.var("_arr",b);return this.forRange("_i",0,(0,t._)`${te}.length`,oe=>{this.var(q,(0,t._)`${te}[${oe}]`),O(q)})}return this._for(new A("of",F,q,b),()=>O(q))}forIn(d,b,O,F=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(d,(0,t._)`Object.keys(${b})`,O);const q=this._scope.toName(d);return this._for(new A("in",F,q,b),()=>O(q))}endFor(){return this._endBlockNode(x)}label(d){return this._leafNode(new c(d))}break(d){return this._leafNode(new u(d))}return(d){const b=new P;if(this._blockNode(b),this.code(d),b.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(P)}try(d,b,O){if(!b&&!O)throw new Error('CodeGen: "try" without "catch" and "finally"');const F=new j;if(this._blockNode(F),this.code(d),b){const q=this.name("e");this._currNode=F.catch=new L(q),b(q)}return O&&(this._currNode=F.finally=new U,this.code(O)),this._endBlockNode(L,U)}throw(d){return this._leafNode(new f(d))}block(d,b){return this._blockStarts.push(this._nodes.length),d&&this.code(d).endBlock(b),this}endBlock(d){const b=this._blockStarts.pop();if(b===void 0)throw new Error("CodeGen: not in self-balancing block");const O=this._nodes.length-b;if(O<0||d!==void 0&&O!==d)throw new Error(`CodeGen: wrong number of nodes: ${O} vs ${d} expected`);return this._nodes.length=b,this}func(d,b=t.nil,O,F){return this._blockNode(new E(d,b,O)),F&&this.code(F).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(d=1){for(;d-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(d){return this._currNode.nodes.push(d),this}_blockNode(d){this._currNode.nodes.push(d),this._nodes.push(d)}_endBlockNode(d,b){const O=this._currNode;if(O instanceof d||b&&O instanceof b)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${b?`${d.kind}/${b.kind}`:d.kind}"`)}_elseNode(d){const b=this._currNode;if(!(b instanceof h))throw new Error('CodeGen: "else" without "if"');return this._currNode=b.else=d,this}get _root(){return this._nodes[0]}get _currNode(){const d=this._nodes;return d[d.length-1]}set _currNode(d){const b=this._nodes;b[b.length-1]=d}}e.CodeGen=X;function Z(T,d){for(const b in d)T[b]=(T[b]||0)+(d[b]||0);return T}function ee(T,d){return d instanceof t._CodeOrName?Z(T,d.names):T}function C(T,d,b){if(T instanceof t.Name)return O(T);if(!F(T))return T;return new t._Code(T._items.reduce((q,te)=>(te instanceof t.Name&&(te=O(te)),te instanceof t._Code?q.push(...te._items):q.push(te),q),[]));function O(q){const te=b[q.str];return te===void 0||d[q.str]!==1?q:(delete d[q.str],te)}function F(q){return q instanceof t._Code&&q._items.some(te=>te instanceof t.Name&&d[te.str]===1&&b[te.str]!==void 0)}}function V(T,d){for(const b in d)T[b]=(T[b]||0)-(d[b]||0)}function z(T){return typeof T=="boolean"||typeof T=="number"||T===null?!T:(0,t._)`!${D(T)}`}e.not=z;const H=N(e.operators.AND);function G(...T){return T.reduce(H)}e.and=G;const Y=N(e.operators.OR);function I(...T){return T.reduce(Y)}e.or=I;function N(T){return(d,b)=>d===t.nil?b:b===t.nil?d:(0,t._)`${D(d)} ${T} ${D(b)}`}function D(T){return T instanceof t.Name?T:(0,t._)`(${T})`}})(re);var ae={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=re,n=bn;function r(E){const P={};for(const j of E)P[j]=!0;return P}e.toHash=r;function o(E,P){return typeof P=="boolean"?P:Object.keys(P).length===0?!0:(i(E,P),!a(P,E.self.RULES.all))}e.alwaysValidSchema=o;function i(E,P=E.schema){const{opts:j,self:L}=E;if(!j.strictSchema||typeof P=="boolean")return;const U=L.RULES.keywords;for(const X in P)U[X]||A(E,`unknown keyword: "${X}"`)}e.checkUnknownRules=i;function a(E,P){if(typeof E=="boolean")return!E;for(const j in E)if(P[j])return!0;return!1}e.schemaHasRules=a;function s(E,P){if(typeof E=="boolean")return!E;for(const j in E)if(j!=="$ref"&&P.all[j])return!0;return!1}e.schemaHasRulesButRef=s;function l({topSchemaRef:E,schemaPath:P},j,L,U){if(!U){if(typeof j=="number"||typeof j=="boolean")return j;if(typeof j=="string")return(0,t._)`${j}`}return(0,t._)`${E}${P}${(0,t.getProperty)(L)}`}e.schemaRefOrVal=l;function c(E){return y(decodeURIComponent(E))}e.unescapeFragment=c;function u(E){return encodeURIComponent(f(E))}e.escapeFragment=u;function f(E){return typeof E=="number"?`${E}`:E.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=f;function y(E){return E.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=y;function m(E,P){if(Array.isArray(E))for(const j of E)P(j);else P(E)}e.eachItem=m;function w({mergeNames:E,mergeToName:P,mergeValues:j,resultToName:L}){return(U,X,Z,ee)=>{const C=Z===void 0?X:Z instanceof t.Name?(X instanceof t.Name?E(U,X,Z):P(U,X,Z),Z):X instanceof t.Name?(P(U,Z,X),X):j(X,Z);return ee===t.Name&&!(C instanceof t.Name)?L(U,C):C}}e.mergeEvaluated={props:w({mergeNames:(E,P,j)=>E.if((0,t._)`${j} !== true && ${P} !== undefined`,()=>{E.if((0,t._)`${P} === true`,()=>E.assign(j,!0),()=>E.assign(j,(0,t._)`${j} || {}`).code((0,t._)`Object.assign(${j}, ${P})`))}),mergeToName:(E,P,j)=>E.if((0,t._)`${j} !== true`,()=>{P===!0?E.assign(j,!0):(E.assign(j,(0,t._)`${j} || {}`),g(E,j,P))}),mergeValues:(E,P)=>E===!0?!0:{...E,...P},resultToName:_}),items:w({mergeNames:(E,P,j)=>E.if((0,t._)`${j} !== true && ${P} !== undefined`,()=>E.assign(j,(0,t._)`${P} === true ? true : ${j} > ${P} ? ${j} : ${P}`)),mergeToName:(E,P,j)=>E.if((0,t._)`${j} !== true`,()=>E.assign(j,P===!0?!0:(0,t._)`${j} > ${P} ? ${j} : ${P}`)),mergeValues:(E,P)=>E===!0?!0:Math.max(E,P),resultToName:(E,P)=>E.var("items",P)})};function _(E,P){if(P===!0)return E.var("props",!0);const j=E.var("props",(0,t._)`{}`);return P!==void 0&&g(E,j,P),j}e.evaluatedPropsToName=_;function g(E,P,j){Object.keys(j).forEach(L=>E.assign((0,t._)`${P}${(0,t.getProperty)(L)}`,!0))}e.setEvaluated=g;const h={};function x(E,P){return E.scopeValue("func",{ref:P,code:h[P.code]||(h[P.code]=new n._Code(P.code))})}e.useFunc=x;var S;(function(E){E[E.Num=0]="Num",E[E.Str=1]="Str"})(S=e.Type||(e.Type={}));function v(E,P,j){if(E instanceof t.Name){const L=P===S.Num;return j?L?(0,t._)`"[" + ${E} + "]"`:(0,t._)`"['" + ${E} + "']"`:L?(0,t._)`"/" + ${E}`:(0,t._)`"/" + ${E}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return j?(0,t.getProperty)(E).toString():"/"+f(E)}e.getErrorPath=v;function A(E,P,j=E.opts.strictSchema){if(j){if(P=`strict mode: ${P}`,j===!0)throw new Error(P);E.self.logger.warn(P)}}e.checkStrictMode=A})(ae);var et={};Object.defineProperty(et,"__esModule",{value:!0});const $e=re,kf={data:new $e.Name("data"),valCxt:new $e.Name("valCxt"),instancePath:new $e.Name("instancePath"),parentData:new $e.Name("parentData"),parentDataProperty:new $e.Name("parentDataProperty"),rootData:new $e.Name("rootData"),dynamicAnchors:new $e.Name("dynamicAnchors"),vErrors:new $e.Name("vErrors"),errors:new $e.Name("errors"),this:new $e.Name("this"),self:new $e.Name("self"),scope:new $e.Name("scope"),json:new $e.Name("json"),jsonPos:new $e.Name("jsonPos"),jsonLen:new $e.Name("jsonLen"),jsonPart:new $e.Name("jsonPart")};et.default=kf;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=re,n=ae,r=et;e.keywordError={message:({keyword:g})=>(0,t.str)`must pass "${g}" keyword validation`},e.keyword$DataError={message:({keyword:g,schemaType:h})=>h?(0,t.str)`"${g}" keyword must be ${h} ($data)`:(0,t.str)`"${g}" keyword is invalid ($data)`};function o(g,h=e.keywordError,x,S){const{it:v}=g,{gen:A,compositeRule:E,allErrors:P}=v,j=f(g,h,x);(S!=null?S:E||P)?l(A,j):c(v,(0,t._)`[${j}]`)}e.reportError=o;function i(g,h=e.keywordError,x){const{it:S}=g,{gen:v,compositeRule:A,allErrors:E}=S,P=f(g,h,x);l(v,P),A||E||c(S,r.default.vErrors)}e.reportExtraError=i;function a(g,h){g.assign(r.default.errors,h),g.if((0,t._)`${r.default.vErrors} !== null`,()=>g.if(h,()=>g.assign((0,t._)`${r.default.vErrors}.length`,h),()=>g.assign(r.default.vErrors,null)))}e.resetErrorsCount=a;function s({gen:g,keyword:h,schemaValue:x,data:S,errsCount:v,it:A}){if(v===void 0)throw new Error("ajv implementation error");const E=g.name("err");g.forRange("i",v,r.default.errors,P=>{g.const(E,(0,t._)`${r.default.vErrors}[${P}]`),g.if((0,t._)`${E}.instancePath === undefined`,()=>g.assign((0,t._)`${E}.instancePath`,(0,t.strConcat)(r.default.instancePath,A.errorPath))),g.assign((0,t._)`${E}.schemaPath`,(0,t.str)`${A.errSchemaPath}/${h}`),A.opts.verbose&&(g.assign((0,t._)`${E}.schema`,x),g.assign((0,t._)`${E}.data`,S))})}e.extendErrors=s;function l(g,h){const x=g.const("err",h);g.if((0,t._)`${r.default.vErrors} === null`,()=>g.assign(r.default.vErrors,(0,t._)`[${x}]`),(0,t._)`${r.default.vErrors}.push(${x})`),g.code((0,t._)`${r.default.errors}++`)}function c(g,h){const{gen:x,validateName:S,schemaEnv:v}=g;v.$async?x.throw((0,t._)`new ${g.ValidationError}(${h})`):(x.assign((0,t._)`${S}.errors`,h),x.return(!1))}const u={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function f(g,h,x){const{createErrors:S}=g.it;return S===!1?(0,t._)`{}`:y(g,h,x)}function y(g,h,x={}){const{gen:S,it:v}=g,A=[m(v,x),w(g,x)];return _(g,h,A),S.object(...A)}function m({errorPath:g},{instancePath:h}){const x=h?(0,t.str)`${g}${(0,n.getErrorPath)(h,n.Type.Str)}`:g;return[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,x)]}function w({keyword:g,it:{errSchemaPath:h}},{schemaPath:x,parentSchema:S}){let v=S?h:(0,t.str)`${h}/${g}`;return x&&(v=(0,t.str)`${v}${(0,n.getErrorPath)(x,n.Type.Str)}`),[u.schemaPath,v]}function _(g,{params:h,message:x},S){const{keyword:v,data:A,schemaValue:E,it:P}=g,{opts:j,propertyName:L,topSchemaRef:U,schemaPath:X}=P;S.push([u.keyword,v],[u.params,typeof h=="function"?h(g):h||(0,t._)`{}`]),j.messages&&S.push([u.message,typeof x=="function"?x(g):x]),j.verbose&&S.push([u.schema,E],[u.parentSchema,(0,t._)`${U}${X}`],[r.default.data,A]),L&&S.push([u.propertyName,L])}})(Pn);Object.defineProperty(Gt,"__esModule",{value:!0});Gt.boolOrEmptySchema=Gt.topBoolOrEmptySchema=void 0;const Sf=Pn,Pf=re,Nf=et,Cf={message:"boolean schema is false"};function Tf(e){const{gen:t,schema:n,validateName:r}=e;n===!1?Za(e,!1):typeof n=="object"&&n.$async===!0?t.return(Nf.default.data):(t.assign((0,Pf._)`${r}.errors`,null),t.return(!0))}Gt.topBoolOrEmptySchema=Tf;function Af(e,t){const{gen:n,schema:r}=e;r===!1?(n.var(t,!1),Za(e)):n.var(t,!0)}Gt.boolOrEmptySchema=Af;function Za(e,t){const{gen:n,data:r}=e,o={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,Sf.reportError)(o,Cf,void 0,t)}var Nn={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.getRules=Pt.isJSONType=void 0;const jf=["string","number","integer","boolean","null","object","array"],Of=new Set(jf);function Mf(e){return typeof e=="string"&&Of.has(e)}Pt.isJSONType=Mf;function Rf(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}Pt.getRules=Rf;var st={};Object.defineProperty(st,"__esModule",{value:!0});st.shouldUseRule=st.shouldUseGroup=st.schemaHasRulesForType=void 0;function Df({schema:e,self:t},n){const r=t.RULES.types[n];return r&&r!==!0&&Ja(e,r)}st.schemaHasRulesForType=Df;function Ja(e,t){return t.rules.some(n=>Xa(e,n))}st.shouldUseGroup=Ja;function Xa(e,t){var n;return e[t.keyword]!==void 0||((n=t.definition.implements)===null||n===void 0?void 0:n.some(r=>e[r]!==void 0))}st.shouldUseRule=Xa;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Pt,n=st,r=Pn,o=re,i=ae;var a;(function(S){S[S.Correct=0]="Correct",S[S.Wrong=1]="Wrong"})(a=e.DataType||(e.DataType={}));function s(S){const v=l(S.type);if(v.includes("null")){if(S.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!v.length&&S.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');S.nullable===!0&&v.push("null")}return v}e.getSchemaTypes=s;function l(S){const v=Array.isArray(S)?S:S?[S]:[];if(v.every(t.isJSONType))return v;throw new Error("type must be JSONType or JSONType[]: "+v.join(","))}e.getJSONTypes=l;function c(S,v){const{gen:A,data:E,opts:P}=S,j=f(v,P.coerceTypes),L=v.length>0&&!(j.length===0&&v.length===1&&(0,n.schemaHasRulesForType)(S,v[0]));if(L){const U=_(v,E,P.strictNumbers,a.Wrong);A.if(U,()=>{j.length?y(S,v,j):h(S)})}return L}e.coerceAndCheckDataType=c;const u=new Set(["string","number","integer","boolean","null"]);function f(S,v){return v?S.filter(A=>u.has(A)||v==="array"&&A==="array"):[]}function y(S,v,A){const{gen:E,data:P,opts:j}=S,L=E.let("dataType",(0,o._)`typeof ${P}`),U=E.let("coerced",(0,o._)`undefined`);j.coerceTypes==="array"&&E.if((0,o._)`${L} == 'object' && Array.isArray(${P}) && ${P}.length == 1`,()=>E.assign(P,(0,o._)`${P}[0]`).assign(L,(0,o._)`typeof ${P}`).if(_(v,P,j.strictNumbers),()=>E.assign(U,P))),E.if((0,o._)`${U} !== undefined`);for(const Z of A)(u.has(Z)||Z==="array"&&j.coerceTypes==="array")&&X(Z);E.else(),h(S),E.endIf(),E.if((0,o._)`${U} !== undefined`,()=>{E.assign(P,U),m(S,U)});function X(Z){switch(Z){case"string":E.elseIf((0,o._)`${L} == "number" || ${L} == "boolean"`).assign(U,(0,o._)`"" + ${P}`).elseIf((0,o._)`${P} === null`).assign(U,(0,o._)`""`);return;case"number":E.elseIf((0,o._)`${L} == "boolean" || ${P} === null
	              || (${L} == "string" && ${P} && ${P} == +${P})`).assign(U,(0,o._)`+${P}`);return;case"integer":E.elseIf((0,o._)`${L} === "boolean" || ${P} === null
	              || (${L} === "string" && ${P} && ${P} == +${P} && !(${P} % 1))`).assign(U,(0,o._)`+${P}`);return;case"boolean":E.elseIf((0,o._)`${P} === "false" || ${P} === 0 || ${P} === null`).assign(U,!1).elseIf((0,o._)`${P} === "true" || ${P} === 1`).assign(U,!0);return;case"null":E.elseIf((0,o._)`${P} === "" || ${P} === 0 || ${P} === false`),E.assign(U,null);return;case"array":E.elseIf((0,o._)`${L} === "string" || ${L} === "number"
	              || ${L} === "boolean" || ${P} === null`).assign(U,(0,o._)`[${P}]`)}}}function m({gen:S,parentData:v,parentDataProperty:A},E){S.if((0,o._)`${v} !== undefined`,()=>S.assign((0,o._)`${v}[${A}]`,E))}function w(S,v,A,E=a.Correct){const P=E===a.Correct?o.operators.EQ:o.operators.NEQ;let j;switch(S){case"null":return(0,o._)`${v} ${P} null`;case"array":j=(0,o._)`Array.isArray(${v})`;break;case"object":j=(0,o._)`${v} && typeof ${v} == "object" && !Array.isArray(${v})`;break;case"integer":j=L((0,o._)`!(${v} % 1) && !isNaN(${v})`);break;case"number":j=L();break;default:return(0,o._)`typeof ${v} ${P} ${S}`}return E===a.Correct?j:(0,o.not)(j);function L(U=o.nil){return(0,o.and)((0,o._)`typeof ${v} == "number"`,U,A?(0,o._)`isFinite(${v})`:o.nil)}}e.checkDataType=w;function _(S,v,A,E){if(S.length===1)return w(S[0],v,A,E);let P;const j=(0,i.toHash)(S);if(j.array&&j.object){const L=(0,o._)`typeof ${v} != "object"`;P=j.null?L:(0,o._)`!${v} || ${L}`,delete j.null,delete j.array,delete j.object}else P=o.nil;j.number&&delete j.integer;for(const L in j)P=(0,o.and)(P,w(L,v,A,E));return P}e.checkDataTypes=_;const g={message:({schema:S})=>`must be ${S}`,params:({schema:S,schemaValue:v})=>typeof S=="string"?(0,o._)`{type: ${S}}`:(0,o._)`{type: ${v}}`};function h(S){const v=x(S);(0,r.reportError)(v,g)}e.reportTypeError=h;function x(S){const{gen:v,data:A,schema:E}=S,P=(0,i.schemaRefOrVal)(S,E,"type");return{gen:v,keyword:"type",data:A,schema:E.type,schemaCode:P,schemaValue:P,parentSchema:E,params:{},it:S}}})(Nn);var br={};Object.defineProperty(br,"__esModule",{value:!0});br.assignDefaults=void 0;const Dt=re,If=ae;function zf(e,t){const{properties:n,items:r}=e.schema;if(t==="object"&&n)for(const o in n)Li(e,o,n[o].default);else t==="array"&&Array.isArray(r)&&r.forEach((o,i)=>Li(e,i,o.default))}br.assignDefaults=zf;function Li(e,t,n){const{gen:r,compositeRule:o,data:i,opts:a}=e;if(n===void 0)return;const s=(0,Dt._)`${i}${(0,Dt.getProperty)(t)}`;if(o){(0,If.checkStrictMode)(e,`default is ignored for: ${s}`);return}let l=(0,Dt._)`${s} === undefined`;a.useDefaults==="empty"&&(l=(0,Dt._)`${l} || ${s} === null || ${s} === ""`),r.if(l,(0,Dt._)`${s} = ${(0,Dt.stringify)(n)}`)}var Ye={},ne={};Object.defineProperty(ne,"__esModule",{value:!0});ne.validateUnion=ne.validateArray=ne.usePattern=ne.callValidateCode=ne.schemaProperties=ne.allSchemaProperties=ne.noPropertyInData=ne.propertyInData=ne.isOwnProperty=ne.hasPropFunc=ne.reportMissingProp=ne.checkMissingProp=ne.checkReportMissingProp=void 0;const fe=re,$o=ae,ut=et,Vf=ae;function Ff(e,t){const{gen:n,data:r,it:o}=e;n.if(bo(n,r,t,o.opts.ownProperties),()=>{e.setParams({missingProperty:(0,fe._)`${t}`},!0),e.error()})}ne.checkReportMissingProp=Ff;function Lf({gen:e,data:t,it:{opts:n}},r,o){return(0,fe.or)(...r.map(i=>(0,fe.and)(bo(e,t,i,n.ownProperties),(0,fe._)`${o} = ${i}`)))}ne.checkMissingProp=Lf;function qf(e,t){e.setParams({missingProperty:t},!0),e.error()}ne.reportMissingProp=qf;function Ya(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,fe._)`Object.prototype.hasOwnProperty`})}ne.hasPropFunc=Ya;function xo(e,t,n){return(0,fe._)`${Ya(e)}.call(${t}, ${n})`}ne.isOwnProperty=xo;function Hf(e,t,n,r){const o=(0,fe._)`${t}${(0,fe.getProperty)(n)} !== undefined`;return r?(0,fe._)`${o} && ${xo(e,t,n)}`:o}ne.propertyInData=Hf;function bo(e,t,n,r){const o=(0,fe._)`${t}${(0,fe.getProperty)(n)} === undefined`;return r?(0,fe.or)(o,(0,fe.not)(xo(e,t,n))):o}ne.noPropertyInData=bo;function Wa(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}ne.allSchemaProperties=Wa;function Uf(e,t){return Wa(t).filter(n=>!(0,$o.alwaysValidSchema)(e,t[n]))}ne.schemaProperties=Uf;function Kf({schemaCode:e,data:t,it:{gen:n,topSchemaRef:r,schemaPath:o,errorPath:i},it:a},s,l,c){const u=c?(0,fe._)`${e}, ${t}, ${r}${o}`:t,f=[[ut.default.instancePath,(0,fe.strConcat)(ut.default.instancePath,i)],[ut.default.parentData,a.parentData],[ut.default.parentDataProperty,a.parentDataProperty],[ut.default.rootData,ut.default.rootData]];a.opts.dynamicRef&&f.push([ut.default.dynamicAnchors,ut.default.dynamicAnchors]);const y=(0,fe._)`${u}, ${n.object(...f)}`;return l!==fe.nil?(0,fe._)`${s}.call(${l}, ${y})`:(0,fe._)`${s}(${y})`}ne.callValidateCode=Kf;const Gf=(0,fe._)`new RegExp`;function Bf({gen:e,it:{opts:t}},n){const r=t.unicodeRegExp?"u":"",{regExp:o}=t.code,i=o(n,r);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,fe._)`${o.code==="new RegExp"?Gf:(0,Vf.useFunc)(e,o)}(${n}, ${r})`})}ne.usePattern=Bf;function Zf(e){const{gen:t,data:n,keyword:r,it:o}=e,i=t.name("valid");if(o.allErrors){const s=t.let("valid",!0);return a(()=>t.assign(s,!1)),s}return t.var(i,!0),a(()=>t.break()),i;function a(s){const l=t.const("len",(0,fe._)`${n}.length`);t.forRange("i",0,l,c=>{e.subschema({keyword:r,dataProp:c,dataPropType:$o.Type.Num},i),t.if((0,fe.not)(i),s)})}}ne.validateArray=Zf;function Jf(e){const{gen:t,schema:n,keyword:r,it:o}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(s=>(0,$o.alwaysValidSchema)(o,s))&&!o.opts.unevaluated)return;const i=t.let("valid",!1),a=t.name("_valid");t.block(()=>n.forEach((s,l)=>{const c=e.subschema({keyword:r,schemaProp:l,compositeRule:!0},a);t.assign(i,(0,fe._)`${i} || ${a}`),e.mergeValidEvaluated(c,a)||t.if((0,fe.not)(i))})),e.result(i,()=>e.reset(),()=>e.error(!0))}ne.validateUnion=Jf;Object.defineProperty(Ye,"__esModule",{value:!0});Ye.validateKeywordUsage=Ye.validSchemaType=Ye.funcKeywordCode=Ye.macroKeywordCode=void 0;const be=re,$t=et,Xf=ne,Yf=Pn;function Wf(e,t){const{gen:n,keyword:r,schema:o,parentSchema:i,it:a}=e,s=t.macro.call(a.self,o,i,a),l=Qa(n,r,s);a.opts.validateSchema!==!1&&a.self.validateSchema(s,!0);const c=n.name("valid");e.subschema({schema:s,schemaPath:be.nil,errSchemaPath:`${a.errSchemaPath}/${r}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}Ye.macroKeywordCode=Wf;function Qf(e,t){var n;const{gen:r,keyword:o,schema:i,parentSchema:a,$data:s,it:l}=e;td(l,t);const c=!s&&t.compile?t.compile.call(l.self,i,a,l):t.validate,u=Qa(r,o,c),f=r.let("valid");e.block$data(f,y),e.ok((n=t.valid)!==null&&n!==void 0?n:f);function y(){if(t.errors===!1)_(),t.modifying&&qi(e),g(()=>e.error());else{const h=t.async?m():w();t.modifying&&qi(e),g(()=>ed(e,h))}}function m(){const h=r.let("ruleErrs",null);return r.try(()=>_((0,be._)`await `),x=>r.assign(f,!1).if((0,be._)`${x} instanceof ${l.ValidationError}`,()=>r.assign(h,(0,be._)`${x}.errors`),()=>r.throw(x))),h}function w(){const h=(0,be._)`${u}.errors`;return r.assign(h,null),_(be.nil),h}function _(h=t.async?(0,be._)`await `:be.nil){const x=l.opts.passContext?$t.default.this:$t.default.self,S=!("compile"in t&&!s||t.schema===!1);r.assign(f,(0,be._)`${h}${(0,Xf.callValidateCode)(e,u,x,S)}`,t.modifying)}function g(h){var x;r.if((0,be.not)((x=t.valid)!==null&&x!==void 0?x:f),h)}}Ye.funcKeywordCode=Qf;function qi(e){const{gen:t,data:n,it:r}=e;t.if(r.parentData,()=>t.assign(n,(0,be._)`${r.parentData}[${r.parentDataProperty}]`))}function ed(e,t){const{gen:n}=e;n.if((0,be._)`Array.isArray(${t})`,()=>{n.assign($t.default.vErrors,(0,be._)`${$t.default.vErrors} === null ? ${t} : ${$t.default.vErrors}.concat(${t})`).assign($t.default.errors,(0,be._)`${$t.default.vErrors}.length`),(0,Yf.extendErrors)(e)},()=>e.error())}function td({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function Qa(e,t,n){if(n===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,be.stringify)(n)})}function nd(e,t,n=!1){return!t.length||t.some(r=>r==="array"?Array.isArray(e):r==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==r||n&&typeof e>"u")}Ye.validSchemaType=nd;function rd({schema:e,opts:t,self:n,errSchemaPath:r},o,i){if(Array.isArray(o.keyword)?!o.keyword.includes(i):o.keyword!==i)throw new Error("ajv implementation error");const a=o.dependencies;if(a!=null&&a.some(s=>!Object.prototype.hasOwnProperty.call(e,s)))throw new Error(`parent schema must have dependencies of ${i}: ${a.join(",")}`);if(o.validateSchema&&!o.validateSchema(e[i])){const s=`keyword "${i}" value is invalid at path "${r}": `+n.errorsText(o.validateSchema.errors);if(t.validateSchema==="log")n.logger.error(s);else throw new Error(s)}}Ye.validateKeywordUsage=rd;var pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.extendSubschemaMode=pt.extendSubschemaData=pt.getSubschema=void 0;const Xe=re,es=ae;function od(e,{keyword:t,schemaProp:n,schema:r,schemaPath:o,errSchemaPath:i,topSchemaRef:a}){if(t!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const s=e.schema[t];return n===void 0?{schema:s,schemaPath:(0,Xe._)`${e.schemaPath}${(0,Xe.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:s[n],schemaPath:(0,Xe._)`${e.schemaPath}${(0,Xe.getProperty)(t)}${(0,Xe.getProperty)(n)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,es.escapeFragment)(n)}`}}if(r!==void 0){if(o===void 0||i===void 0||a===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:o,topSchemaRef:a,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}pt.getSubschema=od;function id(e,t,{dataProp:n,dataPropType:r,data:o,dataTypes:i,propertyName:a}){if(o!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:s}=t;if(n!==void 0){const{errorPath:c,dataPathArr:u,opts:f}=t,y=s.let("data",(0,Xe._)`${t.data}${(0,Xe.getProperty)(n)}`,!0);l(y),e.errorPath=(0,Xe.str)`${c}${(0,es.getErrorPath)(n,r,f.jsPropertySyntax)}`,e.parentDataProperty=(0,Xe._)`${n}`,e.dataPathArr=[...u,e.parentDataProperty]}if(o!==void 0){const c=o instanceof Xe.Name?o:s.let("data",o,!0);l(c),a!==void 0&&(e.propertyName=a)}i&&(e.dataTypes=i);function l(c){e.data=c,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,c]}}pt.extendSubschemaData=id;function ad(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:r,createErrors:o,allErrors:i}){r!==void 0&&(e.compositeRule=r),o!==void 0&&(e.createErrors=o),i!==void 0&&(e.allErrors=i),e.jtdDiscriminator=t,e.jtdMetadata=n}pt.extendSubschemaMode=ad;var we={},ts=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(o=r;o--!==0;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;o--!==0;){var a=i[o];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},ns={exports:{}},dt=ns.exports=function(e,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var r=typeof n=="function"?n:n.pre||function(){},o=n.post||function(){};Qn(t,r,o,e,"",e)};dt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};dt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};dt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};dt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Qn(e,t,n,r,o,i,a,s,l,c){if(r&&typeof r=="object"&&!Array.isArray(r)){t(r,o,i,a,s,l,c);for(var u in r){var f=r[u];if(Array.isArray(f)){if(u in dt.arrayKeywords)for(var y=0;y<f.length;y++)Qn(e,t,n,f[y],o+"/"+u+"/"+y,i,o,u,r,y)}else if(u in dt.propsKeywords){if(f&&typeof f=="object")for(var m in f)Qn(e,t,n,f[m],o+"/"+u+"/"+sd(m),i,o,u,r,m)}else(u in dt.keywords||e.allKeys&&!(u in dt.skipKeywords))&&Qn(e,t,n,f,o+"/"+u,i,o,u,r)}n(r,o,i,a,s,l,c)}}function sd(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(we,"__esModule",{value:!0});we.getSchemaRefs=we.resolveUrl=we.normalizeId=we._getFullPath=we.getFullPath=we.inlineRef=void 0;const ld=ae,cd=ts,ud=ns.exports,hd=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function fd(e,t=!0){return typeof e=="boolean"?!0:t===!0?!Xr(e):t?rs(e)<=t:!1}we.inlineRef=fd;const dd=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Xr(e){for(const t in e){if(dd.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(Xr)||typeof n=="object"&&Xr(n))return!0}return!1}function rs(e){let t=0;for(const n in e)if(n==="$ref"||(t++,!hd.has(n)&&(typeof e[n]=="object"&&(0,ld.eachItem)(e[n],r=>t+=rs(r)),t===1/0)))return 1/0;return t}function os(e,t="",n){n!==!1&&(t=Ht(t));const r=e.parse(t);return is(e,r)}we.getFullPath=os;function is(e,t){return e.serialize(t).split("#")[0]+"#"}we._getFullPath=is;const pd=/#\/?$/;function Ht(e){return e?e.replace(pd,""):""}we.normalizeId=Ht;function md(e,t,n){return n=Ht(n),e.resolve(t,n)}we.resolveUrl=md;const yd=/^[a-z_][-a-z0-9._]*$/i;function gd(e,t){if(typeof e=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,o=Ht(e[n]||t),i={"":o},a=os(r,o,!1),s={},l=new Set;return ud(e,{allKeys:!0},(f,y,m,w)=>{if(w===void 0)return;const _=a+y;let g=i[w];typeof f[n]=="string"&&(g=h.call(this,f[n])),x.call(this,f.$anchor),x.call(this,f.$dynamicAnchor),i[y]=g;function h(S){const v=this.opts.uriResolver.resolve;if(S=Ht(g?v(g,S):S),l.has(S))throw u(S);l.add(S);let A=this.refs[S];return typeof A=="string"&&(A=this.refs[A]),typeof A=="object"?c(f,A.schema,S):S!==Ht(_)&&(S[0]==="#"?(c(f,s[S],S),s[S]=f):this.refs[S]=_),S}function x(S){if(typeof S=="string"){if(!yd.test(S))throw new Error(`invalid anchor "${S}"`);h.call(this,`#${S}`)}}}),s;function c(f,y,m){if(y!==void 0&&!cd(f,y))throw u(m)}function u(f){return new Error(`reference "${f}" resolves to more than one schema`)}}we.getSchemaRefs=gd;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getData=Ue.KeywordCxt=Ue.validateFunctionCode=void 0;const as=Gt,Hi=Nn,Eo=st,hr=Nn,vd=br,dn=Ye,Mr=pt,K=re,W=et,_d=we,lt=ae,sn=Pn;function wd(e){if(cs(e)&&(us(e),ls(e))){bd(e);return}ss(e,()=>(0,as.topBoolOrEmptySchema)(e))}Ue.validateFunctionCode=wd;function ss({gen:e,validateName:t,schema:n,schemaEnv:r,opts:o},i){o.code.es5?e.func(t,(0,K._)`${W.default.data}, ${W.default.valCxt}`,r.$async,()=>{e.code((0,K._)`"use strict"; ${Ui(n,o)}`),xd(e,o),e.code(i)}):e.func(t,(0,K._)`${W.default.data}, ${$d(o)}`,r.$async,()=>e.code(Ui(n,o)).code(i))}function $d(e){return(0,K._)`{${W.default.instancePath}="", ${W.default.parentData}, ${W.default.parentDataProperty}, ${W.default.rootData}=${W.default.data}${e.dynamicRef?(0,K._)`, ${W.default.dynamicAnchors}={}`:K.nil}}={}`}function xd(e,t){e.if(W.default.valCxt,()=>{e.var(W.default.instancePath,(0,K._)`${W.default.valCxt}.${W.default.instancePath}`),e.var(W.default.parentData,(0,K._)`${W.default.valCxt}.${W.default.parentData}`),e.var(W.default.parentDataProperty,(0,K._)`${W.default.valCxt}.${W.default.parentDataProperty}`),e.var(W.default.rootData,(0,K._)`${W.default.valCxt}.${W.default.rootData}`),t.dynamicRef&&e.var(W.default.dynamicAnchors,(0,K._)`${W.default.valCxt}.${W.default.dynamicAnchors}`)},()=>{e.var(W.default.instancePath,(0,K._)`""`),e.var(W.default.parentData,(0,K._)`undefined`),e.var(W.default.parentDataProperty,(0,K._)`undefined`),e.var(W.default.rootData,W.default.data),t.dynamicRef&&e.var(W.default.dynamicAnchors,(0,K._)`{}`)})}function bd(e){const{schema:t,opts:n,gen:r}=e;ss(e,()=>{n.$comment&&t.$comment&&fs(e),Nd(e),r.let(W.default.vErrors,null),r.let(W.default.errors,0),n.unevaluated&&Ed(e),hs(e),Ad(e)})}function Ed(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,K._)`${n}.evaluated`),t.if((0,K._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,K._)`${e.evaluated}.props`,(0,K._)`undefined`)),t.if((0,K._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,K._)`${e.evaluated}.items`,(0,K._)`undefined`))}function Ui(e,t){const n=typeof e=="object"&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,K._)`/*# sourceURL=${n} */`:K.nil}function kd(e,t){if(cs(e)&&(us(e),ls(e))){Sd(e,t);return}(0,as.boolOrEmptySchema)(e,t)}function ls({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const n in e)if(t.RULES.all[n])return!0;return!1}function cs(e){return typeof e.schema!="boolean"}function Sd(e,t){const{schema:n,gen:r,opts:o}=e;o.$comment&&n.$comment&&fs(e),Cd(e),Td(e);const i=r.const("_errs",W.default.errors);hs(e,i),r.var(t,(0,K._)`${i} === ${W.default.errors}`)}function us(e){(0,lt.checkUnknownRules)(e),Pd(e)}function hs(e,t){if(e.opts.jtd)return Ki(e,[],!1,t);const n=(0,Hi.getSchemaTypes)(e.schema),r=(0,Hi.coerceAndCheckDataType)(e,n);Ki(e,n,!r,t)}function Pd(e){const{schema:t,errSchemaPath:n,opts:r,self:o}=e;t.$ref&&r.ignoreKeywordsWithRef&&(0,lt.schemaHasRulesButRef)(t,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function Nd(e){const{schema:t,opts:n}=e;t.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,lt.checkStrictMode)(e,"default is ignored in the schema root")}function Cd(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,_d.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function Td(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function fs({gen:e,schemaEnv:t,schema:n,errSchemaPath:r,opts:o}){const i=n.$comment;if(o.$comment===!0)e.code((0,K._)`${W.default.self}.logger.log(${i})`);else if(typeof o.$comment=="function"){const a=(0,K.str)`${r}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code((0,K._)`${W.default.self}.opts.$comment(${i}, ${a}, ${s}.schema)`)}}function Ad(e){const{gen:t,schemaEnv:n,validateName:r,ValidationError:o,opts:i}=e;n.$async?t.if((0,K._)`${W.default.errors} === 0`,()=>t.return(W.default.data),()=>t.throw((0,K._)`new ${o}(${W.default.vErrors})`)):(t.assign((0,K._)`${r}.errors`,W.default.vErrors),i.unevaluated&&jd(e),t.return((0,K._)`${W.default.errors} === 0`))}function jd({gen:e,evaluated:t,props:n,items:r}){n instanceof K.Name&&e.assign((0,K._)`${t}.props`,n),r instanceof K.Name&&e.assign((0,K._)`${t}.items`,r)}function Ki(e,t,n,r){const{gen:o,schema:i,data:a,allErrors:s,opts:l,self:c}=e,{RULES:u}=c;if(i.$ref&&(l.ignoreKeywordsWithRef||!(0,lt.schemaHasRulesButRef)(i,u))){o.block(()=>ps(e,"$ref",u.all.$ref.definition));return}l.jtd||Od(e,t),o.block(()=>{for(const y of u.rules)f(y);f(u.post)});function f(y){!(0,Eo.shouldUseGroup)(i,y)||(y.type?(o.if((0,hr.checkDataType)(y.type,a,l.strictNumbers)),Gi(e,y),t.length===1&&t[0]===y.type&&n&&(o.else(),(0,hr.reportTypeError)(e)),o.endIf()):Gi(e,y),s||o.if((0,K._)`${W.default.errors} === ${r||0}`))}}function Gi(e,t){const{gen:n,schema:r,opts:{useDefaults:o}}=e;o&&(0,vd.assignDefaults)(e,t.type),n.block(()=>{for(const i of t.rules)(0,Eo.shouldUseRule)(r,i)&&ps(e,i.keyword,i.definition,t.type)})}function Od(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(Md(e,t),e.opts.allowUnionTypes||Rd(e,t),Dd(e,e.dataTypes))}function Md(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(n=>{Bi(e.dataTypes,n)||ko(e,`type "${n}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(n=>Bi(t,n))}}function Rd(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&ko(e,"use allowUnionTypes to allow union type keyword")}function Dd(e,t){const n=e.self.RULES.all;for(const r in n){const o=n[r];if(typeof o=="object"&&(0,Eo.shouldUseRule)(e.schema,o)){const{type:i}=o.definition;i.length&&!i.some(a=>Id(t,a))&&ko(e,`missing type "${i.join(",")}" for keyword "${r}"`)}}}function Id(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function Bi(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function ko(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,lt.checkStrictMode)(e,t,e.opts.strictTypes)}class ds{constructor(t,n,r){if((0,dn.validateKeywordUsage)(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,lt.schemaRefOrVal)(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",ms(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,dn.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=t.gen.const("_errs",W.default.errors))}result(t,n,r){this.failResult((0,K.not)(t),n,r)}failResult(t,n,r){this.gen.if(t),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,n){this.failResult((0,K.not)(t),void 0,n)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:n}=this;this.fail((0,K._)`${n} !== undefined && (${(0,K.or)(this.invalid$data(),t)})`)}error(t,n,r){if(n){this.setParams(n),this._error(t,r),this.setParams({});return}this._error(t,r)}_error(t,n){(t?sn.reportExtraError:sn.reportError)(this,this.def.error,n)}$dataError(){(0,sn.reportError)(this,this.def.$dataError||sn.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,sn.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,n){n?Object.assign(this.params,t):this.params=t}block$data(t,n,r=K.nil){this.gen.block(()=>{this.check$data(t,r),n()})}check$data(t=K.nil,n=K.nil){if(!this.$data)return;const{gen:r,schemaCode:o,schemaType:i,def:a}=this;r.if((0,K.or)((0,K._)`${o} === undefined`,n)),t!==K.nil&&r.assign(t,!0),(i.length||a.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),t!==K.nil&&r.assign(t,!1)),r.else()}invalid$data(){const{gen:t,schemaCode:n,schemaType:r,def:o,it:i}=this;return(0,K.or)(a(),s());function a(){if(r.length){if(!(n instanceof K.Name))throw new Error("ajv implementation error");const l=Array.isArray(r)?r:[r];return(0,K._)`${(0,hr.checkDataTypes)(l,n,i.opts.strictNumbers,hr.DataType.Wrong)}`}return K.nil}function s(){if(o.validateSchema){const l=t.scopeValue("validate$data",{ref:o.validateSchema});return(0,K._)`!${l}(${n})`}return K.nil}}subschema(t,n){const r=(0,Mr.getSubschema)(this.it,t);(0,Mr.extendSubschemaData)(r,this.it,t),(0,Mr.extendSubschemaMode)(r,t);const o={...this.it,...r,items:void 0,props:void 0};return kd(o,n),o}mergeEvaluated(t,n){const{it:r,gen:o}=this;!r.opts.unevaluated||(r.props!==!0&&t.props!==void 0&&(r.props=lt.mergeEvaluated.props(o,t.props,r.props,n)),r.items!==!0&&t.items!==void 0&&(r.items=lt.mergeEvaluated.items(o,t.items,r.items,n)))}mergeValidEvaluated(t,n){const{it:r,gen:o}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return o.if(n,()=>this.mergeEvaluated(t,K.Name)),!0}}Ue.KeywordCxt=ds;function ps(e,t,n,r){const o=new ds(e,n,t);"code"in n?n.code(o,r):o.$data&&n.validate?(0,dn.funcKeywordCode)(o,n):"macro"in n?(0,dn.macroKeywordCode)(o,n):(n.compile||n.validate)&&(0,dn.funcKeywordCode)(o,n)}const zd=/^\/(?:[^~]|~0|~1)*$/,Vd=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ms(e,{dataLevel:t,dataNames:n,dataPathArr:r}){let o,i;if(e==="")return W.default.rootData;if(e[0]==="/"){if(!zd.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);o=e,i=W.default.rootData}else{const c=Vd.exec(e);if(!c)throw new Error(`Invalid JSON-pointer: ${e}`);const u=+c[1];if(o=c[2],o==="#"){if(u>=t)throw new Error(l("property/index",u));return r[t-u]}if(u>t)throw new Error(l("data",u));if(i=n[t-u],!o)return i}let a=i;const s=o.split("/");for(const c of s)c&&(i=(0,K._)`${i}${(0,K.getProperty)((0,lt.unescapeJsonPointer)(c))}`,a=(0,K._)`${a} && ${i}`);return a;function l(c,u){return`Cannot access ${c} ${u} levels up, current level is ${t}`}}Ue.getData=ms;var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});class Fd extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}Cn.default=Fd;var Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});const Rr=we;class Ld extends Error{constructor(t,n,r,o){super(o||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,Rr.resolveUrl)(t,n,r),this.missingSchema=(0,Rr.normalizeId)((0,Rr.getFullPath)(t,this.missingRef))}}Tn.default=Ld;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.resolveSchema=Ce.getCompilingSchema=Ce.resolveRef=Ce.compileSchema=Ce.SchemaEnv=void 0;const Fe=re,qd=Cn,wt=et,He=we,Zi=ae,Hd=Ue;class Er{constructor(t){var n;this.refs={},this.dynamicAnchors={};let r;typeof t.schema=="object"&&(r=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(n=t.baseId)!==null&&n!==void 0?n:(0,He.normalizeId)(r==null?void 0:r[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}Ce.SchemaEnv=Er;function So(e){const t=ys.call(this,e);if(t)return t;const n=(0,He.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:r,lines:o}=this.opts.code,{ownProperties:i}=this.opts,a=new Fe.CodeGen(this.scope,{es5:r,lines:o,ownProperties:i});let s;e.$async&&(s=a.scopeValue("Error",{ref:qd.default,code:(0,Fe._)`require("ajv/dist/runtime/validation_error").default`}));const l=a.scopeName("validate");e.validateName=l;const c={gen:a,allErrors:this.opts.allErrors,data:wt.default.data,parentData:wt.default.parentData,parentDataProperty:wt.default.parentDataProperty,dataNames:[wt.default.data],dataPathArr:[Fe.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:a.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Fe.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:s,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:Fe.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Fe._)`""`,opts:this.opts,self:this};let u;try{this._compilations.add(e),(0,Hd.validateFunctionCode)(c),a.optimize(this.opts.code.optimize);const f=a.toString();u=`${a.scopeRefs(wt.default.scope)}return ${f}`,this.opts.code.process&&(u=this.opts.code.process(u,e));const y=new Function(`${wt.default.self}`,`${wt.default.scope}`,u)(this,this.scope.get());if(this.scope.value(l,{ref:y}),y.errors=null,y.schema=e.schema,y.schemaEnv=e,e.$async&&(y.$async=!0),this.opts.code.source===!0&&(y.source={validateName:l,validateCode:f,scopeValues:a._values}),this.opts.unevaluated){const{props:m,items:w}=c;y.evaluated={props:m instanceof Fe.Name?void 0:m,items:w instanceof Fe.Name?void 0:w,dynamicProps:m instanceof Fe.Name,dynamicItems:w instanceof Fe.Name},y.source&&(y.source.evaluated=(0,Fe.stringify)(y.evaluated))}return e.validate=y,e}catch(f){throw delete e.validate,delete e.validateName,u&&this.logger.error("Error compiling schema, function code:",u),f}finally{this._compilations.delete(e)}}Ce.compileSchema=So;function Ud(e,t,n){var r;n=(0,He.resolveUrl)(this.opts.uriResolver,t,n);const o=e.refs[n];if(o)return o;let i=Bd.call(this,e,n);if(i===void 0){const a=(r=e.localRefs)===null||r===void 0?void 0:r[n],{schemaId:s}=this.opts;a&&(i=new Er({schema:a,schemaId:s,root:e,baseId:t}))}if(i!==void 0)return e.refs[n]=Kd.call(this,i)}Ce.resolveRef=Ud;function Kd(e){return(0,He.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:So.call(this,e)}function ys(e){for(const t of this._compilations)if(Gd(t,e))return t}Ce.getCompilingSchema=ys;function Gd(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Bd(e,t){let n;for(;typeof(n=this.refs[t])=="string";)t=n;return n||this.schemas[t]||kr.call(this,e,t)}function kr(e,t){const n=this.opts.uriResolver.parse(t),r=(0,He._getFullPath)(this.opts.uriResolver,n);let o=(0,He.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===o)return Dr.call(this,n,e);const i=(0,He.normalizeId)(r),a=this.refs[i]||this.schemas[i];if(typeof a=="string"){const s=kr.call(this,e,a);return typeof(s==null?void 0:s.schema)!="object"?void 0:Dr.call(this,n,s)}if(typeof(a==null?void 0:a.schema)=="object"){if(a.validate||So.call(this,a),i===(0,He.normalizeId)(t)){const{schema:s}=a,{schemaId:l}=this.opts,c=s[l];return c&&(o=(0,He.resolveUrl)(this.opts.uriResolver,o,c)),new Er({schema:s,schemaId:l,root:e,baseId:o})}return Dr.call(this,n,a)}}Ce.resolveSchema=kr;const Zd=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Dr(e,{baseId:t,schema:n,root:r}){var o;if(((o=e.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(const s of e.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const l=n[(0,Zi.unescapeFragment)(s)];if(l===void 0)return;n=l;const c=typeof n=="object"&&n[this.opts.schemaId];!Zd.has(s)&&c&&(t=(0,He.resolveUrl)(this.opts.uriResolver,t,c))}let i;if(typeof n!="boolean"&&n.$ref&&!(0,Zi.schemaHasRulesButRef)(n,this.RULES)){const s=(0,He.resolveUrl)(this.opts.uriResolver,t,n.$ref);i=kr.call(this,r,s)}const{schemaId:a}=this.opts;if(i=i||new Er({schema:n,schemaId:a,root:r,baseId:t}),i.schema!==i.root.schema)return i}const Jd="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Xd="Meta-schema for $data reference (JSON AnySchema extension proposal)",Yd="object",Wd=["$data"],Qd={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},ep=!1,tp={$id:Jd,description:Xd,type:Yd,required:Wd,properties:Qd,additionalProperties:ep};var Po={},Yr={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(n,r){r(t)})(bf,function(n){function r(){for(var p=arguments.length,$=Array(p),k=0;k<p;k++)$[k]=arguments[k];if($.length>1){$[0]=$[0].slice(0,-1);for(var M=$.length-1,R=1;R<M;++R)$[R]=$[R].slice(1,-1);return $[M]=$[M].slice(1),$.join("")}else return $[0]}function o(p){return"(?:"+p+")"}function i(p){return p===void 0?"undefined":p===null?"null":Object.prototype.toString.call(p).split(" ").pop().split("]").shift().toLowerCase()}function a(p){return p.toUpperCase()}function s(p){return p!=null?p instanceof Array?p:typeof p.length!="number"||p.split||p.setInterval||p.call?[p]:Array.prototype.slice.call(p):[]}function l(p,$){var k=p;if($)for(var M in $)k[M]=$[M];return k}function c(p){var $="[A-Za-z]",k="[0-9]",M=r(k,"[A-Fa-f]"),R=o(o("%[EFef]"+M+"%"+M+M+"%"+M+M)+"|"+o("%[89A-Fa-f]"+M+"%"+M+M)+"|"+o("%"+M+M)),J="[\\:\\/\\?\\#\\[\\]\\@]",B="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",se=r(J,B),ge=p?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",le=p?"[\\uE000-\\uF8FF]":"[]",ie=r($,k,"[\\-\\.\\_\\~]",ge);o($+r($,k,"[\\+\\-\\.]")+"*"),o(o(R+"|"+r(ie,B,"[\\:]"))+"*");var ue=o(o("25[0-5]")+"|"+o("2[0-4]"+k)+"|"+o("1"+k+k)+"|"+o("0?[1-9]"+k)+"|0?0?"+k),me=o(ue+"\\."+ue+"\\."+ue+"\\."+ue),Q=o(M+"{1,4}"),ve=o(o(Q+"\\:"+Q)+"|"+me),ce=o(o(Q+"\\:")+"{6}"+ve),De=o("\\:\\:"+o(Q+"\\:")+"{5}"+ve),Rt=o(o(Q)+"?\\:\\:"+o(Q+"\\:")+"{4}"+ve),Ve=o(o(o(Q+"\\:")+"{0,1}"+Q)+"?\\:\\:"+o(Q+"\\:")+"{3}"+ve),tt=o(o(o(Q+"\\:")+"{0,2}"+Q)+"?\\:\\:"+o(Q+"\\:")+"{2}"+ve),gt=o(o(o(Q+"\\:")+"{0,3}"+Q)+"?\\:\\:"+Q+"\\:"+ve),vt=o(o(o(Q+"\\:")+"{0,4}"+Q)+"?\\:\\:"+ve),Ie=o(o(o(Q+"\\:")+"{0,5}"+Q)+"?\\:\\:"+Q),nt=o(o(o(Q+"\\:")+"{0,6}"+Q)+"?\\:\\:"),_t=o([ce,De,Rt,Ve,tt,gt,vt,Ie,nt].join("|")),Je=o(o(ie+"|"+R)+"+");o("[vV]"+M+"+\\."+r(ie,B,"[\\:]")+"+"),o(o(R+"|"+r(ie,B))+"*");var On=o(R+"|"+r(ie,B,"[\\:\\@]"));return o(o(R+"|"+r(ie,B,"[\\@]"))+"+"),o(o(On+"|"+r("[\\/\\?]",le))+"*"),{NOT_SCHEME:new RegExp(r("[^]",$,k,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",ie,B),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",ie,B),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",ie,B),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",ie,B),"g"),NOT_QUERY:new RegExp(r("[^\\%]",ie,B,"[\\:\\@\\/\\?]",le),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",ie,B,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",ie,B),"g"),UNRESERVED:new RegExp(ie,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",ie,se),"g"),PCT_ENCODED:new RegExp(R,"g"),IPV4ADDRESS:new RegExp("^("+me+")$"),IPV6ADDRESS:new RegExp("^\\[?("+_t+")"+o(o("\\%25|\\%(?!"+M+"{2})")+"("+Je+")")+"?\\]?$")}}var u=c(!1),f=c(!0),y=function(){function p($,k){var M=[],R=!0,J=!1,B=void 0;try{for(var se=$[Symbol.iterator](),ge;!(R=(ge=se.next()).done)&&(M.push(ge.value),!(k&&M.length===k));R=!0);}catch(le){J=!0,B=le}finally{try{!R&&se.return&&se.return()}finally{if(J)throw B}}return M}return function($,k){if(Array.isArray($))return $;if(Symbol.iterator in Object($))return p($,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(p){if(Array.isArray(p)){for(var $=0,k=Array(p.length);$<p.length;$++)k[$]=p[$];return k}else return Array.from(p)},w=2147483647,_=36,g=1,h=26,x=38,S=700,v=72,A=128,E="-",P=/^xn--/,j=/[^\0-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},X=_-g,Z=Math.floor,ee=String.fromCharCode;function C(p){throw new RangeError(U[p])}function V(p,$){for(var k=[],M=p.length;M--;)k[M]=$(p[M]);return k}function z(p,$){var k=p.split("@"),M="";k.length>1&&(M=k[0]+"@",p=k[1]),p=p.replace(L,".");var R=p.split("."),J=V(R,$).join(".");return M+J}function H(p){for(var $=[],k=0,M=p.length;k<M;){var R=p.charCodeAt(k++);if(R>=55296&&R<=56319&&k<M){var J=p.charCodeAt(k++);(J&64512)==56320?$.push(((R&1023)<<10)+(J&1023)+65536):($.push(R),k--)}else $.push(R)}return $}var G=function(p){return String.fromCodePoint.apply(String,m(p))},Y=function(p){return p-48<10?p-22:p-65<26?p-65:p-97<26?p-97:_},I=function(p,$){return p+22+75*(p<26)-(($!=0)<<5)},N=function(p,$,k){var M=0;for(p=k?Z(p/S):p>>1,p+=Z(p/$);p>X*h>>1;M+=_)p=Z(p/X);return Z(M+(X+1)*p/(p+x))},D=function(p){var $=[],k=p.length,M=0,R=A,J=v,B=p.lastIndexOf(E);B<0&&(B=0);for(var se=0;se<B;++se)p.charCodeAt(se)>=128&&C("not-basic"),$.push(p.charCodeAt(se));for(var ge=B>0?B+1:0;ge<k;){for(var le=M,ie=1,ue=_;;ue+=_){ge>=k&&C("invalid-input");var me=Y(p.charCodeAt(ge++));(me>=_||me>Z((w-M)/ie))&&C("overflow"),M+=me*ie;var Q=ue<=J?g:ue>=J+h?h:ue-J;if(me<Q)break;var ve=_-Q;ie>Z(w/ve)&&C("overflow"),ie*=ve}var ce=$.length+1;J=N(M-le,ce,le==0),Z(M/ce)>w-R&&C("overflow"),R+=Z(M/ce),M%=ce,$.splice(M++,0,R)}return String.fromCodePoint.apply(String,$)},T=function(p){var $=[];p=H(p);var k=p.length,M=A,R=0,J=v,B=!0,se=!1,ge=void 0;try{for(var le=p[Symbol.iterator](),ie;!(B=(ie=le.next()).done);B=!0){var ue=ie.value;ue<128&&$.push(ee(ue))}}catch(rn){se=!0,ge=rn}finally{try{!B&&le.return&&le.return()}finally{if(se)throw ge}}var me=$.length,Q=me;for(me&&$.push(E);Q<k;){var ve=w,ce=!0,De=!1,Rt=void 0;try{for(var Ve=p[Symbol.iterator](),tt;!(ce=(tt=Ve.next()).done);ce=!0){var gt=tt.value;gt>=M&&gt<ve&&(ve=gt)}}catch(rn){De=!0,Rt=rn}finally{try{!ce&&Ve.return&&Ve.return()}finally{if(De)throw Rt}}var vt=Q+1;ve-M>Z((w-R)/vt)&&C("overflow"),R+=(ve-M)*vt,M=ve;var Ie=!0,nt=!1,_t=void 0;try{for(var Je=p[Symbol.iterator](),On;!(Ie=(On=Je.next()).done);Ie=!0){var pi=On.value;if(pi<M&&++R>w&&C("overflow"),pi==M){for(var Mn=R,Rn=_;;Rn+=_){var Dn=Rn<=J?g:Rn>=J+h?h:Rn-J;if(Mn<Dn)break;var mi=Mn-Dn,yi=_-Dn;$.push(ee(I(Dn+mi%yi,0))),Mn=Z(mi/yi)}$.push(ee(I(Mn,0))),J=N(R,vt,Q==me),R=0,++Q}}}catch(rn){nt=!0,_t=rn}finally{try{!Ie&&Je.return&&Je.return()}finally{if(nt)throw _t}}++R,++M}return $.join("")},d=function(p){return z(p,function($){return P.test($)?D($.slice(4).toLowerCase()):$})},b=function(p){return z(p,function($){return j.test($)?"xn--"+T($):$})},O={version:"2.1.0",ucs2:{decode:H,encode:G},decode:D,encode:T,toASCII:b,toUnicode:d},F={};function q(p){var $=p.charCodeAt(0),k=void 0;return $<16?k="%0"+$.toString(16).toUpperCase():$<128?k="%"+$.toString(16).toUpperCase():$<2048?k="%"+($>>6|192).toString(16).toUpperCase()+"%"+($&63|128).toString(16).toUpperCase():k="%"+($>>12|224).toString(16).toUpperCase()+"%"+($>>6&63|128).toString(16).toUpperCase()+"%"+($&63|128).toString(16).toUpperCase(),k}function te(p){for(var $="",k=0,M=p.length;k<M;){var R=parseInt(p.substr(k+1,2),16);if(R<128)$+=String.fromCharCode(R),k+=3;else if(R>=194&&R<224){if(M-k>=6){var J=parseInt(p.substr(k+4,2),16);$+=String.fromCharCode((R&31)<<6|J&63)}else $+=p.substr(k,6);k+=6}else if(R>=224){if(M-k>=9){var B=parseInt(p.substr(k+4,2),16),se=parseInt(p.substr(k+7,2),16);$+=String.fromCharCode((R&15)<<12|(B&63)<<6|se&63)}else $+=p.substr(k,9);k+=9}else $+=p.substr(k,3),k+=3}return $}function oe(p,$){function k(M){var R=te(M);return R.match($.UNRESERVED)?R:M}return p.scheme&&(p.scheme=String(p.scheme).replace($.PCT_ENCODED,k).toLowerCase().replace($.NOT_SCHEME,"")),p.userinfo!==void 0&&(p.userinfo=String(p.userinfo).replace($.PCT_ENCODED,k).replace($.NOT_USERINFO,q).replace($.PCT_ENCODED,a)),p.host!==void 0&&(p.host=String(p.host).replace($.PCT_ENCODED,k).toLowerCase().replace($.NOT_HOST,q).replace($.PCT_ENCODED,a)),p.path!==void 0&&(p.path=String(p.path).replace($.PCT_ENCODED,k).replace(p.scheme?$.NOT_PATH:$.NOT_PATH_NOSCHEME,q).replace($.PCT_ENCODED,a)),p.query!==void 0&&(p.query=String(p.query).replace($.PCT_ENCODED,k).replace($.NOT_QUERY,q).replace($.PCT_ENCODED,a)),p.fragment!==void 0&&(p.fragment=String(p.fragment).replace($.PCT_ENCODED,k).replace($.NOT_FRAGMENT,q).replace($.PCT_ENCODED,a)),p}function pe(p){return p.replace(/^0*(.*)/,"$1")||"0"}function Ge(p,$){var k=p.match($.IPV4ADDRESS)||[],M=y(k,2),R=M[1];return R?R.split(".").map(pe).join("."):p}function Ct(p,$){var k=p.match($.IPV6ADDRESS)||[],M=y(k,3),R=M[1],J=M[2];if(R){for(var B=R.toLowerCase().split("::").reverse(),se=y(B,2),ge=se[0],le=se[1],ie=le?le.split(":").map(pe):[],ue=ge.split(":").map(pe),me=$.IPV4ADDRESS.test(ue[ue.length-1]),Q=me?7:8,ve=ue.length-Q,ce=Array(Q),De=0;De<Q;++De)ce[De]=ie[De]||ue[ve+De]||"";me&&(ce[Q-1]=Ge(ce[Q-1],$));var Rt=ce.reduce(function(Ie,nt,_t){if(!nt||nt==="0"){var Je=Ie[Ie.length-1];Je&&Je.index+Je.length===_t?Je.length++:Ie.push({index:_t,length:1})}return Ie},[]),Ve=Rt.sort(function(Ie,nt){return nt.length-Ie.length})[0],tt=void 0;if(Ve&&Ve.length>1){var gt=ce.slice(0,Ve.index),vt=ce.slice(Ve.index+Ve.length);tt=gt.join(":")+"::"+vt.join(":")}else tt=ce.join(":");return J&&(tt+="%"+J),tt}else return p}var Xt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Yt="".match(/(){0}/)[1]===void 0;function je(p){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k={},M=$.iri!==!1?f:u;$.reference==="suffix"&&(p=($.scheme?$.scheme+":":"")+"//"+p);var R=p.match(Xt);if(R){Yt?(k.scheme=R[1],k.userinfo=R[3],k.host=R[4],k.port=parseInt(R[5],10),k.path=R[6]||"",k.query=R[7],k.fragment=R[8],isNaN(k.port)&&(k.port=R[5])):(k.scheme=R[1]||void 0,k.userinfo=p.indexOf("@")!==-1?R[3]:void 0,k.host=p.indexOf("//")!==-1?R[4]:void 0,k.port=parseInt(R[5],10),k.path=R[6]||"",k.query=p.indexOf("?")!==-1?R[7]:void 0,k.fragment=p.indexOf("#")!==-1?R[8]:void 0,isNaN(k.port)&&(k.port=p.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?R[4]:void 0)),k.host&&(k.host=Ct(Ge(k.host,M),M)),k.scheme===void 0&&k.userinfo===void 0&&k.host===void 0&&k.port===void 0&&!k.path&&k.query===void 0?k.reference="same-document":k.scheme===void 0?k.reference="relative":k.fragment===void 0?k.reference="absolute":k.reference="uri",$.reference&&$.reference!=="suffix"&&$.reference!==k.reference&&(k.error=k.error||"URI is not a "+$.reference+" reference.");var J=F[($.scheme||k.scheme||"").toLowerCase()];if(!$.unicodeSupport&&(!J||!J.unicodeSupport)){if(k.host&&($.domainHost||J&&J.domainHost))try{k.host=O.toASCII(k.host.replace(M.PCT_ENCODED,te).toLowerCase())}catch(B){k.error=k.error||"Host's domain name can not be converted to ASCII via punycode: "+B}oe(k,u)}else oe(k,M);J&&J.parse&&J.parse(k,$)}else k.error=k.error||"URI can not be parsed.";return k}function Wt(p,$){var k=$.iri!==!1?f:u,M=[];return p.userinfo!==void 0&&(M.push(p.userinfo),M.push("@")),p.host!==void 0&&M.push(Ct(Ge(String(p.host),k),k).replace(k.IPV6ADDRESS,function(R,J,B){return"["+J+(B?"%25"+B:"")+"]"})),(typeof p.port=="number"||typeof p.port=="string")&&(M.push(":"),M.push(String(p.port))),M.length?M.join(""):void 0}var Tt=/^\.\.?\//,At=/^\/\.(\/|$)/,jt=/^\/\.\.(\/|$)/,Qt=/^\/?(?:.|\n)*?(?=\/|$)/;function Be(p){for(var $=[];p.length;)if(p.match(Tt))p=p.replace(Tt,"");else if(p.match(At))p=p.replace(At,"/");else if(p.match(jt))p=p.replace(jt,"/"),$.pop();else if(p==="."||p==="..")p="";else{var k=p.match(Qt);if(k){var M=k[0];p=p.slice(M.length),$.push(M)}else throw new Error("Unexpected dot segment condition")}return $.join("")}function Pe(p){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=$.iri?f:u,M=[],R=F[($.scheme||p.scheme||"").toLowerCase()];if(R&&R.serialize&&R.serialize(p,$),p.host&&!k.IPV6ADDRESS.test(p.host)&&($.domainHost||R&&R.domainHost))try{p.host=$.iri?O.toUnicode(p.host):O.toASCII(p.host.replace(k.PCT_ENCODED,te).toLowerCase())}catch(se){p.error=p.error||"Host's domain name can not be converted to "+($.iri?"Unicode":"ASCII")+" via punycode: "+se}oe(p,k),$.reference!=="suffix"&&p.scheme&&(M.push(p.scheme),M.push(":"));var J=Wt(p,$);if(J!==void 0&&($.reference!=="suffix"&&M.push("//"),M.push(J),p.path&&p.path.charAt(0)!=="/"&&M.push("/")),p.path!==void 0){var B=p.path;!$.absolutePath&&(!R||!R.absolutePath)&&(B=Be(B)),J===void 0&&(B=B.replace(/^\/\//,"/%2F")),M.push(B)}return p.query!==void 0&&(M.push("?"),M.push(p.query)),p.fragment!==void 0&&(M.push("#"),M.push(p.fragment)),M.join("")}function Ot(p,$){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},M=arguments[3],R={};return M||(p=je(Pe(p,k),k),$=je(Pe($,k),k)),k=k||{},!k.tolerant&&$.scheme?(R.scheme=$.scheme,R.userinfo=$.userinfo,R.host=$.host,R.port=$.port,R.path=Be($.path||""),R.query=$.query):($.userinfo!==void 0||$.host!==void 0||$.port!==void 0?(R.userinfo=$.userinfo,R.host=$.host,R.port=$.port,R.path=Be($.path||""),R.query=$.query):($.path?($.path.charAt(0)==="/"?R.path=Be($.path):((p.userinfo!==void 0||p.host!==void 0||p.port!==void 0)&&!p.path?R.path="/"+$.path:p.path?R.path=p.path.slice(0,p.path.lastIndexOf("/")+1)+$.path:R.path=$.path,R.path=Be(R.path)),R.query=$.query):(R.path=p.path,$.query!==void 0?R.query=$.query:R.query=p.query),R.userinfo=p.userinfo,R.host=p.host,R.port=p.port),R.scheme=p.scheme),R.fragment=$.fragment,R}function en(p,$,k){var M=l({scheme:"null"},k);return Pe(Ot(je(p,M),je($,M),M,!0),M)}function mt(p,$){return typeof p=="string"?p=Pe(je(p,$),$):i(p)==="object"&&(p=je(Pe(p,$),$)),p}function tn(p,$,k){return typeof p=="string"?p=Pe(je(p,k),k):i(p)==="object"&&(p=Pe(p,k)),typeof $=="string"?$=Pe(je($,k),k):i($)==="object"&&($=Pe($,k)),p===$}function jn(p,$){return p&&p.toString().replace(!$||!$.iri?u.ESCAPE:f.ESCAPE,q)}function Re(p,$){return p&&p.toString().replace(!$||!$.iri?u.PCT_ENCODED:f.PCT_ENCODED,te)}var yt={scheme:"http",domainHost:!0,parse:function(p,$){return p.host||(p.error=p.error||"HTTP URIs must have a host."),p},serialize:function(p,$){var k=String(p.scheme).toLowerCase()==="https";return(p.port===(k?443:80)||p.port==="")&&(p.port=void 0),p.path||(p.path="/"),p}},ai={scheme:"https",domainHost:yt.domainHost,parse:yt.parse,serialize:yt.serialize};function si(p){return typeof p.secure=="boolean"?p.secure:String(p.scheme).toLowerCase()==="wss"}var nn={scheme:"ws",domainHost:!0,parse:function(p,$){var k=p;return k.secure=si(k),k.resourceName=(k.path||"/")+(k.query?"?"+k.query:""),k.path=void 0,k.query=void 0,k},serialize:function(p,$){if((p.port===(si(p)?443:80)||p.port==="")&&(p.port=void 0),typeof p.secure=="boolean"&&(p.scheme=p.secure?"wss":"ws",p.secure=void 0),p.resourceName){var k=p.resourceName.split("?"),M=y(k,2),R=M[0],J=M[1];p.path=R&&R!=="/"?R:void 0,p.query=J,p.resourceName=void 0}return p.fragment=void 0,p}},li={scheme:"wss",domainHost:nn.domainHost,parse:nn.parse,serialize:nn.serialize},Ms={},ci="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Ze="[0-9A-Fa-f]",Rs=o(o("%[EFef]"+Ze+"%"+Ze+Ze+"%"+Ze+Ze)+"|"+o("%[89A-Fa-f]"+Ze+"%"+Ze+Ze)+"|"+o("%"+Ze+Ze)),Ds="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Is="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",zs=r(Is,'[\\"\\\\]'),Vs="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Fs=new RegExp(ci,"g"),Mt=new RegExp(Rs,"g"),Ls=new RegExp(r("[^]",Ds,"[\\.]",'[\\"]',zs),"g"),ui=new RegExp(r("[^]",ci,Vs),"g"),qs=ui;function Nr(p){var $=te(p);return $.match(Fs)?$:p}var hi={scheme:"mailto",parse:function(p,$){var k=p,M=k.to=k.path?k.path.split(","):[];if(k.path=void 0,k.query){for(var R=!1,J={},B=k.query.split("&"),se=0,ge=B.length;se<ge;++se){var le=B[se].split("=");switch(le[0]){case"to":for(var ie=le[1].split(","),ue=0,me=ie.length;ue<me;++ue)M.push(ie[ue]);break;case"subject":k.subject=Re(le[1],$);break;case"body":k.body=Re(le[1],$);break;default:R=!0,J[Re(le[0],$)]=Re(le[1],$);break}}R&&(k.headers=J)}k.query=void 0;for(var Q=0,ve=M.length;Q<ve;++Q){var ce=M[Q].split("@");if(ce[0]=Re(ce[0]),$.unicodeSupport)ce[1]=Re(ce[1],$).toLowerCase();else try{ce[1]=O.toASCII(Re(ce[1],$).toLowerCase())}catch(De){k.error=k.error||"Email address's domain name can not be converted to ASCII via punycode: "+De}M[Q]=ce.join("@")}return k},serialize:function(p,$){var k=p,M=s(p.to);if(M){for(var R=0,J=M.length;R<J;++R){var B=String(M[R]),se=B.lastIndexOf("@"),ge=B.slice(0,se).replace(Mt,Nr).replace(Mt,a).replace(Ls,q),le=B.slice(se+1);try{le=$.iri?O.toUnicode(le):O.toASCII(Re(le,$).toLowerCase())}catch(Q){k.error=k.error||"Email address's domain name can not be converted to "+($.iri?"Unicode":"ASCII")+" via punycode: "+Q}M[R]=ge+"@"+le}k.path=M.join(",")}var ie=p.headers=p.headers||{};p.subject&&(ie.subject=p.subject),p.body&&(ie.body=p.body);var ue=[];for(var me in ie)ie[me]!==Ms[me]&&ue.push(me.replace(Mt,Nr).replace(Mt,a).replace(ui,q)+"="+ie[me].replace(Mt,Nr).replace(Mt,a).replace(qs,q));return ue.length&&(k.query=ue.join("&")),k}},Hs=/^([^\:]+)\:(.*)/,fi={scheme:"urn",parse:function(p,$){var k=p.path&&p.path.match(Hs),M=p;if(k){var R=$.scheme||M.scheme||"urn",J=k[1].toLowerCase(),B=k[2],se=R+":"+($.nid||J),ge=F[se];M.nid=J,M.nss=B,M.path=void 0,ge&&(M=ge.parse(M,$))}else M.error=M.error||"URN can not be parsed.";return M},serialize:function(p,$){var k=$.scheme||p.scheme||"urn",M=p.nid,R=k+":"+($.nid||M),J=F[R];J&&(p=J.serialize(p,$));var B=p,se=p.nss;return B.path=(M||$.nid)+":"+se,B}},Us=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,di={scheme:"urn:uuid",parse:function(p,$){var k=p;return k.uuid=k.nss,k.nss=void 0,!$.tolerant&&(!k.uuid||!k.uuid.match(Us))&&(k.error=k.error||"UUID is not valid."),k},serialize:function(p,$){var k=p;return k.nss=(p.uuid||"").toLowerCase(),k}};F[yt.scheme]=yt,F[ai.scheme]=ai,F[nn.scheme]=nn,F[li.scheme]=li,F[hi.scheme]=hi,F[fi.scheme]=fi,F[di.scheme]=di,n.SCHEMES=F,n.pctEncChar=q,n.pctDecChars=te,n.parse=je,n.removeDotSegments=Be,n.serialize=Pe,n.resolveComponents=Ot,n.resolve=en,n.normalize=mt,n.equal=tn,n.escapeComponent=jn,n.unescapeComponent=Re,Object.defineProperty(n,"__esModule",{value:!0})})})(Yr,Yr.exports);Object.defineProperty(Po,"__esModule",{value:!0});const gs=Yr.exports;gs.code='require("ajv/dist/runtime/uri").default';Po.default=gs;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Ue;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var n=re;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=Cn,o=Tn,i=Pt,a=Ce,s=re,l=we,c=Nn,u=ae,f=tp,y=Po,m=(I,N)=>new RegExp(I,N);m.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},h={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},x=200;function S(I){var N,D,T,d,b,O,F,q,te,oe,pe,Ge,Ct,Xt,Yt,je,Wt,Tt,At,jt,Qt,Be,Pe,Ot,en;const mt=I.strict,tn=(N=I.code)===null||N===void 0?void 0:N.optimize,jn=tn===!0||tn===void 0?1:tn||0,Re=(T=(D=I.code)===null||D===void 0?void 0:D.regExp)!==null&&T!==void 0?T:m,yt=(d=I.uriResolver)!==null&&d!==void 0?d:y.default;return{strictSchema:(O=(b=I.strictSchema)!==null&&b!==void 0?b:mt)!==null&&O!==void 0?O:!0,strictNumbers:(q=(F=I.strictNumbers)!==null&&F!==void 0?F:mt)!==null&&q!==void 0?q:!0,strictTypes:(oe=(te=I.strictTypes)!==null&&te!==void 0?te:mt)!==null&&oe!==void 0?oe:"log",strictTuples:(Ge=(pe=I.strictTuples)!==null&&pe!==void 0?pe:mt)!==null&&Ge!==void 0?Ge:"log",strictRequired:(Xt=(Ct=I.strictRequired)!==null&&Ct!==void 0?Ct:mt)!==null&&Xt!==void 0?Xt:!1,code:I.code?{...I.code,optimize:jn,regExp:Re}:{optimize:jn,regExp:Re},loopRequired:(Yt=I.loopRequired)!==null&&Yt!==void 0?Yt:x,loopEnum:(je=I.loopEnum)!==null&&je!==void 0?je:x,meta:(Wt=I.meta)!==null&&Wt!==void 0?Wt:!0,messages:(Tt=I.messages)!==null&&Tt!==void 0?Tt:!0,inlineRefs:(At=I.inlineRefs)!==null&&At!==void 0?At:!0,schemaId:(jt=I.schemaId)!==null&&jt!==void 0?jt:"$id",addUsedSchema:(Qt=I.addUsedSchema)!==null&&Qt!==void 0?Qt:!0,validateSchema:(Be=I.validateSchema)!==null&&Be!==void 0?Be:!0,validateFormats:(Pe=I.validateFormats)!==null&&Pe!==void 0?Pe:!0,unicodeRegExp:(Ot=I.unicodeRegExp)!==null&&Ot!==void 0?Ot:!0,int32range:(en=I.int32range)!==null&&en!==void 0?en:!0,uriResolver:yt}}class v{constructor(N={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,N=this.opts={...N,...S(N)};const{es5:D,lines:T}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:_,es5:D,lines:T}),this.logger=Z(N.logger);const d=N.validateFormats;N.validateFormats=!1,this.RULES=(0,i.getRules)(),A.call(this,g,N,"NOT SUPPORTED"),A.call(this,h,N,"DEPRECATED","warn"),this._metaOpts=U.call(this),N.formats&&j.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),N.keywords&&L.call(this,N.keywords),typeof N.meta=="object"&&this.addMetaSchema(N.meta),P.call(this),N.validateFormats=d}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:N,meta:D,schemaId:T}=this.opts;let d=f;T==="id"&&(d={...f},d.id=d.$id,delete d.$id),D&&N&&this.addMetaSchema(d,d[T],!1)}defaultMeta(){const{meta:N,schemaId:D}=this.opts;return this.opts.defaultMeta=typeof N=="object"?N[D]||N:void 0}validate(N,D){let T;if(typeof N=="string"){if(T=this.getSchema(N),!T)throw new Error(`no schema with key or ref "${N}"`)}else T=this.compile(N);const d=T(D);return"$async"in T||(this.errors=T.errors),d}compile(N,D){const T=this._addSchema(N,D);return T.validate||this._compileSchemaEnv(T)}compileAsync(N,D){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:T}=this.opts;return d.call(this,N,D);async function d(oe,pe){await b.call(this,oe.$schema);const Ge=this._addSchema(oe,pe);return Ge.validate||O.call(this,Ge)}async function b(oe){oe&&!this.getSchema(oe)&&await d.call(this,{$ref:oe},!0)}async function O(oe){try{return this._compileSchemaEnv(oe)}catch(pe){if(!(pe instanceof o.default))throw pe;return F.call(this,pe),await q.call(this,pe.missingSchema),O.call(this,oe)}}function F({missingSchema:oe,missingRef:pe}){if(this.refs[oe])throw new Error(`AnySchema ${oe} is loaded but ${pe} cannot be resolved`)}async function q(oe){const pe=await te.call(this,oe);this.refs[oe]||await b.call(this,pe.$schema),this.refs[oe]||this.addSchema(pe,oe,D)}async function te(oe){const pe=this._loading[oe];if(pe)return pe;try{return await(this._loading[oe]=T(oe))}finally{delete this._loading[oe]}}}addSchema(N,D,T,d=this.opts.validateSchema){if(Array.isArray(N)){for(const O of N)this.addSchema(O,void 0,T,d);return this}let b;if(typeof N=="object"){const{schemaId:O}=this.opts;if(b=N[O],b!==void 0&&typeof b!="string")throw new Error(`schema ${O} must be string`)}return D=(0,l.normalizeId)(D||b),this._checkUnique(D),this.schemas[D]=this._addSchema(N,T,D,d,!0),this}addMetaSchema(N,D,T=this.opts.validateSchema){return this.addSchema(N,D,!0,T),this}validateSchema(N,D){if(typeof N=="boolean")return!0;let T;if(T=N.$schema,T!==void 0&&typeof T!="string")throw new Error("$schema must be a string");if(T=T||this.opts.defaultMeta||this.defaultMeta(),!T)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const d=this.validate(T,N);if(!d&&D){const b="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(b);else throw new Error(b)}return d}getSchema(N){let D;for(;typeof(D=E.call(this,N))=="string";)N=D;if(D===void 0){const{schemaId:T}=this.opts,d=new a.SchemaEnv({schema:{},schemaId:T});if(D=a.resolveSchema.call(this,d,N),!D)return;this.refs[N]=D}return D.validate||this._compileSchemaEnv(D)}removeSchema(N){if(N instanceof RegExp)return this._removeAllSchemas(this.schemas,N),this._removeAllSchemas(this.refs,N),this;switch(typeof N){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const D=E.call(this,N);return typeof D=="object"&&this._cache.delete(D.schema),delete this.schemas[N],delete this.refs[N],this}case"object":{const D=N;this._cache.delete(D);let T=N[this.opts.schemaId];return T&&(T=(0,l.normalizeId)(T),delete this.schemas[T],delete this.refs[T]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(N){for(const D of N)this.addKeyword(D);return this}addKeyword(N,D){let T;if(typeof N=="string")T=N,typeof D=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),D.keyword=T);else if(typeof N=="object"&&D===void 0){if(D=N,T=D.keyword,Array.isArray(T)&&!T.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(C.call(this,T,D),!D)return(0,u.eachItem)(T,b=>V.call(this,b)),this;H.call(this,D);const d={...D,type:(0,c.getJSONTypes)(D.type),schemaType:(0,c.getJSONTypes)(D.schemaType)};return(0,u.eachItem)(T,d.type.length===0?b=>V.call(this,b,d):b=>d.type.forEach(O=>V.call(this,b,d,O))),this}getKeyword(N){const D=this.RULES.all[N];return typeof D=="object"?D.definition:!!D}removeKeyword(N){const{RULES:D}=this;delete D.keywords[N],delete D.all[N];for(const T of D.rules){const d=T.rules.findIndex(b=>b.keyword===N);d>=0&&T.rules.splice(d,1)}return this}addFormat(N,D){return typeof D=="string"&&(D=new RegExp(D)),this.formats[N]=D,this}errorsText(N=this.errors,{separator:D=", ",dataVar:T="data"}={}){return!N||N.length===0?"No errors":N.map(d=>`${T}${d.instancePath} ${d.message}`).reduce((d,b)=>d+D+b)}$dataMetaSchema(N,D){const T=this.RULES.all;N=JSON.parse(JSON.stringify(N));for(const d of D){const b=d.split("/").slice(1);let O=N;for(const F of b)O=O[F];for(const F in T){const q=T[F];if(typeof q!="object")continue;const{$data:te}=q.definition,oe=O[F];te&&oe&&(O[F]=Y(oe))}}return N}_removeAllSchemas(N,D){for(const T in N){const d=N[T];(!D||D.test(T))&&(typeof d=="string"?delete N[T]:d&&!d.meta&&(this._cache.delete(d.schema),delete N[T]))}}_addSchema(N,D,T,d=this.opts.validateSchema,b=this.opts.addUsedSchema){let O;const{schemaId:F}=this.opts;if(typeof N=="object")O=N[F];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof N!="boolean")throw new Error("schema must be object or boolean")}let q=this._cache.get(N);if(q!==void 0)return q;T=(0,l.normalizeId)(O||T);const te=l.getSchemaRefs.call(this,N,T);return q=new a.SchemaEnv({schema:N,schemaId:F,meta:D,baseId:T,localRefs:te}),this._cache.set(q.schema,q),b&&!T.startsWith("#")&&(T&&this._checkUnique(T),this.refs[T]=q),d&&this.validateSchema(N,!0),q}_checkUnique(N){if(this.schemas[N]||this.refs[N])throw new Error(`schema with key or id "${N}" already exists`)}_compileSchemaEnv(N){if(N.meta?this._compileMetaSchema(N):a.compileSchema.call(this,N),!N.validate)throw new Error("ajv implementation error");return N.validate}_compileMetaSchema(N){const D=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,N)}finally{this.opts=D}}}e.default=v,v.ValidationError=r.default,v.MissingRefError=o.default;function A(I,N,D,T="error"){for(const d in I){const b=d;b in N&&this.logger[T](`${D}: option ${d}. ${I[b]}`)}}function E(I){return I=(0,l.normalizeId)(I),this.schemas[I]||this.refs[I]}function P(){const I=this.opts.schemas;if(I)if(Array.isArray(I))this.addSchema(I);else for(const N in I)this.addSchema(I[N],N)}function j(){for(const I in this.opts.formats){const N=this.opts.formats[I];N&&this.addFormat(I,N)}}function L(I){if(Array.isArray(I)){this.addVocabulary(I);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const N in I){const D=I[N];D.keyword||(D.keyword=N),this.addKeyword(D)}}function U(){const I={...this.opts};for(const N of w)delete I[N];return I}const X={log(){},warn(){},error(){}};function Z(I){if(I===!1)return X;if(I===void 0)return console;if(I.log&&I.warn&&I.error)return I;throw new Error("logger must implement log, warn and error methods")}const ee=/^[a-z_$][a-z0-9_$:-]*$/i;function C(I,N){const{RULES:D}=this;if((0,u.eachItem)(I,T=>{if(D.keywords[T])throw new Error(`Keyword ${T} is already defined`);if(!ee.test(T))throw new Error(`Keyword ${T} has invalid name`)}),!!N&&N.$data&&!("code"in N||"validate"in N))throw new Error('$data keyword must have "code" or "validate" function')}function V(I,N,D){var T;const d=N==null?void 0:N.post;if(D&&d)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:b}=this;let O=d?b.post:b.rules.find(({type:q})=>q===D);if(O||(O={type:D,rules:[]},b.rules.push(O)),b.keywords[I]=!0,!N)return;const F={keyword:I,definition:{...N,type:(0,c.getJSONTypes)(N.type),schemaType:(0,c.getJSONTypes)(N.schemaType)}};N.before?z.call(this,O,F,N.before):O.rules.push(F),b.all[I]=F,(T=N.implements)===null||T===void 0||T.forEach(q=>this.addKeyword(q))}function z(I,N,D){const T=I.rules.findIndex(d=>d.keyword===D);T>=0?I.rules.splice(T,0,N):(I.rules.push(N),this.logger.warn(`rule ${D} is not defined`))}function H(I){let{metaSchema:N}=I;N!==void 0&&(I.$data&&this.opts.$data&&(N=Y(N)),I.validateSchema=this.compile(N,!0))}const G={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Y(I){return{anyOf:[I,G]}}})(Ba);var No={},Co={},To={};Object.defineProperty(To,"__esModule",{value:!0});const np={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};To.default=np;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.callRef=Nt.getValidate=void 0;const rp=Tn,Ji=ne,Ne=re,It=et,Xi=Ce,qn=ae,op={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:r}=e,{baseId:o,schemaEnv:i,validateName:a,opts:s,self:l}=r,{root:c}=i;if((n==="#"||n==="#/")&&o===c.baseId)return f();const u=Xi.resolveRef.call(l,c,o,n);if(u===void 0)throw new rp.default(r.opts.uriResolver,o,n);if(u instanceof Xi.SchemaEnv)return y(u);return m(u);function f(){if(i===c)return er(e,a,i,i.$async);const w=t.scopeValue("root",{ref:c});return er(e,(0,Ne._)`${w}.validate`,c,c.$async)}function y(w){const _=vs(e,w);er(e,_,w,w.$async)}function m(w){const _=t.scopeValue("schema",s.code.source===!0?{ref:w,code:(0,Ne.stringify)(w)}:{ref:w}),g=t.name("valid"),h=e.subschema({schema:w,dataTypes:[],schemaPath:Ne.nil,topSchemaRef:_,errSchemaPath:n},g);e.mergeEvaluated(h),e.ok(g)}}};function vs(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,Ne._)`${n.scopeValue("wrapper",{ref:t})}.validate`}Nt.getValidate=vs;function er(e,t,n,r){const{gen:o,it:i}=e,{allErrors:a,schemaEnv:s,opts:l}=i,c=l.passContext?It.default.this:Ne.nil;r?u():f();function u(){if(!s.$async)throw new Error("async schema referenced by sync schema");const w=o.let("valid");o.try(()=>{o.code((0,Ne._)`await ${(0,Ji.callValidateCode)(e,t,c)}`),m(t),a||o.assign(w,!0)},_=>{o.if((0,Ne._)`!(${_} instanceof ${i.ValidationError})`,()=>o.throw(_)),y(_),a||o.assign(w,!1)}),e.ok(w)}function f(){e.result((0,Ji.callValidateCode)(e,t,c),()=>m(t),()=>y(t))}function y(w){const _=(0,Ne._)`${w}.errors`;o.assign(It.default.vErrors,(0,Ne._)`${It.default.vErrors} === null ? ${_} : ${It.default.vErrors}.concat(${_})`),o.assign(It.default.errors,(0,Ne._)`${It.default.vErrors}.length`)}function m(w){var _;if(!i.opts.unevaluated)return;const g=(_=n==null?void 0:n.validate)===null||_===void 0?void 0:_.evaluated;if(i.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(i.props=qn.mergeEvaluated.props(o,g.props,i.props));else{const h=o.var("props",(0,Ne._)`${w}.evaluated.props`);i.props=qn.mergeEvaluated.props(o,h,i.props,Ne.Name)}if(i.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(i.items=qn.mergeEvaluated.items(o,g.items,i.items));else{const h=o.var("items",(0,Ne._)`${w}.evaluated.items`);i.items=qn.mergeEvaluated.items(o,h,i.items,Ne.Name)}}}Nt.callRef=er;Nt.default=op;Object.defineProperty(Co,"__esModule",{value:!0});const ip=To,ap=Nt,sp=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",ip.default,ap.default];Co.default=sp;var Ao={},jo={};Object.defineProperty(jo,"__esModule",{value:!0});const fr=re,ht=fr.operators,dr={maximum:{okStr:"<=",ok:ht.LTE,fail:ht.GT},minimum:{okStr:">=",ok:ht.GTE,fail:ht.LT},exclusiveMaximum:{okStr:"<",ok:ht.LT,fail:ht.GTE},exclusiveMinimum:{okStr:">",ok:ht.GT,fail:ht.LTE}},lp={message:({keyword:e,schemaCode:t})=>(0,fr.str)`must be ${dr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,fr._)`{comparison: ${dr[e].okStr}, limit: ${t}}`},cp={keyword:Object.keys(dr),type:"number",schemaType:"number",$data:!0,error:lp,code(e){const{keyword:t,data:n,schemaCode:r}=e;e.fail$data((0,fr._)`${n} ${dr[t].fail} ${r} || isNaN(${n})`)}};jo.default=cp;var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});const pn=re,up={message:({schemaCode:e})=>(0,pn.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,pn._)`{multipleOf: ${e}}`},hp={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:up,code(e){const{gen:t,data:n,schemaCode:r,it:o}=e,i=o.opts.multipleOfPrecision,a=t.let("res"),s=i?(0,pn._)`Math.abs(Math.round(${a}) - ${a}) > 1e-${i}`:(0,pn._)`${a} !== parseInt(${a})`;e.fail$data((0,pn._)`(${r} === 0 || (${a} = ${n}/${r}, ${s}))`)}};Oo.default=hp;var Mo={},Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});function _s(e){const t=e.length;let n=0,r=0,o;for(;r<t;)n++,o=e.charCodeAt(r++),o>=55296&&o<=56319&&r<t&&(o=e.charCodeAt(r),(o&64512)===56320&&r++);return n}Ro.default=_s;_s.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Mo,"__esModule",{value:!0});const xt=re,fp=ae,dp=Ro,pp={message({keyword:e,schemaCode:t}){const n=e==="maxLength"?"more":"fewer";return(0,xt.str)`must NOT have ${n} than ${t} characters`},params:({schemaCode:e})=>(0,xt._)`{limit: ${e}}`},mp={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:pp,code(e){const{keyword:t,data:n,schemaCode:r,it:o}=e,i=t==="maxLength"?xt.operators.GT:xt.operators.LT,a=o.opts.unicode===!1?(0,xt._)`${n}.length`:(0,xt._)`${(0,fp.useFunc)(e.gen,dp.default)}(${n})`;e.fail$data((0,xt._)`${a} ${i} ${r}`)}};Mo.default=mp;var Do={};Object.defineProperty(Do,"__esModule",{value:!0});const yp=ne,pr=re,gp={message:({schemaCode:e})=>(0,pr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,pr._)`{pattern: ${e}}`},vp={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:gp,code(e){const{data:t,$data:n,schema:r,schemaCode:o,it:i}=e,a=i.opts.unicodeRegExp?"u":"",s=n?(0,pr._)`(new RegExp(${o}, ${a}))`:(0,yp.usePattern)(e,r);e.fail$data((0,pr._)`!${s}.test(${t})`)}};Do.default=vp;var Io={};Object.defineProperty(Io,"__esModule",{value:!0});const mn=re,_p={message({keyword:e,schemaCode:t}){const n=e==="maxProperties"?"more":"fewer";return(0,mn.str)`must NOT have ${n} than ${t} properties`},params:({schemaCode:e})=>(0,mn._)`{limit: ${e}}`},wp={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:_p,code(e){const{keyword:t,data:n,schemaCode:r}=e,o=t==="maxProperties"?mn.operators.GT:mn.operators.LT;e.fail$data((0,mn._)`Object.keys(${n}).length ${o} ${r}`)}};Io.default=wp;var zo={};Object.defineProperty(zo,"__esModule",{value:!0});const ln=ne,yn=re,$p=ae,xp={message:({params:{missingProperty:e}})=>(0,yn.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,yn._)`{missingProperty: ${e}}`},bp={keyword:"required",type:"object",schemaType:"array",$data:!0,error:xp,code(e){const{gen:t,schema:n,schemaCode:r,data:o,$data:i,it:a}=e,{opts:s}=a;if(!i&&n.length===0)return;const l=n.length>=s.loopRequired;if(a.allErrors?c():u(),s.strictRequired){const m=e.parentSchema.properties,{definedProperties:w}=e.it;for(const _ of n)if((m==null?void 0:m[_])===void 0&&!w.has(_)){const g=a.schemaEnv.baseId+a.errSchemaPath,h=`required property "${_}" is not defined at "${g}" (strictRequired)`;(0,$p.checkStrictMode)(a,h,a.opts.strictRequired)}}function c(){if(l||i)e.block$data(yn.nil,f);else for(const m of n)(0,ln.checkReportMissingProp)(e,m)}function u(){const m=t.let("missing");if(l||i){const w=t.let("valid",!0);e.block$data(w,()=>y(m,w)),e.ok(w)}else t.if((0,ln.checkMissingProp)(e,n,m)),(0,ln.reportMissingProp)(e,m),t.else()}function f(){t.forOf("prop",r,m=>{e.setParams({missingProperty:m}),t.if((0,ln.noPropertyInData)(t,o,m,s.ownProperties),()=>e.error())})}function y(m,w){e.setParams({missingProperty:m}),t.forOf(m,r,()=>{t.assign(w,(0,ln.propertyInData)(t,o,m,s.ownProperties)),t.if((0,yn.not)(w),()=>{e.error(),t.break()})},yn.nil)}}};zo.default=bp;var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});const gn=re,Ep={message({keyword:e,schemaCode:t}){const n=e==="maxItems"?"more":"fewer";return(0,gn.str)`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>(0,gn._)`{limit: ${e}}`},kp={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Ep,code(e){const{keyword:t,data:n,schemaCode:r}=e,o=t==="maxItems"?gn.operators.GT:gn.operators.LT;e.fail$data((0,gn._)`${n}.length ${o} ${r}`)}};Vo.default=kp;var Fo={},An={};Object.defineProperty(An,"__esModule",{value:!0});const ws=ts;ws.code='require("ajv/dist/runtime/equal").default';An.default=ws;Object.defineProperty(Fo,"__esModule",{value:!0});const Ir=Nn,_e=re,Sp=ae,Pp=An,Np={message:({params:{i:e,j:t}})=>(0,_e.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,_e._)`{i: ${e}, j: ${t}}`},Cp={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Np,code(e){const{gen:t,data:n,$data:r,schema:o,parentSchema:i,schemaCode:a,it:s}=e;if(!r&&!o)return;const l=t.let("valid"),c=i.items?(0,Ir.getSchemaTypes)(i.items):[];e.block$data(l,u,(0,_e._)`${a} === false`),e.ok(l);function u(){const w=t.let("i",(0,_e._)`${n}.length`),_=t.let("j");e.setParams({i:w,j:_}),t.assign(l,!0),t.if((0,_e._)`${w} > 1`,()=>(f()?y:m)(w,_))}function f(){return c.length>0&&!c.some(w=>w==="object"||w==="array")}function y(w,_){const g=t.name("item"),h=(0,Ir.checkDataTypes)(c,g,s.opts.strictNumbers,Ir.DataType.Wrong),x=t.const("indices",(0,_e._)`{}`);t.for((0,_e._)`;${w}--;`,()=>{t.let(g,(0,_e._)`${n}[${w}]`),t.if(h,(0,_e._)`continue`),c.length>1&&t.if((0,_e._)`typeof ${g} == "string"`,(0,_e._)`${g} += "_"`),t.if((0,_e._)`typeof ${x}[${g}] == "number"`,()=>{t.assign(_,(0,_e._)`${x}[${g}]`),e.error(),t.assign(l,!1).break()}).code((0,_e._)`${x}[${g}] = ${w}`)})}function m(w,_){const g=(0,Sp.useFunc)(t,Pp.default),h=t.name("outer");t.label(h).for((0,_e._)`;${w}--;`,()=>t.for((0,_e._)`${_} = ${w}; ${_}--;`,()=>t.if((0,_e._)`${g}(${n}[${w}], ${n}[${_}])`,()=>{e.error(),t.assign(l,!1).break(h)})))}}};Fo.default=Cp;var Lo={};Object.defineProperty(Lo,"__esModule",{value:!0});const Wr=re,Tp=ae,Ap=An,jp={message:"must be equal to constant",params:({schemaCode:e})=>(0,Wr._)`{allowedValue: ${e}}`},Op={keyword:"const",$data:!0,error:jp,code(e){const{gen:t,data:n,$data:r,schemaCode:o,schema:i}=e;r||i&&typeof i=="object"?e.fail$data((0,Wr._)`!${(0,Tp.useFunc)(t,Ap.default)}(${n}, ${o})`):e.fail((0,Wr._)`${i} !== ${n}`)}};Lo.default=Op;var qo={};Object.defineProperty(qo,"__esModule",{value:!0});const hn=re,Mp=ae,Rp=An,Dp={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,hn._)`{allowedValues: ${e}}`},Ip={keyword:"enum",schemaType:"array",$data:!0,error:Dp,code(e){const{gen:t,data:n,$data:r,schema:o,schemaCode:i,it:a}=e;if(!r&&o.length===0)throw new Error("enum must have non-empty array");const s=o.length>=a.opts.loopEnum;let l;const c=()=>l!=null?l:l=(0,Mp.useFunc)(t,Rp.default);let u;if(s||r)u=t.let("valid"),e.block$data(u,f);else{if(!Array.isArray(o))throw new Error("ajv implementation error");const m=t.const("vSchema",i);u=(0,hn.or)(...o.map((w,_)=>y(m,_)))}e.pass(u);function f(){t.assign(u,!1),t.forOf("v",i,m=>t.if((0,hn._)`${c()}(${n}, ${m})`,()=>t.assign(u,!0).break()))}function y(m,w){const _=o[w];return typeof _=="object"&&_!==null?(0,hn._)`${c()}(${n}, ${m}[${w}])`:(0,hn._)`${n} === ${_}`}}};qo.default=Ip;Object.defineProperty(Ao,"__esModule",{value:!0});const zp=jo,Vp=Oo,Fp=Mo,Lp=Do,qp=Io,Hp=zo,Up=Vo,Kp=Fo,Gp=Lo,Bp=qo,Zp=[zp.default,Vp.default,Fp.default,Lp.default,qp.default,Hp.default,Up.default,Kp.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Gp.default,Bp.default];Ao.default=Zp;var Ho={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.validateAdditionalItems=void 0;const bt=re,Qr=ae,Jp={message:({params:{len:e}})=>(0,bt.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,bt._)`{limit: ${e}}`},Xp={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Jp,code(e){const{parentSchema:t,it:n}=e,{items:r}=t;if(!Array.isArray(r)){(0,Qr.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}$s(e,r)}};function $s(e,t){const{gen:n,schema:r,data:o,keyword:i,it:a}=e;a.items=!0;const s=n.const("len",(0,bt._)`${o}.length`);if(r===!1)e.setParams({len:t.length}),e.pass((0,bt._)`${s} <= ${t.length}`);else if(typeof r=="object"&&!(0,Qr.alwaysValidSchema)(a,r)){const c=n.var("valid",(0,bt._)`${s} <= ${t.length}`);n.if((0,bt.not)(c),()=>l(c)),e.ok(c)}function l(c){n.forRange("i",t.length,s,u=>{e.subschema({keyword:i,dataProp:u,dataPropType:Qr.Type.Num},c),a.allErrors||n.if((0,bt.not)(c),()=>n.break())})}}Zt.validateAdditionalItems=$s;Zt.default=Xp;var Uo={},Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.validateTuple=void 0;const Yi=re,tr=ae,Yp=ne,Wp={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return xs(e,"additionalItems",t);n.items=!0,!(0,tr.alwaysValidSchema)(n,t)&&e.ok((0,Yp.validateArray)(e))}};function xs(e,t,n=e.schema){const{gen:r,parentSchema:o,data:i,keyword:a,it:s}=e;u(o),s.opts.unevaluated&&n.length&&s.items!==!0&&(s.items=tr.mergeEvaluated.items(r,n.length,s.items));const l=r.name("valid"),c=r.const("len",(0,Yi._)`${i}.length`);n.forEach((f,y)=>{(0,tr.alwaysValidSchema)(s,f)||(r.if((0,Yi._)`${c} > ${y}`,()=>e.subschema({keyword:a,schemaProp:y,dataProp:y},l)),e.ok(l))});function u(f){const{opts:y,errSchemaPath:m}=s,w=n.length,_=w===f.minItems&&(w===f.maxItems||f[t]===!1);if(y.strictTuples&&!_){const g=`"${a}" is ${w}-tuple, but minItems or maxItems/${t} are not specified or different at path "${m}"`;(0,tr.checkStrictMode)(s,g,y.strictTuples)}}}Jt.validateTuple=xs;Jt.default=Wp;Object.defineProperty(Uo,"__esModule",{value:!0});const Qp=Jt,e0={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Qp.validateTuple)(e,"items")};Uo.default=e0;var Ko={};Object.defineProperty(Ko,"__esModule",{value:!0});const Wi=re,t0=ae,n0=ne,r0=Zt,o0={message:({params:{len:e}})=>(0,Wi.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Wi._)`{limit: ${e}}`},i0={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:o0,code(e){const{schema:t,parentSchema:n,it:r}=e,{prefixItems:o}=n;r.items=!0,!(0,t0.alwaysValidSchema)(r,t)&&(o?(0,r0.validateAdditionalItems)(e,o):e.ok((0,n0.validateArray)(e)))}};Ko.default=i0;var Go={};Object.defineProperty(Go,"__esModule",{value:!0});const ze=re,Hn=ae,a0={message:({params:{min:e,max:t}})=>t===void 0?(0,ze.str)`must contain at least ${e} valid item(s)`:(0,ze.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,ze._)`{minContains: ${e}}`:(0,ze._)`{minContains: ${e}, maxContains: ${t}}`},s0={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:a0,code(e){const{gen:t,schema:n,parentSchema:r,data:o,it:i}=e;let a,s;const{minContains:l,maxContains:c}=r;i.opts.next?(a=l===void 0?1:l,s=c):a=1;const u=t.const("len",(0,ze._)`${o}.length`);if(e.setParams({min:a,max:s}),s===void 0&&a===0){(0,Hn.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(s!==void 0&&a>s){(0,Hn.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,Hn.alwaysValidSchema)(i,n)){let _=(0,ze._)`${u} >= ${a}`;s!==void 0&&(_=(0,ze._)`${_} && ${u} <= ${s}`),e.pass(_);return}i.items=!0;const f=t.name("valid");s===void 0&&a===1?m(f,()=>t.if(f,()=>t.break())):a===0?(t.let(f,!0),s!==void 0&&t.if((0,ze._)`${o}.length > 0`,y)):(t.let(f,!1),y()),e.result(f,()=>e.reset());function y(){const _=t.name("_valid"),g=t.let("count",0);m(_,()=>t.if(_,()=>w(g)))}function m(_,g){t.forRange("i",0,u,h=>{e.subschema({keyword:"contains",dataProp:h,dataPropType:Hn.Type.Num,compositeRule:!0},_),g()})}function w(_){t.code((0,ze._)`${_}++`),s===void 0?t.if((0,ze._)`${_} >= ${a}`,()=>t.assign(f,!0).break()):(t.if((0,ze._)`${_} > ${s}`,()=>t.assign(f,!1).break()),a===1?t.assign(f,!0):t.if((0,ze._)`${_} >= ${a}`,()=>t.assign(f,!0)))}}};Go.default=s0;var bs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=re,n=ae,r=ne;e.error={message:({params:{property:l,depsCount:c,deps:u}})=>{const f=c===1?"property":"properties";return(0,t.str)`must have ${f} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:f}})=>(0,t._)`{property: ${l},
	    missingProperty: ${f},
	    depsCount: ${c},
	    deps: ${u}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(l){const[c,u]=i(l);a(l,c),s(l,u)}};function i({schema:l}){const c={},u={};for(const f in l){if(f==="__proto__")continue;const y=Array.isArray(l[f])?c:u;y[f]=l[f]}return[c,u]}function a(l,c=l.schema){const{gen:u,data:f,it:y}=l;if(Object.keys(c).length===0)return;const m=u.let("missing");for(const w in c){const _=c[w];if(_.length===0)continue;const g=(0,r.propertyInData)(u,f,w,y.opts.ownProperties);l.setParams({property:w,depsCount:_.length,deps:_.join(", ")}),y.allErrors?u.if(g,()=>{for(const h of _)(0,r.checkReportMissingProp)(l,h)}):(u.if((0,t._)`${g} && (${(0,r.checkMissingProp)(l,_,m)})`),(0,r.reportMissingProp)(l,m),u.else())}}e.validatePropertyDeps=a;function s(l,c=l.schema){const{gen:u,data:f,keyword:y,it:m}=l,w=u.name("valid");for(const _ in c)(0,n.alwaysValidSchema)(m,c[_])||(u.if((0,r.propertyInData)(u,f,_,m.opts.ownProperties),()=>{const g=l.subschema({keyword:y,schemaProp:_},w);l.mergeValidEvaluated(g,w)},()=>u.var(w,!0)),l.ok(w))}e.validateSchemaDeps=s,e.default=o})(bs);var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});const Es=re,l0=ae,c0={message:"property name must be valid",params:({params:e})=>(0,Es._)`{propertyName: ${e.propertyName}}`},u0={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:c0,code(e){const{gen:t,schema:n,data:r,it:o}=e;if((0,l0.alwaysValidSchema)(o,n))return;const i=t.name("valid");t.forIn("key",r,a=>{e.setParams({propertyName:a}),e.subschema({keyword:"propertyNames",data:a,dataTypes:["string"],propertyName:a,compositeRule:!0},i),t.if((0,Es.not)(i),()=>{e.error(!0),o.allErrors||t.break()})}),e.ok(i)}};Bo.default=u0;var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});const Un=ne,Le=re,h0=et,Kn=ae,f0={message:"must NOT have additional properties",params:({params:e})=>(0,Le._)`{additionalProperty: ${e.additionalProperty}}`},d0={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:f0,code(e){const{gen:t,schema:n,parentSchema:r,data:o,errsCount:i,it:a}=e;if(!i)throw new Error("ajv implementation error");const{allErrors:s,opts:l}=a;if(a.props=!0,l.removeAdditional!=="all"&&(0,Kn.alwaysValidSchema)(a,n))return;const c=(0,Un.allSchemaProperties)(r.properties),u=(0,Un.allSchemaProperties)(r.patternProperties);f(),e.ok((0,Le._)`${i} === ${h0.default.errors}`);function f(){t.forIn("key",o,g=>{!c.length&&!u.length?w(g):t.if(y(g),()=>w(g))})}function y(g){let h;if(c.length>8){const x=(0,Kn.schemaRefOrVal)(a,r.properties,"properties");h=(0,Un.isOwnProperty)(t,x,g)}else c.length?h=(0,Le.or)(...c.map(x=>(0,Le._)`${g} === ${x}`)):h=Le.nil;return u.length&&(h=(0,Le.or)(h,...u.map(x=>(0,Le._)`${(0,Un.usePattern)(e,x)}.test(${g})`))),(0,Le.not)(h)}function m(g){t.code((0,Le._)`delete ${o}[${g}]`)}function w(g){if(l.removeAdditional==="all"||l.removeAdditional&&n===!1){m(g);return}if(n===!1){e.setParams({additionalProperty:g}),e.error(),s||t.break();return}if(typeof n=="object"&&!(0,Kn.alwaysValidSchema)(a,n)){const h=t.name("valid");l.removeAdditional==="failing"?(_(g,h,!1),t.if((0,Le.not)(h),()=>{e.reset(),m(g)})):(_(g,h),s||t.if((0,Le.not)(h),()=>t.break()))}}function _(g,h,x){const S={keyword:"additionalProperties",dataProp:g,dataPropType:Kn.Type.Str};x===!1&&Object.assign(S,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(S,h)}}};Sr.default=d0;var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});const p0=Ue,Qi=ne,zr=ae,ea=Sr,m0={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:r,data:o,it:i}=e;i.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&ea.default.code(new p0.KeywordCxt(i,ea.default,"additionalProperties"));const a=(0,Qi.allSchemaProperties)(n);for(const f of a)i.definedProperties.add(f);i.opts.unevaluated&&a.length&&i.props!==!0&&(i.props=zr.mergeEvaluated.props(t,(0,zr.toHash)(a),i.props));const s=a.filter(f=>!(0,zr.alwaysValidSchema)(i,n[f]));if(s.length===0)return;const l=t.name("valid");for(const f of s)c(f)?u(f):(t.if((0,Qi.propertyInData)(t,o,f,i.opts.ownProperties)),u(f),i.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(f),e.ok(l);function c(f){return i.opts.useDefaults&&!i.compositeRule&&n[f].default!==void 0}function u(f){e.subschema({keyword:"properties",schemaProp:f,dataProp:f},l)}}};Zo.default=m0;var Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});const ta=ne,Gn=re,na=ae,ra=ae,y0={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:r,parentSchema:o,it:i}=e,{opts:a}=i,s=(0,ta.allSchemaProperties)(n),l=s.filter(_=>(0,na.alwaysValidSchema)(i,n[_]));if(s.length===0||l.length===s.length&&(!i.opts.unevaluated||i.props===!0))return;const c=a.strictSchema&&!a.allowMatchingProperties&&o.properties,u=t.name("valid");i.props!==!0&&!(i.props instanceof Gn.Name)&&(i.props=(0,ra.evaluatedPropsToName)(t,i.props));const{props:f}=i;y();function y(){for(const _ of s)c&&m(_),i.allErrors?w(_):(t.var(u,!0),w(_),t.if(u))}function m(_){for(const g in c)new RegExp(_).test(g)&&(0,na.checkStrictMode)(i,`property ${g} matches pattern ${_} (use allowMatchingProperties)`)}function w(_){t.forIn("key",r,g=>{t.if((0,Gn._)`${(0,ta.usePattern)(e,_)}.test(${g})`,()=>{const h=l.includes(_);h||e.subschema({keyword:"patternProperties",schemaProp:_,dataProp:g,dataPropType:ra.Type.Str},u),i.opts.unevaluated&&f!==!0?t.assign((0,Gn._)`${f}[${g}]`,!0):!h&&!i.allErrors&&t.if((0,Gn.not)(u),()=>t.break())})})}}};Jo.default=y0;var Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});const g0=ae,v0={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:r}=e;if((0,g0.alwaysValidSchema)(r,n)){e.fail();return}const o=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),e.failResult(o,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Xo.default=v0;var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});const _0=ne,w0={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:_0.validateUnion,error:{message:"must match a schema in anyOf"}};Yo.default=w0;var Wo={};Object.defineProperty(Wo,"__esModule",{value:!0});const nr=re,$0=ae,x0={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,nr._)`{passingSchemas: ${e.passing}}`},b0={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:x0,code(e){const{gen:t,schema:n,parentSchema:r,it:o}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(o.opts.discriminator&&r.discriminator)return;const i=n,a=t.let("valid",!1),s=t.let("passing",null),l=t.name("_valid");e.setParams({passing:s}),t.block(c),e.result(a,()=>e.reset(),()=>e.error(!0));function c(){i.forEach((u,f)=>{let y;(0,$0.alwaysValidSchema)(o,u)?t.var(l,!0):y=e.subschema({keyword:"oneOf",schemaProp:f,compositeRule:!0},l),f>0&&t.if((0,nr._)`${l} && ${a}`).assign(a,!1).assign(s,(0,nr._)`[${s}, ${f}]`).else(),t.if(l,()=>{t.assign(a,!0),t.assign(s,f),y&&e.mergeEvaluated(y,nr.Name)})})}}};Wo.default=b0;var Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});const E0=ae,k0={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:r}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const o=t.name("valid");n.forEach((i,a)=>{if((0,E0.alwaysValidSchema)(r,i))return;const s=e.subschema({keyword:"allOf",schemaProp:a},o);e.ok(o),e.mergeEvaluated(s)})}};Qo.default=k0;var ei={};Object.defineProperty(ei,"__esModule",{value:!0});const mr=re,ks=ae,S0={message:({params:e})=>(0,mr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,mr._)`{failingKeyword: ${e.ifClause}}`},P0={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:S0,code(e){const{gen:t,parentSchema:n,it:r}=e;n.then===void 0&&n.else===void 0&&(0,ks.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const o=oa(r,"then"),i=oa(r,"else");if(!o&&!i)return;const a=t.let("valid",!0),s=t.name("_valid");if(l(),e.reset(),o&&i){const u=t.let("ifClause");e.setParams({ifClause:u}),t.if(s,c("then",u),c("else",u))}else o?t.if(s,c("then")):t.if((0,mr.not)(s),c("else"));e.pass(a,()=>e.error(!0));function l(){const u=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},s);e.mergeEvaluated(u)}function c(u,f){return()=>{const y=e.subschema({keyword:u},s);t.assign(a,s),e.mergeValidEvaluated(y,a),f?t.assign(f,(0,mr._)`${u}`):e.setParams({ifClause:u})}}}};function oa(e,t){const n=e.schema[t];return n!==void 0&&!(0,ks.alwaysValidSchema)(e,n)}ei.default=P0;var ti={};Object.defineProperty(ti,"__esModule",{value:!0});const N0=ae,C0={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:n}){t.if===void 0&&(0,N0.checkStrictMode)(n,`"${e}" without "if" is ignored`)}};ti.default=C0;Object.defineProperty(Ho,"__esModule",{value:!0});const T0=Zt,A0=Uo,j0=Jt,O0=Ko,M0=Go,R0=bs,D0=Bo,I0=Sr,z0=Zo,V0=Jo,F0=Xo,L0=Yo,q0=Wo,H0=Qo,U0=ei,K0=ti;function G0(e=!1){const t=[F0.default,L0.default,q0.default,H0.default,U0.default,K0.default,D0.default,I0.default,R0.default,z0.default,V0.default];return e?t.push(A0.default,O0.default):t.push(T0.default,j0.default),t.push(M0.default),t}Ho.default=G0;var ni={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});const ye=re,B0={message:({schemaCode:e})=>(0,ye.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,ye._)`{format: ${e}}`},Z0={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:B0,code(e,t){const{gen:n,data:r,$data:o,schema:i,schemaCode:a,it:s}=e,{opts:l,errSchemaPath:c,schemaEnv:u,self:f}=s;if(!l.validateFormats)return;o?y():m();function y(){const w=n.scopeValue("formats",{ref:f.formats,code:l.code.formats}),_=n.const("fDef",(0,ye._)`${w}[${a}]`),g=n.let("fType"),h=n.let("format");n.if((0,ye._)`typeof ${_} == "object" && !(${_} instanceof RegExp)`,()=>n.assign(g,(0,ye._)`${_}.type || "string"`).assign(h,(0,ye._)`${_}.validate`),()=>n.assign(g,(0,ye._)`"string"`).assign(h,_)),e.fail$data((0,ye.or)(x(),S()));function x(){return l.strictSchema===!1?ye.nil:(0,ye._)`${a} && !${h}`}function S(){const v=u.$async?(0,ye._)`(${_}.async ? await ${h}(${r}) : ${h}(${r}))`:(0,ye._)`${h}(${r})`,A=(0,ye._)`(typeof ${h} == "function" ? ${v} : ${h}.test(${r}))`;return(0,ye._)`${h} && ${h} !== true && ${g} === ${t} && !${A}`}}function m(){const w=f.formats[i];if(!w){x();return}if(w===!0)return;const[_,g,h]=S(w);_===t&&e.pass(v());function x(){if(l.strictSchema===!1){f.logger.warn(A());return}throw new Error(A());function A(){return`unknown format "${i}" ignored in schema at path "${c}"`}}function S(A){const E=A instanceof RegExp?(0,ye.regexpCode)(A):l.code.formats?(0,ye._)`${l.code.formats}${(0,ye.getProperty)(i)}`:void 0,P=n.scopeValue("formats",{key:i,ref:A,code:E});return typeof A=="object"&&!(A instanceof RegExp)?[A.type||"string",A.validate,(0,ye._)`${P}.validate`]:["string",A,P]}function v(){if(typeof w=="object"&&!(w instanceof RegExp)&&w.async){if(!u.$async)throw new Error("async format in sync schema");return(0,ye._)`await ${h}(${r})`}return typeof g=="function"?(0,ye._)`${h}(${r})`:(0,ye._)`${h}.test(${r})`}}}};ri.default=Z0;Object.defineProperty(ni,"__esModule",{value:!0});const J0=ri,X0=[J0.default];ni.default=X0;var Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.contentVocabulary=Bt.metadataVocabulary=void 0;Bt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Bt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(No,"__esModule",{value:!0});const Y0=Co,W0=Ao,Q0=Ho,em=ni,ia=Bt,tm=[Y0.default,W0.default,(0,Q0.default)(),em.default,ia.metadataVocabulary,ia.contentVocabulary];No.default=tm;var oi={},Ss={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(Ss);Object.defineProperty(oi,"__esModule",{value:!0});const zt=re,eo=Ss,aa=Ce,nm=ae,rm={message:({params:{discrError:e,tagName:t}})=>e===eo.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:n}})=>(0,zt._)`{error: ${e}, tag: ${n}, tagValue: ${t}}`},om={keyword:"discriminator",type:"object",schemaType:"object",error:rm,code(e){const{gen:t,data:n,schema:r,parentSchema:o,it:i}=e,{oneOf:a}=o;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const s=r.propertyName;if(typeof s!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!a)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),c=t.const("tag",(0,zt._)`${n}${(0,zt.getProperty)(s)}`);t.if((0,zt._)`typeof ${c} == "string"`,()=>u(),()=>e.error(!1,{discrError:eo.DiscrError.Tag,tag:c,tagName:s})),e.ok(l);function u(){const m=y();t.if(!1);for(const w in m)t.elseIf((0,zt._)`${c} === ${w}`),t.assign(l,f(m[w]));t.else(),e.error(!1,{discrError:eo.DiscrError.Mapping,tag:c,tagName:s}),t.endIf()}function f(m){const w=t.name("valid"),_=e.subschema({keyword:"oneOf",schemaProp:m},w);return e.mergeEvaluated(_,zt.Name),w}function y(){var m;const w={},_=h(o);let g=!0;for(let v=0;v<a.length;v++){let A=a[v];(A==null?void 0:A.$ref)&&!(0,nm.schemaHasRulesButRef)(A,i.self.RULES)&&(A=aa.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,A==null?void 0:A.$ref),A instanceof aa.SchemaEnv&&(A=A.schema));const E=(m=A==null?void 0:A.properties)===null||m===void 0?void 0:m[s];if(typeof E!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${s}"`);g=g&&(_||h(A)),x(E,v)}if(!g)throw new Error(`discriminator: "${s}" must be required`);return w;function h({required:v}){return Array.isArray(v)&&v.includes(s)}function x(v,A){if(v.const)S(v.const,A);else if(v.enum)for(const E of v.enum)S(E,A);else throw new Error(`discriminator: "properties/${s}" must have "const" or "enum"`)}function S(v,A){if(typeof v!="string"||v in w)throw new Error(`discriminator: "${s}" values must be unique strings`);w[v]=A}}}};oi.default=om;const im="http://json-schema.org/draft-07/schema#",am="http://json-schema.org/draft-07/schema#",sm="Core schema meta-schema",lm={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},cm=["object","boolean"],um={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},hm={$schema:im,$id:am,title:sm,definitions:lm,type:cm,properties:um,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=Ba,r=No,o=oi,i=hm,a=["/properties"],s="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(i,a):i;this.addMetaSchema(w,s,!1),this.refs["http://json-schema.org/schema"]=s}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var c=Ue;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=re;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var f=Cn;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return f.default}});var y=Tn;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return y.default}})})(Zr,Zr.exports);const fm=Ef(Zr.exports),dm=new fm({allErrors:!0});function sa(e){var t,n,r,o,i,a,s,l,c,u;if(!e.forceSimulation)return e.shape.failed=!0,null;const f=e.forceSimulation.nodeDataStore.hasNode(e.id)?Ee(this):Ae("g"),y=e.forceSimulation.nodeDataStore.hasPayloadChanges(e.id,e),m=e.forceSimulation.nodeDataStore.hasTemplateChange(e.id,e);if(e.forceSimulation.nodeDataStore.add(e.id,e),!y&&!m&&!e.shape.failed)return Yn(f.select("[data-object=shape]"),e.shape.scale*((n=(t=e.shape.template)==null?void 0:t.shapeSize)!=null?n:300)),f.node();if(f.selectAll("*").remove(),f.classed("gly-node",!0).attr("data-id",e.id),!e.shape.template)return S(`Template "${e.shape.type}" not found!`);if((o=(r=e.shape)==null?void 0:r.template)!=null&&o.shapePayload){const v=dm.compile(e.shape.template.shapePayload);if(!v(e.payload))return console.error(`[graphly-d3] ${e.shape.type} 
 \u2022 ${(i=v.errors)==null?void 0:i.map(A=>`${A.instancePath} ${A.message}`).join(`
 \u2022 `)}`),S(`"${e.shape.type}" ${(a=v.errors)==null?void 0:a[0].instancePath} ${(s=v.errors)==null?void 0:s[0].message}`)}else console.warn(`[graphly-d3] "${e.shape.type}" has no payload schema defined!`);try{f.append(()=>e.shape.template.shapeBuilder.bind(this)(e,Fi).node()).attr("data-object","shape")}catch(v){return console.error(`[graphly-d3] ${v}`),S(v.message)}const w=at(f),_=e.shape.scale*((c=(l=e.shape.template)==null?void 0:l.shapeSize)!=null?c:300);e.shape.bodyPoints=[];const g=f.select(".gly-body").node(),h=[];if(g&&g.getTotalLength){let v=((u=e.shape)==null?void 0:u.bodyResolution)||32;const A=g.getTotalLength();for(let ee=0;ee<v;ee++){const C=g.getPointAtLength(ee/v*A);C.x=Math.round(C.x),C.y=Math.round(C.y),h.push(C)}const E=Math.min(...h.map(ee=>ee.x)),P=Math.max(...h.map(ee=>ee.x)),j=Math.min(...h.map(ee=>ee.y)),L=Math.max(...h.map(ee=>ee.y)),U=P-E,X=L-j,Z={x:w.width/U,y:w.height/X};h.forEach(ee=>{var C,V,z,H,G,Y,I,N;ee.x=(ee.x-E)*Z.x+w.x-U*Z.x/2+_,ee.y=(ee.y-j)*Z.y+w.y-X*Z.y/2+_,((V=(C=e.forceSimulation)==null?void 0:C.debug)==null?void 0:V.enabled)&&((G=(H=(z=e.forceSimulation)==null?void 0:z.debug)==null?void 0:H.bodyPoints)==null?void 0:G.enabled)&&f.select("[data-object=shape]").append("circle").classed("gly-body-points",!0).attr("cx",ee.x+U*Z.x/2-_).attr("cy",ee.y+X*Z.y/2-_).attr("r",Math.max(w.height,w.width)/_*5).attr("fill",(N=(I=(Y=e.forceSimulation)==null?void 0:Y.debug)==null?void 0:I.bodyPoints)==null?void 0:N.color).attr("stroke","none")}),e.shape.bodyPoints=h}e.shape.failed=!1;const x=Yn(f.select("[data-object=shape]"),_);for(let v of h)v.x=(v.x-_)*x.scale,v.y=(v.y-_)*x.scale;return f.node();function S(v){var A,E,P,j;return e.shape.failed=!0,e.errorMessage=v,f.append(()=>e.forceSimulation?e.forceSimulation.templateStore.errorTemplate.shapeBuilder.bind(this)(e,Fi).node():null).attr("data-object","shape"),Yn(f.select("[data-object=shape]"),e.shape.scale*((j=(P=(E=(A=e.forceSimulation)==null?void 0:A.templateStore)==null?void 0:E.errorTemplate)==null?void 0:P.shapeSize)!=null?j:300)),f.node()}}var he=(e=>(e.NodeClick="node:click",e.NodeDoubleClick="node:doubleclick",e.NodeContextMenu="node:contextmenu",e.NodeDragStart="node:dragstart",e.NodeDragMove="node:dragmove",e.NodeDragEnd="node:dragend",e.LinkClick="link:click",e.LinkDoubleClick="link:doubleclick",e.LinkContextMenu="link:contextmenu",e.LinkDragStart="link:dragstart",e.LinkDragMove="link:dragmove",e.LinkDragEnd="link:dragend",e.EnvironmentClick="environment:click",e.EnvironmentDoubleClick="environment:doubleclick",e.EnvironmentContextMenu="environment:contextmenu",e.EnvironmentMove="environment:move",e.SimulationTick="simulation:tick",e.SimulationTickEnd="simulation:tickend",e))(he||{});const pm={["node:click"]:{event:e=>e,node:e=>e},["node:doubleclick"]:{event:e=>e,node:e=>e},["node:contextmenu"]:{event:e=>e,node:e=>e},["node:dragstart"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragmove"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragend"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["link:click"]:{event:e=>e,link:e=>e},["link:doubleclick"]:{event:e=>e,link:e=>e},["link:contextmenu"]:{event:e=>e,link:e=>e},["link:dragstart"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragmove"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragend"]:{event:e=>e,source:e=>e,target:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:click"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:doubleclick"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:contextmenu"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:move"]:{pos:e=>e},["simulation:tick"]:{},["simulation:tickend"]:{}};class Ps{constructor(){de(this,"register",{})}on(t,n){this.register[t]||(this.register[t]={}),this.register[t][n.name]=n}off(t,n){!this.register[t]||delete this.register[t][n.name]}emit(t,...n){if(this.register[t])for(const r in this.register[t])return this.register[t][r](...n)}}de(Ps,"events",pm);let Pr=!1,yr,to={x:0,y:0};function mm(){return Mc().on("start",(e,t)=>ym.bind(this)(e,t)).on("drag",(e,t)=>gm.bind(this)(e,t)).on("end",(e,t)=>vm.bind(this)(e,t))}function ym(e,t){if(this.eventStore.emit(he.NodeDragStart,e,t,{x:e.x,y:e.y})=="newlink")return _m.bind(this)(e,t);!this.draggableNodes||(this.simulation.alphaTarget(.05).restart(),t.isDraged=!0,t.fx=e.x,t.fy=e.y)}function gm(e,t){if(Pr)return wm.bind(this)(e,t);!this.draggableNodes||(t.fx=e.x,t.fy=e.y,this.eventStore.emit(he.NodeDragMove,e,t,{x:e.x,y:e.y}))}function vm(e,t){if(Pr)return la.bind(this)(e,t);if(!this.draggableNodes)return la.bind(this)(e,t);!this.draggableNodes||(this.simulation.alphaTarget(0),t.isDraged=!1,t.fx=null,t.fy=null,this.eventStore.emit(he.NodeDragEnd,e,t,{x:e.x,y:e.y}))}function _m(e,t){var n,r,o,i;to={x:e.sourceEvent.offsetX/this.worldTransform.k-this.worldTransform.x/this.worldTransform.k-((n=t.x)!=null?n:0),y:e.sourceEvent.offsetY/this.worldTransform.k-this.worldTransform.y/this.worldTransform.k-((r=t.y)!=null?r:0)},Pr=!0,yr=this.selectionGroups.links.append("g").attr("data-object","prelink").classed("gly-prelink",!0),yr.append("line").attr("data-object","prelink-link-line").classed("gly-link-line",!0).attr("x1",(o=t.x)!=null?o:0).attr("y1",(i=t.y)!=null?i:0).attr("x2",e.x).attr("y2",e.y),this.eventStore.emit(he.LinkDragStart,e,t,{x:e.x,y:e.y})}function wm(e,t){const n={x:e.x+to.x,y:e.y+to.y};yr.select("[data-object='prelink-link-line']").attr("x2",n.x).attr("y2",n.y),this.eventStore.emit(he.LinkDragMove,e,t,{x:e.x,y:e.y})}function la(e,t){yr.remove(),Pr=!1;let n=e.sourceEvent.target;if(n==this.svgElement)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y});for(;n.attributes["data-object"]==null;){if(n==null)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(n=n.parentElement,!n)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y})}if(n=n.parentElement,!n)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y});const r=this.graph.nodes.find(o=>{var i;return o.id==((i=n.attributes["data-id"])==null?void 0:i.value)});if(!r)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(r.id==t.id)return this.eventStore.emit(he.LinkDragEnd,e,t,null,{x:e.x,y:e.y});this.eventStore.emit(he.LinkDragEnd,e,t,r,{x:e.x,y:e.y})}function $m(e){e.links=e.links.filter(t=>{const n=typeof t.source=="string"?e.nodes.find(o=>o.id===t.source):e.nodes.find(o=>o.id===t.source.id),r=typeof t.target=="string"?e.nodes.find(o=>o.id===t.target):e.nodes.find(o=>o.id===t.target.id);return!(!n||!r)}),e.nodes.forEach(t=>{const n=[];e.links.forEach(o=>{(o.source==t.id||o.source.id==t.id)&&n.push(o)});const r={};n.forEach(o=>{if(typeof o.target=="object"){const i=typeof o.target=="string"?o.target:o.target.id;r[i]||(r[i]=[]),r[i].push(o)}else r[o.target]||(r[o.target]=[]),r[o.target].push(o)}),Object.keys(r).forEach(o=>{r[o].forEach((i,a)=>{i.i=a}),r[o].sort((i,a)=>{var s,l;return((s=i.index)!=null?s:0)-((l=a.index)!=null?l:0)})})})}async function xm(e){await Em.bind(this)(e),e.nodes.forEach(n=>{n.forceSimulation=this}),km(e.nodes);const t=this.selectionGroups.nodes.selectAll("[data-object='node']").data(e.nodes,n=>n.id);t.enter().append(sa.bind(this)).attr("data-object","node").style("pointer-events","fill").call(mm.bind(this)()).on("click",(n,r)=>{this.eventStore.emit(he.NodeClick,n,r),n.stopPropagation()}).on("dblclick",(n,r)=>{this.eventStore.emit(he.NodeDoubleClick,n,r),n.stopPropagation()}).on("contextmenu",(n,r)=>{this.eventStore.emit(he.NodeContextMenu,n,r),n.stopPropagation()}).attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).each(n=>{this.nodeDataStore.remove(n.id)}).remove(),t.each(n=>{t.filter(r=>r.id===n.id).select(sa)}).attr("opacity",1)}function bm(e){const t=this.selectionGroups.links.selectAll("[data-object='link']").data(e.links,r=>fn(r)),n=t.enter().append("g").attr("data-object","link").attr("data-id",r=>fn(r)).classed("gly-link",!0).on("click",(r,o)=>{this.eventStore.emit(he.LinkClick,r,o),r.stopPropagation()}).on("dblclick",(r,o)=>{this.eventStore.emit(he.LinkDoubleClick,r,o),r.stopPropagation()}).on("contextmenu",(r,o)=>{this.eventStore.emit(he.LinkContextMenu,r,o),r.stopPropagation()});n.append("path").attr("data-object","link-line-full").attr("fill","none").attr("stroke","none"),n.append("path").attr("id",r=>`link-path-${fn(r)}`).attr("data-object","link-line").classed("gly-link-line",!0).classed("solid",r=>r.type?r.type===xe.Solid:!0).classed("dashed",r=>r.type===xe.Dashed).classed("dotted",r=>r.type===xe.Dotted).classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),n.append("path").attr("data-object","link-arrow-head").classed("gly-link-arrow",!0).classed("gly-link-arrow-head",!0).classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),n.append("path").attr("data-object","link-arrow-tail").classed("gly-link-arrow",!0).classed("gly-link-arrow-tail",!0).classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),n.append("text").attr("data-object","link-label").classed("gly-link-label",!0).attr("text-anchor","middle").attr("dy","-0.5em").attr("dominant-baseline","central").append("textPath").attr("data-object","link-label-path").attr("xlink:href",r=>`#link-path-${fn(r)}`).attr("startOffset","50%").text(r=>{var o;return r.type!==xe.Hidden&&(o=r.label)!=null?o:""}),n.attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).remove(),t.attr("opacity",1),t.select("[data-object='link-line']").classed("solid",r=>r.type?r.type===xe.Solid:!0).classed("dashed",r=>r.type===xe.Dashed).classed("dotted",r=>r.type===xe.Dotted).classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),t.select("[data-object='link-arrow-head']").classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),t.select("[data-object='link-arrow-tail']").classed("hidden",r=>r.type===xe.Hidden).style("stroke-width",r=>{var o;return(o=r.width)!=null?o:null}),t.select("[data-object='link-label-path']").text(r=>{var o;return r.type!==xe.Hidden&&(o=r.label)!=null?o:""})}async function Em(e){for(let t in e.nodes){const n=e.nodes[t];await this.templateStore.get(n).then(r=>{n.shape.template=r})}}function km(e){var t,n,r,o,i,a,s,l,c,u,f,y;for(let m of e){if(m.x||m.y||m.fx||m.fy||((t=m.anchor)==null?void 0:t.x)||((n=m.anchor)==null?void 0:n.y)||((r=m.satellite)==null?void 0:r.x)||((o=m.satellite)==null?void 0:o.y))continue;if(m.spawn){const g=typeof m.spawn.source=="string"?m.spawn.source:m.spawn.source.id,h=e.find(E=>E.id===g),x={x:(l=(s=(i=h==null?void 0:h.x)!=null?i:h==null?void 0:h.fx)!=null?s:(a=h==null?void 0:h.anchor)==null?void 0:a.x)!=null?l:0,y:(y=(f=(c=h==null?void 0:h.y)!=null?c:h==null?void 0:h.fy)!=null?f:(u=h==null?void 0:h.anchor)==null?void 0:u.y)!=null?y:0},S=m.spawn.distance,v=m.spawn.angle,A={x:x.x+S*Math.cos(v*Math.PI/180-Math.PI/2),y:x.y+S*Math.sin(v*Math.PI/180-Math.PI/2)};m.x=A.x,m.y=A.y;continue}const{x:w,y:_}=Ns(e);m.x=w,m.y=_}}function Ns(e,t={x:0,y:0}){return e.find(n=>n.x===t.x&&n.y===t.y)?Ns(e,{x:t.x+1,y:t.y}):t}function fn(e){return e.id||(e.id=Math.random().toString(36).substring(2,34)+Math.random().toString(36).substring(2,34)),e.id?e.id:(typeof e.source=="string"?e.source:e.source.id)+(typeof e.target=="string"?e.target:e.target.id)+e.type+e.directed+e.label+e.strength}var no=(e=>(e.Head="head",e.Tail="tail",e))(no||{});function Sm(e){const t=Cs(e),n=Ts(e),r=ro(t,n,oo(e,t,n,.1)),o={start:t,center:r,end:n};if(o)return`M ${o.start.x} ${o.start.y}Q ${o.center.x}, ${o.center.y} ${o.end.x} ${o.end.y}`}function Pm(e){var t;const n=ii(e,(t=e.padding)!=null?t:10);if(!n)return;const r=n.start.x>n.end.x,o={x:r?n.end.x:n.start.x,y:r?n.end.y:n.start.y},i={x:r?n.start.x:n.end.x,y:r?n.start.y:n.end.y};return`M ${o.x} ${o.y}Q ${n.center.x}, ${n.center.y} ${i.x} ${i.y}`}function ca(e,t="head"){var n;if(!e.directed)return"";const r=ii(e,(n=e.padding)!=null?n:10);if(!r)return;const o=Math.atan2(r.end.y-r.center.y,r.end.x-r.center.x),i=10,a={x:r.end.x+i*Math.cos(o+Math.PI/2),y:r.end.y+i*Math.sin(o+Math.PI/2)},s={x:r.end.x+i*Math.cos(o),y:r.end.y+i*Math.sin(o)},l={x:r.end.x+i*Math.cos(o-Math.PI/2),y:r.end.y+i*Math.sin(o-Math.PI/2)};return`M ${a.x} ${a.y}L ${s.x} ${s.y}L ${l.x} ${l.y}`}function Nm(e){var t;const n=ii(e,(t=e.padding)!=null?t:10);if(n)return n.start.x>n.end.x?"0.5em":"-0.5em"}function Cs(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:As(e.target,e.source)}function Ts(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:As(e.source,e.target)}function Cm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ro(e,t,n){var r,o;const i=Cm(e,t);return{x:i.x+((r=n==null?void 0:n.x)!=null?r:0),y:i.y-((o=n==null?void 0:n.y)!=null?o:0)}}function oo(e,t,n,r){var o;const i=Tm(t,n),a=Am(t,n),s=jm(i,a),l=e.curvature!==void 0?e.curvature:r,c=e.curvature!==void 0?1:((o=e.i)!=null?o:0)+1,u=l*(a/s)*s*c,f=l*(i/s)*s*c;return{x:u,y:f}}function Tm(e,t){return t.x-e.x}function Am(e,t){return t.y-e.y}function jm(e,t){return Math.sqrt(e*e+t*t)}function As(e,t){var n,r,o,i,a,s,l,c;const u=((n=t.x)!=null?n:0)-((r=e.x)!=null?r:0),f=((o=t.y)!=null?o:0)-((i=e.y)!=null?i:0);return Math.sqrt(u*u+f*f)===0?{x:(a=e.x)!=null?a:0,y:(s=e.y)!=null?s:0}:{x:u+((l=e.x)!=null?l:0),y:f+((c=e.y)!=null?c:0)}}function ii(e,t=0){var n,r,o,i,a,s,l,c,u,f,y,m;const w=Cs(e),_=Ts(e),g=oo(e,w,_,.1);if(typeof e.source=="string"||typeof e.target=="string")return{start:w,end:_,center:g};const h=ro({x:(n=e.source.x)!=null?n:0,y:(r=e.source.y)!=null?r:0},{x:(o=e.target.x)!=null?o:0,y:(i=e.target.y)!=null?i:0},g),x=e.directed?20:0,S=Ae("g").append("path").attr("d",`M ${w.x} ${w.y}Q ${h.x}, ${h.y} ${_.x} ${_.y}`).node();if(!S)return{start:w,end:_,center:g};const v=e.source.shape.failed?(a=e.source.forceSimulation)==null?void 0:a.templateStore.errorTemplate.shapeSize:(l=(s=e.source.shape.template)==null?void 0:s.shapeSize)!=null?l:300,A=e.target.shape.failed?(c=e.target.forceSimulation)==null?void 0:c.templateStore.errorTemplate.shapeSize:(f=(u=e.target.shape.template)==null?void 0:u.shapeSize)!=null?f:300,E=ua(e.source,e.target,e,!1),P=ua(e.source,e.target,e,!0),j=E||((y=e.source.shape.scale)!=null?y:1)*((v!=null?v:300)/2),L=P||((m=e.target.shape.scale)!=null?m:1)*((A!=null?A:300)/2),U=S.getAttribute("d").includes("NaN")?0:S.getPointAtLength(j+t),X=S.getAttribute("d").includes("NaN")?0:S.getPointAtLength(S.getTotalLength()-L-t-x),Z=oo(e,U,X,.1),ee=ro(U,X,Z);return{start:{x:U.x,y:U.y},center:{x:ee.x,y:ee.y},end:{x:X.x,y:X.y}}}function ua(e,t,n,r=!1){var o,i,a,s,l,c,u,f,y,m,w,_,g,h,x,S,v,A,E,P,j,L;const U=Ee("[data-id='"+fn(n)+"']").select("[data-object='link-line-full']").node();if(!U||!U.getPointAtLength||U.getAttribute("d").includes("NaN"))return 0;const X=r?(o=t.shape.bodyPoints)!=null?o:[]:(i=e.shape.bodyPoints)!=null?i:[];if(X.length===0)return 0;const Z=U.getTotalLength(),ee=r?-(((s=(a=t.shape.template)==null?void 0:a.shapeSize)!=null?s:300)*((l=t.shape.scale)!=null?l:1))/20:((u=(c=e.shape.template)==null?void 0:c.shapeSize)!=null?u:300)*((f=e.shape.scale)!=null?f:1)/20;let C=r?Z:0,V=U.getPointAtLength(C),z={x:0,y:0};r?z={x:V.x-((w=t.x)!=null?w:0),y:V.y-((_=t.y)!=null?_:0)}:z={x:V.x-((y=e.x)!=null?y:0),y:V.y-((m=e.y)!=null?m:0)};let H=0;for(;io(z,X)&&C<=Z&&H<30;)H++,C+=ee,V=U.getPointAtLength(C),r?z={x:V.x-((x=t.x)!=null?x:0),y:V.y-((S=t.y)!=null?S:0)}:z={x:V.x-((g=e.x)!=null?g:0),y:V.y-((h=e.y)!=null?h:0)};for(H=0;!io(z,X)&&C>=0&&H<30;)H++,C=r?C+1:C-1,V=U.getPointAtLength(C),r?z={x:V.x-((E=t.x)!=null?E:0),y:V.y-((P=t.y)!=null?P:0)}:z={x:V.x-((v=e.x)!=null?v:0),y:V.y-((A=e.y)!=null?A:0)};const G=r?((j=t.shape.scale)!=null?j:1)/((L=e.shape.scale)!=null?L:1):1;return(r?Z-C:C)*G}function io(e,t){for(var n=!1,r=0,o=t.length-1;r<t.length;o=r++){var i=t[r].x,a=t[r].y,s=t[o].x,l=t[o].y,c=a>e.y!=l>e.y&&e.x<(s-i)*(e.y-a)/(l-a)+i;c&&(n=!n)}return n}function ha(e){return Dh().id(t=>t.id).strength(t=>{if(t.strength===void 0)return .3;if(typeof t.strength=="number")return t.strength;switch(t.strength){case Wn.Strong:return .5;case Wn.Weak:return .3;case Wn.Loose:return 0;default:return .3}}).distance(e)}function Om(){return Gh().x(e=>gr(e).x).strength(e=>vr(e))}function Mm(){return Bh().y(e=>gr(e).y).strength(e=>vr(e))}function fa(e){return Kh().strength(t=>t.gravity?t.gravity:e)}function gr(e){var t,n,r,o;return e.satellite?{x:(t=e.satellite.x)!=null?t:0,y:(n=e.satellite.y)!=null?n:0}:e.anchor?{x:(r=e.anchor.x)!=null?r:0,y:(o=e.anchor.y)!=null?o:0}:{x:0,y:0}}function vr(e){if(e.satellite)return 6;if(e.anchor)switch(e.anchor.type){case ur.Hard:case ur.Soft:return 2;default:return 0}return 0}function Rm(e){const t=this.graph.nodes;var n=mo().x(r=>r.x).y(r=>r.y).addAll(t);t.forEach(r=>{var o,i;r.x=r.x||0,r.y=r.y||0;var a=((i=(o=r.shape.template)==null?void 0:o.shapeSize)!=null?i:300)*r.shape.scale,s=r.x-a,l=r.x+a,c=r.y-a,u=r.y+a;n.visit((f,y,m,w,_)=>{var g,h,x,S,v,A;if(f.data&&f.data!==r){var E=((g=r.x)!=null?g:0)-f.data.x,P=((h=r.y)!=null?h:0)-f.data.y,j=Math.sqrt(E*E+P*P);const L=((S=(x=r.shape.template)==null?void 0:x.shapeSize)!=null?S:300)*r.shape.scale;Dm(r,f.data)&&(((v=r.shape.bodyPoints)==null?void 0:v.length)==0||((A=f.data.shape.bodyPoints)==null?void 0:A.length)==0?j<L&&(j=(j-L)/j*e,r.x=r.x||0,r.y=r.y||0,r.x-=E*=j,r.y-=P*=j,f.data.x+=E,f.data.y+=P):Im(r,f.data)&&(j=(j-L)/j*e,r.x=r.x||0,r.y=r.y||0,r.x-=E*=j,r.y-=P*=j,f.data.x+=E,f.data.y+=P))}return y>l||w<s||m>u||_<c})})}function Dm(e,t){var n,r,o,i,a,s,l,c,u,f;const y={x:(n=e.x)!=null?n:0,y:(r=e.y)!=null?r:0},m=((a=(i=(o=e.shape)==null?void 0:o.template)==null?void 0:i.shapeSize)!=null?a:300)/2*(e.shape.scale*1.5),w={x:(s=t.x)!=null?s:0,y:(l=t.y)!=null?l:0},_=((f=(u=(c=t.shape)==null?void 0:c.template)==null?void 0:u.shapeSize)!=null?f:300)/2*(t.shape.scale*1.5);return Math.sqrt(Math.pow(y.x-w.x,2)+Math.pow(y.y-w.y,2))<m+_}function Im(e,t){var n,r;const o=((n=e.shape.bodyPoints)!=null?n:[]).map(a=>{var s,l;return{x:a.x-((s=e.x)!=null?s:0),y:a.y-((l=e.y)!=null?l:0)}}),i=((r=t.shape.bodyPoints)!=null?r:[]).map(a=>{var s,l;return{x:a.x-((s=t.x)!=null?s:0),y:a.y-((l=t.y)!=null?l:0)}});for(let a=0;a<o.length;a++){const s={x:o[a].x,y:o[a].y};if(io(s,i))return!0}return!1}function zm(){for(let e in this.graph.nodes)this.graph.nodes[e].isDraged||(Vm(this.graph,this.graph.nodes[e]),Fm(this.graph.nodes[e]));this.selectionGroups.nodes.selectAll("[data-object='node']").attr("transform",e=>{var t,n;return`translate(${(t=e.x)!=null?t:0},${(n=e.y)!=null?n:0})`}),this.selectionGroups.links.selectAll("[data-object='link']").call(e=>{e.select("[data-object='link-line-full']").attr("d",Sm),e.select("[data-object='link-line']").attr("d",Pm),e.select("[data-object='link-arrow-head']").attr("d",t=>ca(t,no.Head)),e.select("[data-object='link-arrow-tail']").attr("d",t=>ca(t,no.Tail)),e.select("[data-object='link-label']").attr("dy",Nm)}),this.simulation.force("forceX").x(e=>gr(e).x).strength(e=>vr(e)),this.simulation.force("forceY").y(e=>gr(e).y).strength(e=>vr(e)),this.eventStore.emit(he.SimulationTick)}function Vm(e,t){var n,r,o,i,a,s,l,c;if(!t.satellite)return;if(typeof t.satellite.source=="string"){const m=e.nodes.find(w=>w.id===t.satellite.source);if(!m)return;t.satellite.source=m}const u=(n=t.satellite.distance)!=null?n:400,f=(r=t.satellite.angle)!=null?r:0,y={x:((a=(i=(o=t.satellite)==null?void 0:o.source)==null?void 0:i.x)!=null?a:0)+u*Math.cos(f*Math.PI/180-Math.PI/2),y:((c=(l=(s=t.satellite)==null?void 0:s.source)==null?void 0:l.y)!=null?c:0)+u*Math.sin(f*Math.PI/180-Math.PI/2)};t.satellite.x=y.x,t.satellite.y=y.y}function Fm(e){e.satellite||!e.anchor||(e.fx=null,e.fy=null,e.anchor.type===ur.Hard&&(e.fx=e.anchor.x,e.fy=e.anchor.y))}function da(){const e=ef().extent([[0,0],[this.svgElement.clientWidth,this.svgElement.clientHeight]]).scaleExtent([.1,3]).on("zoom",({transform:t})=>js.bind(this)(t));return this.svgSelection.call(e).call(e.transform,xr.translate(this.worldTransform.x,this.worldTransform.y).scale(this.worldTransform.k)),this.svgSelection.on("dblclick.zoom",null),e}function js(e){if(this.selectionGroups.world.attr("transform",`translate(${e.x}, ${e.y}) scale(${e.k})`),this.worldTransform.k!=e.k){const t=[this.worldTransform.k,e.k].sort();Object.keys(this.onZoomRoutines).forEach(n=>{const r=parseFloat(n);r>t[0]&&r<t[1]&&this.onZoomRoutines[r].forEach(o=>o(e.k))})}this.worldTransform=e,this.eventStore.emit(he.EnvironmentMove,e)}function Lm(e,t){if(e.transform)return Os.bind(this)(e.transform,t,e.duration);const n=[];e.boundaries&&n.push(pa(e.boundaries)),e.nodes&&n.push(qm(e.nodes)),Hm.bind(this)(pa(n),t,e.duration,e.padding)}function pa(e){let t=e.reduce((i,a)=>Math.min(i,a.x),1/0),n=e.reduce((i,a)=>Math.min(i,a.y),1/0),r=e.reduce((i,a)=>Math.max(i,a.x+a.width),-1/0),o=e.reduce((i,a)=>Math.max(i,a.y+a.height),-1/0);return{x:t,y:n,width:r-t,height:o-n}}function qm(e){var t,n,r,o,i,a,s;const l=gi(e,m=>m.x),c=gi(e,m=>m.y),u=((t=l[1])!=null?t:0)-((n=l[0])!=null?n:0),f=((r=c[1])!=null?r:0)-((o=c[0])!=null?o:0),y=(i=Gs(e.map(m=>{var w,_;return m.shape.scale*((_=(w=m.shape.template)==null?void 0:w.shapeSize)!=null?_:300)})))!=null?i:0;return{x:((a=l[0])!=null?a:0)-y/2,y:((s=c[0])!=null?s:0)-y/2,width:u+y,height:f+y}}function Os(e,t,n){const r=this.svgElement.clientWidth,o=this.svgElement.clientHeight,i={x:r/2,y:o/2},a={x:-e.x+r/2*(1-e.k)*(e.x/(r/2))+i.x,y:-e.y+o/2*(1-e.k)*(e.y/(o/2))+i.y,k:e.k};Um.bind(this)(a,t,n)}function Hm(e,t,n,r){const o=this.svgElement.clientWidth,i=this.svgElement.clientHeight,a=o/i,s=(e.width+(r!=null?r:0)*2)/(e.height+(r!=null?r:0)*2),l=a<s?o/(e.width+(r!=null?r:0)*2):i/(e.height+(r!=null?r:0)*2),c={x:e.x+e.width/2,y:e.y+e.height/2,k:l};Os.bind(this)(c,t,n)}function Um(e,t,n){isNaN(e.x)||isNaN(e.y)||isNaN(e.k)||this.selectionGroups.world.transition().duration(n!=null?n:1e3).ease(mh).attr("transform",`translate(${e.x},${e.y}) scale(${e.k})`).on("end",()=>{t(e)})}function Km(){const e=[],t=[];return this.graph.nodes.forEach(n=>{var r,o,i,a,s,l,c,u;const f={id:n.id,x:n.x,y:n.y,shape:{type:n.shape.type,scale:n.shape.scale,url:n.shape.url},gravity:n.gravity,anchor:{type:((r=n.anchor)==null?void 0:r.type)||"",x:((o=n.anchor)==null?void 0:o.x)||0,y:((i=n.anchor)==null?void 0:i.y)||0},satellite:{source:typeof((a=n.satellite)==null?void 0:a.source)=="string"?n.satellite.source:((l=(s=n.satellite)==null?void 0:s.source)==null?void 0:l.id)||"",angle:((c=n.satellite)==null?void 0:c.angle)||0,distance:((u=n.satellite)==null?void 0:u.distance)||0},payload:n.payload};e.push(f)}),this.graph.links.forEach(n=>{const r={source:typeof n.source=="string"?n.source:n.source.id,target:typeof n.target=="string"?n.target:n.target.id,id:n.id,type:n.type,directed:n.directed,label:n.label,strength:n.strength,padding:n.padding,width:n.width,curvature:n.curvature,payload:n.payload};t.push(r)}),{nodes:e,links:t}}class Bm{constructor(t){de(this,"debug",{enabled:!1,bodyPoints:{enabled:!0,color:"#00ffff"}}),de(this,"_svgElement"),de(this,"_svgSelection"),de(this,"_simulation"),de(this,"_selectedNodes",[]),de(this,"_zoom"),de(this,"worldTransform",{x:0,y:0,k:1}),de(this,"_onZoomRegister",[]),de(this,"_onZoomRoutines",{}),de(this,"animationDuration",300),de(this,"draggableNodes",!0),de(this,"selectionGroups"),de(this,"graph",{nodes:[],links:[]}),de(this,"templateStore",new $f),de(this,"nodeDataStore",new xf),de(this,"eventStore",new Ps),t instanceof SVGElement?(this._svgElement=t,this._svgSelection=Ee(t)):(this._svgSelection=t,this._svgElement=t.node()),this.worldTransform={x:this.svgElement.clientWidth/2,y:this.svgElement.clientHeight/2,k:1},this._simulation=this.createSimulation(),this.selectionGroups=this.createWorld(),this._zoom=da.bind(this)(),this.setEvents()}get svgElement(){return this._svgElement}set svgElement(t){this._svgElement=t,this._svgSelection=Ee(t),this.selectionGroups=this.createWorld(),this._zoom=da.bind(this)(),this.setEvents(),this.render(this.graph)}get svgSelection(){return this._svgSelection}get simulation(){return this._simulation}get selectedNodes(){return this._selectedNodes}set selectedNodes(t){this._selectedNodes=t,this.selectNodes()}get worldBounds(){const{x:t,y:n,k:r}=this.worldTransform;return{x:-(t/r),y:-(n/r),width:this.svgElement.clientWidth/r,height:this.svgElement.clientHeight/r}}set zoomScaleExtent(t){this._zoom.scaleExtent(t)}set zoomEnabled(t){this._zoom.on("zoom",null),t&&this._zoom.on("zoom",({transform:n})=>js.bind(this)(n))}get onZoomRegister(){return this._onZoomRegister}get onZoomRoutines(){return this._onZoomRoutines}set envGravity(t){this.simulation.force("gravity",fa(t))}set linkDistance(t){this.simulation.force("link",ha(t))}createSimulation(){return Uh().force("link",ha(400)).force("forceX",Om()).force("forceY",Mm()).force("gravity",fa(-1e4)).force("shapeCollide",Rm.bind(this)).on("tick",zm.bind(this)).on("end",()=>{this.eventStore.emit(he.SimulationTickEnd)})}createWorld(){const t=this.svgSelection.append("g").attr("data-object","world"),n=t.append("g").attr("data-object","links"),r=t.append("g").attr("data-object","nodes");return{world:t,nodes:r,links:n}}setEvents(){function t(n){return{x:this.worldBounds.x+n.offsetX/this.worldTransform.k,y:this.worldBounds.y+n.offsetY/this.worldTransform.k}}this.svgSelection.on("click",n=>this.eventStore.emit(he.EnvironmentClick,n,t.bind(this)(n))),this.svgSelection.on("dblclick",n=>this.eventStore.emit(he.EnvironmentDoubleClick,n,t.bind(this)(n))),this.svgSelection.on("contextmenu",n=>this.eventStore.emit(he.EnvironmentContextMenu,n,t.bind(this)(n)))}registerOnZoom(t,n,r){this.deregisterOnZoom(t),this._onZoomRegister.push({id:t,threshold:n,callback:r}),this.createOnZoomRoutines()}deregisterOnZoom(t){this._onZoomRegister=this._onZoomRegister.filter(({id:n})=>n!==t)}createOnZoomRoutines(){this._onZoomRoutines={},this._onZoomRegister.forEach(t=>{this._onZoomRoutines[t.threshold]||(this._onZoomRoutines[t.threshold]=[]),this._onZoomRoutines[t.threshold].push(t.callback)})}selectNodes(){this.selectionGroups.nodes.selectAll(".gly-selectable").classed("gly-selected",!1),this.selectionGroups.nodes.selectAll("[data-object='node']").filter(t=>this.selectedNodes.includes(t.id)).selectAll(".gly-selectable").classed("gly-selected",!0)}async render(t,n=.05,r=!1){r&&(this.nodeDataStore.clear(),this.selectionGroups.nodes.selectAll("*").remove(),this.selectionGroups.links.selectAll("*").remove()),this.graph=t,await xm.bind(this)(this.graph).then(()=>{$m(t),bm.bind(this)(this.graph),this.simulation.nodes(this.graph.nodes),this.simulation.force("link").links(t.links),this.simulation.alphaTarget(n).restart(),setTimeout(()=>{this.simulation.alphaTarget(0)},100),this._onZoomRegister.forEach(o=>o.callback(this.worldTransform.k)),this.selectNodes()})}exportGraph(){return Km.bind(this)()}moveTo(t){Lm.bind(this)(t,n=>{this.svgSelection.call(this._zoom.transform,xr.translate(n.x,n.y).scale(n.k))})}on(t,n){this.eventStore.on(t,n)}}export{ur as AnchorType,he as Event,Bm as ForceSimulation,Wn as LinkStrength,xe as LinkType,Fi as TemplateAPI};
