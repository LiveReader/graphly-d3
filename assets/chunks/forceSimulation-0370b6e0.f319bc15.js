import{g as Ys}from"../app.a4372555.js";function bo(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}function Ws(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}var Js={value:()=>{}};function Nn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Wn(n)}function Wn(e){this._=e}function Qs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Wn.prototype=Nn.prototype={constructor:Wn,on:function(e,t){var n=this._,r=Qs(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=ec(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=So(n[i],e.name,t);else if(t==null)for(i in n)n[i]=So(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Wn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function ec(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function So(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Js,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Kr="http://www.w3.org/1999/xhtml";const Eo={svg:"http://www.w3.org/2000/svg",xhtml:Kr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Pr(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Eo.hasOwnProperty(t)?{space:Eo[t],local:e}:e}function tc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Kr&&t.documentElement.namespaceURI===Kr?t.createElement(e):t.createElementNS(n,e)}}function nc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _a(e){var t=Pr(e);return(t.local?nc:tc)(t)}function rc(){}function li(e){return e==null?rc:function(){return this.querySelector(e)}}function ic(e){typeof e!="function"&&(e=li(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),c,u,l=0;l<a;++l)(c=o[l])&&(u=e.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),s[l]=u);return new De(r,this._parents)}function oc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ac(){return[]}function $a(e){return e==null?ac:function(){return this.querySelectorAll(e)}}function sc(e){return function(){return oc(e.apply(this,arguments))}}function cc(e){typeof e=="function"?e=sc(e):e=$a(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&(r.push(e.call(c,c.__data__,u,a)),i.push(c));return new De(r,i)}function wa(e){return function(){return this.matches(e)}}function ba(e){return function(t){return t.matches(e)}}var uc=Array.prototype.find;function lc(e){return function(){return uc.call(this.children,e)}}function fc(){return this.firstElementChild}function hc(e){return this.select(e==null?fc:lc(typeof e=="function"?e:ba(e)))}var dc=Array.prototype.filter;function pc(){return Array.from(this.children)}function mc(e){return function(){return dc.call(this.children,e)}}function yc(e){return this.selectAll(e==null?pc:mc(typeof e=="function"?e:ba(e)))}function gc(e){typeof e!="function"&&(e=wa(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],c,u=0;u<a;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&s.push(c);return new De(r,this._parents)}function Sa(e){return new Array(e.length)}function vc(){return new De(this._enter||this._groups.map(Sa),this._parents)}function sr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}sr.prototype={constructor:sr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function _c(e){return function(){return e}}function $c(e,t,n,r,i,o){for(var a=0,s,c=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new sr(e,o[a]);for(;a<c;++a)(s=t[a])&&(i[a]=s)}function wc(e,t,n,r,i,o,a){var s,c,u=new Map,l=t.length,f=o.length,m=new Array(l),p;for(s=0;s<l;++s)(c=t[s])&&(m[s]=p=a.call(c,c.__data__,s,t)+"",u.has(p)?i[s]=c:u.set(p,c));for(s=0;s<f;++s)p=a.call(e,o[s],s,o)+"",(c=u.get(p))?(r[s]=c,c.__data__=o[s],u.delete(p)):n[s]=new sr(e,o[s]);for(s=0;s<l;++s)(c=t[s])&&u.get(m[s])===c&&(i[s]=c)}function bc(e){return e.__data__}function Sc(e,t){if(!arguments.length)return Array.from(this,bc);var n=t?wc:$c,r=this._parents,i=this._groups;typeof e!="function"&&(e=_c(e));for(var o=i.length,a=new Array(o),s=new Array(o),c=new Array(o),u=0;u<o;++u){var l=r[u],f=i[u],m=f.length,p=Ec(e.call(l,l&&l.__data__,u,r)),$=p.length,v=s[u]=new Array($),y=a[u]=new Array($),h=c[u]=new Array(m);n(l,f,v,y,h,p,t);for(var w=0,x=0,_,O;w<$;++w)if(_=v[w]){for(w>=x&&(x=w+1);!(O=y[x])&&++x<$;);_._next=O||null}}return a=new De(a,r),a._enter=s,a._exit=c,a}function Ec(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xc(){return new De(this._exit||this._groups.map(Sa),this._parents)}function Pc(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Nc(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),c=0;c<a;++c)for(var u=n[c],l=r[c],f=u.length,m=s[c]=new Array(f),p,$=0;$<f;++$)(p=u[$]||l[$])&&(m[$]=p);for(;c<i;++c)s[c]=n[c];return new De(s,this._parents)}function kc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Tc(e){e||(e=Cc);function t(f,m){return f&&m?e(f.__data__,m.__data__):!f-!m}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,c=i[o]=new Array(s),u,l=0;l<s;++l)(u=a[l])&&(c[l]=u);c.sort(t)}return new De(i,this._parents).order()}function Cc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Oc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ac(){return Array.from(this)}function Mc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Rc(){let e=0;for(const t of this)++e;return e}function Ic(){return!this.node()}function Dc(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function jc(e){return function(){this.removeAttribute(e)}}function zc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Vc(e,t){return function(){this.setAttribute(e,t)}}function Fc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Lc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function qc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Hc(e,t){var n=Pr(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?zc:jc:typeof t=="function"?n.local?qc:Lc:n.local?Fc:Vc)(n,t))}function Ea(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Uc(e){return function(){this.style.removeProperty(e)}}function Kc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Gc(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Bc(e,t,n){return arguments.length>1?this.each((t==null?Uc:typeof t=="function"?Gc:Kc)(e,t,n??"")):Kt(this.node(),e)}function Kt(e,t){return e.style.getPropertyValue(t)||Ea(e).getComputedStyle(e,null).getPropertyValue(t)}function Xc(e){return function(){delete this[e]}}function Zc(e,t){return function(){this[e]=t}}function Yc(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Wc(e,t){return arguments.length>1?this.each((t==null?Xc:typeof t=="function"?Yc:Zc)(e,t)):this.node()[e]}function xa(e){return e.trim().split(/^|\s+/)}function fi(e){return e.classList||new Pa(e)}function Pa(e){this._node=e,this._names=xa(e.getAttribute("class")||"")}Pa.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Na(e,t){for(var n=fi(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function ka(e,t){for(var n=fi(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Jc(e){return function(){Na(this,e)}}function Qc(e){return function(){ka(this,e)}}function eu(e,t){return function(){(t.apply(this,arguments)?Na:ka)(this,e)}}function tu(e,t){var n=xa(e+"");if(arguments.length<2){for(var r=fi(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?eu:t?Jc:Qc)(n,t))}function nu(){this.textContent=""}function ru(e){return function(){this.textContent=e}}function iu(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ou(e){return arguments.length?this.each(e==null?nu:(typeof e=="function"?iu:ru)(e)):this.node().textContent}function au(){this.innerHTML=""}function su(e){return function(){this.innerHTML=e}}function cu(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uu(e){return arguments.length?this.each(e==null?au:(typeof e=="function"?cu:su)(e)):this.node().innerHTML}function lu(){this.nextSibling&&this.parentNode.appendChild(this)}function fu(){return this.each(lu)}function hu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function du(){return this.each(hu)}function pu(e){var t=typeof e=="function"?e:_a(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function mu(){return null}function yu(e,t){var n=typeof e=="function"?e:_a(e),r=t==null?mu:typeof t=="function"?t:li(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function gu(){var e=this.parentNode;e&&e.removeChild(this)}function vu(){return this.each(gu)}function _u(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $u(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wu(e){return this.select(e?$u:_u)}function bu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Su(e){return function(t){e.call(this,t,this.__data__)}}function Eu(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function xu(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Pu(e,t,n){return function(){var r=this.__on,i,o=Su(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Nu(e,t,n){var r=Eu(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,u=s.length,l;c<u;++c)for(i=0,l=s[c];i<o;++i)if((a=r[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=t?Pu:xu,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function Ta(e,t,n){var r=Ea(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ku(e,t){return function(){return Ta(this,e,t)}}function Tu(e,t){return function(){return Ta(this,e,t.apply(this,arguments))}}function Cu(e,t){return this.each((typeof t=="function"?Tu:ku)(e,t))}function*Ou(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Ca=[null];function De(e,t){this._groups=e,this._parents=t}function kn(){return new De([[document.documentElement]],Ca)}function Au(){return this}De.prototype=kn.prototype={constructor:De,select:ic,selectAll:cc,selectChild:hc,selectChildren:yc,filter:gc,data:Sc,enter:vc,exit:xc,join:Pc,merge:Nc,selection:Au,order:kc,sort:Tc,call:Oc,nodes:Ac,node:Mc,size:Rc,empty:Ic,each:Dc,attr:Hc,style:Bc,property:Wc,classed:tu,text:ou,html:uu,raise:fu,lower:du,append:pu,insert:yu,remove:vu,clone:wu,datum:bu,on:Nu,dispatch:Cu,[Symbol.iterator]:Ou};function Pe(e){return typeof e=="string"?new De([[document.querySelector(e)]],[document.documentElement]):new De([[e]],Ca)}function Mu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ot(e,t){if(e=Mu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ru={passive:!1},wn={capture:!0,passive:!1};function Dr(e){e.stopImmediatePropagation()}function Lt(e){e.preventDefault(),e.stopImmediatePropagation()}function Oa(e){var t=e.document.documentElement,n=Pe(e).on("dragstart.drag",Lt,wn);"onselectstart"in t?n.on("selectstart.drag",Lt,wn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Aa(e,t){var n=e.document.documentElement,r=Pe(e).on("dragstart.drag",null);t&&(r.on("click.drag",Lt,wn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Vn=e=>()=>e;function Gr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}Gr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Iu(e){return!e.ctrlKey&&!e.button}function Du(){return this.parentNode}function ju(e,t){return t??{x:e.x,y:e.y}}function zu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vu(){var e=Iu,t=Du,n=ju,r=zu,i={},o=Nn("start","drag","end"),a=0,s,c,u,l,f=0;function m(_){_.on("mousedown.drag",p).filter(r).on("touchstart.drag",y).on("touchmove.drag",h,Ru).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(_,O){if(!(l||!e.call(this,_,O))){var P=x(this,t.call(this,_,O),_,O,"mouse");P&&(Pe(_.view).on("mousemove.drag",$,wn).on("mouseup.drag",v,wn),Oa(_.view),Dr(_),u=!1,s=_.clientX,c=_.clientY,P("start",_))}}function $(_){if(Lt(_),!u){var O=_.clientX-s,P=_.clientY-c;u=O*O+P*P>f}i.mouse("drag",_)}function v(_){Pe(_.view).on("mousemove.drag mouseup.drag",null),Aa(_.view,u),Lt(_),i.mouse("end",_)}function y(_,O){if(e.call(this,_,O)){var P=_.changedTouches,k=t.call(this,_,O),R=P.length,L,K;for(L=0;L<R;++L)(K=x(this,k,_,O,P[L].identifier,P[L]))&&(Dr(_),K("start",_,P[L]))}}function h(_){var O=_.changedTouches,P=O.length,k,R;for(k=0;k<P;++k)(R=i[O[k].identifier])&&(Lt(_),R("drag",_,O[k]))}function w(_){var O=_.changedTouches,P=O.length,k,R;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),k=0;k<P;++k)(R=i[O[k].identifier])&&(Dr(_),R("end",_,O[k]))}function x(_,O,P,k,R,L){var K=o.copy(),ne=ot(L||P,O),Q,$e,C;if((C=n.call(_,new Gr("beforestart",{sourceEvent:P,target:m,identifier:R,active:a,x:ne[0],y:ne[1],dx:0,dy:0,dispatch:K}),k))!=null)return Q=C.x-ne[0]||0,$e=C.y-ne[1]||0,function q(z,H,X){var Z=ne,j;switch(z){case"start":i[R]=q,j=a++;break;case"end":delete i[R],--a;case"drag":ne=ot(X||H,O),j=a;break}K.call(z,_,new Gr(z,{sourceEvent:H,subject:C,target:m,identifier:R,active:j,x:ne[0]+Q,y:ne[1]+$e,dx:ne[0]-Z[0],dy:ne[1]-Z[1],dispatch:K}),k)}}return m.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Vn(!!_),m):e},m.container=function(_){return arguments.length?(t=typeof _=="function"?_:Vn(_),m):t},m.subject=function(_){return arguments.length?(n=typeof _=="function"?_:Vn(_),m):n},m.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:Vn(!!_),m):r},m.on=function(){var _=o.on.apply(o,arguments);return _===o?m:_},m.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,m):Math.sqrt(f)},m}function hi(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ma(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Tn(){}var bn=.7,cr=1/bn,qt="\\s*([+-]?\\d+)\\s*",Sn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",et="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fu=/^#([0-9a-f]{3,8})$/,Lu=new RegExp(`^rgb\\(${qt},${qt},${qt}\\)$`),qu=new RegExp(`^rgb\\(${et},${et},${et}\\)$`),Hu=new RegExp(`^rgba\\(${qt},${qt},${qt},${Sn}\\)$`),Uu=new RegExp(`^rgba\\(${et},${et},${et},${Sn}\\)$`),Ku=new RegExp(`^hsl\\(${Sn},${et},${et}\\)$`),Gu=new RegExp(`^hsla\\(${Sn},${et},${et},${Sn}\\)$`),xo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hi(Tn,En,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Po,formatHex:Po,formatHex8:Bu,formatHsl:Xu,formatRgb:No,toString:No});function Po(){return this.rgb().formatHex()}function Bu(){return this.rgb().formatHex8()}function Xu(){return Ra(this).formatHsl()}function No(){return this.rgb().formatRgb()}function En(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Fu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ko(t):n===3?new Me(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Fn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Fn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Lu.exec(e))?new Me(t[1],t[2],t[3],1):(t=qu.exec(e))?new Me(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Hu.exec(e))?Fn(t[1],t[2],t[3],t[4]):(t=Uu.exec(e))?Fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ku.exec(e))?Oo(t[1],t[2]/100,t[3]/100,1):(t=Gu.exec(e))?Oo(t[1],t[2]/100,t[3]/100,t[4]):xo.hasOwnProperty(e)?ko(xo[e]):e==="transparent"?new Me(NaN,NaN,NaN,0):null}function ko(e){return new Me(e>>16&255,e>>8&255,e&255,1)}function Fn(e,t,n,r){return r<=0&&(e=t=n=NaN),new Me(e,t,n,r)}function Zu(e){return e instanceof Tn||(e=En(e)),e?(e=e.rgb(),new Me(e.r,e.g,e.b,e.opacity)):new Me}function Br(e,t,n,r){return arguments.length===1?Zu(e):new Me(e,t,n,r??1)}function Me(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}hi(Me,Br,Ma(Tn,{brighter(e){return e=e==null?cr:Math.pow(cr,e),new Me(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?bn:Math.pow(bn,e),new Me(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Me(Pt(this.r),Pt(this.g),Pt(this.b),ur(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:To,formatHex:To,formatHex8:Yu,formatRgb:Co,toString:Co}));function To(){return`#${xt(this.r)}${xt(this.g)}${xt(this.b)}`}function Yu(){return`#${xt(this.r)}${xt(this.g)}${xt(this.b)}${xt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Co(){const e=ur(this.opacity);return`${e===1?"rgb(":"rgba("}${Pt(this.r)}, ${Pt(this.g)}, ${Pt(this.b)}${e===1?")":`, ${e})`}`}function ur(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Pt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xt(e){return e=Pt(e),(e<16?"0":"")+e.toString(16)}function Oo(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new qe(e,t,n,r)}function Ra(e){if(e instanceof qe)return new qe(e.h,e.s,e.l,e.opacity);if(e instanceof Tn||(e=En(e)),!e)return new qe;if(e instanceof qe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new qe(a,s,c,e.opacity)}function Wu(e,t,n,r){return arguments.length===1?Ra(e):new qe(e,t,n,r??1)}function qe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}hi(qe,Wu,Ma(Tn,{brighter(e){return e=e==null?cr:Math.pow(cr,e),new qe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?bn:Math.pow(bn,e),new qe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Me(jr(e>=240?e-240:e+120,i,r),jr(e,i,r),jr(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new qe(Ao(this.h),Ln(this.s),Ln(this.l),ur(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ur(this.opacity);return`${e===1?"hsl(":"hsla("}${Ao(this.h)}, ${Ln(this.s)*100}%, ${Ln(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ao(e){return e=(e||0)%360,e<0?e+360:e}function Ln(e){return Math.max(0,Math.min(1,e||0))}function jr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ia=e=>()=>e;function Ju(e,t){return function(n){return e+n*t}}function Qu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function el(e){return(e=+e)==1?Da:function(t,n){return n-t?Qu(t,n,e):Ia(isNaN(t)?n:t)}}function Da(e,t){var n=t-e;return n?Ju(e,n):Ia(isNaN(e)?t:e)}const Mo=function e(t){var n=el(t);function r(i,o){var a=n((i=Br(i)).r,(o=Br(o)).r),s=n(i.g,o.g),c=n(i.b,o.b),u=Da(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=c(l),i.opacity=u(l),i+""}}return r.gamma=e,r}(1);function pt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Xr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zr=new RegExp(Xr.source,"g");function tl(e){return function(){return e}}function nl(e){return function(t){return e(t)+""}}function rl(e,t){var n=Xr.lastIndex=zr.lastIndex=0,r,i,o,a=-1,s=[],c=[];for(e=e+"",t=t+"";(r=Xr.exec(e))&&(i=zr.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:pt(r,i)})),n=zr.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?nl(c[0].x):tl(t):(t=c.length,function(u){for(var l=0,f;l<t;++l)s[(f=c[l]).i]=f.x(u);return s.join("")})}var Ro=180/Math.PI,Zr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ja(e,t,n,r,i,o){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Ro,skewX:Math.atan(c)*Ro,scaleX:a,scaleY:s}}var qn;function il(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Zr:ja(t.a,t.b,t.c,t.d,t.e,t.f)}function ol(e){return e==null||(qn||(qn=document.createElementNS("http://www.w3.org/2000/svg","g")),qn.setAttribute("transform",e),!(e=qn.transform.baseVal.consolidate()))?Zr:(e=e.matrix,ja(e.a,e.b,e.c,e.d,e.e,e.f))}function za(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,l,f,m,p,$){if(u!==f||l!==m){var v=p.push("translate(",null,t,null,n);$.push({i:v-4,x:pt(u,f)},{i:v-2,x:pt(l,m)})}else(f||m)&&p.push("translate("+f+t+m+n)}function a(u,l,f,m){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),m.push({i:f.push(i(f)+"rotate(",null,r)-2,x:pt(u,l)})):l&&f.push(i(f)+"rotate("+l+r)}function s(u,l,f,m){u!==l?m.push({i:f.push(i(f)+"skewX(",null,r)-2,x:pt(u,l)}):l&&f.push(i(f)+"skewX("+l+r)}function c(u,l,f,m,p,$){if(u!==f||l!==m){var v=p.push(i(p)+"scale(",null,",",null,")");$.push({i:v-4,x:pt(u,f)},{i:v-2,x:pt(l,m)})}else(f!==1||m!==1)&&p.push(i(p)+"scale("+f+","+m+")")}return function(u,l){var f=[],m=[];return u=e(u),l=e(l),o(u.translateX,u.translateY,l.translateX,l.translateY,f,m),a(u.rotate,l.rotate,f,m),s(u.skewX,l.skewX,f,m),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,m),u=l=null,function(p){for(var $=-1,v=m.length,y;++$<v;)f[(y=m[$]).i]=y.x(p);return f.join("")}}}var al=za(il,"px, ","px)","deg)"),sl=za(ol,", ",")",")"),cl=1e-12;function Io(e){return((e=Math.exp(e))+1/e)/2}function ul(e){return((e=Math.exp(e))-1/e)/2}function ll(e){return((e=Math.exp(2*e))-1)/(e+1)}const fl=function e(t,n,r){function i(o,a){var s=o[0],c=o[1],u=o[2],l=a[0],f=a[1],m=a[2],p=l-s,$=f-c,v=p*p+$*$,y,h;if(v<cl)h=Math.log(m/u)/t,y=function(k){return[s+k*p,c+k*$,u*Math.exp(t*k*h)]};else{var w=Math.sqrt(v),x=(m*m-u*u+r*v)/(2*u*n*w),_=(m*m-u*u-r*v)/(2*m*n*w),O=Math.log(Math.sqrt(x*x+1)-x),P=Math.log(Math.sqrt(_*_+1)-_);h=(P-O)/t,y=function(k){var R=k*h,L=Io(O),K=u/(n*w)*(L*ll(t*R+O)-ul(O));return[s+K*p,c+K*$,u*L/Io(t*R+O)]}}return y.duration=h*1e3*t/Math.SQRT2,y}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,c=s*s;return e(a,s,c)},i}(Math.SQRT2,2,4);var Gt=0,fn=0,sn=0,Va=1e3,lr,hn,fr=0,Nt=0,Nr=0,xn=typeof performance=="object"&&performance.now?performance:Date,Fa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function di(){return Nt||(Fa(hl),Nt=xn.now()+Nr)}function hl(){Nt=0}function hr(){this._call=this._time=this._next=null}hr.prototype=pi.prototype={constructor:hr,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?di():+n)+(t==null?0:+t),!this._next&&hn!==this&&(hn?hn._next=this:lr=this,hn=this),this._call=e,this._time=n,Yr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yr())}};function pi(e,t,n){var r=new hr;return r.restart(e,t,n),r}function dl(){di(),++Gt;for(var e=lr,t;e;)(t=Nt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Gt}function Do(){Nt=(fr=xn.now())+Nr,Gt=fn=0;try{dl()}finally{Gt=0,ml(),Nt=0}}function pl(){var e=xn.now(),t=e-fr;t>Va&&(Nr-=t,fr=e)}function ml(){for(var e,t=lr,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:lr=n);hn=e,Yr(r)}function Yr(e){if(!Gt){fn&&(fn=clearTimeout(fn));var t=e-Nt;t>24?(e<1/0&&(fn=setTimeout(Do,e-xn.now()-Nr)),sn&&(sn=clearInterval(sn))):(sn||(fr=xn.now(),sn=setInterval(pl,Va)),Gt=1,Fa(Do))}}function jo(e,t,n){var r=new hr;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var yl=Nn("start","end","cancel","interrupt"),gl=[],La=0,zo=1,Wr=2,Jn=3,Vo=4,Jr=5,Qn=6;function kr(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;vl(e,n,{name:t,index:r,group:i,on:yl,tween:gl,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:La})}function mi(e,t){var n=Ke(e,t);if(n.state>La)throw new Error("too late; already scheduled");return n}function tt(e,t){var n=Ke(e,t);if(n.state>Jn)throw new Error("too late; already running");return n}function Ke(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vl(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=pi(o,0,n.time);function o(u){n.state=zo,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var l,f,m,p;if(n.state!==zo)return c();for(l in r)if(p=r[l],p.name===n.name){if(p.state===Jn)return jo(a);p.state===Vo?(p.state=Qn,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[l]):+l<t&&(p.state=Qn,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[l])}if(jo(function(){n.state===Jn&&(n.state=Vo,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Wr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Wr){for(n.state=Jn,i=new Array(m=n.tween.length),l=0,f=-1;l<m;++l)(p=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=p);i.length=f+1}}function s(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Jr,1),f=-1,m=i.length;++f<m;)i[f].call(e,l);n.state===Jr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Qn,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function er(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>Wr&&r.state<Jr,r.state=Qn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function _l(e){return this.each(function(){er(this,e)})}function $l(e,t){var n,r;return function(){var i=tt(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function wl(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=tt(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=s;break}c===u&&i.push(s)}o.tween=i}}function bl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ke(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?$l:wl)(n,e,t))}function yi(e,t,n){var r=e._id;return e.each(function(){var i=tt(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Ke(i,r).value[t]}}function qa(e,t){var n;return(typeof t=="number"?pt:t instanceof En?Mo:(n=En(t))?(t=n,Mo):rl)(e,t)}function Sl(e){return function(){this.removeAttribute(e)}}function El(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xl(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function Pl(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function Nl(e,t,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s)))}}function kl(e,t,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s)))}}function Tl(e,t){var n=Pr(e),r=n==="transform"?sl:qa;return this.attrTween(e,typeof t=="function"?(n.local?kl:Nl)(n,r,yi(this,"attr."+e,t)):t==null?(n.local?El:Sl)(n):(n.local?Pl:xl)(n,r,t))}function Cl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ol(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Al(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Ol(e,o)),n}return i._value=t,i}function Ml(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Cl(e,o)),n}return i._value=t,i}function Rl(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Pr(e);return this.tween(n,(r.local?Al:Ml)(r,t))}function Il(e,t){return function(){mi(this,e).delay=+t.apply(this,arguments)}}function Dl(e,t){return t=+t,function(){mi(this,e).delay=t}}function jl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Il:Dl)(t,e)):Ke(this.node(),t).delay}function zl(e,t){return function(){tt(this,e).duration=+t.apply(this,arguments)}}function Vl(e,t){return t=+t,function(){tt(this,e).duration=t}}function Fl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?zl:Vl)(t,e)):Ke(this.node(),t).duration}function Ll(e,t){if(typeof t!="function")throw new Error;return function(){tt(this,e).ease=t}}function ql(e){var t=this._id;return arguments.length?this.each(Ll(t,e)):Ke(this.node(),t).ease}function Hl(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;tt(this,e).ease=n}}function Ul(e){if(typeof e!="function")throw new Error;return this.each(Hl(this._id,e))}function Kl(e){typeof e!="function"&&(e=wa(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],c,u=0;u<a;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&s.push(c);return new lt(r,this._parents,this._name,this._id)}function Gl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c=t[s],u=n[s],l=c.length,f=a[s]=new Array(l),m,p=0;p<l;++p)(m=c[p]||u[p])&&(f[p]=m);for(;s<r;++s)a[s]=t[s];return new lt(a,this._parents,this._name,this._id)}function Bl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Xl(e,t,n){var r,i,o=Bl(t)?mi:tt;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function Zl(e,t){var n=this._id;return arguments.length<2?Ke(this.node(),n).on.on(e):this.each(Xl(n,e,t))}function Yl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Wl(){return this.on("end.remove",Yl(this._id))}function Jl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=li(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],c=s.length,u=o[a]=new Array(c),l,f,m=0;m<c;++m)(l=s[m])&&(f=e.call(l,l.__data__,m,s))&&("__data__"in l&&(f.__data__=l.__data__),u[m]=f,kr(u[m],t,n,m,u,Ke(l,n)));return new lt(o,this._parents,t,n)}function Ql(e){var t=this._name,n=this._id;typeof e!="function"&&(e=$a(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c=r[s],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var m=e.call(l,l.__data__,f,c),p,$=Ke(l,n),v=0,y=m.length;v<y;++v)(p=m[v])&&kr(p,t,n,v,m,$);o.push(m),a.push(l)}return new lt(o,a,t,n)}var ef=kn.prototype.constructor;function tf(){return new ef(this._groups,this._parents)}function nf(e,t){var n,r,i;return function(){var o=Kt(this,e),a=(this.style.removeProperty(e),Kt(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function Ha(e){return function(){this.style.removeProperty(e)}}function rf(e,t,n){var r,i=n+"",o;return function(){var a=Kt(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function of(e,t,n){var r,i,o;return function(){var a=Kt(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),Kt(this,e))),a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s))}}function af(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var c=tt(this,e),u=c.on,l=c.value[o]==null?s||(s=Ha(t)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(a,i=l),c.on=r}}function sf(e,t,n){var r=(e+="")=="transform"?al:qa;return t==null?this.styleTween(e,nf(e,r)).on("end.style."+e,Ha(e)):typeof t=="function"?this.styleTween(e,of(e,r,yi(this,"style."+e,t))).each(af(this._id,e)):this.styleTween(e,rf(e,r,t),n).on("end.style."+e,null)}function cf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function uf(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&cf(e,a,n)),r}return o._value=t,o}function lf(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,uf(e,t,n??""))}function ff(e){return function(){this.textContent=e}}function hf(e){return function(){var t=e(this);this.textContent=t??""}}function df(e){return this.tween("text",typeof e=="function"?hf(yi(this,"text",e)):ff(e==null?"":e+""))}function pf(e){return function(t){this.textContent=e.call(this,t)}}function mf(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&pf(i)),t}return r._value=e,r}function yf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,mf(e))}function gf(){for(var e=this._name,t=this._id,n=Ua(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,u=0;u<s;++u)if(c=a[u]){var l=Ke(c,t);kr(c,e,n,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new lt(r,this._parents,e,n)}function vf(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},c={value:function(){--i===0&&o()}};n.each(function(){var u=tt(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),u.on=t}),i===0&&o()})}var _f=0;function lt(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ua(){return++_f}var it=kn.prototype;lt.prototype={constructor:lt,select:Jl,selectAll:Ql,selectChild:it.selectChild,selectChildren:it.selectChildren,filter:Kl,merge:Gl,selection:tf,transition:gf,call:it.call,nodes:it.nodes,node:it.node,size:it.size,empty:it.empty,each:it.each,on:Zl,attr:Tl,attrTween:Rl,style:sf,styleTween:lf,text:df,textTween:yf,remove:Wl,tween:bl,delay:jl,duration:Fl,ease:ql,easeVarying:Ul,end:vf,[Symbol.iterator]:it[Symbol.iterator]};function $f(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var gi=3;(function e(t){t=+t;function n(r){return Math.pow(r,t)}return n.exponent=e,n})(gi);(function e(t){t=+t;function n(r){return 1-Math.pow(1-r,t)}return n.exponent=e,n})(gi);var wf=function e(t){t=+t;function n(r){return((r*=2)<=1?Math.pow(r,t):2-Math.pow(2-r,t))/2}return n.exponent=e,n}(gi),bf={time:null,delay:0,duration:250,ease:$f};function Sf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ef(e){var t,n;e instanceof lt?(t=e._id,e=e._name):(t=Ua(),(n=bf).time=di(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&kr(c,e,t,u,a,n||Sf(c,t));return new lt(r,this._parents,e,t)}kn.prototype.interrupt=_l;kn.prototype.transition=Ef;function xf(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Ka(this.cover(t,n),t,n,e)}function Ka(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,a={data:r},s=e._x0,c=e._y0,u=e._x1,l=e._y1,f,m,p,$,v,y,h,w;if(!o)return e._root=a,e;for(;o.length;)if((v=t>=(f=(s+u)/2))?s=f:u=f,(y=n>=(m=(c+l)/2))?c=m:l=m,i=o,!(o=o[h=y<<1|v]))return i[h]=a,e;if(p=+e._x.call(null,o.data),$=+e._y.call(null,o.data),t===p&&n===$)return a.next=o,i?i[h]=a:e._root=a,e;do i=i?i[h]=new Array(4):e._root=new Array(4),(v=t>=(f=(s+u)/2))?s=f:u=f,(y=n>=(m=(c+l)/2))?c=m:l=m;while((h=y<<1|v)===(w=($>=m)<<1|p>=f));return i[w]=o,i[h]=a,e}function Pf(e){var t,n,r=e.length,i,o,a=new Array(r),s=new Array(r),c=1/0,u=1/0,l=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=i,s[n]=o,i<c&&(c=i),i>l&&(l=i),o<u&&(u=o),o>f&&(f=o));if(c>l||u>f)return this;for(this.cover(c,u).cover(l,f),n=0;n<r;++n)Ka(this,a[n],s[n],e[n]);return this}function Nf(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a=i-n||1,s=this._root,c,u;n>e||e>=i||r>t||t>=o;)switch(u=(t<r)<<1|e<n,c=new Array(4),c[u]=s,s=c,a*=2,u){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function kf(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Tf(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ne(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Cf(e,t,n){var r,i=this._x0,o=this._y0,a,s,c,u,l=this._x1,f=this._y1,m=[],p=this._root,$,v;for(p&&m.push(new Ne(p,i,o,l,f)),n==null?n=1/0:(i=e-n,o=t-n,l=e+n,f=t+n,n*=n);$=m.pop();)if(!(!(p=$.node)||(a=$.x0)>l||(s=$.y0)>f||(c=$.x1)<i||(u=$.y1)<o))if(p.length){var y=(a+c)/2,h=(s+u)/2;m.push(new Ne(p[3],y,h,c,u),new Ne(p[2],a,h,y,u),new Ne(p[1],y,s,c,h),new Ne(p[0],a,s,y,h)),(v=(t>=h)<<1|e>=y)&&($=m[m.length-1],m[m.length-1]=m[m.length-1-v],m[m.length-1-v]=$)}else{var w=e-+this._x.call(null,p.data),x=t-+this._y.call(null,p.data),_=w*w+x*x;if(_<n){var O=Math.sqrt(n=_);i=e-O,o=t-O,l=e+O,f=t+O,r=p.data}}return r}function Of(e){if(isNaN(l=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,a=this._x0,s=this._y0,c=this._x1,u=this._y1,l,f,m,p,$,v,y,h;if(!n)return this;if(n.length)for(;;){if(($=l>=(m=(a+c)/2))?a=m:c=m,(v=f>=(p=(s+u)/2))?s=p:u=p,t=n,!(n=n[y=v<<1|$]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,h=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[y]=o:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[h]=n:this._root=n),this):(this._root=o,this)}function Af(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Mf(){return this._root}function Rf(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function If(e){var t=[],n,r=this._root,i,o,a,s,c;for(r&&t.push(new Ne(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,a=n.y0,s=n.x1,c=n.y1)&&r.length){var u=(o+s)/2,l=(a+c)/2;(i=r[3])&&t.push(new Ne(i,u,l,s,c)),(i=r[2])&&t.push(new Ne(i,o,l,u,c)),(i=r[1])&&t.push(new Ne(i,u,a,s,l)),(i=r[0])&&t.push(new Ne(i,o,a,u,l))}return this}function Df(e){var t=[],n=[],r;for(this._root&&t.push(new Ne(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,c=r.x1,u=r.y1,l=(a+c)/2,f=(s+u)/2;(o=i[0])&&t.push(new Ne(o,a,s,l,f)),(o=i[1])&&t.push(new Ne(o,l,s,c,f)),(o=i[2])&&t.push(new Ne(o,a,f,l,u)),(o=i[3])&&t.push(new Ne(o,l,f,c,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function jf(e){return e[0]}function zf(e){return arguments.length?(this._x=e,this):this._x}function Vf(e){return e[1]}function Ff(e){return arguments.length?(this._y=e,this):this._y}function vi(e,t,n){var r=new _i(t??jf,n??Vf,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function _i(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Fo(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Te=vi.prototype=_i.prototype;Te.copy=function(){var e=new _i(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Fo(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Fo(r));return e};Te.add=xf;Te.addAll=Pf;Te.cover=Nf;Te.data=kf;Te.extent=Tf;Te.find=Cf;Te.remove=Of;Te.removeAll=Af;Te.root=Mf;Te.size=Rf;Te.visit=If;Te.visitAfter=Df;Te.x=zf;Te.y=Ff;function Ie(e){return function(){return e}}function Ft(e){return(e()-.5)*1e-6}function Lf(e){return e.index}function Lo(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function qf(e){var t=Lf,n=f,r,i=Ie(30),o,a,s,c,u,l=1;e==null&&(e=[]);function f(y){return 1/Math.min(s[y.source.index],s[y.target.index])}function m(y){for(var h=0,w=e.length;h<l;++h)for(var x=0,_,O,P,k,R,L,K;x<w;++x)_=e[x],O=_.source,P=_.target,k=P.x+P.vx-O.x-O.vx||Ft(u),R=P.y+P.vy-O.y-O.vy||Ft(u),L=Math.sqrt(k*k+R*R),L=(L-o[x])/L*y*r[x],k*=L,R*=L,P.vx-=k*(K=c[x]),P.vy-=R*K,O.vx+=k*(K=1-K),O.vy+=R*K}function p(){if(a){var y,h=a.length,w=e.length,x=new Map(a.map((O,P)=>[t(O,P,a),O])),_;for(y=0,s=new Array(h);y<w;++y)_=e[y],_.index=y,typeof _.source!="object"&&(_.source=Lo(x,_.source)),typeof _.target!="object"&&(_.target=Lo(x,_.target)),s[_.source.index]=(s[_.source.index]||0)+1,s[_.target.index]=(s[_.target.index]||0)+1;for(y=0,c=new Array(w);y<w;++y)_=e[y],c[y]=s[_.source.index]/(s[_.source.index]+s[_.target.index]);r=new Array(w),$(),o=new Array(w),v()}}function $(){if(a)for(var y=0,h=e.length;y<h;++y)r[y]=+n(e[y],y,e)}function v(){if(a)for(var y=0,h=e.length;y<h;++y)o[y]=+i(e[y],y,e)}return m.initialize=function(y,h){a=y,u=h,p()},m.links=function(y){return arguments.length?(e=y,p(),m):e},m.id=function(y){return arguments.length?(t=y,m):t},m.iterations=function(y){return arguments.length?(l=+y,m):l},m.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Ie(+y),$(),m):n},m.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Ie(+y),v(),m):i},m}const Hf=1664525,Uf=1013904223,qo=4294967296;function Kf(){let e=1;return()=>(e=(Hf*e+Uf)%qo)/qo}function Gf(e){return e.x}function Bf(e){return e.y}var Xf=10,Zf=Math.PI*(3-Math.sqrt(5));function Yf(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,c=pi(f),u=Nn("tick","end"),l=Kf();e==null&&(e=[]);function f(){m(),u.call("tick",t),n<r&&(c.stop(),u.call("end",t))}function m(v){var y,h=e.length,w;v===void 0&&(v=1);for(var x=0;x<v;++x)for(n+=(o-n)*i,s.forEach(function(_){_(n)}),y=0;y<h;++y)w=e[y],w.fx==null?w.x+=w.vx*=a:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=a:(w.y=w.fy,w.vy=0);return t}function p(){for(var v=0,y=e.length,h;v<y;++v){if(h=e[v],h.index=v,h.fx!=null&&(h.x=h.fx),h.fy!=null&&(h.y=h.fy),isNaN(h.x)||isNaN(h.y)){var w=Xf*Math.sqrt(.5+v),x=v*Zf;h.x=w*Math.cos(x),h.y=w*Math.sin(x)}(isNaN(h.vx)||isNaN(h.vy))&&(h.vx=h.vy=0)}}function $(v){return v.initialize&&v.initialize(e,l),v}return p(),t={tick:m,restart:function(){return c.restart(f),t},stop:function(){return c.stop(),t},nodes:function(v){return arguments.length?(e=v,p(),s.forEach($),t):e},alpha:function(v){return arguments.length?(n=+v,t):n},alphaMin:function(v){return arguments.length?(r=+v,t):r},alphaDecay:function(v){return arguments.length?(i=+v,t):+i},alphaTarget:function(v){return arguments.length?(o=+v,t):o},velocityDecay:function(v){return arguments.length?(a=1-v,t):1-a},randomSource:function(v){return arguments.length?(l=v,s.forEach($),t):l},force:function(v,y){return arguments.length>1?(y==null?s.delete(v):s.set(v,$(y)),t):s.get(v)},find:function(v,y,h){var w=0,x=e.length,_,O,P,k,R;for(h==null?h=1/0:h*=h,w=0;w<x;++w)k=e[w],_=v-k.x,O=y-k.y,P=_*_+O*O,P<h&&(R=k,h=P);return R},on:function(v,y){return arguments.length>1?(u.on(v,y),t):u.on(v)}}}function Wf(){var e,t,n,r,i=Ie(-30),o,a=1,s=1/0,c=.81;function u(p){var $,v=e.length,y=vi(e,Gf,Bf).visitAfter(f);for(r=p,$=0;$<v;++$)t=e[$],y.visit(m)}function l(){if(e){var p,$=e.length,v;for(o=new Array($),p=0;p<$;++p)v=e[p],o[v.index]=+i(v,p,e)}}function f(p){var $=0,v,y,h=0,w,x,_;if(p.length){for(w=x=_=0;_<4;++_)(v=p[_])&&(y=Math.abs(v.value))&&($+=v.value,h+=y,w+=y*v.x,x+=y*v.y);p.x=w/h,p.y=x/h}else{v=p,v.x=v.data.x,v.y=v.data.y;do $+=o[v.data.index];while(v=v.next)}p.value=$}function m(p,$,v,y){if(!p.value)return!0;var h=p.x-t.x,w=p.y-t.y,x=y-$,_=h*h+w*w;if(x*x/c<_)return _<s&&(h===0&&(h=Ft(n),_+=h*h),w===0&&(w=Ft(n),_+=w*w),_<a&&(_=Math.sqrt(a*_)),t.vx+=h*p.value*r/_,t.vy+=w*p.value*r/_),!0;if(p.length||_>=s)return;(p.data!==t||p.next)&&(h===0&&(h=Ft(n),_+=h*h),w===0&&(w=Ft(n),_+=w*w),_<a&&(_=Math.sqrt(a*_)));do p.data!==t&&(x=o[p.data.index]*r/_,t.vx+=h*x,t.vy+=w*x);while(p=p.next)}return u.initialize=function(p,$){e=p,n=$,l()},u.strength=function(p){return arguments.length?(i=typeof p=="function"?p:Ie(+p),l(),u):i},u.distanceMin=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.distanceMax=function(p){return arguments.length?(s=p*p,u):Math.sqrt(s)},u.theta=function(p){return arguments.length?(c=p*p,u):Math.sqrt(c)},u}function Jf(e){var t=Ie(.1),n,r,i;typeof e!="function"&&(e=Ie(e==null?0:+e));function o(s){for(var c=0,u=n.length,l;c<u;++c)l=n[c],l.vx+=(i[c]-l.x)*r[c]*s}function a(){if(n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Ie(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Ie(+s),a(),o):e},o}function Qf(e){var t=Ie(.1),n,r,i;typeof e!="function"&&(e=Ie(e==null?0:+e));function o(s){for(var c=0,u=n.length,l;c<u;++c)l=n[c],l.vy+=(i[c]-l.y)*r[c]*s}function a(){if(n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Ie(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:Ie(+s),a(),o):e},o}const Hn=e=>()=>e;function eh(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function at(e,t,n){this.k=e,this.x=t,this.y=n}at.prototype={constructor:at,scale:function(e){return e===1?this:new at(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new at(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Tr=new at(1,0,0);at.prototype;function Vr(e){e.stopImmediatePropagation()}function cn(e){e.preventDefault(),e.stopImmediatePropagation()}function th(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function nh(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ho(){return this.__zoom||Tr}function rh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ih(){return navigator.maxTouchPoints||"ontouchstart"in this}function oh(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function ah(){var e=th,t=nh,n=oh,r=rh,i=ih,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=fl,u=Nn("start","zoom","end"),l,f,m,p=500,$=150,v=0,y=10;function h(C){C.property("__zoom",Ho).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",K).filter(i).on("touchstart.zoom",ne).on("touchmove.zoom",Q).on("touchend.zoom touchcancel.zoom",$e).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(C,q,z,H){var X=C.selection?C.selection():C;X.property("__zoom",Ho),C!==X?O(C,q,z,H):X.interrupt().each(function(){P(this,arguments).event(H).start().zoom(null,typeof q=="function"?q.apply(this,arguments):q).end()})},h.scaleBy=function(C,q,z,H){h.scaleTo(C,function(){var X=this.__zoom.k,Z=typeof q=="function"?q.apply(this,arguments):q;return X*Z},z,H)},h.scaleTo=function(C,q,z,H){h.transform(C,function(){var X=t.apply(this,arguments),Z=this.__zoom,j=z==null?_(X):typeof z=="function"?z.apply(this,arguments):z,N=Z.invert(j),D=typeof q=="function"?q.apply(this,arguments):q;return n(x(w(Z,D),j,N),X,a)},z,H)},h.translateBy=function(C,q,z,H){h.transform(C,function(){return n(this.__zoom.translate(typeof q=="function"?q.apply(this,arguments):q,typeof z=="function"?z.apply(this,arguments):z),t.apply(this,arguments),a)},null,H)},h.translateTo=function(C,q,z,H,X){h.transform(C,function(){var Z=t.apply(this,arguments),j=this.__zoom,N=H==null?_(Z):typeof H=="function"?H.apply(this,arguments):H;return n(Tr.translate(N[0],N[1]).scale(j.k).translate(typeof q=="function"?-q.apply(this,arguments):-q,typeof z=="function"?-z.apply(this,arguments):-z),Z,a)},H,X)};function w(C,q){return q=Math.max(o[0],Math.min(o[1],q)),q===C.k?C:new at(q,C.x,C.y)}function x(C,q,z){var H=q[0]-z[0]*C.k,X=q[1]-z[1]*C.k;return H===C.x&&X===C.y?C:new at(C.k,H,X)}function _(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function O(C,q,z,H){C.on("start.zoom",function(){P(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){P(this,arguments).event(H).end()}).tween("zoom",function(){var X=this,Z=arguments,j=P(X,Z).event(H),N=t.apply(X,Z),D=z==null?_(N):typeof z=="function"?z.apply(X,Z):z,T=Math.max(N[1][0]-N[0][0],N[1][1]-N[0][1]),d=X.__zoom,b=typeof q=="function"?q.apply(X,Z):q,I=c(d.invert(D).concat(T/d.k),b.invert(D).concat(T/b.k));return function(V){if(V===1)V=b;else{var F=I(V),J=T/F[2];V=new at(J,D[0]-F[0]*J,D[1]-F[1]*J)}j.zoom(null,V)}})}function P(C,q,z){return!z&&C.__zooming||new k(C,q)}function k(C,q){this.that=C,this.args=q,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,q),this.taps=0}k.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,q){return this.mouse&&C!=="mouse"&&(this.mouse[1]=q.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=q.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=q.invert(this.touch1[0])),this.that.__zoom=q,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var q=Pe(this.that).datum();u.call(C,this.that,new eh(C,{sourceEvent:this.sourceEvent,target:h,type:C,transform:this.that.__zoom,dispatch:u}),q)}};function R(C,...q){if(!e.apply(this,arguments))return;var z=P(this,q).event(C),H=this.__zoom,X=Math.max(o[0],Math.min(o[1],H.k*Math.pow(2,r.apply(this,arguments)))),Z=ot(C);if(z.wheel)(z.mouse[0][0]!==Z[0]||z.mouse[0][1]!==Z[1])&&(z.mouse[1]=H.invert(z.mouse[0]=Z)),clearTimeout(z.wheel);else{if(H.k===X)return;z.mouse=[Z,H.invert(Z)],er(this),z.start()}cn(C),z.wheel=setTimeout(j,$),z.zoom("mouse",n(x(w(H,X),z.mouse[0],z.mouse[1]),z.extent,a));function j(){z.wheel=null,z.end()}}function L(C,...q){if(m||!e.apply(this,arguments))return;var z=C.currentTarget,H=P(this,q,!0).event(C),X=Pe(C.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",T,!0),Z=ot(C,z),j=C.clientX,N=C.clientY;Oa(C.view),Vr(C),H.mouse=[Z,this.__zoom.invert(Z)],er(this),H.start();function D(d){if(cn(d),!H.moved){var b=d.clientX-j,I=d.clientY-N;H.moved=b*b+I*I>v}H.event(d).zoom("mouse",n(x(H.that.__zoom,H.mouse[0]=ot(d,z),H.mouse[1]),H.extent,a))}function T(d){X.on("mousemove.zoom mouseup.zoom",null),Aa(d.view,H.moved),cn(d),H.event(d).end()}}function K(C,...q){if(e.apply(this,arguments)){var z=this.__zoom,H=ot(C.changedTouches?C.changedTouches[0]:C,this),X=z.invert(H),Z=z.k*(C.shiftKey?.5:2),j=n(x(w(z,Z),H,X),t.apply(this,q),a);cn(C),s>0?Pe(this).transition().duration(s).call(O,j,H,C):Pe(this).call(h.transform,j,H,C)}}function ne(C,...q){if(e.apply(this,arguments)){var z=C.touches,H=z.length,X=P(this,q,C.changedTouches.length===H).event(C),Z,j,N,D;for(Vr(C),j=0;j<H;++j)N=z[j],D=ot(N,this),D=[D,this.__zoom.invert(D),N.identifier],X.touch0?!X.touch1&&X.touch0[2]!==D[2]&&(X.touch1=D,X.taps=0):(X.touch0=D,Z=!0,X.taps=1+!!l);l&&(l=clearTimeout(l)),Z&&(X.taps<2&&(f=D[0],l=setTimeout(function(){l=null},p)),er(this),X.start())}}function Q(C,...q){if(this.__zooming){var z=P(this,q).event(C),H=C.changedTouches,X=H.length,Z,j,N,D;for(cn(C),Z=0;Z<X;++Z)j=H[Z],N=ot(j,this),z.touch0&&z.touch0[2]===j.identifier?z.touch0[0]=N:z.touch1&&z.touch1[2]===j.identifier&&(z.touch1[0]=N);if(j=z.that.__zoom,z.touch1){var T=z.touch0[0],d=z.touch0[1],b=z.touch1[0],I=z.touch1[1],V=(V=b[0]-T[0])*V+(V=b[1]-T[1])*V,F=(F=I[0]-d[0])*F+(F=I[1]-d[1])*F;j=w(j,Math.sqrt(V/F)),N=[(T[0]+b[0])/2,(T[1]+b[1])/2],D=[(d[0]+I[0])/2,(d[1]+I[1])/2]}else if(z.touch0)N=z.touch0[0],D=z.touch0[1];else return;z.zoom("touch",n(x(j,N,D),z.extent,a))}}function $e(C,...q){if(this.__zooming){var z=P(this,q).event(C),H=C.changedTouches,X=H.length,Z,j;for(Vr(C),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),Z=0;Z<X;++Z)j=H[Z],z.touch0&&z.touch0[2]===j.identifier?delete z.touch0:z.touch1&&z.touch1[2]===j.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(j=ot(j,this),Math.hypot(f[0]-j[0],f[1]-j[1])<y)){var N=Pe(this).on("dblclick.zoom");N&&N.apply(this,arguments)}}}return h.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:Hn(+C),h):r},h.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Hn(!!C),h):e},h.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Hn(!!C),h):i},h.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Hn([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),h):t},h.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],h):[o[0],o[1]]},h.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],h):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},h.constrain=function(C){return arguments.length?(n=C,h):n},h.duration=function(C){return arguments.length?(s=+C,h):s},h.interpolate=function(C){return arguments.length?(c=C,h):c},h.on=function(){var C=u.on.apply(u,arguments);return C===u?h:C},h.clickDistance=function(C){return arguments.length?(v=(C=+C)*C,h):Math.sqrt(v)},h.tapDistance=function(C){return arguments.length?(y=+C,h):y},h}var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ch(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dr={},uh={get exports(){return dr},set exports(e){dr=e}},Ga={},Ue={},Bt={},Cn={},te={},Pn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends t{constructor(w){if(super(),!e.IDENTIFIER.test(w))throw new Error("CodeGen: name must be a valid identifier");this.str=w}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class r extends t{constructor(w){super(),this._items=typeof w=="string"?[w]:w}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const w=this._items[0];return w===""||w==='""'}get str(){var w;return(w=this._str)!==null&&w!==void 0?w:this._str=this._items.reduce((x,_)=>`${x}${_}`,"")}get names(){var w;return(w=this._names)!==null&&w!==void 0?w:this._names=this._items.reduce((x,_)=>(_ instanceof n&&(x[_.str]=(x[_.str]||0)+1),x),{})}}e._Code=r,e.nil=new r("");function i(h,...w){const x=[h[0]];let _=0;for(;_<w.length;)s(x,w[_]),x.push(h[++_]);return new r(x)}e._=i;const o=new r("+");function a(h,...w){const x=[p(h[0])];let _=0;for(;_<w.length;)x.push(o),s(x,w[_]),x.push(o,p(h[++_]));return c(x),new r(x)}e.str=a;function s(h,w){w instanceof r?h.push(...w._items):w instanceof n?h.push(w):h.push(f(w))}e.addCodeArg=s;function c(h){let w=1;for(;w<h.length-1;){if(h[w]===o){const x=u(h[w-1],h[w+1]);if(x!==void 0){h.splice(w-1,3,x);continue}h[w++]="+"}w++}}function u(h,w){if(w==='""')return h;if(h==='""')return w;if(typeof h=="string")return w instanceof n||h[h.length-1]!=='"'?void 0:typeof w!="string"?`${h.slice(0,-1)}${w}"`:w[0]==='"'?h.slice(0,-1)+w.slice(1):void 0;if(typeof w=="string"&&w[0]==='"'&&!(h instanceof n))return`"${h}${w.slice(1)}`}function l(h,w){return w.emptyStr()?h:h.emptyStr()?w:a`${h}${w}`}e.strConcat=l;function f(h){return typeof h=="number"||typeof h=="boolean"||h===null?h:p(Array.isArray(h)?h.join(","):h)}function m(h){return new r(p(h))}e.stringify=m;function p(h){return JSON.stringify(h).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=p;function $(h){return typeof h=="string"&&e.IDENTIFIER.test(h)?new r(`.${h}`):i`[${h}]`}e.getProperty=$;function v(h){if(typeof h=="string"&&e.IDENTIFIER.test(h))return new r(`${h}`);throw new Error(`CodeGen: invalid export name: ${h}, use explicit $id name mapping`)}e.getEsmExportName=v;function y(h){return new r(h.toString())}e.regexpCode=y})(Pn);var Qr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Pn;class n extends Error{constructor(u){super(`CodeGen: "code" for ${u} not defined`),this.value=u.value}}var r;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(r=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class i{constructor({prefixes:u,parent:l}={}){this._names={},this._prefixes=u,this._parent=l}toName(u){return u instanceof t.Name?u:this.name(u)}name(u){return new t.Name(this._newName(u))}_newName(u){const l=this._names[u]||this._nameGroup(u);return`${u}${l.index++}`}_nameGroup(u){var l,f;if(!((f=(l=this._parent)===null||l===void 0?void 0:l._prefixes)===null||f===void 0)&&f.has(u)||this._prefixes&&!this._prefixes.has(u))throw new Error(`CodeGen: prefix "${u}" is not allowed in this scope`);return this._names[u]={prefix:u,index:0}}}e.Scope=i;class o extends t.Name{constructor(u,l){super(l),this.prefix=u}setValue(u,{property:l,itemIndex:f}){this.value=u,this.scopePath=(0,t._)`.${new t.Name(l)}[${f}]`}}e.ValueScopeName=o;const a=(0,t._)`\n`;class s extends i{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?a:t.nil}}get(){return this._scope}name(u){return new o(u,this._newName(u))}value(u,l){var f;if(l.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const m=this.toName(u),{prefix:p}=m,$=(f=l.key)!==null&&f!==void 0?f:l.ref;let v=this._values[p];if(v){const w=v.get($);if(w)return w}else v=this._values[p]=new Map;v.set($,m);const y=this._scope[p]||(this._scope[p]=[]),h=y.length;return y[h]=l.ref,m.setValue(l,{property:p,itemIndex:h}),m}getValue(u,l){const f=this._values[u];if(f)return f.get(l)}scopeRefs(u,l=this._values){return this._reduceValues(l,f=>{if(f.scopePath===void 0)throw new Error(`CodeGen: name "${f}" has no value`);return(0,t._)`${u}${f.scopePath}`})}scopeCode(u=this._values,l,f){return this._reduceValues(u,m=>{if(m.value===void 0)throw new Error(`CodeGen: name "${m}" has no value`);return m.value.code},l,f)}_reduceValues(u,l,f={},m){let p=t.nil;for(const $ in u){const v=u[$];if(!v)continue;const y=f[$]=f[$]||new Map;v.forEach(h=>{if(y.has(h))return;y.set(h,r.Started);let w=l(h);if(w){const x=this.opts.es5?e.varKinds.var:e.varKinds.const;p=(0,t._)`${p}${x} ${h} = ${w};${this.opts._n}`}else if(w=m==null?void 0:m(h))p=(0,t._)`${p}${w}${this.opts._n}`;else throw new n(h);y.set(h,r.Completed)})}return p}}e.ValueScope=s})(Qr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Pn,n=Qr;var r=Pn;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var i=Qr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(d,b){return this}}class a extends o{constructor(d,b,I){super(),this.varKind=d,this.name=b,this.rhs=I}render({es5:d,_n:b}){const I=d?n.varKinds.var:this.varKind,V=this.rhs===void 0?"":` = ${this.rhs}`;return`${I} ${this.name}${V};`+b}optimizeNames(d,b){if(d[this.name.str])return this.rhs&&(this.rhs=C(this.rhs,d,b)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class s extends o{constructor(d,b,I){super(),this.lhs=d,this.rhs=b,this.sideEffects=I}render({_n:d}){return`${this.lhs} = ${this.rhs};`+d}optimizeNames(d,b){if(!(this.lhs instanceof t.Name&&!d[this.lhs.str]&&!this.sideEffects))return this.rhs=C(this.rhs,d,b),this}get names(){const d=this.lhs instanceof t.Name?{}:{...this.lhs.names};return $e(d,this.rhs)}}class c extends s{constructor(d,b,I,V){super(d,I,V),this.op=b}render({_n:d}){return`${this.lhs} ${this.op}= ${this.rhs};`+d}}class u extends o{constructor(d){super(),this.label=d,this.names={}}render({_n:d}){return`${this.label}:`+d}}class l extends o{constructor(d){super(),this.label=d,this.names={}}render({_n:d}){return`break${this.label?` ${this.label}`:""};`+d}}class f extends o{constructor(d){super(),this.error=d}render({_n:d}){return`throw ${this.error};`+d}get names(){return this.error.names}}class m extends o{constructor(d){super(),this.code=d}render({_n:d}){return`${this.code};`+d}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(d,b){return this.code=C(this.code,d,b),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class p extends o{constructor(d=[]){super(),this.nodes=d}render(d){return this.nodes.reduce((b,I)=>b+I.render(d),"")}optimizeNodes(){const{nodes:d}=this;let b=d.length;for(;b--;){const I=d[b].optimizeNodes();Array.isArray(I)?d.splice(b,1,...I):I?d[b]=I:d.splice(b,1)}return d.length>0?this:void 0}optimizeNames(d,b){const{nodes:I}=this;let V=I.length;for(;V--;){const F=I[V];F.optimizeNames(d,b)||(q(d,F.names),I.splice(V,1))}return I.length>0?this:void 0}get names(){return this.nodes.reduce((d,b)=>Q(d,b.names),{})}}class $ extends p{render(d){return"{"+d._n+super.render(d)+"}"+d._n}}class v extends p{}class y extends ${}y.kind="else";class h extends ${constructor(d,b){super(b),this.condition=d}render(d){let b=`if(${this.condition})`+super.render(d);return this.else&&(b+="else "+this.else.render(d)),b}optimizeNodes(){super.optimizeNodes();const d=this.condition;if(d===!0)return this.nodes;let b=this.else;if(b){const I=b.optimizeNodes();b=this.else=Array.isArray(I)?new y(I):I}if(b)return d===!1?b instanceof h?b:b.nodes:this.nodes.length?this:new h(z(d),b instanceof h?[b]:b.nodes);if(!(d===!1||!this.nodes.length))return this}optimizeNames(d,b){var I;if(this.else=(I=this.else)===null||I===void 0?void 0:I.optimizeNames(d,b),!!(super.optimizeNames(d,b)||this.else))return this.condition=C(this.condition,d,b),this}get names(){const d=super.names;return $e(d,this.condition),this.else&&Q(d,this.else.names),d}}h.kind="if";class w extends ${}w.kind="for";class x extends w{constructor(d){super(),this.iteration=d}render(d){return`for(${this.iteration})`+super.render(d)}optimizeNames(d,b){if(super.optimizeNames(d,b))return this.iteration=C(this.iteration,d,b),this}get names(){return Q(super.names,this.iteration.names)}}class _ extends w{constructor(d,b,I,V){super(),this.varKind=d,this.name=b,this.from=I,this.to=V}render(d){const b=d.es5?n.varKinds.var:this.varKind,{name:I,from:V,to:F}=this;return`for(${b} ${I}=${V}; ${I}<${F}; ${I}++)`+super.render(d)}get names(){const d=$e(super.names,this.from);return $e(d,this.to)}}class O extends w{constructor(d,b,I,V){super(),this.loop=d,this.varKind=b,this.name=I,this.iterable=V}render(d){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(d)}optimizeNames(d,b){if(super.optimizeNames(d,b))return this.iterable=C(this.iterable,d,b),this}get names(){return Q(super.names,this.iterable.names)}}class P extends ${constructor(d,b,I){super(),this.name=d,this.args=b,this.async=I}render(d){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(d)}}P.kind="func";class k extends p{render(d){return"return "+super.render(d)}}k.kind="return";class R extends ${render(d){let b="try"+super.render(d);return this.catch&&(b+=this.catch.render(d)),this.finally&&(b+=this.finally.render(d)),b}optimizeNodes(){var d,b;return super.optimizeNodes(),(d=this.catch)===null||d===void 0||d.optimizeNodes(),(b=this.finally)===null||b===void 0||b.optimizeNodes(),this}optimizeNames(d,b){var I,V;return super.optimizeNames(d,b),(I=this.catch)===null||I===void 0||I.optimizeNames(d,b),(V=this.finally)===null||V===void 0||V.optimizeNames(d,b),this}get names(){const d=super.names;return this.catch&&Q(d,this.catch.names),this.finally&&Q(d,this.finally.names),d}}class L extends ${constructor(d){super(),this.error=d}render(d){return`catch(${this.error})`+super.render(d)}}L.kind="catch";class K extends ${render(d){return"finally"+super.render(d)}}K.kind="finally";class ne{constructor(d,b={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...b,_n:b.lines?`
`:""},this._extScope=d,this._scope=new n.Scope({parent:d}),this._nodes=[new v]}toString(){return this._root.render(this.opts)}name(d){return this._scope.name(d)}scopeName(d){return this._extScope.name(d)}scopeValue(d,b){const I=this._extScope.value(d,b);return(this._values[I.prefix]||(this._values[I.prefix]=new Set)).add(I),I}getScopeValue(d,b){return this._extScope.getValue(d,b)}scopeRefs(d){return this._extScope.scopeRefs(d,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(d,b,I,V){const F=this._scope.toName(b);return I!==void 0&&V&&(this._constants[F.str]=I),this._leafNode(new a(d,F,I)),F}const(d,b,I){return this._def(n.varKinds.const,d,b,I)}let(d,b,I){return this._def(n.varKinds.let,d,b,I)}var(d,b,I){return this._def(n.varKinds.var,d,b,I)}assign(d,b,I){return this._leafNode(new s(d,b,I))}add(d,b){return this._leafNode(new c(d,e.operators.ADD,b))}code(d){return typeof d=="function"?d():d!==t.nil&&this._leafNode(new m(d)),this}object(...d){const b=["{"];for(const[I,V]of d)b.length>1&&b.push(","),b.push(I),(I!==V||this.opts.es5)&&(b.push(":"),(0,t.addCodeArg)(b,V));return b.push("}"),new t._Code(b)}if(d,b,I){if(this._blockNode(new h(d)),b&&I)this.code(b).else().code(I).endIf();else if(b)this.code(b).endIf();else if(I)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(d){return this._elseNode(new h(d))}else(){return this._elseNode(new y)}endIf(){return this._endBlockNode(h,y)}_for(d,b){return this._blockNode(d),b&&this.code(b).endFor(),this}for(d,b){return this._for(new x(d),b)}forRange(d,b,I,V,F=this.opts.es5?n.varKinds.var:n.varKinds.let){const J=this._scope.toName(d);return this._for(new _(F,J,b,I),()=>V(J))}forOf(d,b,I,V=n.varKinds.const){const F=this._scope.toName(d);if(this.opts.es5){const J=b instanceof t.Name?b:this.var("_arr",b);return this.forRange("_i",0,(0,t._)`${J}.length`,ie=>{this.var(F,(0,t._)`${J}[${ie}]`),I(F)})}return this._for(new O("of",V,F,b),()=>I(F))}forIn(d,b,I,V=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(d,(0,t._)`Object.keys(${b})`,I);const F=this._scope.toName(d);return this._for(new O("in",V,F,b),()=>I(F))}endFor(){return this._endBlockNode(w)}label(d){return this._leafNode(new u(d))}break(d){return this._leafNode(new l(d))}return(d){const b=new k;if(this._blockNode(b),this.code(d),b.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(d,b,I){if(!b&&!I)throw new Error('CodeGen: "try" without "catch" and "finally"');const V=new R;if(this._blockNode(V),this.code(d),b){const F=this.name("e");this._currNode=V.catch=new L(F),b(F)}return I&&(this._currNode=V.finally=new K,this.code(I)),this._endBlockNode(L,K)}throw(d){return this._leafNode(new f(d))}block(d,b){return this._blockStarts.push(this._nodes.length),d&&this.code(d).endBlock(b),this}endBlock(d){const b=this._blockStarts.pop();if(b===void 0)throw new Error("CodeGen: not in self-balancing block");const I=this._nodes.length-b;if(I<0||d!==void 0&&I!==d)throw new Error(`CodeGen: wrong number of nodes: ${I} vs ${d} expected`);return this._nodes.length=b,this}func(d,b=t.nil,I,V){return this._blockNode(new P(d,b,I)),V&&this.code(V).endFunc(),this}endFunc(){return this._endBlockNode(P)}optimize(d=1){for(;d-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(d){return this._currNode.nodes.push(d),this}_blockNode(d){this._currNode.nodes.push(d),this._nodes.push(d)}_endBlockNode(d,b){const I=this._currNode;if(I instanceof d||b&&I instanceof b)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${b?`${d.kind}/${b.kind}`:d.kind}"`)}_elseNode(d){const b=this._currNode;if(!(b instanceof h))throw new Error('CodeGen: "else" without "if"');return this._currNode=b.else=d,this}get _root(){return this._nodes[0]}get _currNode(){const d=this._nodes;return d[d.length-1]}set _currNode(d){const b=this._nodes;b[b.length-1]=d}}e.CodeGen=ne;function Q(T,d){for(const b in d)T[b]=(T[b]||0)+(d[b]||0);return T}function $e(T,d){return d instanceof t._CodeOrName?Q(T,d.names):T}function C(T,d,b){if(T instanceof t.Name)return I(T);if(!V(T))return T;return new t._Code(T._items.reduce((F,J)=>(J instanceof t.Name&&(J=I(J)),J instanceof t._Code?F.push(...J._items):F.push(J),F),[]));function I(F){const J=b[F.str];return J===void 0||d[F.str]!==1?F:(delete d[F.str],J)}function V(F){return F instanceof t._Code&&F._items.some(J=>J instanceof t.Name&&d[J.str]===1&&b[J.str]!==void 0)}}function q(T,d){for(const b in d)T[b]=(T[b]||0)-(d[b]||0)}function z(T){return typeof T=="boolean"||typeof T=="number"||T===null?!T:(0,t._)`!${D(T)}`}e.not=z;const H=N(e.operators.AND);function X(...T){return T.reduce(H)}e.and=X;const Z=N(e.operators.OR);function j(...T){return T.reduce(Z)}e.or=j;function N(T){return(d,b)=>d===t.nil?b:b===t.nil?d:(0,t._)`${D(d)} ${T} ${D(b)}`}function D(T){return T instanceof t.Name?T:(0,t._)`(${T})`}})(te);var ae={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=te,n=Pn;function r(P){const k={};for(const R of P)k[R]=!0;return k}e.toHash=r;function i(P,k){return typeof k=="boolean"?k:Object.keys(k).length===0?!0:(o(P,k),!a(k,P.self.RULES.all))}e.alwaysValidSchema=i;function o(P,k=P.schema){const{opts:R,self:L}=P;if(!R.strictSchema||typeof k=="boolean")return;const K=L.RULES.keywords;for(const ne in k)K[ne]||O(P,`unknown keyword: "${ne}"`)}e.checkUnknownRules=o;function a(P,k){if(typeof P=="boolean")return!P;for(const R in P)if(k[R])return!0;return!1}e.schemaHasRules=a;function s(P,k){if(typeof P=="boolean")return!P;for(const R in P)if(R!=="$ref"&&k.all[R])return!0;return!1}e.schemaHasRulesButRef=s;function c({topSchemaRef:P,schemaPath:k},R,L,K){if(!K){if(typeof R=="number"||typeof R=="boolean")return R;if(typeof R=="string")return(0,t._)`${R}`}return(0,t._)`${P}${k}${(0,t.getProperty)(L)}`}e.schemaRefOrVal=c;function u(P){return m(decodeURIComponent(P))}e.unescapeFragment=u;function l(P){return encodeURIComponent(f(P))}e.escapeFragment=l;function f(P){return typeof P=="number"?`${P}`:P.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=f;function m(P){return P.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=m;function p(P,k){if(Array.isArray(P))for(const R of P)k(R);else k(P)}e.eachItem=p;function $({mergeNames:P,mergeToName:k,mergeValues:R,resultToName:L}){return(K,ne,Q,$e)=>{const C=Q===void 0?ne:Q instanceof t.Name?(ne instanceof t.Name?P(K,ne,Q):k(K,ne,Q),Q):ne instanceof t.Name?(k(K,Q,ne),ne):R(ne,Q);return $e===t.Name&&!(C instanceof t.Name)?L(K,C):C}}e.mergeEvaluated={props:$({mergeNames:(P,k,R)=>P.if((0,t._)`${R} !== true && ${k} !== undefined`,()=>{P.if((0,t._)`${k} === true`,()=>P.assign(R,!0),()=>P.assign(R,(0,t._)`${R} || {}`).code((0,t._)`Object.assign(${R}, ${k})`))}),mergeToName:(P,k,R)=>P.if((0,t._)`${R} !== true`,()=>{k===!0?P.assign(R,!0):(P.assign(R,(0,t._)`${R} || {}`),y(P,R,k))}),mergeValues:(P,k)=>P===!0?!0:{...P,...k},resultToName:v}),items:$({mergeNames:(P,k,R)=>P.if((0,t._)`${R} !== true && ${k} !== undefined`,()=>P.assign(R,(0,t._)`${k} === true ? true : ${R} > ${k} ? ${R} : ${k}`)),mergeToName:(P,k,R)=>P.if((0,t._)`${R} !== true`,()=>P.assign(R,k===!0?!0:(0,t._)`${R} > ${k} ? ${R} : ${k}`)),mergeValues:(P,k)=>P===!0?!0:Math.max(P,k),resultToName:(P,k)=>P.var("items",k)})};function v(P,k){if(k===!0)return P.var("props",!0);const R=P.var("props",(0,t._)`{}`);return k!==void 0&&y(P,R,k),R}e.evaluatedPropsToName=v;function y(P,k,R){Object.keys(R).forEach(L=>P.assign((0,t._)`${k}${(0,t.getProperty)(L)}`,!0))}e.setEvaluated=y;const h={};function w(P,k){return P.scopeValue("func",{ref:k,code:h[k.code]||(h[k.code]=new n._Code(k.code))})}e.useFunc=w;var x;(function(P){P[P.Num=0]="Num",P[P.Str=1]="Str"})(x=e.Type||(e.Type={}));function _(P,k,R){if(P instanceof t.Name){const L=k===x.Num;return R?L?(0,t._)`"[" + ${P} + "]"`:(0,t._)`"['" + ${P} + "']"`:L?(0,t._)`"/" + ${P}`:(0,t._)`"/" + ${P}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return R?(0,t.getProperty)(P).toString():"/"+f(P)}e.getErrorPath=_;function O(P,k,R=P.opts.strictSchema){if(R){if(k=`strict mode: ${k}`,R===!0)throw new Error(k);P.self.logger.warn(k)}}e.checkStrictMode=O})(ae);var nt={};Object.defineProperty(nt,"__esModule",{value:!0});const Se=te,lh={data:new Se.Name("data"),valCxt:new Se.Name("valCxt"),instancePath:new Se.Name("instancePath"),parentData:new Se.Name("parentData"),parentDataProperty:new Se.Name("parentDataProperty"),rootData:new Se.Name("rootData"),dynamicAnchors:new Se.Name("dynamicAnchors"),vErrors:new Se.Name("vErrors"),errors:new Se.Name("errors"),this:new Se.Name("this"),self:new Se.Name("self"),scope:new Se.Name("scope"),json:new Se.Name("json"),jsonPos:new Se.Name("jsonPos"),jsonLen:new Se.Name("jsonLen"),jsonPart:new Se.Name("jsonPart")};nt.default=lh;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=te,n=ae,r=nt;e.keywordError={message:({keyword:y})=>(0,t.str)`must pass "${y}" keyword validation`},e.keyword$DataError={message:({keyword:y,schemaType:h})=>h?(0,t.str)`"${y}" keyword must be ${h} ($data)`:(0,t.str)`"${y}" keyword is invalid ($data)`};function i(y,h=e.keywordError,w,x){const{it:_}=y,{gen:O,compositeRule:P,allErrors:k}=_,R=f(y,h,w);x??(P||k)?c(O,R):u(_,(0,t._)`[${R}]`)}e.reportError=i;function o(y,h=e.keywordError,w){const{it:x}=y,{gen:_,compositeRule:O,allErrors:P}=x,k=f(y,h,w);c(_,k),O||P||u(x,r.default.vErrors)}e.reportExtraError=o;function a(y,h){y.assign(r.default.errors,h),y.if((0,t._)`${r.default.vErrors} !== null`,()=>y.if(h,()=>y.assign((0,t._)`${r.default.vErrors}.length`,h),()=>y.assign(r.default.vErrors,null)))}e.resetErrorsCount=a;function s({gen:y,keyword:h,schemaValue:w,data:x,errsCount:_,it:O}){if(_===void 0)throw new Error("ajv implementation error");const P=y.name("err");y.forRange("i",_,r.default.errors,k=>{y.const(P,(0,t._)`${r.default.vErrors}[${k}]`),y.if((0,t._)`${P}.instancePath === undefined`,()=>y.assign((0,t._)`${P}.instancePath`,(0,t.strConcat)(r.default.instancePath,O.errorPath))),y.assign((0,t._)`${P}.schemaPath`,(0,t.str)`${O.errSchemaPath}/${h}`),O.opts.verbose&&(y.assign((0,t._)`${P}.schema`,w),y.assign((0,t._)`${P}.data`,x))})}e.extendErrors=s;function c(y,h){const w=y.const("err",h);y.if((0,t._)`${r.default.vErrors} === null`,()=>y.assign(r.default.vErrors,(0,t._)`[${w}]`),(0,t._)`${r.default.vErrors}.push(${w})`),y.code((0,t._)`${r.default.errors}++`)}function u(y,h){const{gen:w,validateName:x,schemaEnv:_}=y;_.$async?w.throw((0,t._)`new ${y.ValidationError}(${h})`):(w.assign((0,t._)`${x}.errors`,h),w.return(!1))}const l={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function f(y,h,w){const{createErrors:x}=y.it;return x===!1?(0,t._)`{}`:m(y,h,w)}function m(y,h,w={}){const{gen:x,it:_}=y,O=[p(_,w),$(y,w)];return v(y,h,O),x.object(...O)}function p({errorPath:y},{instancePath:h}){const w=h?(0,t.str)`${y}${(0,n.getErrorPath)(h,n.Type.Str)}`:y;return[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,w)]}function $({keyword:y,it:{errSchemaPath:h}},{schemaPath:w,parentSchema:x}){let _=x?h:(0,t.str)`${h}/${y}`;return w&&(_=(0,t.str)`${_}${(0,n.getErrorPath)(w,n.Type.Str)}`),[l.schemaPath,_]}function v(y,{params:h,message:w},x){const{keyword:_,data:O,schemaValue:P,it:k}=y,{opts:R,propertyName:L,topSchemaRef:K,schemaPath:ne}=k;x.push([l.keyword,_],[l.params,typeof h=="function"?h(y):h||(0,t._)`{}`]),R.messages&&x.push([l.message,typeof w=="function"?w(y):w]),R.verbose&&x.push([l.schema,P],[l.parentSchema,(0,t._)`${K}${ne}`],[r.default.data,O]),L&&x.push([l.propertyName,L])}})(Cn);Object.defineProperty(Bt,"__esModule",{value:!0});Bt.boolOrEmptySchema=Bt.topBoolOrEmptySchema=void 0;const fh=Cn,hh=te,dh=nt,ph={message:"boolean schema is false"};function mh(e){const{gen:t,schema:n,validateName:r}=e;n===!1?Ba(e,!1):typeof n=="object"&&n.$async===!0?t.return(dh.default.data):(t.assign((0,hh._)`${r}.errors`,null),t.return(!0))}Bt.topBoolOrEmptySchema=mh;function yh(e,t){const{gen:n,schema:r}=e;r===!1?(n.var(t,!1),Ba(e)):n.var(t,!0)}Bt.boolOrEmptySchema=yh;function Ba(e,t){const{gen:n,data:r}=e,i={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,fh.reportError)(i,ph,void 0,t)}var On={},kt={};Object.defineProperty(kt,"__esModule",{value:!0});kt.getRules=kt.isJSONType=void 0;const gh=["string","number","integer","boolean","null","object","array"],vh=new Set(gh);function _h(e){return typeof e=="string"&&vh.has(e)}kt.isJSONType=_h;function $h(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}kt.getRules=$h;var st={};Object.defineProperty(st,"__esModule",{value:!0});st.shouldUseRule=st.shouldUseGroup=st.schemaHasRulesForType=void 0;function wh({schema:e,self:t},n){const r=t.RULES.types[n];return r&&r!==!0&&Xa(e,r)}st.schemaHasRulesForType=wh;function Xa(e,t){return t.rules.some(n=>Za(e,n))}st.shouldUseGroup=Xa;function Za(e,t){var n;return e[t.keyword]!==void 0||((n=t.definition.implements)===null||n===void 0?void 0:n.some(r=>e[r]!==void 0))}st.shouldUseRule=Za;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=kt,n=st,r=Cn,i=te,o=ae;var a;(function(x){x[x.Correct=0]="Correct",x[x.Wrong=1]="Wrong"})(a=e.DataType||(e.DataType={}));function s(x){const _=c(x.type);if(_.includes("null")){if(x.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!_.length&&x.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');x.nullable===!0&&_.push("null")}return _}e.getSchemaTypes=s;function c(x){const _=Array.isArray(x)?x:x?[x]:[];if(_.every(t.isJSONType))return _;throw new Error("type must be JSONType or JSONType[]: "+_.join(","))}e.getJSONTypes=c;function u(x,_){const{gen:O,data:P,opts:k}=x,R=f(_,k.coerceTypes),L=_.length>0&&!(R.length===0&&_.length===1&&(0,n.schemaHasRulesForType)(x,_[0]));if(L){const K=v(_,P,k.strictNumbers,a.Wrong);O.if(K,()=>{R.length?m(x,_,R):h(x)})}return L}e.coerceAndCheckDataType=u;const l=new Set(["string","number","integer","boolean","null"]);function f(x,_){return _?x.filter(O=>l.has(O)||_==="array"&&O==="array"):[]}function m(x,_,O){const{gen:P,data:k,opts:R}=x,L=P.let("dataType",(0,i._)`typeof ${k}`),K=P.let("coerced",(0,i._)`undefined`);R.coerceTypes==="array"&&P.if((0,i._)`${L} == 'object' && Array.isArray(${k}) && ${k}.length == 1`,()=>P.assign(k,(0,i._)`${k}[0]`).assign(L,(0,i._)`typeof ${k}`).if(v(_,k,R.strictNumbers),()=>P.assign(K,k))),P.if((0,i._)`${K} !== undefined`);for(const Q of O)(l.has(Q)||Q==="array"&&R.coerceTypes==="array")&&ne(Q);P.else(),h(x),P.endIf(),P.if((0,i._)`${K} !== undefined`,()=>{P.assign(k,K),p(x,K)});function ne(Q){switch(Q){case"string":P.elseIf((0,i._)`${L} == "number" || ${L} == "boolean"`).assign(K,(0,i._)`"" + ${k}`).elseIf((0,i._)`${k} === null`).assign(K,(0,i._)`""`);return;case"number":P.elseIf((0,i._)`${L} == "boolean" || ${k} === null
              || (${L} == "string" && ${k} && ${k} == +${k})`).assign(K,(0,i._)`+${k}`);return;case"integer":P.elseIf((0,i._)`${L} === "boolean" || ${k} === null
              || (${L} === "string" && ${k} && ${k} == +${k} && !(${k} % 1))`).assign(K,(0,i._)`+${k}`);return;case"boolean":P.elseIf((0,i._)`${k} === "false" || ${k} === 0 || ${k} === null`).assign(K,!1).elseIf((0,i._)`${k} === "true" || ${k} === 1`).assign(K,!0);return;case"null":P.elseIf((0,i._)`${k} === "" || ${k} === 0 || ${k} === false`),P.assign(K,null);return;case"array":P.elseIf((0,i._)`${L} === "string" || ${L} === "number"
              || ${L} === "boolean" || ${k} === null`).assign(K,(0,i._)`[${k}]`)}}}function p({gen:x,parentData:_,parentDataProperty:O},P){x.if((0,i._)`${_} !== undefined`,()=>x.assign((0,i._)`${_}[${O}]`,P))}function $(x,_,O,P=a.Correct){const k=P===a.Correct?i.operators.EQ:i.operators.NEQ;let R;switch(x){case"null":return(0,i._)`${_} ${k} null`;case"array":R=(0,i._)`Array.isArray(${_})`;break;case"object":R=(0,i._)`${_} && typeof ${_} == "object" && !Array.isArray(${_})`;break;case"integer":R=L((0,i._)`!(${_} % 1) && !isNaN(${_})`);break;case"number":R=L();break;default:return(0,i._)`typeof ${_} ${k} ${x}`}return P===a.Correct?R:(0,i.not)(R);function L(K=i.nil){return(0,i.and)((0,i._)`typeof ${_} == "number"`,K,O?(0,i._)`isFinite(${_})`:i.nil)}}e.checkDataType=$;function v(x,_,O,P){if(x.length===1)return $(x[0],_,O,P);let k;const R=(0,o.toHash)(x);if(R.array&&R.object){const L=(0,i._)`typeof ${_} != "object"`;k=R.null?L:(0,i._)`!${_} || ${L}`,delete R.null,delete R.array,delete R.object}else k=i.nil;R.number&&delete R.integer;for(const L in R)k=(0,i.and)(k,$(L,_,O,P));return k}e.checkDataTypes=v;const y={message:({schema:x})=>`must be ${x}`,params:({schema:x,schemaValue:_})=>typeof x=="string"?(0,i._)`{type: ${x}}`:(0,i._)`{type: ${_}}`};function h(x){const _=w(x);(0,r.reportError)(_,y)}e.reportTypeError=h;function w(x){const{gen:_,data:O,schema:P}=x,k=(0,o.schemaRefOrVal)(x,P,"type");return{gen:_,keyword:"type",data:O,schema:P.type,schemaCode:k,schemaValue:k,parentSchema:P,params:{},it:x}}})(On);var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.assignDefaults=void 0;const jt=te,bh=ae;function Sh(e,t){const{properties:n,items:r}=e.schema;if(t==="object"&&n)for(const i in n)Uo(e,i,n[i].default);else t==="array"&&Array.isArray(r)&&r.forEach((i,o)=>Uo(e,o,i.default))}Cr.assignDefaults=Sh;function Uo(e,t,n){const{gen:r,compositeRule:i,data:o,opts:a}=e;if(n===void 0)return;const s=(0,jt._)`${o}${(0,jt.getProperty)(t)}`;if(i){(0,bh.checkStrictMode)(e,`default is ignored for: ${s}`);return}let c=(0,jt._)`${s} === undefined`;a.useDefaults==="empty"&&(c=(0,jt._)`${c} || ${s} === null || ${s} === ""`),r.if(c,(0,jt._)`${s} = ${(0,jt.stringify)(n)}`)}var Qe={},ee={};Object.defineProperty(ee,"__esModule",{value:!0});ee.validateUnion=ee.validateArray=ee.usePattern=ee.callValidateCode=ee.schemaProperties=ee.allSchemaProperties=ee.noPropertyInData=ee.propertyInData=ee.isOwnProperty=ee.hasPropFunc=ee.reportMissingProp=ee.checkMissingProp=ee.checkReportMissingProp=void 0;const fe=te,$i=ae,ht=nt,Eh=ae;function xh(e,t){const{gen:n,data:r,it:i}=e;n.if(bi(n,r,t,i.opts.ownProperties),()=>{e.setParams({missingProperty:(0,fe._)`${t}`},!0),e.error()})}ee.checkReportMissingProp=xh;function Ph({gen:e,data:t,it:{opts:n}},r,i){return(0,fe.or)(...r.map(o=>(0,fe.and)(bi(e,t,o,n.ownProperties),(0,fe._)`${i} = ${o}`)))}ee.checkMissingProp=Ph;function Nh(e,t){e.setParams({missingProperty:t},!0),e.error()}ee.reportMissingProp=Nh;function Ya(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,fe._)`Object.prototype.hasOwnProperty`})}ee.hasPropFunc=Ya;function wi(e,t,n){return(0,fe._)`${Ya(e)}.call(${t}, ${n})`}ee.isOwnProperty=wi;function kh(e,t,n,r){const i=(0,fe._)`${t}${(0,fe.getProperty)(n)} !== undefined`;return r?(0,fe._)`${i} && ${wi(e,t,n)}`:i}ee.propertyInData=kh;function bi(e,t,n,r){const i=(0,fe._)`${t}${(0,fe.getProperty)(n)} === undefined`;return r?(0,fe.or)(i,(0,fe.not)(wi(e,t,n))):i}ee.noPropertyInData=bi;function Wa(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}ee.allSchemaProperties=Wa;function Th(e,t){return Wa(t).filter(n=>!(0,$i.alwaysValidSchema)(e,t[n]))}ee.schemaProperties=Th;function Ch({schemaCode:e,data:t,it:{gen:n,topSchemaRef:r,schemaPath:i,errorPath:o},it:a},s,c,u){const l=u?(0,fe._)`${e}, ${t}, ${r}${i}`:t,f=[[ht.default.instancePath,(0,fe.strConcat)(ht.default.instancePath,o)],[ht.default.parentData,a.parentData],[ht.default.parentDataProperty,a.parentDataProperty],[ht.default.rootData,ht.default.rootData]];a.opts.dynamicRef&&f.push([ht.default.dynamicAnchors,ht.default.dynamicAnchors]);const m=(0,fe._)`${l}, ${n.object(...f)}`;return c!==fe.nil?(0,fe._)`${s}.call(${c}, ${m})`:(0,fe._)`${s}(${m})`}ee.callValidateCode=Ch;const Oh=(0,fe._)`new RegExp`;function Ah({gen:e,it:{opts:t}},n){const r=t.unicodeRegExp?"u":"",{regExp:i}=t.code,o=i(n,r);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,fe._)`${i.code==="new RegExp"?Oh:(0,Eh.useFunc)(e,i)}(${n}, ${r})`})}ee.usePattern=Ah;function Mh(e){const{gen:t,data:n,keyword:r,it:i}=e,o=t.name("valid");if(i.allErrors){const s=t.let("valid",!0);return a(()=>t.assign(s,!1)),s}return t.var(o,!0),a(()=>t.break()),o;function a(s){const c=t.const("len",(0,fe._)`${n}.length`);t.forRange("i",0,c,u=>{e.subschema({keyword:r,dataProp:u,dataPropType:$i.Type.Num},o),t.if((0,fe.not)(o),s)})}}ee.validateArray=Mh;function Rh(e){const{gen:t,schema:n,keyword:r,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(c=>(0,$i.alwaysValidSchema)(i,c))&&!i.opts.unevaluated)return;const a=t.let("valid",!1),s=t.name("_valid");t.block(()=>n.forEach((c,u)=>{const l=e.subschema({keyword:r,schemaProp:u,compositeRule:!0},s);t.assign(a,(0,fe._)`${a} || ${s}`),e.mergeValidEvaluated(l,s)||t.if((0,fe.not)(a))})),e.result(a,()=>e.reset(),()=>e.error(!0))}ee.validateUnion=Rh;Object.defineProperty(Qe,"__esModule",{value:!0});Qe.validateKeywordUsage=Qe.validSchemaType=Qe.funcKeywordCode=Qe.macroKeywordCode=void 0;const xe=te,bt=nt,Ih=ee,Dh=Cn;function jh(e,t){const{gen:n,keyword:r,schema:i,parentSchema:o,it:a}=e,s=t.macro.call(a.self,i,o,a),c=Ja(n,r,s);a.opts.validateSchema!==!1&&a.self.validateSchema(s,!0);const u=n.name("valid");e.subschema({schema:s,schemaPath:xe.nil,errSchemaPath:`${a.errSchemaPath}/${r}`,topSchemaRef:c,compositeRule:!0},u),e.pass(u,()=>e.error(!0))}Qe.macroKeywordCode=jh;function zh(e,t){var n;const{gen:r,keyword:i,schema:o,parentSchema:a,$data:s,it:c}=e;Fh(c,t);const u=!s&&t.compile?t.compile.call(c.self,o,a,c):t.validate,l=Ja(r,i,u),f=r.let("valid");e.block$data(f,m),e.ok((n=t.valid)!==null&&n!==void 0?n:f);function m(){if(t.errors===!1)v(),t.modifying&&Ko(e),y(()=>e.error());else{const h=t.async?p():$();t.modifying&&Ko(e),y(()=>Vh(e,h))}}function p(){const h=r.let("ruleErrs",null);return r.try(()=>v((0,xe._)`await `),w=>r.assign(f,!1).if((0,xe._)`${w} instanceof ${c.ValidationError}`,()=>r.assign(h,(0,xe._)`${w}.errors`),()=>r.throw(w))),h}function $(){const h=(0,xe._)`${l}.errors`;return r.assign(h,null),v(xe.nil),h}function v(h=t.async?(0,xe._)`await `:xe.nil){const w=c.opts.passContext?bt.default.this:bt.default.self,x=!("compile"in t&&!s||t.schema===!1);r.assign(f,(0,xe._)`${h}${(0,Ih.callValidateCode)(e,l,w,x)}`,t.modifying)}function y(h){var w;r.if((0,xe.not)((w=t.valid)!==null&&w!==void 0?w:f),h)}}Qe.funcKeywordCode=zh;function Ko(e){const{gen:t,data:n,it:r}=e;t.if(r.parentData,()=>t.assign(n,(0,xe._)`${r.parentData}[${r.parentDataProperty}]`))}function Vh(e,t){const{gen:n}=e;n.if((0,xe._)`Array.isArray(${t})`,()=>{n.assign(bt.default.vErrors,(0,xe._)`${bt.default.vErrors} === null ? ${t} : ${bt.default.vErrors}.concat(${t})`).assign(bt.default.errors,(0,xe._)`${bt.default.vErrors}.length`),(0,Dh.extendErrors)(e)},()=>e.error())}function Fh({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function Ja(e,t,n){if(n===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,xe.stringify)(n)})}function Lh(e,t,n=!1){return!t.length||t.some(r=>r==="array"?Array.isArray(e):r==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==r||n&&typeof e>"u")}Qe.validSchemaType=Lh;function qh({schema:e,opts:t,self:n,errSchemaPath:r},i,o){if(Array.isArray(i.keyword)?!i.keyword.includes(o):i.keyword!==o)throw new Error("ajv implementation error");const a=i.dependencies;if(a!=null&&a.some(s=>!Object.prototype.hasOwnProperty.call(e,s)))throw new Error(`parent schema must have dependencies of ${o}: ${a.join(",")}`);if(i.validateSchema&&!i.validateSchema(e[o])){const c=`keyword "${o}" value is invalid at path "${r}": `+n.errorsText(i.validateSchema.errors);if(t.validateSchema==="log")n.logger.error(c);else throw new Error(c)}}Qe.validateKeywordUsage=qh;var yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.extendSubschemaMode=yt.extendSubschemaData=yt.getSubschema=void 0;const Je=te,Qa=ae;function Hh(e,{keyword:t,schemaProp:n,schema:r,schemaPath:i,errSchemaPath:o,topSchemaRef:a}){if(t!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const s=e.schema[t];return n===void 0?{schema:s,schemaPath:(0,Je._)`${e.schemaPath}${(0,Je.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:s[n],schemaPath:(0,Je._)`${e.schemaPath}${(0,Je.getProperty)(t)}${(0,Je.getProperty)(n)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Qa.escapeFragment)(n)}`}}if(r!==void 0){if(i===void 0||o===void 0||a===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:i,topSchemaRef:a,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}yt.getSubschema=Hh;function Uh(e,t,{dataProp:n,dataPropType:r,data:i,dataTypes:o,propertyName:a}){if(i!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:s}=t;if(n!==void 0){const{errorPath:u,dataPathArr:l,opts:f}=t,m=s.let("data",(0,Je._)`${t.data}${(0,Je.getProperty)(n)}`,!0);c(m),e.errorPath=(0,Je.str)`${u}${(0,Qa.getErrorPath)(n,r,f.jsPropertySyntax)}`,e.parentDataProperty=(0,Je._)`${n}`,e.dataPathArr=[...l,e.parentDataProperty]}if(i!==void 0){const u=i instanceof Je.Name?i:s.let("data",i,!0);c(u),a!==void 0&&(e.propertyName=a)}o&&(e.dataTypes=o);function c(u){e.data=u,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,u]}}yt.extendSubschemaData=Uh;function Kh(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:r,createErrors:i,allErrors:o}){r!==void 0&&(e.compositeRule=r),i!==void 0&&(e.createErrors=i),o!==void 0&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=n}yt.extendSubschemaMode=Kh;var be={},es=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},ei={},Gh={get exports(){return ei},set exports(e){ei=e}},mt=Gh.exports=function(e,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var r=typeof n=="function"?n:n.pre||function(){},i=n.post||function(){};tr(t,r,i,e,"",e)};mt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};mt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};mt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};mt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function tr(e,t,n,r,i,o,a,s,c,u){if(r&&typeof r=="object"&&!Array.isArray(r)){t(r,i,o,a,s,c,u);for(var l in r){var f=r[l];if(Array.isArray(f)){if(l in mt.arrayKeywords)for(var m=0;m<f.length;m++)tr(e,t,n,f[m],i+"/"+l+"/"+m,o,i,l,r,m)}else if(l in mt.propsKeywords){if(f&&typeof f=="object")for(var p in f)tr(e,t,n,f[p],i+"/"+l+"/"+Bh(p),o,i,l,r,p)}else(l in mt.keywords||e.allKeys&&!(l in mt.skipKeywords))&&tr(e,t,n,f,i+"/"+l,o,i,l,r)}n(r,i,o,a,s,c,u)}}function Bh(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(be,"__esModule",{value:!0});be.getSchemaRefs=be.resolveUrl=be.normalizeId=be._getFullPath=be.getFullPath=be.inlineRef=void 0;const Xh=ae,Zh=es,Yh=ei,Wh=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Jh(e,t=!0){return typeof e=="boolean"?!0:t===!0?!ti(e):t?ts(e)<=t:!1}be.inlineRef=Jh;const Qh=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function ti(e){for(const t in e){if(Qh.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(ti)||typeof n=="object"&&ti(n))return!0}return!1}function ts(e){let t=0;for(const n in e){if(n==="$ref")return 1/0;if(t++,!Wh.has(n)&&(typeof e[n]=="object"&&(0,Xh.eachItem)(e[n],r=>t+=ts(r)),t===1/0))return 1/0}return t}function ns(e,t="",n){n!==!1&&(t=Ht(t));const r=e.parse(t);return rs(e,r)}be.getFullPath=ns;function rs(e,t){return e.serialize(t).split("#")[0]+"#"}be._getFullPath=rs;const ed=/#\/?$/;function Ht(e){return e?e.replace(ed,""):""}be.normalizeId=Ht;function td(e,t,n){return n=Ht(n),e.resolve(t,n)}be.resolveUrl=td;const nd=/^[a-z_][-a-z0-9._]*$/i;function rd(e,t){if(typeof e=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,i=Ht(e[n]||t),o={"":i},a=ns(r,i,!1),s={},c=new Set;return Yh(e,{allKeys:!0},(f,m,p,$)=>{if($===void 0)return;const v=a+m;let y=o[$];typeof f[n]=="string"&&(y=h.call(this,f[n])),w.call(this,f.$anchor),w.call(this,f.$dynamicAnchor),o[m]=y;function h(x){const _=this.opts.uriResolver.resolve;if(x=Ht(y?_(y,x):x),c.has(x))throw l(x);c.add(x);let O=this.refs[x];return typeof O=="string"&&(O=this.refs[O]),typeof O=="object"?u(f,O.schema,x):x!==Ht(v)&&(x[0]==="#"?(u(f,s[x],x),s[x]=f):this.refs[x]=v),x}function w(x){if(typeof x=="string"){if(!nd.test(x))throw new Error(`invalid anchor "${x}"`);h.call(this,`#${x}`)}}}),s;function u(f,m,p){if(m!==void 0&&!Zh(f,m))throw l(p)}function l(f){return new Error(`reference "${f}" resolves to more than one schema`)}}be.getSchemaRefs=rd;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getData=Ue.KeywordCxt=Ue.validateFunctionCode=void 0;const is=Bt,Go=On,Si=st,pr=On,id=Cr,mn=Qe,Fr=yt,U=te,Y=nt,od=be,ct=ae,un=Cn;function ad(e){if(ss(e)&&(cs(e),as(e))){ud(e);return}os(e,()=>(0,is.topBoolOrEmptySchema)(e))}Ue.validateFunctionCode=ad;function os({gen:e,validateName:t,schema:n,schemaEnv:r,opts:i},o){i.code.es5?e.func(t,(0,U._)`${Y.default.data}, ${Y.default.valCxt}`,r.$async,()=>{e.code((0,U._)`"use strict"; ${Bo(n,i)}`),cd(e,i),e.code(o)}):e.func(t,(0,U._)`${Y.default.data}, ${sd(i)}`,r.$async,()=>e.code(Bo(n,i)).code(o))}function sd(e){return(0,U._)`{${Y.default.instancePath}="", ${Y.default.parentData}, ${Y.default.parentDataProperty}, ${Y.default.rootData}=${Y.default.data}${e.dynamicRef?(0,U._)`, ${Y.default.dynamicAnchors}={}`:U.nil}}={}`}function cd(e,t){e.if(Y.default.valCxt,()=>{e.var(Y.default.instancePath,(0,U._)`${Y.default.valCxt}.${Y.default.instancePath}`),e.var(Y.default.parentData,(0,U._)`${Y.default.valCxt}.${Y.default.parentData}`),e.var(Y.default.parentDataProperty,(0,U._)`${Y.default.valCxt}.${Y.default.parentDataProperty}`),e.var(Y.default.rootData,(0,U._)`${Y.default.valCxt}.${Y.default.rootData}`),t.dynamicRef&&e.var(Y.default.dynamicAnchors,(0,U._)`${Y.default.valCxt}.${Y.default.dynamicAnchors}`)},()=>{e.var(Y.default.instancePath,(0,U._)`""`),e.var(Y.default.parentData,(0,U._)`undefined`),e.var(Y.default.parentDataProperty,(0,U._)`undefined`),e.var(Y.default.rootData,Y.default.data),t.dynamicRef&&e.var(Y.default.dynamicAnchors,(0,U._)`{}`)})}function ud(e){const{schema:t,opts:n,gen:r}=e;os(e,()=>{n.$comment&&t.$comment&&ls(e),pd(e),r.let(Y.default.vErrors,null),r.let(Y.default.errors,0),n.unevaluated&&ld(e),us(e),gd(e)})}function ld(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",(0,U._)`${n}.evaluated`),t.if((0,U._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,U._)`${e.evaluated}.props`,(0,U._)`undefined`)),t.if((0,U._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,U._)`${e.evaluated}.items`,(0,U._)`undefined`))}function Bo(e,t){const n=typeof e=="object"&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,U._)`/*# sourceURL=${n} */`:U.nil}function fd(e,t){if(ss(e)&&(cs(e),as(e))){hd(e,t);return}(0,is.boolOrEmptySchema)(e,t)}function as({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const n in e)if(t.RULES.all[n])return!0;return!1}function ss(e){return typeof e.schema!="boolean"}function hd(e,t){const{schema:n,gen:r,opts:i}=e;i.$comment&&n.$comment&&ls(e),md(e),yd(e);const o=r.const("_errs",Y.default.errors);us(e,o),r.var(t,(0,U._)`${o} === ${Y.default.errors}`)}function cs(e){(0,ct.checkUnknownRules)(e),dd(e)}function us(e,t){if(e.opts.jtd)return Xo(e,[],!1,t);const n=(0,Go.getSchemaTypes)(e.schema),r=(0,Go.coerceAndCheckDataType)(e,n);Xo(e,n,!r,t)}function dd(e){const{schema:t,errSchemaPath:n,opts:r,self:i}=e;t.$ref&&r.ignoreKeywordsWithRef&&(0,ct.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function pd(e){const{schema:t,opts:n}=e;t.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,ct.checkStrictMode)(e,"default is ignored in the schema root")}function md(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,od.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function yd(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function ls({gen:e,schemaEnv:t,schema:n,errSchemaPath:r,opts:i}){const o=n.$comment;if(i.$comment===!0)e.code((0,U._)`${Y.default.self}.logger.log(${o})`);else if(typeof i.$comment=="function"){const a=(0,U.str)`${r}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code((0,U._)`${Y.default.self}.opts.$comment(${o}, ${a}, ${s}.schema)`)}}function gd(e){const{gen:t,schemaEnv:n,validateName:r,ValidationError:i,opts:o}=e;n.$async?t.if((0,U._)`${Y.default.errors} === 0`,()=>t.return(Y.default.data),()=>t.throw((0,U._)`new ${i}(${Y.default.vErrors})`)):(t.assign((0,U._)`${r}.errors`,Y.default.vErrors),o.unevaluated&&vd(e),t.return((0,U._)`${Y.default.errors} === 0`))}function vd({gen:e,evaluated:t,props:n,items:r}){n instanceof U.Name&&e.assign((0,U._)`${t}.props`,n),r instanceof U.Name&&e.assign((0,U._)`${t}.items`,r)}function Xo(e,t,n,r){const{gen:i,schema:o,data:a,allErrors:s,opts:c,self:u}=e,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,ct.schemaHasRulesButRef)(o,l))){i.block(()=>hs(e,"$ref",l.all.$ref.definition));return}c.jtd||_d(e,t),i.block(()=>{for(const m of l.rules)f(m);f(l.post)});function f(m){(0,Si.shouldUseGroup)(o,m)&&(m.type?(i.if((0,pr.checkDataType)(m.type,a,c.strictNumbers)),Zo(e,m),t.length===1&&t[0]===m.type&&n&&(i.else(),(0,pr.reportTypeError)(e)),i.endIf()):Zo(e,m),s||i.if((0,U._)`${Y.default.errors} === ${r||0}`))}}function Zo(e,t){const{gen:n,schema:r,opts:{useDefaults:i}}=e;i&&(0,id.assignDefaults)(e,t.type),n.block(()=>{for(const o of t.rules)(0,Si.shouldUseRule)(r,o)&&hs(e,o.keyword,o.definition,t.type)})}function _d(e,t){e.schemaEnv.meta||!e.opts.strictTypes||($d(e,t),e.opts.allowUnionTypes||wd(e,t),bd(e,e.dataTypes))}function $d(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(n=>{Yo(e.dataTypes,n)||Ei(e,`type "${n}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(n=>Yo(t,n))}}function wd(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&Ei(e,"use allowUnionTypes to allow union type keyword")}function bd(e,t){const n=e.self.RULES.all;for(const r in n){const i=n[r];if(typeof i=="object"&&(0,Si.shouldUseRule)(e.schema,i)){const{type:o}=i.definition;o.length&&!o.some(a=>Sd(t,a))&&Ei(e,`missing type "${o.join(",")}" for keyword "${r}"`)}}}function Sd(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function Yo(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function Ei(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${n}" (strictTypes)`,(0,ct.checkStrictMode)(e,t,e.opts.strictTypes)}class fs{constructor(t,n,r){if((0,mn.validateKeywordUsage)(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ct.schemaRefOrVal)(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",ds(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,mn.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=t.gen.const("_errs",Y.default.errors))}result(t,n,r){this.failResult((0,U.not)(t),n,r)}failResult(t,n,r){this.gen.if(t),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,n){this.failResult((0,U.not)(t),void 0,n)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:n}=this;this.fail((0,U._)`${n} !== undefined && (${(0,U.or)(this.invalid$data(),t)})`)}error(t,n,r){if(n){this.setParams(n),this._error(t,r),this.setParams({});return}this._error(t,r)}_error(t,n){(t?un.reportExtraError:un.reportError)(this,this.def.error,n)}$dataError(){(0,un.reportError)(this,this.def.$dataError||un.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,un.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,n){n?Object.assign(this.params,t):this.params=t}block$data(t,n,r=U.nil){this.gen.block(()=>{this.check$data(t,r),n()})}check$data(t=U.nil,n=U.nil){if(!this.$data)return;const{gen:r,schemaCode:i,schemaType:o,def:a}=this;r.if((0,U.or)((0,U._)`${i} === undefined`,n)),t!==U.nil&&r.assign(t,!0),(o.length||a.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),t!==U.nil&&r.assign(t,!1)),r.else()}invalid$data(){const{gen:t,schemaCode:n,schemaType:r,def:i,it:o}=this;return(0,U.or)(a(),s());function a(){if(r.length){if(!(n instanceof U.Name))throw new Error("ajv implementation error");const c=Array.isArray(r)?r:[r];return(0,U._)`${(0,pr.checkDataTypes)(c,n,o.opts.strictNumbers,pr.DataType.Wrong)}`}return U.nil}function s(){if(i.validateSchema){const c=t.scopeValue("validate$data",{ref:i.validateSchema});return(0,U._)`!${c}(${n})`}return U.nil}}subschema(t,n){const r=(0,Fr.getSubschema)(this.it,t);(0,Fr.extendSubschemaData)(r,this.it,t),(0,Fr.extendSubschemaMode)(r,t);const i={...this.it,...r,items:void 0,props:void 0};return fd(i,n),i}mergeEvaluated(t,n){const{it:r,gen:i}=this;r.opts.unevaluated&&(r.props!==!0&&t.props!==void 0&&(r.props=ct.mergeEvaluated.props(i,t.props,r.props,n)),r.items!==!0&&t.items!==void 0&&(r.items=ct.mergeEvaluated.items(i,t.items,r.items,n)))}mergeValidEvaluated(t,n){const{it:r,gen:i}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return i.if(n,()=>this.mergeEvaluated(t,U.Name)),!0}}Ue.KeywordCxt=fs;function hs(e,t,n,r){const i=new fs(e,n,t);"code"in n?n.code(i,r):i.$data&&n.validate?(0,mn.funcKeywordCode)(i,n):"macro"in n?(0,mn.macroKeywordCode)(i,n):(n.compile||n.validate)&&(0,mn.funcKeywordCode)(i,n)}const Ed=/^\/(?:[^~]|~0|~1)*$/,xd=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ds(e,{dataLevel:t,dataNames:n,dataPathArr:r}){let i,o;if(e==="")return Y.default.rootData;if(e[0]==="/"){if(!Ed.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);i=e,o=Y.default.rootData}else{const u=xd.exec(e);if(!u)throw new Error(`Invalid JSON-pointer: ${e}`);const l=+u[1];if(i=u[2],i==="#"){if(l>=t)throw new Error(c("property/index",l));return r[t-l]}if(l>t)throw new Error(c("data",l));if(o=n[t-l],!i)return o}let a=o;const s=i.split("/");for(const u of s)u&&(o=(0,U._)`${o}${(0,U.getProperty)((0,ct.unescapeJsonPointer)(u))}`,a=(0,U._)`${a} && ${o}`);return a;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${t}`}}Ue.getData=ds;var An={};Object.defineProperty(An,"__esModule",{value:!0});class Pd extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}An.default=Pd;var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});const Lr=be;class Nd extends Error{constructor(t,n,r,i){super(i||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,Lr.resolveUrl)(t,n,r),this.missingSchema=(0,Lr.normalizeId)((0,Lr.getFullPath)(t,this.missingRef))}}Mn.default=Nd;var Ae={};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.resolveSchema=Ae.getCompilingSchema=Ae.resolveRef=Ae.compileSchema=Ae.SchemaEnv=void 0;const Fe=te,kd=An,wt=nt,He=be,Wo=ae,Td=Ue;class Or{constructor(t){var n;this.refs={},this.dynamicAnchors={};let r;typeof t.schema=="object"&&(r=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(n=t.baseId)!==null&&n!==void 0?n:(0,He.normalizeId)(r==null?void 0:r[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}Ae.SchemaEnv=Or;function xi(e){const t=ps.call(this,e);if(t)return t;const n=(0,He.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:r,lines:i}=this.opts.code,{ownProperties:o}=this.opts,a=new Fe.CodeGen(this.scope,{es5:r,lines:i,ownProperties:o});let s;e.$async&&(s=a.scopeValue("Error",{ref:kd.default,code:(0,Fe._)`require("ajv/dist/runtime/validation_error").default`}));const c=a.scopeName("validate");e.validateName=c;const u={gen:a,allErrors:this.opts.allErrors,data:wt.default.data,parentData:wt.default.parentData,parentDataProperty:wt.default.parentDataProperty,dataNames:[wt.default.data],dataPathArr:[Fe.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:a.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Fe.stringify)(e.schema)}:{ref:e.schema}),validateName:c,ValidationError:s,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:Fe.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Fe._)`""`,opts:this.opts,self:this};let l;try{this._compilations.add(e),(0,Td.validateFunctionCode)(u),a.optimize(this.opts.code.optimize);const f=a.toString();l=`${a.scopeRefs(wt.default.scope)}return ${f}`,this.opts.code.process&&(l=this.opts.code.process(l,e));const p=new Function(`${wt.default.self}`,`${wt.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=e.schema,p.schemaEnv=e,e.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:f,scopeValues:a._values}),this.opts.unevaluated){const{props:$,items:v}=u;p.evaluated={props:$ instanceof Fe.Name?void 0:$,items:v instanceof Fe.Name?void 0:v,dynamicProps:$ instanceof Fe.Name,dynamicItems:v instanceof Fe.Name},p.source&&(p.source.evaluated=(0,Fe.stringify)(p.evaluated))}return e.validate=p,e}catch(f){throw delete e.validate,delete e.validateName,l&&this.logger.error("Error compiling schema, function code:",l),f}finally{this._compilations.delete(e)}}Ae.compileSchema=xi;function Cd(e,t,n){var r;n=(0,He.resolveUrl)(this.opts.uriResolver,t,n);const i=e.refs[n];if(i)return i;let o=Md.call(this,e,n);if(o===void 0){const a=(r=e.localRefs)===null||r===void 0?void 0:r[n],{schemaId:s}=this.opts;a&&(o=new Or({schema:a,schemaId:s,root:e,baseId:t}))}if(o!==void 0)return e.refs[n]=Od.call(this,o)}Ae.resolveRef=Cd;function Od(e){return(0,He.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:xi.call(this,e)}function ps(e){for(const t of this._compilations)if(Ad(t,e))return t}Ae.getCompilingSchema=ps;function Ad(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Md(e,t){let n;for(;typeof(n=this.refs[t])=="string";)t=n;return n||this.schemas[t]||Ar.call(this,e,t)}function Ar(e,t){const n=this.opts.uriResolver.parse(t),r=(0,He._getFullPath)(this.opts.uriResolver,n);let i=(0,He.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===i)return qr.call(this,n,e);const o=(0,He.normalizeId)(r),a=this.refs[o]||this.schemas[o];if(typeof a=="string"){const s=Ar.call(this,e,a);return typeof(s==null?void 0:s.schema)!="object"?void 0:qr.call(this,n,s)}if(typeof(a==null?void 0:a.schema)=="object"){if(a.validate||xi.call(this,a),o===(0,He.normalizeId)(t)){const{schema:s}=a,{schemaId:c}=this.opts,u=s[c];return u&&(i=(0,He.resolveUrl)(this.opts.uriResolver,i,u)),new Or({schema:s,schemaId:c,root:e,baseId:i})}return qr.call(this,n,a)}}Ae.resolveSchema=Ar;const Rd=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function qr(e,{baseId:t,schema:n,root:r}){var i;if(((i=e.fragment)===null||i===void 0?void 0:i[0])!=="/")return;for(const s of e.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const c=n[(0,Wo.unescapeFragment)(s)];if(c===void 0)return;n=c;const u=typeof n=="object"&&n[this.opts.schemaId];!Rd.has(s)&&u&&(t=(0,He.resolveUrl)(this.opts.uriResolver,t,u))}let o;if(typeof n!="boolean"&&n.$ref&&!(0,Wo.schemaHasRulesButRef)(n,this.RULES)){const s=(0,He.resolveUrl)(this.opts.uriResolver,t,n.$ref);o=Ar.call(this,r,s)}const{schemaId:a}=this.opts;if(o=o||new Or({schema:n,schemaId:a,root:r,baseId:t}),o.schema!==o.root.schema)return o}const Id="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Dd="Meta-schema for $data reference (JSON AnySchema extension proposal)",jd="object",zd=["$data"],Vd={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Fd=!1,Ld={$id:Id,description:Dd,type:jd,required:zd,properties:Vd,additionalProperties:Fd};var Pi={},mr={},qd={get exports(){return mr},set exports(e){mr=e}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(n,r){r(t)})(sh,function(n){function r(){for(var S=arguments.length,g=Array(S),E=0;E<S;E++)g[E]=arguments[E];if(g.length>1){g[0]=g[0].slice(0,-1);for(var M=g.length-1,A=1;A<M;++A)g[A]=g[A].slice(1,-1);return g[M]=g[M].slice(1),g.join("")}else return g[0]}function i(S){return"(?:"+S+")"}function o(S){return S===void 0?"undefined":S===null?"null":Object.prototype.toString.call(S).split(" ").pop().split("]").shift().toLowerCase()}function a(S){return S.toUpperCase()}function s(S){return S!=null?S instanceof Array?S:typeof S.length!="number"||S.split||S.setInterval||S.call?[S]:Array.prototype.slice.call(S):[]}function c(S,g){var E=S;if(g)for(var M in g)E[M]=g[M];return E}function u(S){var g="[A-Za-z]",E="[0-9]",M=r(E,"[A-Fa-f]"),A=i(i("%[EFef]"+M+"%"+M+M+"%"+M+M)+"|"+i("%[89A-Fa-f]"+M+"%"+M+M)+"|"+i("%"+M+M)),G="[\\:\\/\\?\\#\\[\\]\\@]",B="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",oe=r(G,B),ue=S?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",me=S?"[\\uE000-\\uF8FF]":"[]",re=r(g,E,"[\\-\\.\\_\\~]",ue);i(g+r(g,E,"[\\+\\-\\.]")+"*"),i(i(A+"|"+r(re,B,"[\\:]"))+"*");var ce=i(i("25[0-5]")+"|"+i("2[0-4]"+E)+"|"+i("1"+E+E)+"|"+i("0?[1-9]"+E)+"|0?0?"+E),ye=i(ce+"\\."+ce+"\\."+ce+"\\."+ce),W=i(M+"{1,4}"),he=i(i(W+"\\:"+W)+"|"+ye),_e=i(i(W+"\\:")+"{6}"+he),de=i("\\:\\:"+i(W+"\\:")+"{5}"+he),ft=i(i(W)+"?\\:\\:"+i(W+"\\:")+"{4}"+he),Ze=i(i(i(W+"\\:")+"{0,1}"+W)+"?\\:\\:"+i(W+"\\:")+"{3}"+he),Ye=i(i(i(W+"\\:")+"{0,2}"+W)+"?\\:\\:"+i(W+"\\:")+"{2}"+he),Dt=i(i(i(W+"\\:")+"{0,3}"+W)+"?\\:\\:"+W+"\\:"+he),_t=i(i(i(W+"\\:")+"{0,4}"+W)+"?\\:\\:"+he),ze=i(i(i(W+"\\:")+"{0,5}"+W)+"?\\:\\:"+W),We=i(i(i(W+"\\:")+"{0,6}"+W)+"?\\:\\:"),$t=i([_e,de,ft,Ze,Ye,Dt,_t,ze,We].join("|")),rt=i(i(re+"|"+A)+"+");i("[vV]"+M+"+\\."+r(re,B,"[\\:]")+"+"),i(i(A+"|"+r(re,B))+"*");var on=i(A+"|"+r(re,B,"[\\:\\@]"));return i(i(A+"|"+r(re,B,"[\\@]"))+"+"),i(i(on+"|"+r("[\\/\\?]",me))+"*"),{NOT_SCHEME:new RegExp(r("[^]",g,E,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",re,B),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",re,B),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",re,B),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",re,B),"g"),NOT_QUERY:new RegExp(r("[^\\%]",re,B,"[\\:\\@\\/\\?]",me),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",re,B,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",re,B),"g"),UNRESERVED:new RegExp(re,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",re,oe),"g"),PCT_ENCODED:new RegExp(A,"g"),IPV4ADDRESS:new RegExp("^("+ye+")$"),IPV6ADDRESS:new RegExp("^\\[?("+$t+")"+i(i("\\%25|\\%(?!"+M+"{2})")+"("+rt+")")+"?\\]?$")}}var l=u(!1),f=u(!0),m=function(){function S(g,E){var M=[],A=!0,G=!1,B=void 0;try{for(var oe=g[Symbol.iterator](),ue;!(A=(ue=oe.next()).done)&&(M.push(ue.value),!(E&&M.length===E));A=!0);}catch(me){G=!0,B=me}finally{try{!A&&oe.return&&oe.return()}finally{if(G)throw B}}return M}return function(g,E){if(Array.isArray(g))return g;if(Symbol.iterator in Object(g))return S(g,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(S){if(Array.isArray(S)){for(var g=0,E=Array(S.length);g<S.length;g++)E[g]=S[g];return E}else return Array.from(S)},$=2147483647,v=36,y=1,h=26,w=38,x=700,_=72,O=128,P="-",k=/^xn--/,R=/[^\0-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,K={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ne=v-y,Q=Math.floor,$e=String.fromCharCode;function C(S){throw new RangeError(K[S])}function q(S,g){for(var E=[],M=S.length;M--;)E[M]=g(S[M]);return E}function z(S,g){var E=S.split("@"),M="";E.length>1&&(M=E[0]+"@",S=E[1]),S=S.replace(L,".");var A=S.split("."),G=q(A,g).join(".");return M+G}function H(S){for(var g=[],E=0,M=S.length;E<M;){var A=S.charCodeAt(E++);if(A>=55296&&A<=56319&&E<M){var G=S.charCodeAt(E++);(G&64512)==56320?g.push(((A&1023)<<10)+(G&1023)+65536):(g.push(A),E--)}else g.push(A)}return g}var X=function(g){return String.fromCodePoint.apply(String,p(g))},Z=function(g){return g-48<10?g-22:g-65<26?g-65:g-97<26?g-97:v},j=function(g,E){return g+22+75*(g<26)-((E!=0)<<5)},N=function(g,E,M){var A=0;for(g=M?Q(g/x):g>>1,g+=Q(g/E);g>ne*h>>1;A+=v)g=Q(g/ne);return Q(A+(ne+1)*g/(g+w))},D=function(g){var E=[],M=g.length,A=0,G=O,B=_,oe=g.lastIndexOf(P);oe<0&&(oe=0);for(var ue=0;ue<oe;++ue)g.charCodeAt(ue)>=128&&C("not-basic"),E.push(g.charCodeAt(ue));for(var me=oe>0?oe+1:0;me<M;){for(var re=A,ce=1,ye=v;;ye+=v){me>=M&&C("invalid-input");var W=Z(g.charCodeAt(me++));(W>=v||W>Q(($-A)/ce))&&C("overflow"),A+=W*ce;var he=ye<=B?y:ye>=B+h?h:ye-B;if(W<he)break;var _e=v-he;ce>Q($/_e)&&C("overflow"),ce*=_e}var de=E.length+1;B=N(A-re,de,re==0),Q(A/de)>$-G&&C("overflow"),G+=Q(A/de),A%=de,E.splice(A++,0,G)}return String.fromCodePoint.apply(String,E)},T=function(g){var E=[];g=H(g);var M=g.length,A=O,G=0,B=_,oe=!0,ue=!1,me=void 0;try{for(var re=g[Symbol.iterator](),ce;!(oe=(ce=re.next()).done);oe=!0){var ye=ce.value;ye<128&&E.push($e(ye))}}catch(an){ue=!0,me=an}finally{try{!oe&&re.return&&re.return()}finally{if(ue)throw me}}var W=E.length,he=W;for(W&&E.push(P);he<M;){var _e=$,de=!0,ft=!1,Ze=void 0;try{for(var Ye=g[Symbol.iterator](),Dt;!(de=(Dt=Ye.next()).done);de=!0){var _t=Dt.value;_t>=A&&_t<_e&&(_e=_t)}}catch(an){ft=!0,Ze=an}finally{try{!de&&Ye.return&&Ye.return()}finally{if(ft)throw Ze}}var ze=he+1;_e-A>Q(($-G)/ze)&&C("overflow"),G+=(_e-A)*ze,A=_e;var We=!0,$t=!1,rt=void 0;try{for(var on=g[Symbol.iterator](),vo;!(We=(vo=on.next()).done);We=!0){var _o=vo.value;if(_o<A&&++G>$&&C("overflow"),_o==A){for(var Dn=G,jn=v;;jn+=v){var zn=jn<=B?y:jn>=B+h?h:jn-B;if(Dn<zn)break;var $o=Dn-zn,wo=v-zn;E.push($e(j(zn+$o%wo,0))),Dn=Q($o/wo)}E.push($e(j(Dn,0))),B=N(G,ze,he==W),G=0,++he}}}catch(an){$t=!0,rt=an}finally{try{!We&&on.return&&on.return()}finally{if($t)throw rt}}++G,++A}return E.join("")},d=function(g){return z(g,function(E){return k.test(E)?D(E.slice(4).toLowerCase()):E})},b=function(g){return z(g,function(E){return R.test(E)?"xn--"+T(E):E})},I={version:"2.1.0",ucs2:{decode:H,encode:X},decode:D,encode:T,toASCII:b,toUnicode:d},V={};function F(S){var g=S.charCodeAt(0),E=void 0;return g<16?E="%0"+g.toString(16).toUpperCase():g<128?E="%"+g.toString(16).toUpperCase():g<2048?E="%"+(g>>6|192).toString(16).toUpperCase()+"%"+(g&63|128).toString(16).toUpperCase():E="%"+(g>>12|224).toString(16).toUpperCase()+"%"+(g>>6&63|128).toString(16).toUpperCase()+"%"+(g&63|128).toString(16).toUpperCase(),E}function J(S){for(var g="",E=0,M=S.length;E<M;){var A=parseInt(S.substr(E+1,2),16);if(A<128)g+=String.fromCharCode(A),E+=3;else if(A>=194&&A<224){if(M-E>=6){var G=parseInt(S.substr(E+4,2),16);g+=String.fromCharCode((A&31)<<6|G&63)}else g+=S.substr(E,6);E+=6}else if(A>=224){if(M-E>=9){var B=parseInt(S.substr(E+4,2),16),oe=parseInt(S.substr(E+7,2),16);g+=String.fromCharCode((A&15)<<12|(B&63)<<6|oe&63)}else g+=S.substr(E,9);E+=9}else g+=S.substr(E,3),E+=3}return g}function ie(S,g){function E(M){var A=J(M);return A.match(g.UNRESERVED)?A:M}return S.scheme&&(S.scheme=String(S.scheme).replace(g.PCT_ENCODED,E).toLowerCase().replace(g.NOT_SCHEME,"")),S.userinfo!==void 0&&(S.userinfo=String(S.userinfo).replace(g.PCT_ENCODED,E).replace(g.NOT_USERINFO,F).replace(g.PCT_ENCODED,a)),S.host!==void 0&&(S.host=String(S.host).replace(g.PCT_ENCODED,E).toLowerCase().replace(g.NOT_HOST,F).replace(g.PCT_ENCODED,a)),S.path!==void 0&&(S.path=String(S.path).replace(g.PCT_ENCODED,E).replace(S.scheme?g.NOT_PATH:g.NOT_PATH_NOSCHEME,F).replace(g.PCT_ENCODED,a)),S.query!==void 0&&(S.query=String(S.query).replace(g.PCT_ENCODED,E).replace(g.NOT_QUERY,F).replace(g.PCT_ENCODED,a)),S.fragment!==void 0&&(S.fragment=String(S.fragment).replace(g.PCT_ENCODED,E).replace(g.NOT_FRAGMENT,F).replace(g.PCT_ENCODED,a)),S}function pe(S){return S.replace(/^0*(.*)/,"$1")||"0"}function Ge(S,g){var E=S.match(g.IPV4ADDRESS)||[],M=m(E,2),A=M[1];return A?A.split(".").map(pe).join("."):S}function Ct(S,g){var E=S.match(g.IPV6ADDRESS)||[],M=m(E,3),A=M[1],G=M[2];if(A){for(var B=A.toLowerCase().split("::").reverse(),oe=m(B,2),ue=oe[0],me=oe[1],re=me?me.split(":").map(pe):[],ce=ue.split(":").map(pe),ye=g.IPV4ADDRESS.test(ce[ce.length-1]),W=ye?7:8,he=ce.length-W,_e=Array(W),de=0;de<W;++de)_e[de]=re[de]||ce[he+de]||"";ye&&(_e[W-1]=Ge(_e[W-1],g));var ft=_e.reduce(function(ze,We,$t){if(!We||We==="0"){var rt=ze[ze.length-1];rt&&rt.index+rt.length===$t?rt.length++:ze.push({index:$t,length:1})}return ze},[]),Ze=ft.sort(function(ze,We){return We.length-ze.length})[0],Ye=void 0;if(Ze&&Ze.length>1){var Dt=_e.slice(0,Ze.index),_t=_e.slice(Ze.index+Ze.length);Ye=Dt.join(":")+"::"+_t.join(":")}else Ye=_e.join(":");return G&&(Ye+="%"+G),Ye}else return S}var Wt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Jt="".match(/(){0}/)[1]===void 0;function Re(S){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={},M=g.iri!==!1?f:l;g.reference==="suffix"&&(S=(g.scheme?g.scheme+":":"")+"//"+S);var A=S.match(Wt);if(A){Jt?(E.scheme=A[1],E.userinfo=A[3],E.host=A[4],E.port=parseInt(A[5],10),E.path=A[6]||"",E.query=A[7],E.fragment=A[8],isNaN(E.port)&&(E.port=A[5])):(E.scheme=A[1]||void 0,E.userinfo=S.indexOf("@")!==-1?A[3]:void 0,E.host=S.indexOf("//")!==-1?A[4]:void 0,E.port=parseInt(A[5],10),E.path=A[6]||"",E.query=S.indexOf("?")!==-1?A[7]:void 0,E.fragment=S.indexOf("#")!==-1?A[8]:void 0,isNaN(E.port)&&(E.port=S.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?A[4]:void 0)),E.host&&(E.host=Ct(Ge(E.host,M),M)),E.scheme===void 0&&E.userinfo===void 0&&E.host===void 0&&E.port===void 0&&!E.path&&E.query===void 0?E.reference="same-document":E.scheme===void 0?E.reference="relative":E.fragment===void 0?E.reference="absolute":E.reference="uri",g.reference&&g.reference!=="suffix"&&g.reference!==E.reference&&(E.error=E.error||"URI is not a "+g.reference+" reference.");var G=V[(g.scheme||E.scheme||"").toLowerCase()];if(!g.unicodeSupport&&(!G||!G.unicodeSupport)){if(E.host&&(g.domainHost||G&&G.domainHost))try{E.host=I.toASCII(E.host.replace(M.PCT_ENCODED,J).toLowerCase())}catch(B){E.error=E.error||"Host's domain name can not be converted to ASCII via punycode: "+B}ie(E,l)}else ie(E,M);G&&G.parse&&G.parse(E,g)}else E.error=E.error||"URI can not be parsed.";return E}function Qt(S,g){var E=g.iri!==!1?f:l,M=[];return S.userinfo!==void 0&&(M.push(S.userinfo),M.push("@")),S.host!==void 0&&M.push(Ct(Ge(String(S.host),E),E).replace(E.IPV6ADDRESS,function(A,G,B){return"["+G+(B?"%25"+B:"")+"]"})),(typeof S.port=="number"||typeof S.port=="string")&&(M.push(":"),M.push(String(S.port))),M.length?M.join(""):void 0}var Ot=/^\.\.?\//,At=/^\/\.(\/|$)/,Mt=/^\/\.\.(\/|$)/,en=/^\/?(?:.|\n)*?(?=\/|$)/;function Be(S){for(var g=[];S.length;)if(S.match(Ot))S=S.replace(Ot,"");else if(S.match(At))S=S.replace(At,"/");else if(S.match(Mt))S=S.replace(Mt,"/"),g.pop();else if(S==="."||S==="..")S="";else{var E=S.match(en);if(E){var M=E[0];S=S.slice(M.length),g.push(M)}else throw new Error("Unexpected dot segment condition")}return g.join("")}function Ce(S){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=g.iri?f:l,M=[],A=V[(g.scheme||S.scheme||"").toLowerCase()];if(A&&A.serialize&&A.serialize(S,g),S.host&&!E.IPV6ADDRESS.test(S.host)){if(g.domainHost||A&&A.domainHost)try{S.host=g.iri?I.toUnicode(S.host):I.toASCII(S.host.replace(E.PCT_ENCODED,J).toLowerCase())}catch(oe){S.error=S.error||"Host's domain name can not be converted to "+(g.iri?"Unicode":"ASCII")+" via punycode: "+oe}}ie(S,E),g.reference!=="suffix"&&S.scheme&&(M.push(S.scheme),M.push(":"));var G=Qt(S,g);if(G!==void 0&&(g.reference!=="suffix"&&M.push("//"),M.push(G),S.path&&S.path.charAt(0)!=="/"&&M.push("/")),S.path!==void 0){var B=S.path;!g.absolutePath&&(!A||!A.absolutePath)&&(B=Be(B)),G===void 0&&(B=B.replace(/^\/\//,"/%2F")),M.push(B)}return S.query!==void 0&&(M.push("?"),M.push(S.query)),S.fragment!==void 0&&(M.push("#"),M.push(S.fragment)),M.join("")}function Rt(S,g){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},M=arguments[3],A={};return M||(S=Re(Ce(S,E),E),g=Re(Ce(g,E),E)),E=E||{},!E.tolerant&&g.scheme?(A.scheme=g.scheme,A.userinfo=g.userinfo,A.host=g.host,A.port=g.port,A.path=Be(g.path||""),A.query=g.query):(g.userinfo!==void 0||g.host!==void 0||g.port!==void 0?(A.userinfo=g.userinfo,A.host=g.host,A.port=g.port,A.path=Be(g.path||""),A.query=g.query):(g.path?(g.path.charAt(0)==="/"?A.path=Be(g.path):((S.userinfo!==void 0||S.host!==void 0||S.port!==void 0)&&!S.path?A.path="/"+g.path:S.path?A.path=S.path.slice(0,S.path.lastIndexOf("/")+1)+g.path:A.path=g.path,A.path=Be(A.path)),A.query=g.query):(A.path=S.path,g.query!==void 0?A.query=g.query:A.query=S.query),A.userinfo=S.userinfo,A.host=S.host,A.port=S.port),A.scheme=S.scheme),A.fragment=g.fragment,A}function tn(S,g,E){var M=c({scheme:"null"},E);return Ce(Rt(Re(S,M),Re(g,M),M,!0),M)}function gt(S,g){return typeof S=="string"?S=Ce(Re(S,g),g):o(S)==="object"&&(S=Re(Ce(S,g),g)),S}function nn(S,g,E){return typeof S=="string"?S=Ce(Re(S,E),E):o(S)==="object"&&(S=Ce(S,E)),typeof g=="string"?g=Ce(Re(g,E),E):o(g)==="object"&&(g=Ce(g,E)),S===g}function In(S,g){return S&&S.toString().replace(!g||!g.iri?l.ESCAPE:f.ESCAPE,F)}function je(S,g){return S&&S.toString().replace(!g||!g.iri?l.PCT_ENCODED:f.PCT_ENCODED,J)}var vt={scheme:"http",domainHost:!0,parse:function(g,E){return g.host||(g.error=g.error||"HTTP URIs must have a host."),g},serialize:function(g,E){var M=String(g.scheme).toLowerCase()==="https";return(g.port===(M?443:80)||g.port==="")&&(g.port=void 0),g.path||(g.path="/"),g}},uo={scheme:"https",domainHost:vt.domainHost,parse:vt.parse,serialize:vt.serialize};function lo(S){return typeof S.secure=="boolean"?S.secure:String(S.scheme).toLowerCase()==="wss"}var rn={scheme:"ws",domainHost:!0,parse:function(g,E){var M=g;return M.secure=lo(M),M.resourceName=(M.path||"/")+(M.query?"?"+M.query:""),M.path=void 0,M.query=void 0,M},serialize:function(g,E){if((g.port===(lo(g)?443:80)||g.port==="")&&(g.port=void 0),typeof g.secure=="boolean"&&(g.scheme=g.secure?"wss":"ws",g.secure=void 0),g.resourceName){var M=g.resourceName.split("?"),A=m(M,2),G=A[0],B=A[1];g.path=G&&G!=="/"?G:void 0,g.query=B,g.resourceName=void 0}return g.fragment=void 0,g}},fo={scheme:"wss",domainHost:rn.domainHost,parse:rn.parse,serialize:rn.serialize},Vs={},ho="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Xe="[0-9A-Fa-f]",Fs=i(i("%[EFef]"+Xe+"%"+Xe+Xe+"%"+Xe+Xe)+"|"+i("%[89A-Fa-f]"+Xe+"%"+Xe+Xe)+"|"+i("%"+Xe+Xe)),Ls="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",qs="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Hs=r(qs,'[\\"\\\\]'),Us="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Ks=new RegExp(ho,"g"),It=new RegExp(Fs,"g"),Gs=new RegExp(r("[^]",Ls,"[\\.]",'[\\"]',Hs),"g"),po=new RegExp(r("[^]",ho,Us),"g"),Bs=po;function Ir(S){var g=J(S);return g.match(Ks)?g:S}var mo={scheme:"mailto",parse:function(g,E){var M=g,A=M.to=M.path?M.path.split(","):[];if(M.path=void 0,M.query){for(var G=!1,B={},oe=M.query.split("&"),ue=0,me=oe.length;ue<me;++ue){var re=oe[ue].split("=");switch(re[0]){case"to":for(var ce=re[1].split(","),ye=0,W=ce.length;ye<W;++ye)A.push(ce[ye]);break;case"subject":M.subject=je(re[1],E);break;case"body":M.body=je(re[1],E);break;default:G=!0,B[je(re[0],E)]=je(re[1],E);break}}G&&(M.headers=B)}M.query=void 0;for(var he=0,_e=A.length;he<_e;++he){var de=A[he].split("@");if(de[0]=je(de[0]),E.unicodeSupport)de[1]=je(de[1],E).toLowerCase();else try{de[1]=I.toASCII(je(de[1],E).toLowerCase())}catch(ft){M.error=M.error||"Email address's domain name can not be converted to ASCII via punycode: "+ft}A[he]=de.join("@")}return M},serialize:function(g,E){var M=g,A=s(g.to);if(A){for(var G=0,B=A.length;G<B;++G){var oe=String(A[G]),ue=oe.lastIndexOf("@"),me=oe.slice(0,ue).replace(It,Ir).replace(It,a).replace(Gs,F),re=oe.slice(ue+1);try{re=E.iri?I.toUnicode(re):I.toASCII(je(re,E).toLowerCase())}catch(he){M.error=M.error||"Email address's domain name can not be converted to "+(E.iri?"Unicode":"ASCII")+" via punycode: "+he}A[G]=me+"@"+re}M.path=A.join(",")}var ce=g.headers=g.headers||{};g.subject&&(ce.subject=g.subject),g.body&&(ce.body=g.body);var ye=[];for(var W in ce)ce[W]!==Vs[W]&&ye.push(W.replace(It,Ir).replace(It,a).replace(po,F)+"="+ce[W].replace(It,Ir).replace(It,a).replace(Bs,F));return ye.length&&(M.query=ye.join("&")),M}},Xs=/^([^\:]+)\:(.*)/,yo={scheme:"urn",parse:function(g,E){var M=g.path&&g.path.match(Xs),A=g;if(M){var G=E.scheme||A.scheme||"urn",B=M[1].toLowerCase(),oe=M[2],ue=G+":"+(E.nid||B),me=V[ue];A.nid=B,A.nss=oe,A.path=void 0,me&&(A=me.parse(A,E))}else A.error=A.error||"URN can not be parsed.";return A},serialize:function(g,E){var M=E.scheme||g.scheme||"urn",A=g.nid,G=M+":"+(E.nid||A),B=V[G];B&&(g=B.serialize(g,E));var oe=g,ue=g.nss;return oe.path=(A||E.nid)+":"+ue,oe}},Zs=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,go={scheme:"urn:uuid",parse:function(g,E){var M=g;return M.uuid=M.nss,M.nss=void 0,!E.tolerant&&(!M.uuid||!M.uuid.match(Zs))&&(M.error=M.error||"UUID is not valid."),M},serialize:function(g,E){var M=g;return M.nss=(g.uuid||"").toLowerCase(),M}};V[vt.scheme]=vt,V[uo.scheme]=uo,V[rn.scheme]=rn,V[fo.scheme]=fo,V[mo.scheme]=mo,V[yo.scheme]=yo,V[go.scheme]=go,n.SCHEMES=V,n.pctEncChar=F,n.pctDecChars=J,n.parse=Re,n.removeDotSegments=Be,n.serialize=Ce,n.resolveComponents=Rt,n.resolve=tn,n.normalize=gt,n.equal=nn,n.escapeComponent=In,n.unescapeComponent=je,Object.defineProperty(n,"__esModule",{value:!0})})})(qd,mr);Object.defineProperty(Pi,"__esModule",{value:!0});const ms=mr;ms.code='require("ajv/dist/runtime/uri").default';Pi.default=ms;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Ue;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var n=te;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=An,i=Mn,o=kt,a=Ae,s=te,c=be,u=On,l=ae,f=Ld,m=Pi,p=(j,N)=>new RegExp(j,N);p.code="new RegExp";const $=["removeAdditional","useDefaults","coerceTypes"],v=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),y={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},h={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},w=200;function x(j){var N,D,T,d,b,I,V,F,J,ie,pe,Ge,Ct,Wt,Jt,Re,Qt,Ot,At,Mt,en,Be,Ce,Rt,tn;const gt=j.strict,nn=(N=j.code)===null||N===void 0?void 0:N.optimize,In=nn===!0||nn===void 0?1:nn||0,je=(T=(D=j.code)===null||D===void 0?void 0:D.regExp)!==null&&T!==void 0?T:p,vt=(d=j.uriResolver)!==null&&d!==void 0?d:m.default;return{strictSchema:(I=(b=j.strictSchema)!==null&&b!==void 0?b:gt)!==null&&I!==void 0?I:!0,strictNumbers:(F=(V=j.strictNumbers)!==null&&V!==void 0?V:gt)!==null&&F!==void 0?F:!0,strictTypes:(ie=(J=j.strictTypes)!==null&&J!==void 0?J:gt)!==null&&ie!==void 0?ie:"log",strictTuples:(Ge=(pe=j.strictTuples)!==null&&pe!==void 0?pe:gt)!==null&&Ge!==void 0?Ge:"log",strictRequired:(Wt=(Ct=j.strictRequired)!==null&&Ct!==void 0?Ct:gt)!==null&&Wt!==void 0?Wt:!1,code:j.code?{...j.code,optimize:In,regExp:je}:{optimize:In,regExp:je},loopRequired:(Jt=j.loopRequired)!==null&&Jt!==void 0?Jt:w,loopEnum:(Re=j.loopEnum)!==null&&Re!==void 0?Re:w,meta:(Qt=j.meta)!==null&&Qt!==void 0?Qt:!0,messages:(Ot=j.messages)!==null&&Ot!==void 0?Ot:!0,inlineRefs:(At=j.inlineRefs)!==null&&At!==void 0?At:!0,schemaId:(Mt=j.schemaId)!==null&&Mt!==void 0?Mt:"$id",addUsedSchema:(en=j.addUsedSchema)!==null&&en!==void 0?en:!0,validateSchema:(Be=j.validateSchema)!==null&&Be!==void 0?Be:!0,validateFormats:(Ce=j.validateFormats)!==null&&Ce!==void 0?Ce:!0,unicodeRegExp:(Rt=j.unicodeRegExp)!==null&&Rt!==void 0?Rt:!0,int32range:(tn=j.int32range)!==null&&tn!==void 0?tn:!0,uriResolver:vt}}class _{constructor(N={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,N=this.opts={...N,...x(N)};const{es5:D,lines:T}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:v,es5:D,lines:T}),this.logger=Q(N.logger);const d=N.validateFormats;N.validateFormats=!1,this.RULES=(0,o.getRules)(),O.call(this,y,N,"NOT SUPPORTED"),O.call(this,h,N,"DEPRECATED","warn"),this._metaOpts=K.call(this),N.formats&&R.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),N.keywords&&L.call(this,N.keywords),typeof N.meta=="object"&&this.addMetaSchema(N.meta),k.call(this),N.validateFormats=d}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:N,meta:D,schemaId:T}=this.opts;let d=f;T==="id"&&(d={...f},d.id=d.$id,delete d.$id),D&&N&&this.addMetaSchema(d,d[T],!1)}defaultMeta(){const{meta:N,schemaId:D}=this.opts;return this.opts.defaultMeta=typeof N=="object"?N[D]||N:void 0}validate(N,D){let T;if(typeof N=="string"){if(T=this.getSchema(N),!T)throw new Error(`no schema with key or ref "${N}"`)}else T=this.compile(N);const d=T(D);return"$async"in T||(this.errors=T.errors),d}compile(N,D){const T=this._addSchema(N,D);return T.validate||this._compileSchemaEnv(T)}compileAsync(N,D){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:T}=this.opts;return d.call(this,N,D);async function d(ie,pe){await b.call(this,ie.$schema);const Ge=this._addSchema(ie,pe);return Ge.validate||I.call(this,Ge)}async function b(ie){ie&&!this.getSchema(ie)&&await d.call(this,{$ref:ie},!0)}async function I(ie){try{return this._compileSchemaEnv(ie)}catch(pe){if(!(pe instanceof i.default))throw pe;return V.call(this,pe),await F.call(this,pe.missingSchema),I.call(this,ie)}}function V({missingSchema:ie,missingRef:pe}){if(this.refs[ie])throw new Error(`AnySchema ${ie} is loaded but ${pe} cannot be resolved`)}async function F(ie){const pe=await J.call(this,ie);this.refs[ie]||await b.call(this,pe.$schema),this.refs[ie]||this.addSchema(pe,ie,D)}async function J(ie){const pe=this._loading[ie];if(pe)return pe;try{return await(this._loading[ie]=T(ie))}finally{delete this._loading[ie]}}}addSchema(N,D,T,d=this.opts.validateSchema){if(Array.isArray(N)){for(const I of N)this.addSchema(I,void 0,T,d);return this}let b;if(typeof N=="object"){const{schemaId:I}=this.opts;if(b=N[I],b!==void 0&&typeof b!="string")throw new Error(`schema ${I} must be string`)}return D=(0,c.normalizeId)(D||b),this._checkUnique(D),this.schemas[D]=this._addSchema(N,T,D,d,!0),this}addMetaSchema(N,D,T=this.opts.validateSchema){return this.addSchema(N,D,!0,T),this}validateSchema(N,D){if(typeof N=="boolean")return!0;let T;if(T=N.$schema,T!==void 0&&typeof T!="string")throw new Error("$schema must be a string");if(T=T||this.opts.defaultMeta||this.defaultMeta(),!T)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const d=this.validate(T,N);if(!d&&D){const b="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(b);else throw new Error(b)}return d}getSchema(N){let D;for(;typeof(D=P.call(this,N))=="string";)N=D;if(D===void 0){const{schemaId:T}=this.opts,d=new a.SchemaEnv({schema:{},schemaId:T});if(D=a.resolveSchema.call(this,d,N),!D)return;this.refs[N]=D}return D.validate||this._compileSchemaEnv(D)}removeSchema(N){if(N instanceof RegExp)return this._removeAllSchemas(this.schemas,N),this._removeAllSchemas(this.refs,N),this;switch(typeof N){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const D=P.call(this,N);return typeof D=="object"&&this._cache.delete(D.schema),delete this.schemas[N],delete this.refs[N],this}case"object":{const D=N;this._cache.delete(D);let T=N[this.opts.schemaId];return T&&(T=(0,c.normalizeId)(T),delete this.schemas[T],delete this.refs[T]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(N){for(const D of N)this.addKeyword(D);return this}addKeyword(N,D){let T;if(typeof N=="string")T=N,typeof D=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),D.keyword=T);else if(typeof N=="object"&&D===void 0){if(D=N,T=D.keyword,Array.isArray(T)&&!T.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(C.call(this,T,D),!D)return(0,l.eachItem)(T,b=>q.call(this,b)),this;H.call(this,D);const d={...D,type:(0,u.getJSONTypes)(D.type),schemaType:(0,u.getJSONTypes)(D.schemaType)};return(0,l.eachItem)(T,d.type.length===0?b=>q.call(this,b,d):b=>d.type.forEach(I=>q.call(this,b,d,I))),this}getKeyword(N){const D=this.RULES.all[N];return typeof D=="object"?D.definition:!!D}removeKeyword(N){const{RULES:D}=this;delete D.keywords[N],delete D.all[N];for(const T of D.rules){const d=T.rules.findIndex(b=>b.keyword===N);d>=0&&T.rules.splice(d,1)}return this}addFormat(N,D){return typeof D=="string"&&(D=new RegExp(D)),this.formats[N]=D,this}errorsText(N=this.errors,{separator:D=", ",dataVar:T="data"}={}){return!N||N.length===0?"No errors":N.map(d=>`${T}${d.instancePath} ${d.message}`).reduce((d,b)=>d+D+b)}$dataMetaSchema(N,D){const T=this.RULES.all;N=JSON.parse(JSON.stringify(N));for(const d of D){const b=d.split("/").slice(1);let I=N;for(const V of b)I=I[V];for(const V in T){const F=T[V];if(typeof F!="object")continue;const{$data:J}=F.definition,ie=I[V];J&&ie&&(I[V]=Z(ie))}}return N}_removeAllSchemas(N,D){for(const T in N){const d=N[T];(!D||D.test(T))&&(typeof d=="string"?delete N[T]:d&&!d.meta&&(this._cache.delete(d.schema),delete N[T]))}}_addSchema(N,D,T,d=this.opts.validateSchema,b=this.opts.addUsedSchema){let I;const{schemaId:V}=this.opts;if(typeof N=="object")I=N[V];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof N!="boolean")throw new Error("schema must be object or boolean")}let F=this._cache.get(N);if(F!==void 0)return F;T=(0,c.normalizeId)(I||T);const J=c.getSchemaRefs.call(this,N,T);return F=new a.SchemaEnv({schema:N,schemaId:V,meta:D,baseId:T,localRefs:J}),this._cache.set(F.schema,F),b&&!T.startsWith("#")&&(T&&this._checkUnique(T),this.refs[T]=F),d&&this.validateSchema(N,!0),F}_checkUnique(N){if(this.schemas[N]||this.refs[N])throw new Error(`schema with key or id "${N}" already exists`)}_compileSchemaEnv(N){if(N.meta?this._compileMetaSchema(N):a.compileSchema.call(this,N),!N.validate)throw new Error("ajv implementation error");return N.validate}_compileMetaSchema(N){const D=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,N)}finally{this.opts=D}}}e.default=_,_.ValidationError=r.default,_.MissingRefError=i.default;function O(j,N,D,T="error"){for(const d in j){const b=d;b in N&&this.logger[T](`${D}: option ${d}. ${j[b]}`)}}function P(j){return j=(0,c.normalizeId)(j),this.schemas[j]||this.refs[j]}function k(){const j=this.opts.schemas;if(j)if(Array.isArray(j))this.addSchema(j);else for(const N in j)this.addSchema(j[N],N)}function R(){for(const j in this.opts.formats){const N=this.opts.formats[j];N&&this.addFormat(j,N)}}function L(j){if(Array.isArray(j)){this.addVocabulary(j);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const N in j){const D=j[N];D.keyword||(D.keyword=N),this.addKeyword(D)}}function K(){const j={...this.opts};for(const N of $)delete j[N];return j}const ne={log(){},warn(){},error(){}};function Q(j){if(j===!1)return ne;if(j===void 0)return console;if(j.log&&j.warn&&j.error)return j;throw new Error("logger must implement log, warn and error methods")}const $e=/^[a-z_$][a-z0-9_$:-]*$/i;function C(j,N){const{RULES:D}=this;if((0,l.eachItem)(j,T=>{if(D.keywords[T])throw new Error(`Keyword ${T} is already defined`);if(!$e.test(T))throw new Error(`Keyword ${T} has invalid name`)}),!!N&&N.$data&&!("code"in N||"validate"in N))throw new Error('$data keyword must have "code" or "validate" function')}function q(j,N,D){var T;const d=N==null?void 0:N.post;if(D&&d)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:b}=this;let I=d?b.post:b.rules.find(({type:F})=>F===D);if(I||(I={type:D,rules:[]},b.rules.push(I)),b.keywords[j]=!0,!N)return;const V={keyword:j,definition:{...N,type:(0,u.getJSONTypes)(N.type),schemaType:(0,u.getJSONTypes)(N.schemaType)}};N.before?z.call(this,I,V,N.before):I.rules.push(V),b.all[j]=V,(T=N.implements)===null||T===void 0||T.forEach(F=>this.addKeyword(F))}function z(j,N,D){const T=j.rules.findIndex(d=>d.keyword===D);T>=0?j.rules.splice(T,0,N):(j.rules.push(N),this.logger.warn(`rule ${D} is not defined`))}function H(j){let{metaSchema:N}=j;N!==void 0&&(j.$data&&this.opts.$data&&(N=Z(N)),j.validateSchema=this.compile(N,!0))}const X={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Z(j){return{anyOf:[j,X]}}})(Ga);var Ni={},ki={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});const Hd={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ti.default=Hd;var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.callRef=Tt.getValidate=void 0;const Ud=Mn,Jo=ee,Oe=te,zt=nt,Qo=Ae,Un=ae,Kd={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:r}=e,{baseId:i,schemaEnv:o,validateName:a,opts:s,self:c}=r,{root:u}=o;if((n==="#"||n==="#/")&&i===u.baseId)return f();const l=Qo.resolveRef.call(c,u,i,n);if(l===void 0)throw new Ud.default(r.opts.uriResolver,i,n);if(l instanceof Qo.SchemaEnv)return m(l);return p(l);function f(){if(o===u)return nr(e,a,o,o.$async);const $=t.scopeValue("root",{ref:u});return nr(e,(0,Oe._)`${$}.validate`,u,u.$async)}function m($){const v=ys(e,$);nr(e,v,$,$.$async)}function p($){const v=t.scopeValue("schema",s.code.source===!0?{ref:$,code:(0,Oe.stringify)($)}:{ref:$}),y=t.name("valid"),h=e.subschema({schema:$,dataTypes:[],schemaPath:Oe.nil,topSchemaRef:v,errSchemaPath:n},y);e.mergeEvaluated(h),e.ok(y)}}};function ys(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0,Oe._)`${n.scopeValue("wrapper",{ref:t})}.validate`}Tt.getValidate=ys;function nr(e,t,n,r){const{gen:i,it:o}=e,{allErrors:a,schemaEnv:s,opts:c}=o,u=c.passContext?zt.default.this:Oe.nil;r?l():f();function l(){if(!s.$async)throw new Error("async schema referenced by sync schema");const $=i.let("valid");i.try(()=>{i.code((0,Oe._)`await ${(0,Jo.callValidateCode)(e,t,u)}`),p(t),a||i.assign($,!0)},v=>{i.if((0,Oe._)`!(${v} instanceof ${o.ValidationError})`,()=>i.throw(v)),m(v),a||i.assign($,!1)}),e.ok($)}function f(){e.result((0,Jo.callValidateCode)(e,t,u),()=>p(t),()=>m(t))}function m($){const v=(0,Oe._)`${$}.errors`;i.assign(zt.default.vErrors,(0,Oe._)`${zt.default.vErrors} === null ? ${v} : ${zt.default.vErrors}.concat(${v})`),i.assign(zt.default.errors,(0,Oe._)`${zt.default.vErrors}.length`)}function p($){var v;if(!o.opts.unevaluated)return;const y=(v=n==null?void 0:n.validate)===null||v===void 0?void 0:v.evaluated;if(o.props!==!0)if(y&&!y.dynamicProps)y.props!==void 0&&(o.props=Un.mergeEvaluated.props(i,y.props,o.props));else{const h=i.var("props",(0,Oe._)`${$}.evaluated.props`);o.props=Un.mergeEvaluated.props(i,h,o.props,Oe.Name)}if(o.items!==!0)if(y&&!y.dynamicItems)y.items!==void 0&&(o.items=Un.mergeEvaluated.items(i,y.items,o.items));else{const h=i.var("items",(0,Oe._)`${$}.evaluated.items`);o.items=Un.mergeEvaluated.items(i,h,o.items,Oe.Name)}}}Tt.callRef=nr;Tt.default=Kd;Object.defineProperty(ki,"__esModule",{value:!0});const Gd=Ti,Bd=Tt,Xd=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Gd.default,Bd.default];ki.default=Xd;var Ci={},Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});const yr=te,dt=yr.operators,gr={maximum:{okStr:"<=",ok:dt.LTE,fail:dt.GT},minimum:{okStr:">=",ok:dt.GTE,fail:dt.LT},exclusiveMaximum:{okStr:"<",ok:dt.LT,fail:dt.GTE},exclusiveMinimum:{okStr:">",ok:dt.GT,fail:dt.LTE}},Zd={message:({keyword:e,schemaCode:t})=>(0,yr.str)`must be ${gr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,yr._)`{comparison: ${gr[e].okStr}, limit: ${t}}`},Yd={keyword:Object.keys(gr),type:"number",schemaType:"number",$data:!0,error:Zd,code(e){const{keyword:t,data:n,schemaCode:r}=e;e.fail$data((0,yr._)`${n} ${gr[t].fail} ${r} || isNaN(${n})`)}};Oi.default=Yd;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});const yn=te,Wd={message:({schemaCode:e})=>(0,yn.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,yn._)`{multipleOf: ${e}}`},Jd={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Wd,code(e){const{gen:t,data:n,schemaCode:r,it:i}=e,o=i.opts.multipleOfPrecision,a=t.let("res"),s=o?(0,yn._)`Math.abs(Math.round(${a}) - ${a}) > 1e-${o}`:(0,yn._)`${a} !== parseInt(${a})`;e.fail$data((0,yn._)`(${r} === 0 || (${a} = ${n}/${r}, ${s}))`)}};Ai.default=Jd;var Mi={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});function gs(e){const t=e.length;let n=0,r=0,i;for(;r<t;)n++,i=e.charCodeAt(r++),i>=55296&&i<=56319&&r<t&&(i=e.charCodeAt(r),(i&64512)===56320&&r++);return n}Ri.default=gs;gs.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Mi,"__esModule",{value:!0});const St=te,Qd=ae,ep=Ri,tp={message({keyword:e,schemaCode:t}){const n=e==="maxLength"?"more":"fewer";return(0,St.str)`must NOT have ${n} than ${t} characters`},params:({schemaCode:e})=>(0,St._)`{limit: ${e}}`},np={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:tp,code(e){const{keyword:t,data:n,schemaCode:r,it:i}=e,o=t==="maxLength"?St.operators.GT:St.operators.LT,a=i.opts.unicode===!1?(0,St._)`${n}.length`:(0,St._)`${(0,Qd.useFunc)(e.gen,ep.default)}(${n})`;e.fail$data((0,St._)`${a} ${o} ${r}`)}};Mi.default=np;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});const rp=ee,vr=te,ip={message:({schemaCode:e})=>(0,vr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,vr._)`{pattern: ${e}}`},op={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:ip,code(e){const{data:t,$data:n,schema:r,schemaCode:i,it:o}=e,a=o.opts.unicodeRegExp?"u":"",s=n?(0,vr._)`(new RegExp(${i}, ${a}))`:(0,rp.usePattern)(e,r);e.fail$data((0,vr._)`!${s}.test(${t})`)}};Ii.default=op;var Di={};Object.defineProperty(Di,"__esModule",{value:!0});const gn=te,ap={message({keyword:e,schemaCode:t}){const n=e==="maxProperties"?"more":"fewer";return(0,gn.str)`must NOT have ${n} than ${t} properties`},params:({schemaCode:e})=>(0,gn._)`{limit: ${e}}`},sp={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:ap,code(e){const{keyword:t,data:n,schemaCode:r}=e,i=t==="maxProperties"?gn.operators.GT:gn.operators.LT;e.fail$data((0,gn._)`Object.keys(${n}).length ${i} ${r}`)}};Di.default=sp;var ji={};Object.defineProperty(ji,"__esModule",{value:!0});const ln=ee,vn=te,cp=ae,up={message:({params:{missingProperty:e}})=>(0,vn.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,vn._)`{missingProperty: ${e}}`},lp={keyword:"required",type:"object",schemaType:"array",$data:!0,error:up,code(e){const{gen:t,schema:n,schemaCode:r,data:i,$data:o,it:a}=e,{opts:s}=a;if(!o&&n.length===0)return;const c=n.length>=s.loopRequired;if(a.allErrors?u():l(),s.strictRequired){const p=e.parentSchema.properties,{definedProperties:$}=e.it;for(const v of n)if((p==null?void 0:p[v])===void 0&&!$.has(v)){const y=a.schemaEnv.baseId+a.errSchemaPath,h=`required property "${v}" is not defined at "${y}" (strictRequired)`;(0,cp.checkStrictMode)(a,h,a.opts.strictRequired)}}function u(){if(c||o)e.block$data(vn.nil,f);else for(const p of n)(0,ln.checkReportMissingProp)(e,p)}function l(){const p=t.let("missing");if(c||o){const $=t.let("valid",!0);e.block$data($,()=>m(p,$)),e.ok($)}else t.if((0,ln.checkMissingProp)(e,n,p)),(0,ln.reportMissingProp)(e,p),t.else()}function f(){t.forOf("prop",r,p=>{e.setParams({missingProperty:p}),t.if((0,ln.noPropertyInData)(t,i,p,s.ownProperties),()=>e.error())})}function m(p,$){e.setParams({missingProperty:p}),t.forOf(p,r,()=>{t.assign($,(0,ln.propertyInData)(t,i,p,s.ownProperties)),t.if((0,vn.not)($),()=>{e.error(),t.break()})},vn.nil)}}};ji.default=lp;var zi={};Object.defineProperty(zi,"__esModule",{value:!0});const _n=te,fp={message({keyword:e,schemaCode:t}){const n=e==="maxItems"?"more":"fewer";return(0,_n.str)`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>(0,_n._)`{limit: ${e}}`},hp={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:fp,code(e){const{keyword:t,data:n,schemaCode:r}=e,i=t==="maxItems"?_n.operators.GT:_n.operators.LT;e.fail$data((0,_n._)`${n}.length ${i} ${r}`)}};zi.default=hp;var Vi={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});const vs=es;vs.code='require("ajv/dist/runtime/equal").default';Rn.default=vs;Object.defineProperty(Vi,"__esModule",{value:!0});const Hr=On,we=te,dp=ae,pp=Rn,mp={message:({params:{i:e,j:t}})=>(0,we.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,we._)`{i: ${e}, j: ${t}}`},yp={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:mp,code(e){const{gen:t,data:n,$data:r,schema:i,parentSchema:o,schemaCode:a,it:s}=e;if(!r&&!i)return;const c=t.let("valid"),u=o.items?(0,Hr.getSchemaTypes)(o.items):[];e.block$data(c,l,(0,we._)`${a} === false`),e.ok(c);function l(){const $=t.let("i",(0,we._)`${n}.length`),v=t.let("j");e.setParams({i:$,j:v}),t.assign(c,!0),t.if((0,we._)`${$} > 1`,()=>(f()?m:p)($,v))}function f(){return u.length>0&&!u.some($=>$==="object"||$==="array")}function m($,v){const y=t.name("item"),h=(0,Hr.checkDataTypes)(u,y,s.opts.strictNumbers,Hr.DataType.Wrong),w=t.const("indices",(0,we._)`{}`);t.for((0,we._)`;${$}--;`,()=>{t.let(y,(0,we._)`${n}[${$}]`),t.if(h,(0,we._)`continue`),u.length>1&&t.if((0,we._)`typeof ${y} == "string"`,(0,we._)`${y} += "_"`),t.if((0,we._)`typeof ${w}[${y}] == "number"`,()=>{t.assign(v,(0,we._)`${w}[${y}]`),e.error(),t.assign(c,!1).break()}).code((0,we._)`${w}[${y}] = ${$}`)})}function p($,v){const y=(0,dp.useFunc)(t,pp.default),h=t.name("outer");t.label(h).for((0,we._)`;${$}--;`,()=>t.for((0,we._)`${v} = ${$}; ${v}--;`,()=>t.if((0,we._)`${y}(${n}[${$}], ${n}[${v}])`,()=>{e.error(),t.assign(c,!1).break(h)})))}}};Vi.default=yp;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});const ni=te,gp=ae,vp=Rn,_p={message:"must be equal to constant",params:({schemaCode:e})=>(0,ni._)`{allowedValue: ${e}}`},$p={keyword:"const",$data:!0,error:_p,code(e){const{gen:t,data:n,$data:r,schemaCode:i,schema:o}=e;r||o&&typeof o=="object"?e.fail$data((0,ni._)`!${(0,gp.useFunc)(t,vp.default)}(${n}, ${i})`):e.fail((0,ni._)`${o} !== ${n}`)}};Fi.default=$p;var Li={};Object.defineProperty(Li,"__esModule",{value:!0});const dn=te,wp=ae,bp=Rn,Sp={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,dn._)`{allowedValues: ${e}}`},Ep={keyword:"enum",schemaType:"array",$data:!0,error:Sp,code(e){const{gen:t,data:n,$data:r,schema:i,schemaCode:o,it:a}=e;if(!r&&i.length===0)throw new Error("enum must have non-empty array");const s=i.length>=a.opts.loopEnum;let c;const u=()=>c??(c=(0,wp.useFunc)(t,bp.default));let l;if(s||r)l=t.let("valid"),e.block$data(l,f);else{if(!Array.isArray(i))throw new Error("ajv implementation error");const p=t.const("vSchema",o);l=(0,dn.or)(...i.map(($,v)=>m(p,v)))}e.pass(l);function f(){t.assign(l,!1),t.forOf("v",o,p=>t.if((0,dn._)`${u()}(${n}, ${p})`,()=>t.assign(l,!0).break()))}function m(p,$){const v=i[$];return typeof v=="object"&&v!==null?(0,dn._)`${u()}(${n}, ${p}[${$}])`:(0,dn._)`${n} === ${v}`}}};Li.default=Ep;Object.defineProperty(Ci,"__esModule",{value:!0});const xp=Oi,Pp=Ai,Np=Mi,kp=Ii,Tp=Di,Cp=ji,Op=zi,Ap=Vi,Mp=Fi,Rp=Li,Ip=[xp.default,Pp.default,Np.default,kp.default,Tp.default,Cp.default,Op.default,Ap.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Mp.default,Rp.default];Ci.default=Ip;var qi={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.validateAdditionalItems=void 0;const Et=te,ri=ae,Dp={message:({params:{len:e}})=>(0,Et.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Et._)`{limit: ${e}}`},jp={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Dp,code(e){const{parentSchema:t,it:n}=e,{items:r}=t;if(!Array.isArray(r)){(0,ri.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}_s(e,r)}};function _s(e,t){const{gen:n,schema:r,data:i,keyword:o,it:a}=e;a.items=!0;const s=n.const("len",(0,Et._)`${i}.length`);if(r===!1)e.setParams({len:t.length}),e.pass((0,Et._)`${s} <= ${t.length}`);else if(typeof r=="object"&&!(0,ri.alwaysValidSchema)(a,r)){const u=n.var("valid",(0,Et._)`${s} <= ${t.length}`);n.if((0,Et.not)(u),()=>c(u)),e.ok(u)}function c(u){n.forRange("i",t.length,s,l=>{e.subschema({keyword:o,dataProp:l,dataPropType:ri.Type.Num},u),a.allErrors||n.if((0,Et.not)(u),()=>n.break())})}}Zt.validateAdditionalItems=_s;Zt.default=jp;var Hi={},Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.validateTuple=void 0;const ea=te,rr=ae,zp=ee,Vp={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return $s(e,"additionalItems",t);n.items=!0,!(0,rr.alwaysValidSchema)(n,t)&&e.ok((0,zp.validateArray)(e))}};function $s(e,t,n=e.schema){const{gen:r,parentSchema:i,data:o,keyword:a,it:s}=e;l(i),s.opts.unevaluated&&n.length&&s.items!==!0&&(s.items=rr.mergeEvaluated.items(r,n.length,s.items));const c=r.name("valid"),u=r.const("len",(0,ea._)`${o}.length`);n.forEach((f,m)=>{(0,rr.alwaysValidSchema)(s,f)||(r.if((0,ea._)`${u} > ${m}`,()=>e.subschema({keyword:a,schemaProp:m,dataProp:m},c)),e.ok(c))});function l(f){const{opts:m,errSchemaPath:p}=s,$=n.length,v=$===f.minItems&&($===f.maxItems||f[t]===!1);if(m.strictTuples&&!v){const y=`"${a}" is ${$}-tuple, but minItems or maxItems/${t} are not specified or different at path "${p}"`;(0,rr.checkStrictMode)(s,y,m.strictTuples)}}}Yt.validateTuple=$s;Yt.default=Vp;Object.defineProperty(Hi,"__esModule",{value:!0});const Fp=Yt,Lp={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Fp.validateTuple)(e,"items")};Hi.default=Lp;var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});const ta=te,qp=ae,Hp=ee,Up=Zt,Kp={message:({params:{len:e}})=>(0,ta.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,ta._)`{limit: ${e}}`},Gp={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Kp,code(e){const{schema:t,parentSchema:n,it:r}=e,{prefixItems:i}=n;r.items=!0,!(0,qp.alwaysValidSchema)(r,t)&&(i?(0,Up.validateAdditionalItems)(e,i):e.ok((0,Hp.validateArray)(e)))}};Ui.default=Gp;var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});const Ve=te,Kn=ae,Bp={message:({params:{min:e,max:t}})=>t===void 0?(0,Ve.str)`must contain at least ${e} valid item(s)`:(0,Ve.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,Ve._)`{minContains: ${e}}`:(0,Ve._)`{minContains: ${e}, maxContains: ${t}}`},Xp={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Bp,code(e){const{gen:t,schema:n,parentSchema:r,data:i,it:o}=e;let a,s;const{minContains:c,maxContains:u}=r;o.opts.next?(a=c===void 0?1:c,s=u):a=1;const l=t.const("len",(0,Ve._)`${i}.length`);if(e.setParams({min:a,max:s}),s===void 0&&a===0){(0,Kn.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(s!==void 0&&a>s){(0,Kn.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,Kn.alwaysValidSchema)(o,n)){let v=(0,Ve._)`${l} >= ${a}`;s!==void 0&&(v=(0,Ve._)`${v} && ${l} <= ${s}`),e.pass(v);return}o.items=!0;const f=t.name("valid");s===void 0&&a===1?p(f,()=>t.if(f,()=>t.break())):a===0?(t.let(f,!0),s!==void 0&&t.if((0,Ve._)`${i}.length > 0`,m)):(t.let(f,!1),m()),e.result(f,()=>e.reset());function m(){const v=t.name("_valid"),y=t.let("count",0);p(v,()=>t.if(v,()=>$(y)))}function p(v,y){t.forRange("i",0,l,h=>{e.subschema({keyword:"contains",dataProp:h,dataPropType:Kn.Type.Num,compositeRule:!0},v),y()})}function $(v){t.code((0,Ve._)`${v}++`),s===void 0?t.if((0,Ve._)`${v} >= ${a}`,()=>t.assign(f,!0).break()):(t.if((0,Ve._)`${v} > ${s}`,()=>t.assign(f,!1).break()),a===1?t.assign(f,!0):t.if((0,Ve._)`${v} >= ${a}`,()=>t.assign(f,!0)))}}};Ki.default=Xp;var ws={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=te,n=ae,r=ee;e.error={message:({params:{property:c,depsCount:u,deps:l}})=>{const f=u===1?"property":"properties";return(0,t.str)`must have ${f} ${l} when property ${c} is present`},params:({params:{property:c,depsCount:u,deps:l,missingProperty:f}})=>(0,t._)`{property: ${c},
    missingProperty: ${f},
    depsCount: ${u},
    deps: ${l}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(c){const[u,l]=o(c);a(c,u),s(c,l)}};function o({schema:c}){const u={},l={};for(const f in c){if(f==="__proto__")continue;const m=Array.isArray(c[f])?u:l;m[f]=c[f]}return[u,l]}function a(c,u=c.schema){const{gen:l,data:f,it:m}=c;if(Object.keys(u).length===0)return;const p=l.let("missing");for(const $ in u){const v=u[$];if(v.length===0)continue;const y=(0,r.propertyInData)(l,f,$,m.opts.ownProperties);c.setParams({property:$,depsCount:v.length,deps:v.join(", ")}),m.allErrors?l.if(y,()=>{for(const h of v)(0,r.checkReportMissingProp)(c,h)}):(l.if((0,t._)`${y} && (${(0,r.checkMissingProp)(c,v,p)})`),(0,r.reportMissingProp)(c,p),l.else())}}e.validatePropertyDeps=a;function s(c,u=c.schema){const{gen:l,data:f,keyword:m,it:p}=c,$=l.name("valid");for(const v in u)(0,n.alwaysValidSchema)(p,u[v])||(l.if((0,r.propertyInData)(l,f,v,p.opts.ownProperties),()=>{const y=c.subschema({keyword:m,schemaProp:v},$);c.mergeValidEvaluated(y,$)},()=>l.var($,!0)),c.ok($))}e.validateSchemaDeps=s,e.default=i})(ws);var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});const bs=te,Zp=ae,Yp={message:"property name must be valid",params:({params:e})=>(0,bs._)`{propertyName: ${e.propertyName}}`},Wp={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Yp,code(e){const{gen:t,schema:n,data:r,it:i}=e;if((0,Zp.alwaysValidSchema)(i,n))return;const o=t.name("valid");t.forIn("key",r,a=>{e.setParams({propertyName:a}),e.subschema({keyword:"propertyNames",data:a,dataTypes:["string"],propertyName:a,compositeRule:!0},o),t.if((0,bs.not)(o),()=>{e.error(!0),i.allErrors||t.break()})}),e.ok(o)}};Gi.default=Wp;var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});const Gn=ee,Le=te,Jp=nt,Bn=ae,Qp={message:"must NOT have additional properties",params:({params:e})=>(0,Le._)`{additionalProperty: ${e.additionalProperty}}`},em={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Qp,code(e){const{gen:t,schema:n,parentSchema:r,data:i,errsCount:o,it:a}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:s,opts:c}=a;if(a.props=!0,c.removeAdditional!=="all"&&(0,Bn.alwaysValidSchema)(a,n))return;const u=(0,Gn.allSchemaProperties)(r.properties),l=(0,Gn.allSchemaProperties)(r.patternProperties);f(),e.ok((0,Le._)`${o} === ${Jp.default.errors}`);function f(){t.forIn("key",i,y=>{!u.length&&!l.length?$(y):t.if(m(y),()=>$(y))})}function m(y){let h;if(u.length>8){const w=(0,Bn.schemaRefOrVal)(a,r.properties,"properties");h=(0,Gn.isOwnProperty)(t,w,y)}else u.length?h=(0,Le.or)(...u.map(w=>(0,Le._)`${y} === ${w}`)):h=Le.nil;return l.length&&(h=(0,Le.or)(h,...l.map(w=>(0,Le._)`${(0,Gn.usePattern)(e,w)}.test(${y})`))),(0,Le.not)(h)}function p(y){t.code((0,Le._)`delete ${i}[${y}]`)}function $(y){if(c.removeAdditional==="all"||c.removeAdditional&&n===!1){p(y);return}if(n===!1){e.setParams({additionalProperty:y}),e.error(),s||t.break();return}if(typeof n=="object"&&!(0,Bn.alwaysValidSchema)(a,n)){const h=t.name("valid");c.removeAdditional==="failing"?(v(y,h,!1),t.if((0,Le.not)(h),()=>{e.reset(),p(y)})):(v(y,h),s||t.if((0,Le.not)(h),()=>t.break()))}}function v(y,h,w){const x={keyword:"additionalProperties",dataProp:y,dataPropType:Bn.Type.Str};w===!1&&Object.assign(x,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(x,h)}}};Mr.default=em;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});const tm=Ue,na=ee,Ur=ae,ra=Mr,nm={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:r,data:i,it:o}=e;o.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&ra.default.code(new tm.KeywordCxt(o,ra.default,"additionalProperties"));const a=(0,na.allSchemaProperties)(n);for(const f of a)o.definedProperties.add(f);o.opts.unevaluated&&a.length&&o.props!==!0&&(o.props=Ur.mergeEvaluated.props(t,(0,Ur.toHash)(a),o.props));const s=a.filter(f=>!(0,Ur.alwaysValidSchema)(o,n[f]));if(s.length===0)return;const c=t.name("valid");for(const f of s)u(f)?l(f):(t.if((0,na.propertyInData)(t,i,f,o.opts.ownProperties)),l(f),o.allErrors||t.else().var(c,!0),t.endIf()),e.it.definedProperties.add(f),e.ok(c);function u(f){return o.opts.useDefaults&&!o.compositeRule&&n[f].default!==void 0}function l(f){e.subschema({keyword:"properties",schemaProp:f,dataProp:f},c)}}};Bi.default=nm;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});const ia=ee,Xn=te,oa=ae,aa=ae,rm={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:r,parentSchema:i,it:o}=e,{opts:a}=o,s=(0,ia.allSchemaProperties)(n),c=s.filter(v=>(0,oa.alwaysValidSchema)(o,n[v]));if(s.length===0||c.length===s.length&&(!o.opts.unevaluated||o.props===!0))return;const u=a.strictSchema&&!a.allowMatchingProperties&&i.properties,l=t.name("valid");o.props!==!0&&!(o.props instanceof Xn.Name)&&(o.props=(0,aa.evaluatedPropsToName)(t,o.props));const{props:f}=o;m();function m(){for(const v of s)u&&p(v),o.allErrors?$(v):(t.var(l,!0),$(v),t.if(l))}function p(v){for(const y in u)new RegExp(v).test(y)&&(0,oa.checkStrictMode)(o,`property ${y} matches pattern ${v} (use allowMatchingProperties)`)}function $(v){t.forIn("key",r,y=>{t.if((0,Xn._)`${(0,ia.usePattern)(e,v)}.test(${y})`,()=>{const h=c.includes(v);h||e.subschema({keyword:"patternProperties",schemaProp:v,dataProp:y,dataPropType:aa.Type.Str},l),o.opts.unevaluated&&f!==!0?t.assign((0,Xn._)`${f}[${y}]`,!0):!h&&!o.allErrors&&t.if((0,Xn.not)(l),()=>t.break())})})}}};Xi.default=rm;var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});const im=ae,om={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:r}=e;if((0,im.alwaysValidSchema)(r,n)){e.fail();return}const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.failResult(i,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Zi.default=om;var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});const am=ee,sm={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:am.validateUnion,error:{message:"must match a schema in anyOf"}};Yi.default=sm;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});const ir=te,cm=ae,um={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,ir._)`{passingSchemas: ${e.passing}}`},lm={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:um,code(e){const{gen:t,schema:n,parentSchema:r,it:i}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(i.opts.discriminator&&r.discriminator)return;const o=n,a=t.let("valid",!1),s=t.let("passing",null),c=t.name("_valid");e.setParams({passing:s}),t.block(u),e.result(a,()=>e.reset(),()=>e.error(!0));function u(){o.forEach((l,f)=>{let m;(0,cm.alwaysValidSchema)(i,l)?t.var(c,!0):m=e.subschema({keyword:"oneOf",schemaProp:f,compositeRule:!0},c),f>0&&t.if((0,ir._)`${c} && ${a}`).assign(a,!1).assign(s,(0,ir._)`[${s}, ${f}]`).else(),t.if(c,()=>{t.assign(a,!0),t.assign(s,f),m&&e.mergeEvaluated(m,ir.Name)})})}}};Wi.default=lm;var Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});const fm=ae,hm={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:r}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const i=t.name("valid");n.forEach((o,a)=>{if((0,fm.alwaysValidSchema)(r,o))return;const s=e.subschema({keyword:"allOf",schemaProp:a},i);e.ok(i),e.mergeEvaluated(s)})}};Ji.default=hm;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0});const _r=te,Ss=ae,dm={message:({params:e})=>(0,_r.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,_r._)`{failingKeyword: ${e.ifClause}}`},pm={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:dm,code(e){const{gen:t,parentSchema:n,it:r}=e;n.then===void 0&&n.else===void 0&&(0,Ss.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const i=sa(r,"then"),o=sa(r,"else");if(!i&&!o)return;const a=t.let("valid",!0),s=t.name("_valid");if(c(),e.reset(),i&&o){const l=t.let("ifClause");e.setParams({ifClause:l}),t.if(s,u("then",l),u("else",l))}else i?t.if(s,u("then")):t.if((0,_r.not)(s),u("else"));e.pass(a,()=>e.error(!0));function c(){const l=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},s);e.mergeEvaluated(l)}function u(l,f){return()=>{const m=e.subschema({keyword:l},s);t.assign(a,s),e.mergeValidEvaluated(m,a),f?t.assign(f,(0,_r._)`${l}`):e.setParams({ifClause:l})}}}};function sa(e,t){const n=e.schema[t];return n!==void 0&&!(0,Ss.alwaysValidSchema)(e,n)}Qi.default=pm;var eo={};Object.defineProperty(eo,"__esModule",{value:!0});const mm=ae,ym={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:n}){t.if===void 0&&(0,mm.checkStrictMode)(n,`"${e}" without "if" is ignored`)}};eo.default=ym;Object.defineProperty(qi,"__esModule",{value:!0});const gm=Zt,vm=Hi,_m=Yt,$m=Ui,wm=Ki,bm=ws,Sm=Gi,Em=Mr,xm=Bi,Pm=Xi,Nm=Zi,km=Yi,Tm=Wi,Cm=Ji,Om=Qi,Am=eo;function Mm(e=!1){const t=[Nm.default,km.default,Tm.default,Cm.default,Om.default,Am.default,Sm.default,Em.default,bm.default,xm.default,Pm.default];return e?t.push(vm.default,$m.default):t.push(gm.default,_m.default),t.push(wm.default),t}qi.default=Mm;var to={},no={};Object.defineProperty(no,"__esModule",{value:!0});const ge=te,Rm={message:({schemaCode:e})=>(0,ge.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,ge._)`{format: ${e}}`},Im={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Rm,code(e,t){const{gen:n,data:r,$data:i,schema:o,schemaCode:a,it:s}=e,{opts:c,errSchemaPath:u,schemaEnv:l,self:f}=s;if(!c.validateFormats)return;i?m():p();function m(){const $=n.scopeValue("formats",{ref:f.formats,code:c.code.formats}),v=n.const("fDef",(0,ge._)`${$}[${a}]`),y=n.let("fType"),h=n.let("format");n.if((0,ge._)`typeof ${v} == "object" && !(${v} instanceof RegExp)`,()=>n.assign(y,(0,ge._)`${v}.type || "string"`).assign(h,(0,ge._)`${v}.validate`),()=>n.assign(y,(0,ge._)`"string"`).assign(h,v)),e.fail$data((0,ge.or)(w(),x()));function w(){return c.strictSchema===!1?ge.nil:(0,ge._)`${a} && !${h}`}function x(){const _=l.$async?(0,ge._)`(${v}.async ? await ${h}(${r}) : ${h}(${r}))`:(0,ge._)`${h}(${r})`,O=(0,ge._)`(typeof ${h} == "function" ? ${_} : ${h}.test(${r}))`;return(0,ge._)`${h} && ${h} !== true && ${y} === ${t} && !${O}`}}function p(){const $=f.formats[o];if(!$){w();return}if($===!0)return;const[v,y,h]=x($);v===t&&e.pass(_());function w(){if(c.strictSchema===!1){f.logger.warn(O());return}throw new Error(O());function O(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function x(O){const P=O instanceof RegExp?(0,ge.regexpCode)(O):c.code.formats?(0,ge._)`${c.code.formats}${(0,ge.getProperty)(o)}`:void 0,k=n.scopeValue("formats",{key:o,ref:O,code:P});return typeof O=="object"&&!(O instanceof RegExp)?[O.type||"string",O.validate,(0,ge._)`${k}.validate`]:["string",O,k]}function _(){if(typeof $=="object"&&!($ instanceof RegExp)&&$.async){if(!l.$async)throw new Error("async format in sync schema");return(0,ge._)`await ${h}(${r})`}return typeof y=="function"?(0,ge._)`${h}(${r})`:(0,ge._)`${h}.test(${r})`}}}};no.default=Im;Object.defineProperty(to,"__esModule",{value:!0});const Dm=no,jm=[Dm.default];to.default=jm;var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.contentVocabulary=Xt.metadataVocabulary=void 0;Xt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Xt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(Ni,"__esModule",{value:!0});const zm=ki,Vm=Ci,Fm=qi,Lm=to,ca=Xt,qm=[zm.default,Vm.default,(0,Fm.default)(),Lm.default,ca.metadataVocabulary,ca.contentVocabulary];Ni.default=qm;var ro={},Es={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(Es);Object.defineProperty(ro,"__esModule",{value:!0});const Vt=te,ii=Es,ua=Ae,Hm=ae,Um={message:({params:{discrError:e,tagName:t}})=>e===ii.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:n}})=>(0,Vt._)`{error: ${e}, tag: ${n}, tagValue: ${t}}`},Km={keyword:"discriminator",type:"object",schemaType:"object",error:Um,code(e){const{gen:t,data:n,schema:r,parentSchema:i,it:o}=e,{oneOf:a}=i;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const s=r.propertyName;if(typeof s!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!a)throw new Error("discriminator: requires oneOf keyword");const c=t.let("valid",!1),u=t.const("tag",(0,Vt._)`${n}${(0,Vt.getProperty)(s)}`);t.if((0,Vt._)`typeof ${u} == "string"`,()=>l(),()=>e.error(!1,{discrError:ii.DiscrError.Tag,tag:u,tagName:s})),e.ok(c);function l(){const p=m();t.if(!1);for(const $ in p)t.elseIf((0,Vt._)`${u} === ${$}`),t.assign(c,f(p[$]));t.else(),e.error(!1,{discrError:ii.DiscrError.Mapping,tag:u,tagName:s}),t.endIf()}function f(p){const $=t.name("valid"),v=e.subschema({keyword:"oneOf",schemaProp:p},$);return e.mergeEvaluated(v,Vt.Name),$}function m(){var p;const $={},v=h(i);let y=!0;for(let _=0;_<a.length;_++){let O=a[_];O!=null&&O.$ref&&!(0,Hm.schemaHasRulesButRef)(O,o.self.RULES)&&(O=ua.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,O==null?void 0:O.$ref),O instanceof ua.SchemaEnv&&(O=O.schema));const P=(p=O==null?void 0:O.properties)===null||p===void 0?void 0:p[s];if(typeof P!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${s}"`);y=y&&(v||h(O)),w(P,_)}if(!y)throw new Error(`discriminator: "${s}" must be required`);return $;function h({required:_}){return Array.isArray(_)&&_.includes(s)}function w(_,O){if(_.const)x(_.const,O);else if(_.enum)for(const P of _.enum)x(P,O);else throw new Error(`discriminator: "properties/${s}" must have "const" or "enum"`)}function x(_,O){if(typeof _!="string"||_ in $)throw new Error(`discriminator: "${s}" values must be unique strings`);$[_]=O}}}};ro.default=Km;const Gm="http://json-schema.org/draft-07/schema#",Bm="http://json-schema.org/draft-07/schema#",Xm="Core schema meta-schema",Zm={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},Ym=["object","boolean"],Wm={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Jm={$schema:Gm,$id:Bm,title:Xm,definitions:Zm,type:Ym,properties:Wm,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=Ga,r=Ni,i=ro,o=Jm,a=["/properties"],s="http://json-schema.org/draft-07/schema";class c extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach($=>this.addVocabulary($)),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const $=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema($,s,!1),this.refs["http://json-schema.org/schema"]=s}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}}e.exports=t=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var u=Ue;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var l=te;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return l._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return l.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return l.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return l.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return l.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return l.CodeGen}});var f=An;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return f.default}});var m=Mn;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return m.default}})})(uh,dr);const Qm=ch(dr);var e0=Object.defineProperty,t0=(e,t,n)=>t in e?e0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,le=(e,t,n)=>(t0(e,typeof t!="symbol"?t+"":t,n),n);function xs(e,t){if(!document.getElementById("PRERENDER_SVG")){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id","PRERENDER_SVG"),r.setAttribute("pointer-events","none"),r.setAttribute("width","0"),r.setAttribute("height","0"),r.setAttribute("style","opacity: 0; position: absolute; top: 0; left: 0; width: 0; height: 0;"),document.body.appendChild(r)}let n=document.getElementById("PRERENDER_SVG");n.innerHTML=e.html(),t(n.children[0]),n.innerHTML=""}function ut(e){let t={x:0,y:0,width:0,height:0};return xs(e,n=>{t=n.getBBox()}),t}function ke(e){return Pe(document.createElementNS("http://www.w3.org/2000/svg",e))}function $n(e,t){const n=ut(e),r=t/Math.max(n.width,n.height),i={x:-n.width*r/2||0,y:-n.height*r/2||0};return e.attr("transform",`translate(${i.x}, ${i.y}) scale(${r||1})`),{scale:r,translate:i}}function Ps(e){const t=ke("g"),n=ke("circle");return n.attr("r",e),n.attr("transform",`translate(${e}, ${e})`),t.append(()=>n.node()),t}function n0(e,t,n=0){const r=ke("g"),i=ke("path");return i.attr("d",`M ${0} ${-(t/2)} L ${e/2-n} ${-(t/2)} A ${n} ${n} 0 0 1 ${e/2} ${-(t/2)+n} L ${e/2} ${t/2-n} A ${n} ${n} 0 0 1 ${e/2-n} ${t/2} L ${-(e/2)+n} ${t/2} A ${n} ${n} 0 0 1 ${-(e/2)} ${t/2-n} L ${-(e/2)} ${-(t/2)+n} A ${n} ${n} 0 0 1 ${-(e/2)+n} ${-(t/2)} Z`),i.attr("transform",`translate(${e/2}, ${t/2})`),r.append(()=>i.node()),r}function r0(e,t,n=0){const r=Ps(t);r.select("circle").attr("fill","none"),r.select("circle").attr("stroke","none");const i=ke("path"),o=[];for(let a=0;a<e;a++){const s=a/e*2*Math.PI-Math.PI/2,c=Math.cos(s)*t,u=Math.sin(s)*t;o.push({x:c,y:u})}return i.attr("d",i0(o,n)),i.attr("transform",`translate(${t}, ${t})`),r.append(()=>i.node()),r}function i0(e,t){const n=[];e=e.slice();for(let r=0;r<e.length;r++){const i=r+1>e.length-1?(r+1)%e.length:r+1,o=r+2>e.length-1?(r+2)%e.length:r+2,a=e[r],s=e[i],c=e[o],u=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)),l=(u-t)/u,f=[((1-l)*a.x+l*s.x).toFixed(1),((1-l)*a.y+l*s.y).toFixed(1)],m=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2)),p=t/m,$=[((1-p)*s.x+p*c.x).toFixed(1),((1-p)*s.y+p*c.y).toFixed(1)];r===e.length-1&&n.unshift("M"+$.join(",")),n.push("L"+f.join(",")),n.push("Q"+s.x+","+s.y+","+$.join(","))}return n.push("Z"),n.join(" ")}const o0=Object.freeze(Object.defineProperty({__proto__:null,Circle:Ps,Polygon:r0,Rectangle:n0,create:ke,getBBox:ut,prerender:xs,transform:$n},Symbol.toStringTag,{value:"Module"}));function a0(e,t,n){return{data:e,lightValue:t,darkValue:n}}function Ut(e,t,n){return{key:e,value:t,condition:n??!0}}function s0(e,t,n,r){return{shape:e,key:t,value:n,condition:r??!0}}function $r(e,t){t.forEach(n=>{var r;if(n.value instanceof Object){if(Zn(e,n.key,((r=n.value.data.renderConfig)==null?void 0:r.theme)??!0?n.value.lightValue:n.value.darkValue,n.condition),!n.value.data.forceSimulation)return;n.value.data.forceSimulation.on(se.ThemeChange,i=>{typeof n.value!="string"&&(i=="light"?Zn(e,n.key,n.value.lightValue,n.condition):i=="dark"&&Zn(e,n.key,n.value.darkValue,n.condition))})}else Zn(e,n.key,n.value,n.condition)})}function Zn(e,t,n,r){t==="class"&&n.split(".").forEach(i=>{e.classed(i,typeof r=="function"?r():r)}),(typeof r=="function"?r():r)&&e.style(t,n)}function Ns(e,t){t.forEach(n=>{n.key==="class"&&n.value.split(".").forEach(r=>{n.shape.classed(r,typeof n.condition=="function"?n.condition(e):n.condition)}),(typeof n.condition=="function"?n.condition(e):n.condition)&&n.shape.style(n.key,n.value)})}function c0(e){const t=ke("path");return t.attr("d",e),t}function ks(e){const t=ke("g");return t.html(e),t}function u0(e,t=[],n=[],r=0){let i={top:0,right:0,bottom:0,left:0};return typeof e=="number"?i={top:e,right:e,bottom:e,left:e}:Array.isArray(e)&&e.length===2?i={top:e[0],right:e[1],bottom:e[0],left:e[1]}:Array.isArray(e)&&e.length===4&&(i={top:e[0],right:e[1],bottom:e[2],left:e[3]}),{padding:i,textStyles:t,backgroundStyles:n,cornerRadius:r}}function oi(e,t){const n=ke("g").classed("tag",!0),r=n.append("text").text(e).attr("dy","0.35em").attr("text-anchor","middle");$r(r,t.textStyles);const i=ut(n),o=i.width,a=i.height,s=t.padding.top,c=t.padding.right,u=t.padding.bottom,l=t.padding.left,f=t.cornerRadius,m=n.append("path").attr("d",`M ${0} ${-(a/2)-s} L ${o/2+c-f} ${-(a/2)-s} A ${f} ${f} 0 0 1 ${o/2+c} ${-(a/2)-s+f} L ${o/2+c} ${a/2+u-f} A ${f} ${f} 0 0 1 ${o/2+c-f} ${a/2+u} L ${-(o/2)-l+f} ${a/2+u} A ${f} ${f} 0 0 1 ${-(o/2)-l} ${a/2+u-f} L ${-(o/2)-l} ${-(a/2)-s+f} A ${f} ${f} 0 0 1 ${-(o/2)-l+f} ${-(a/2)-s} Z`);return $r(m,t.backgroundStyles),r.remove(),n.append(()=>r.node()),n}function or(e,t=[]){const n=ke("g").classed("text",!0),r=n.append("text").text(e);return $r(r,t),n.attr("text-anchor","middle"),n}function Ts(){return"break-line"}var io=(e=>(e.Left="left",e.Center="center",e.Right="right",e))(io||{});function oo(e,t,n,r,i,o,a,s="center",c=[]){return{height:e,width:t,x:n,y:r,dx:i,dy:o,rowCount:a,align:s,rowMargins:c}}function ao(e,t,n=null){const r=ke("g").classed("collection",!0).attr("transform",`translate(${t.x}, ${t.y})`);return l0(e,t,n,r),r}function l0(e,t,n=null,r){const i=(t.height-t.dy*(t.rowCount-1))/t.rowCount;let o=0,a=[];for(let s=0;s<t.rowCount;s++){if(o>e.length-1)return;const c=t.rowMargins[s]||0,u=t.width-c*2,l=r.append("g").attr("id",`row-${s}`).attr("transform",`translate(${c}, ${(i+t.dy)*s})`);o=f0(e,t,n,l,u,o,a,s==t.rowCount-1)}}function f0(e,t,n=null,r,i,o,a,s){const c=[];let u=0,l=o;for(;u<i&&l<e.length;){const m=e[l];if(!m)break;if(typeof m=="string"){l++;break}if(typeof m=="string")break;const p=ut(m).width;if(p>i){a.push(m),l++;continue}if(u+p<i)c.push(m),u+=p+t.dx,l++;else{s&&a.push(m);break}}n&&a.length>0&&(l>=e.length||s)&&(c.push(n),u+=ut(n).width+t.dx),u-=t.dx;let f=0;return c.forEach(m=>{const p=ut(m).width;let $=0;switch(t.align){case"left":$=f+p/2;break;case"center":$=f+p/2+(i-u)/2;break;case"right":$=f+p/2+(i-u);break}m.attr("transform",`translate(${$}, 0)`),r.append(()=>m.node()),f+=p+t.dx}),l}function so(e,t,n=[]){const r=[];e.split(" ").forEach(s=>{s.includes(`
`)?(s.split(`
`).forEach(u=>{r.push(or(u,n)),r.push(Ts())}),r.pop()):r.push(or(s,n))});const o=or("...",n);return ao(r,t,o)}function h0(e,t,n){const r=[];e.forEach(a=>{const s=oi(a,n);r.push(s)});const i=oi("...",n);return ao(r,t,i)}function d0(e,t,n=[]){Array.isArray(t)?t.forEach(r=>la(e,r,n)):la(e,t,n)}function la(e,t,n=[]){const r=`${e.id}-${t}`,i=t/(isNaN(e.shape.scale)?1:e.shape.scale),o=a=>{const s=a*(isNaN(e.shape.scale)?1:e.shape.scale);return Ns(s,n),!0};e.renderConfig&&o(e.renderConfig.scale),e.forceSimulation&&e.forceSimulation.registerOnZoom&&e.forceSimulation.registerOnZoom(r,i,o)}function p0(e,t){var n;t(((n=e.renderConfig)==null?void 0:n.theme)??"light"),e.forceSimulation&&e.forceSimulation.eventStore.on("theme:change",t)}function wr(e){if(!e)return-1;const t=e.indexOf("#")==0,n=e.indexOf("rgb")==0;if(t){const r=e.length==7,i=parseInt(r?e.substring(1,3):e.substring(1,2),16),o=parseInt(r?e.substring(3,5):e.substring(2,3),16),a=parseInt(r?e.substring(5,7):e.substring(3,4),16);return(i*299+o*587+a*114)/1e3/255}else if(n){const r=e.match(/\d+/g);if(!r||r.length<3)return-1;const i=parseInt(r[0]),o=parseInt(r[1]),a=parseInt(r[2]);return(i*299+o*587+a*114)/1e3/255}return-1}function m0(e){return wr(e)>.5}function y0(e){return wr(e)<.5&&wr(e)>=0}function g0(e,t,n,...r){t.forceSimulation&&t.forceSimulation.eventStore.emit(`template:${t.shape.type}:${e}`,t,n,...r)}const Cs=Object.freeze(Object.defineProperty({__proto__:null,Alignment:io,BreakLine:Ts,CollectionStyle:oo,EmitEvent:g0,LODStyle:s0,OnThemeChange:p0,OnZoom:d0,PathShape:c0,SVGShape:ks,Shape:o0,ShapeCollection:ao,ShapeStyle:Ut,TagCollection:h0,TagShape:oi,TagStyle:u0,TextCollection:so,TextShape:or,ThemeStyle:a0,applyLODStyles:Ns,applyStyles:$r,brightness:wr,isDark:y0,isLight:m0},Symbol.toStringTag,{value:"Module"})),v0={shapeSize:200,shapeBuilder:_0};function _0(e){const t=ke("g"),{icon_large:n}=$0(t);return n.classed("hidden",!0),w0(t),b0(e,t),t}function $0(e){const t=ks(`
		<g>
			<path id="border" d="M8.373,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c39.417,-68.271 132.833,-230.073 172.249,-298.344c11.165,-19.338 31.798,-31.25 54.127,-31.25l344.498,0c22.329,-0 42.962,11.912 54.126,31.25c39.417,68.271 132.833,230.073 172.249,298.344c11.165,19.337 11.165,43.162 0,62.5c-39.416,68.271 -132.832,230.073 -172.249,298.344c-11.164,19.337 -31.797,31.25 -54.126,31.25l-344.498,-0c-22.329,-0 -42.962,-11.913 -54.127,-31.25c-39.416,-68.271 -132.832,-230.073 -172.249,-298.344Zm41.667,-0c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" style="fill:#e57373;" />
			<path id="body" d="M50.04,392.094c-11.164,-19.338 -11.164,-43.163 0,-62.5c35.831,-62.06 115.585,-200.199 151.416,-262.26c11.164,-19.337 31.797,-31.25 54.126,-31.25l302.831,0c22.33,0 42.963,11.913 54.127,31.25c35.831,62.061 115.585,200.2 151.416,262.26c11.164,19.337 11.164,43.162 -0,62.5c-35.831,62.06 -115.585,200.199 -151.416,262.259c-11.164,19.338 -31.797,31.25 -54.127,31.25l-302.831,0c-22.329,0 -42.962,-11.912 -54.126,-31.25c-35.831,-62.06 -115.585,-200.199 -151.416,-262.259Z" />
			<path id="icon" d="M392.598,301.417c-0,7.953 6.447,14.4 14.4,14.4c0.003,-0 0.005,-0 0.008,-0c3.817,-0 7.478,-1.516 10.177,-4.215c2.699,-2.699 4.215,-6.36 4.215,-10.177c-0,-1.135 -0,-2.281 -0,-3.416c-0,-3.817 -1.516,-7.478 -4.215,-10.177c-2.699,-2.699 -6.36,-4.215 -10.177,-4.215c-0.003,-0 -0.005,-0 -0.008,-0c-7.953,-0 -14.4,6.447 -14.4,14.4c-0,1.129 -0,2.27 -0,3.4Zm2.242,-47.423c0.2,6.587 5.597,11.823 12.187,11.823c0.003,-0 0.007,-0 0.01,-0c6.556,-0 11.93,-5.202 12.144,-11.755c0.506,-15.54 1.397,-42.915 1.944,-59.729c0.124,-3.806 -1.301,-7.499 -3.949,-10.235c-2.649,-2.736 -6.294,-4.281 -10.102,-4.281c-0.004,-0 -0.008,-0 -0.012,-0c-3.795,-0 -7.429,1.537 -10.072,4.261c-2.643,2.724 -4.07,6.403 -3.955,10.196c0.507,16.785 1.335,44.149 1.805,59.72Z" style="fill:#e57373;fill-rule:nonzero;" />
			<path id="icon_large" d="M371.559,477.859c-0,19.491 15.8,35.291 35.291,35.291c0.002,0 0.004,0 0.005,0c19.491,0 35.292,-15.8 35.292,-35.291c-0,-2.771 -0,-5.568 -0,-8.339c-0,-19.491 -15.801,-35.291 -35.292,-35.291c-0.001,-0 -0.003,-0 -0.005,-0c-19.491,-0 -35.291,15.8 -35.291,35.291c-0,2.771 -0,5.568 -0,8.339Zm5.494,-116.303c0.489,16.181 13.748,29.045 29.936,29.045l0.012,0c16.041,0 29.188,-12.726 29.71,-28.758c1.239,-38.08 3.425,-105.217 4.768,-146.446c0.303,-9.329 -3.19,-18.381 -9.681,-25.088c-6.492,-6.706 -15.426,-10.492 -24.759,-10.492c-0.003,-0 -0.005,-0 -0.007,-0c-9.309,-0 -18.22,3.77 -24.702,10.451c-6.481,6.68 -9.981,15.702 -9.699,25.006c1.243,41.116 3.268,108.114 4.422,146.282Z" style="fill:#e57373;fill-rule:nonzero;" />
		</g>
	`);return e.append(()=>t.node()),e.classed("gly_animated",!0),{border:t.select("#border"),body:t.select("#body"),icon:t.select("#icon"),icon_large:t.select("#icon_large")}}function w0(e){const t=ut(e),n=so("Template Error",oo(100,t.width,0,140,20,20,1),[Ut("class","gly_text.dark"),Ut("font-weight","bold"),Ut("font-size","44pt")]);return e.append(()=>n.node()),n}function b0(e,t){const n=ut(t),r=so((e==null?void 0:e.errorMessage)??"Something went wrong while rendering the template!",oo(250,n.width,0,n.height*.6,15,20,4,io.Center,[80,130,180,230]),[Ut("class","gly_text.dark"),Ut("font-size","32pt")]);return t.append(()=>r.node()),r}class S0{constructor(){le(this,"_errorTemplate",v0),le(this,"_templates",{}),le(this,"failed",[]),le(this,"remoteOrigin","")}get errorTemplate(){return this._errorTemplate}get templates(){return this._templates}add(t,n){this._templates[t]=n}async get(t){const n=t.shape.type;return this.templates[n]?this.templates[n]:this.failed.includes(n)?this.errorTemplate:await this.load(t.shape.url??this.remoteOrigin+n+".js",n).then(()=>{if(this.templates[n])return this.templates[n]})}async load(t,n){this.failed.includes(n)||origin!=""&&await Ys(()=>import(t),[]).then(({default:r})=>{this.add(n,r)}).catch(r=>{console.error(`[graphly-d3] Template "${n}" not founnd - Fetched from "${t}"

Failed with error:
${r} 

Troubleshooting: https://docs.graphly.dev/troubleshooting/`),this.failed.push(n)}).finally(()=>{})}}class E0{constructor(){le(this,"nodes",{})}clear(){this.nodes={}}add(t,n){this.nodes[t]=this.storeNode(n)}remove(t){delete this.nodes[t]}hasNode(t){return this.nodes[t]!==void 0}hasTemplateChange(t,n){const r=this.nodes[t];return r===void 0?!1:r.shape.type!==n.shape.type||r.shape.template!==n.shape.template}hasPayloadChanges(t,n){const r=this.nodes[t];return r?JSON.stringify(r.payload??"")!==JSON.stringify(n.payload??""):!0}storeNode(t){return{shape:{type:Object.assign({},t.shape).type,template:Object.assign({},t.shape).template},payload:t.payload?this.deepCopy(t.payload):void 0}}deepCopy(t){if(t==null)return t;if(t instanceof Array){var n=[];return t.forEach(o=>{n.push(o)}),n.map(o=>this.deepCopy(o))}if(t instanceof Object){var r={...t};for(var i in t)t.hasOwnProperty(i)&&(r[i]=this.deepCopy(t[i]));return r}return t}}var br=(e=>(e.Soft="soft",e.Hard="hard",e))(br||{}),Os=(e=>(e.Soft="soft",e.Hard="hard",e))(Os||{}),Ee=(e=>(e.Solid="solid",e.Dashed="dashed",e.Dotted="dotted",e.Hidden="hidden",e))(Ee||{}),ve=(e=>(e.Head="head",e.Tail="tail",e.Both="both",e))(ve||{}),ar=(e=>(e.Strong="strong",e.Weak="weak",e.Loose="loose",e))(ar||{});const x0=new Qm({allErrors:!0});function P0(e,t,n){var r,i,o,a,s,c,u,l,f;if(!e)return Yn(`[graphly-d3] No "${((r=t.shape)==null?void 0:r.type)??""}" template provided!`);if(!t)return Promise.reject("[graphly-d3] No data provided!");if(!n)return Promise.reject("[graphly-d3] No config provided!");t.renderConfig=n;const m=ke("g");if(m.classed("gly-node",!0).attr("data-id",t.id),!e.shapePayload)console.warn(`[graphly-d3] Template ${(i=t.shape)!=null&&i.type?'"'+t.shape.type+'"':""} has no payload schema defined! 

If you are the author of this template, you can find more details here: https://docs.graphly.dev/template-api/shape_payload`);else{const v=x0.compile(e.shapePayload);if(!v(t.payload))return console.error(`[graphly-d3] Invalid payload for template ${(o=t.shape)!=null&&o.type?'"'+t.shape.type+'"':""}
 • ${(a=v.errors)==null?void 0:a.map(h=>`${h.instancePath} ${h.message}`).join(`
 • `)} 

Troubleshooting: https://docs.graphly.dev/troubleshooting/`),Yn(`"${((s=t.shape)==null?void 0:s.type)??""}" ${(c=v.errors)==null?void 0:c[0].instancePath} ${(u=v.errors)==null?void 0:u[0].message}`,!1)}try{m.append(()=>e.shapeBuilder(t,Cs).node()).attr("data-object","shape")}catch(v){return console.error(`[graphly-d3] Template ${(l=t.shape)!=null&&l.type?'"'+t.shape.type+'"':""} failed rendering with error: 
${v} 

Troubleshooting: https://docs.graphly.dev/troubleshooting/`),Yn(v.message)}const p=(e.shapeSize??300)*t.shape.scale*n.scale;$n(m.select("[data-object=shape]"),p);const $=m.node();return $===null?Yn(`[graphly-d3] Template ${(f=t.shape)!=null&&f.type?'"'+t.shape.type+'"':""} failed rendering!`):Promise.resolve($)}function Yn(e,t=!0){return t&&console.error(e),Promise.reject(e)}function fa(e){var t;if(!e.forceSimulation)return e.shape.failed=!0,null;let r=e.forceSimulation.nodeDataStore.hasNode(e.id)?Pe(this):ke("g");r.classed("gly-node",!0).attr("data-id",e.id);const i=e.forceSimulation.nodeDataStore.hasPayloadChanges(e.id,e),o=e.forceSimulation.nodeDataStore.hasTemplateChange(e.id,e);if(e.forceSimulation.nodeDataStore.add(e.id,e),!i&&!o&&!e.shape.failed)return $n(r.select("[data-object=shape]"),e.shape.scale*(((t=e.shape.template)==null?void 0:t.shapeSize)??300)),r.node();if(r.selectAll("*").remove(),!e.shape.template)return s(`Template "${e.shape.type}" not found!`);return P0(e.shape.template,e,{theme:e.forceSimulation.theme??"light",scale:e.forceSimulation.worldTransform.k??1}).then(c=>{r.append(()=>Pe(c).select("[data-object=shape]").node()).attr("data-object","shape"),e.forceSimulation&&e.forceSimulation.onZoomRegister.filter(u=>u.id.startsWith(e.id)).forEach(u=>{e.forceSimulation&&u.callback(e.forceSimulation.worldTransform.k)}),e.shape.failed=!1,a()}).catch(c=>(console.error(c),s(c))),r.node();function a(){var c,u;const l=ut(r),f=e.shape.scale*(((c=e.shape.template)==null?void 0:c.shapeSize)??300);e.shape.bodyPoints=[];const m=r.select(".gly-body").node(),p=[];if(m&&m.getTotalLength){let v=((u=e.shape)==null?void 0:u.bodyResolution)||32;const y=m.getTotalLength();for(let R=0;R<v;R++){const L=m.getPointAtLength(R/v*y);L.x=Math.round(L.x),L.y=Math.round(L.y),p.push(L)}const h=Math.min(...p.map(R=>R.x)),w=Math.max(...p.map(R=>R.x)),x=Math.min(...p.map(R=>R.y)),_=Math.max(...p.map(R=>R.y)),O=w-h,P=_-x,k={x:l.width/O,y:l.height/P};p.forEach(R=>{var L,K;R.x=(R.x-h)*k.x+l.x-O*k.x/2+f,R.y=(R.y-x)*k.y+l.y-P*k.y/2+f,(K=(L=e.forceSimulation)==null?void 0:L.debug)!=null&&K.enabled&&e.forceSimulation.debug.bodyPoints.enabled&&r.select("[data-object=shape]").append("circle").classed("gly-body-points",!0).attr("cx",R.x+O*k.x/2-f).attr("cy",R.y+P*k.y/2-f).attr("r",Math.max(l.height,l.width)/f*5).attr("fill",e.forceSimulation.debug.bodyPoints.color).attr("stroke","none")}),e.shape.bodyPoints=p}const $=$n(r.select("[data-object=shape]"),f);for(let v of p)v.x=(v.x-f)*$.scale,v.y=(v.y-f)*$.scale}function s(c){var u,l,f;return e.shape.failed=!0,e.errorMessage=c,r.append(()=>e.forceSimulation?e.forceSimulation.templateStore.errorTemplate.shapeBuilder.bind(this)(e,Cs).node():null).attr("data-object","shape"),$n(r.select("[data-object=shape]"),e.shape.scale*(((f=(l=(u=e.forceSimulation)==null?void 0:u.templateStore)==null?void 0:l.errorTemplate)==null?void 0:f.shapeSize)??300)),r.node()}}var se=(e=>(e.NodeClick="node:click",e.NodeDoubleClick="node:doubleclick",e.NodeContextMenu="node:contextmenu",e.NodeDragStart="node:dragstart",e.NodeDragMove="node:dragmove",e.NodeDragEnd="node:dragend",e.LinkClick="link:click",e.LinkDoubleClick="link:doubleclick",e.LinkContextMenu="link:contextmenu",e.LinkDragStart="link:dragstart",e.LinkDragMove="link:dragmove",e.LinkDragEnd="link:dragend",e.EnvironmentClick="environment:click",e.EnvironmentDoubleClick="environment:doubleclick",e.EnvironmentContextMenu="environment:contextmenu",e.EnvironmentMove="environment:move",e.ThemeChange="theme:change",e.SimulationTick="simulation:tick",e.SimulationTickEnd="simulation:tickend",e))(se||{});const N0={["node:click"]:{event:e=>e,node:e=>e},["node:doubleclick"]:{event:e=>e,node:e=>e},["node:contextmenu"]:{event:e=>e,node:e=>e},["node:dragstart"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragmove"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["node:dragend"]:{event:e=>e,node:e=>e,pos:(e,t)=>({x:e,y:t})},["link:click"]:{event:e=>e,link:e=>e},["link:doubleclick"]:{event:e=>e,link:e=>e},["link:contextmenu"]:{event:e=>e,link:e=>e},["link:dragstart"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragmove"]:{event:e=>e,source:e=>e,pos:(e,t)=>({x:e,y:t})},["link:dragend"]:{event:e=>e,source:e=>e,target:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:click"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:doubleclick"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:contextmenu"]:{event:e=>e,pos:(e,t)=>({x:e,y:t})},["environment:move"]:{pos:e=>e},["theme:change"]:{theme:e=>e},["simulation:tick"]:{},["simulation:tickend"]:{}};class As{constructor(){le(this,"register",{})}on(t,n){this.register[t]||(this.register[t]=[]),this.register[t].push({[n.name]:n})}off(t,n){this.register[t]&&(this.register[t]=this.register[t].filter(r=>r[n.name]!==n))}emit(t,...n){if(!this.register[t])return[];const r=[];return this.register[t].forEach(i=>{for(const o in i)r.push(i[o](...n))}),r}}le(As,"events",N0);let Rr=!1,Sr,ai={x:0,y:0};function k0(){return Vu().on("start",(e,t)=>T0.bind(this)(e,t)).on("drag",(e,t)=>C0.bind(this)(e,t)).on("end",(e,t)=>O0.bind(this)(e,t))}function T0(e,t){if(this.eventStore.emit(se.NodeDragStart,e,t,{x:e.x,y:e.y}).includes("newlink"))return A0.bind(this)(e,t);this.draggableNodes&&(this.simulation.alphaTarget(.05).restart(),t.isDraged=!0,t.fx=e.x,t.fy=e.y)}function C0(e,t){if(Rr)return M0.bind(this)(e,t);this.draggableNodes&&(t.fx=e.x,t.fy=e.y,this.eventStore.emit(se.NodeDragMove,e,t,{x:e.x,y:e.y}))}function O0(e,t){if(Rr)return ha.bind(this)(e,t);if(!this.draggableNodes)return ha.bind(this)(e,t);this.draggableNodes&&(this.simulation.alphaTarget(0),t.isDraged=!1,t.fx=null,t.fy=null,this.eventStore.emit(se.NodeDragEnd,e,t,{x:e.x,y:e.y}))}function A0(e,t){ai={x:e.sourceEvent.offsetX/this.worldTransform.k-this.worldTransform.x/this.worldTransform.k-(t.x??0),y:e.sourceEvent.offsetY/this.worldTransform.k-this.worldTransform.y/this.worldTransform.k-(t.y??0)},Rr=!0,Sr=this.selectionGroups.links.append("g").attr("data-object","prelink").classed("gly-prelink",!0),Sr.append("line").attr("data-object","prelink-link-line").classed("gly-link-line",!0).attr("x1",t.x??0).attr("y1",t.y??0).attr("x2",e.x).attr("y2",e.y),this.eventStore.emit(se.LinkDragStart,e,t,{x:e.x,y:e.y})}function M0(e,t){const n={x:e.x+ai.x,y:e.y+ai.y};Sr.select("[data-object='prelink-link-line']").attr("x2",n.x).attr("y2",n.y),this.eventStore.emit(se.LinkDragMove,e,t,{x:e.x,y:e.y})}function ha(e,t){Sr.remove(),Rr=!1;let n=e.sourceEvent.target;if(n==this.svgElement)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y});for(;n.attributes["data-object"]==null;){if(n==null)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(n=n.parentElement,!n)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y})}if(n=n.parentElement,!n)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y});const r=this.graph.nodes.find(i=>{var o;return i.id==((o=n.attributes["data-id"])==null?void 0:o.value)});if(!r)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y});if(r.id==t.id)return this.eventStore.emit(se.LinkDragEnd,e,t,null,{x:e.x,y:e.y});this.eventStore.emit(se.LinkDragEnd,e,t,r,{x:e.x,y:e.y})}function R0(e){e.links=e.links.filter(t=>{const n=typeof t.source=="string"?e.nodes.find(i=>i.id===t.source):e.nodes.find(i=>i.id===t.source.id),r=typeof t.target=="string"?e.nodes.find(i=>i.id===t.target):e.nodes.find(i=>i.id===t.target.id);return!(!n||!r)}),e.nodes.forEach(t=>{const n=[];e.links.forEach(i=>{(i.source==t.id||i.source.id==t.id)&&n.push(i)});const r={};n.forEach(i=>{if(typeof i.target=="object"){const o=typeof i.target=="string"?i.target:i.target.id;r[o]||(r[o]=[]),r[o].push(i)}else r[i.target]||(r[i.target]=[]),r[i.target].push(i)}),Object.keys(r).forEach(i=>{r[i].forEach((o,a)=>{o.i=a}),r[i].sort((o,a)=>(o.index??0)-(a.index??0))})})}async function I0(e){await j0.bind(this)(e),e.nodes.forEach(n=>{n.forceSimulation=this}),z0(e.nodes);const t=this.selectionGroups.nodes.selectAll("[data-object='node']").data(e.nodes,n=>n.id);t.enter().append(fa.bind(this)).attr("data-object","node").style("pointer-events","fill").call(k0.bind(this)()).on("click",(n,r)=>{this.eventStore.emit(se.NodeClick,n,r),n.stopPropagation()}).on("dblclick",(n,r)=>{this.eventStore.emit(se.NodeDoubleClick,n,r),n.stopPropagation()}).on("contextmenu",(n,r)=>{this.eventStore.emit(se.NodeContextMenu,n,r),n.stopPropagation()}).attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).each(n=>{this.deregisterOnZoom(n.id),this.nodeDataStore.remove(n.id)}).remove(),t.each(n=>{t.filter(i=>i.id===n.id).select(fa)}).attr("opacity",1)}function D0(e){const t=this.selectionGroups.links.selectAll("[data-object='link']").data(e.links,i=>pn(i)),n=t.enter().append("g").attr("data-object","link").attr("data-id",i=>pn(i)).classed("gly-link",!0).on("click",(i,o)=>{this.eventStore.emit(se.LinkClick,i,o),i.stopPropagation()}).on("dblclick",(i,o)=>{this.eventStore.emit(se.LinkDoubleClick,i,o),i.stopPropagation()}).on("contextmenu",(i,o)=>{this.eventStore.emit(se.LinkContextMenu,i,o),i.stopPropagation()});n.append("path").attr("data-object","link-line-full").attr("fill","none").attr("stroke","none"),n.append("path").attr("id",i=>`link-path-${pn(i)}`).attr("data-object","link-line").classed("gly-link-line",!0).classed("solid",i=>i.type?i.type===Ee.Solid:!0).classed("dashed",i=>i.type===Ee.Dashed).classed("dotted",i=>i.type===Ee.Dotted).classed("hidden",i=>i.type===Ee.Hidden).style("stroke",i=>i.color??null).style("stroke-width",i=>i.width??null),n.append("path").attr("data-object","link-arrow-head").classed("gly-link-arrow",!0).classed("gly-link-arrow-head",!0).classed("hidden",i=>i.type===Ee.Hidden).style("stroke",i=>i.color??null).style("stroke-width",i=>i.width??null),n.append("path").attr("data-object","link-arrow-tail").classed("gly-link-arrow",!0).classed("gly-link-arrow-tail",!0).classed("hidden",i=>i.type===Ee.Hidden).style("stroke",i=>i.color??null).style("stroke-width",i=>i.width??null),n.append("text").attr("data-object","link-label").classed("gly-link-label",!0).attr("text-anchor","middle").attr("dy","-0.5em").attr("dominant-baseline","central").style("fill",i=>i.color??null).append("textPath").attr("data-object","link-label-path").attr("xlink:href",i=>`#link-path-${pn(i)}`).attr("startOffset","50%").text(i=>i.type!==Ee.Hidden?i.label??"":""),n.attr("opacity",0).transition().duration(this.animationDuration).attr("opacity",1),t.exit().transition().duration(this.animationDuration).attr("opacity",0).remove(),t.attr("opacity",1),t.select("[data-object='link-line']").classed("solid",i=>i.type?i.type===Ee.Solid:!0).classed("dashed",i=>i.type===Ee.Dashed).classed("dotted",i=>i.type===Ee.Dotted).classed("hidden",i=>i.type===Ee.Hidden).style("stroke-width",i=>i.width??null),t.select("[data-object='link-arrow-head']").classed("hidden",i=>i.type===Ee.Hidden).style("stroke-width",i=>i.width??null),t.select("[data-object='link-arrow-tail']").classed("hidden",i=>i.type===Ee.Hidden).style("stroke-width",i=>i.width??null),t.select("[data-object='link-label-path']").text(i=>i.type!==Ee.Hidden?i.label??"":"")}async function j0(e){for(let t in e.nodes){const n=e.nodes[t];await this.templateStore.get(n).then(r=>{n.shape.template=r})}}function z0(e){var t,n,r,i,o,a;for(let s of e){if(s.x||s.y||s.fx||s.fy||(t=s.anchor)!=null&&t.x||(n=s.anchor)!=null&&n.y||(r=s.satellite)!=null&&r.x||(i=s.satellite)!=null&&i.y)continue;if(s.spawn){const l=typeof s.spawn.source=="string"?s.spawn.source:s.spawn.source.id,f=e.find(y=>y.id===l),m={x:(f==null?void 0:f.x)??(f==null?void 0:f.fx)??((o=f==null?void 0:f.anchor)==null?void 0:o.x)??0,y:(f==null?void 0:f.y)??(f==null?void 0:f.fy)??((a=f==null?void 0:f.anchor)==null?void 0:a.y)??0},p=s.spawn.distance,$=s.spawn.angle,v={x:m.x+p*Math.cos($*Math.PI/180-Math.PI/2),y:m.y+p*Math.sin($*Math.PI/180-Math.PI/2)};s.x=v.x,s.y=v.y;continue}const{x:c,y:u}=Ms(e);s.x=c,s.y=u}}function Ms(e,t={x:0,y:0}){return e.find(n=>n.x===t.x&&n.y===t.y)?Ms(e,{x:t.x+1,y:t.y}):t}function pn(e){return e.id||(e.id=Math.random().toString(36).substring(2,34)+Math.random().toString(36).substring(2,34)),e.id?e.id:(typeof e.source=="string"?e.source:e.source.id)+(typeof e.target=="string"?e.target:e.target.id)+e.type+e.directed+e.label+e.strength}function V0(e){const t=Rs(e),n=Is(e),r=si(t,n,ci(e,t,n,.1)),i={start:t,center:r,end:n};if(i)return`M ${i.start.x} ${i.start.y}Q ${i.center.x}, ${i.center.y} ${i.end.x} ${i.end.y}`}function F0(e){const t=co(e,e.padding??10);if(!t)return;const n=t.start.x>t.end.x,r={x:n?t.end.x:t.start.x,y:n?t.end.y:t.start.y},i={x:n?t.start.x:t.end.x,y:n?t.start.y:t.end.y};return`M ${r.x} ${r.y}Q ${t.center.x}, ${t.center.y} ${i.x} ${i.y}`}function da(e,t=ve.Head){if(!e.directed||t==ve.Head&&e.directed!==!0&&t==ve.Head&&e.directed!=ve.Head&&t==ve.Head&&e.directed!=ve.Both||t==ve.Tail&&e.directed!=ve.Tail&&t==ve.Tail&&e.directed!=ve.Both)return"";const n=e.padding??10,r=co(e,n);if(!r)return;const i=t==ve.Head?Math.atan2(r.end.y-r.center.y,r.end.x-r.center.x):Math.atan2(r.start.y-r.center.y,r.start.x-r.center.x),o=10,a=t==ve.Head?{x:r.end.x+o*Math.cos(i+Math.PI/2),y:r.end.y+o*Math.sin(i+Math.PI/2)}:{x:r.start.x+o*Math.cos(i+Math.PI/2),y:r.start.y+o*Math.sin(i+Math.PI/2)},s=t==ve.Head?{x:r.end.x+o*Math.cos(i),y:r.end.y+o*Math.sin(i)}:{x:r.start.x+o*Math.cos(i),y:r.start.y+o*Math.sin(i)},c=t==ve.Head?{x:r.end.x+o*Math.cos(i-Math.PI/2),y:r.end.y+o*Math.sin(i-Math.PI/2)}:{x:r.start.x+o*Math.cos(i-Math.PI/2),y:r.start.y+o*Math.sin(i-Math.PI/2)};return`M ${a.x} ${a.y}L ${s.x} ${s.y}L ${c.x} ${c.y}`}function L0(e){const t=co(e,e.padding??10);if(t)return t.start.x>t.end.x?"0.5em":"-0.5em"}function Rs(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:Ds(e.target,e.source)}function Is(e){return typeof e.source=="string"||typeof e.target=="string"?{x:0,y:0}:Ds(e.source,e.target)}function q0(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function si(e,t,n){const r=q0(e,t);return{x:r.x+((n==null?void 0:n.x)??0),y:r.y-((n==null?void 0:n.y)??0)}}function ci(e,t,n,r){const i=H0(t,n),o=U0(t,n),a=K0(i,o),s=e.curvature!==void 0?e.curvature:r,c=e.curvature!==void 0?1:(e.i??0)+1,u=s*(o/a)*a*c,l=s*(i/a)*a*c;return{x:u,y:l}}function H0(e,t){return t.x-e.x}function U0(e,t){return t.y-e.y}function K0(e,t){return Math.sqrt(e*e+t*t)}function Ds(e,t){const n=(t.x??0)-(e.x??0),r=(t.y??0)-(e.y??0);return Math.sqrt(n*n+r*r)===0?{x:e.x??0,y:e.y??0}:{x:n+(e.x??0),y:r+(e.y??0)}}function co(e,t=0){var n,r;const i=Rs(e),o=Is(e),a=ci(e,i,o,.1);if(typeof e.source=="string"||typeof e.target=="string")return{start:i,end:o,center:a};const s=si({x:e.source.x??0,y:e.source.y??0},{x:e.target.x??0,y:e.target.y??0},a),c=e.directed===!0||e.directed==ve.Head||e.directed==ve.Both?20:0,u=e.directed==ve.Tail||e.directed==ve.Both?20:0,l=ke("g").append("path").attr("d",`M ${i.x} ${i.y}Q ${s.x}, ${s.y} ${o.x} ${o.y}`).node();if(!l)return{start:i,end:o,center:a};const f=e.source.shape.failed?200:((n=e.source.shape.template)==null?void 0:n.shapeSize)??300,m=e.target.shape.failed?200:((r=e.target.shape.template)==null?void 0:r.shapeSize)??300,p=pa(e.source,e.target,e,!1),$=pa(e.source,e.target,e,!0),v=p||(e.source.shape.scale??1)*(f/2),y=$||(e.target.shape.scale??1)*(m/2),h=l.getAttribute("d").includes("NaN")?0:l.getPointAtLength(v+t+u),w=l.getAttribute("d").includes("NaN")?0:l.getPointAtLength(l.getTotalLength()-y-t-c),x=ci(e,h,w,.1),_=si(h,w,x);return{start:{x:h.x,y:h.y},center:{x:_.x,y:_.y},end:{x:w.x,y:w.y}}}function pa(e,t,n,r=!1){var i,o;const a=Pe("[data-id='"+pn(n)+"']").select("[data-object='link-line-full']").node();if(!a||!a.getPointAtLength||!a.getAttribute("d")||a.getAttribute("d").includes("NaN"))return 0;const s=r?t.shape.bodyPoints??[]:e.shape.bodyPoints??[];if(s.length===0)return 0;const c=a.getTotalLength(),u=r?-((((i=t.shape.template)==null?void 0:i.shapeSize)??300)*(t.shape.scale??1))/20:(((o=e.shape.template)==null?void 0:o.shapeSize)??300)*(e.shape.scale??1)/20;let l=r?c:0,f=a.getPointAtLength(l),m={x:0,y:0};r?m={x:f.x-(t.x??0),y:f.y-(t.y??0)}:m={x:f.x-(e.x??0),y:f.y-(e.y??0)};let p=0;for(;ui(m,s)&&l<=c&&p<30;)p++,l+=u,f=a.getPointAtLength(l),r?m={x:f.x-(t.x??0),y:f.y-(t.y??0)}:m={x:f.x-(e.x??0),y:f.y-(e.y??0)};for(p=0;!ui(m,s)&&l>=0&&p<30;)p++,l=r?l+1:l-1,f=a.getPointAtLength(l),r?m={x:f.x-(t.x??0),y:f.y-(t.y??0)}:m={x:f.x-(e.x??0),y:f.y-(e.y??0)};const $=r?(t.shape.scale??1)/(e.shape.scale??1):1;return(r?c-l:l)*$}function ui(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r].x,a=t[r].y,s=t[i].x,c=t[i].y,u=a>e.y!=c>e.y&&e.x<(s-o)*(e.y-a)/(c-a)+o;u&&(n=!n)}return n}function ma(e){return qf().id(n=>n.id).strength(n=>{if(n.strength===void 0)return .3;if(typeof n.strength=="number")return n.strength;switch(n.strength){case ar.Strong:return .5;case ar.Weak:return .3;case ar.Loose:return 0;default:return .3}}).distance(e)}function G0(){return Jf().x(t=>Er(t).x).strength(t=>xr(t))}function B0(){return Qf().y(t=>Er(t).y).strength(t=>xr(t))}function ya(e){return Wf().strength(n=>n.gravity?n.gravity:e)}function Er(e){return e.satellite?{x:e.satellite.x??0,y:e.satellite.y??0}:e.anchor?{x:e.anchor.x??0,y:e.anchor.y??0}:{x:0,y:0}}function xr(e){if(e.satellite)return 6;if(e.anchor)switch(e.anchor.type){case br.Hard:case br.Soft:return 2;default:return 0}return 0}function X0(e){const t=this.graph.nodes;var n=vi().x(r=>r.x).y(r=>r.y).addAll(t);t.forEach(r=>{var i;r.x=r.x||0,r.y=r.y||0;var o=(((i=r.shape.template)==null?void 0:i.shapeSize)??300)*r.shape.scale,a=r.x-o,s=r.x+o,c=r.y-o,u=r.y+o;n.visit((l,f,m,p,$)=>{var v,y,h;if(l.data&&l.data!==r){var w=(r.x??0)-l.data.x,x=(r.y??0)-l.data.y,_=Math.sqrt(w*w+x*x);const O=(((v=r.shape.template)==null?void 0:v.shapeSize)??300)*r.shape.scale;Z0(r,l.data)&&(((y=r.shape.bodyPoints)==null?void 0:y.length)==0||((h=l.data.shape.bodyPoints)==null?void 0:h.length)==0?_<O&&(_=(_-O)/_*e,r.x=r.x||0,r.y=r.y||0,r.x-=w*=_,r.y-=x*=_,l.data.x+=w,l.data.y+=x):Y0(r,l.data)&&(_=(_-O)/_*e,r.x=r.x||0,r.y=r.y||0,r.x-=w*=_,r.y-=x*=_,l.data.x+=w,l.data.y+=x))}return f>s||p<a||m>u||$<c})})}function Z0(e,t){var n,r,i,o;const a={x:e.x??0,y:e.y??0},s=(((r=(n=e.shape)==null?void 0:n.template)==null?void 0:r.shapeSize)??300)/2*(e.shape.scale*1.5),c={x:t.x??0,y:t.y??0},u=(((o=(i=t.shape)==null?void 0:i.template)==null?void 0:o.shapeSize)??300)/2*(t.shape.scale*1.5);return Math.sqrt(Math.pow(a.x-c.x,2)+Math.pow(a.y-c.y,2))<s+u}function Y0(e,t){const n=(e.shape.bodyPoints??[]).map(i=>({x:i.x-(e.x??0),y:i.y-(e.y??0)})),r=(t.shape.bodyPoints??[]).map(i=>({x:i.x-(t.x??0),y:i.y-(t.y??0)}));for(let i=0;i<n.length;i++){const o={x:n[i].x,y:n[i].y};if(ui(o,r))return!0}return!1}function W0(){for(let e in this.graph.nodes)this.graph.nodes[e].isDraged||(J0(this.graph,this.graph.nodes[e]),Q0(this.graph.nodes[e]));this.selectionGroups.nodes.selectAll("[data-object='node']").attr("transform",e=>`translate(${e.x??0},${e.y??0})`),this.selectionGroups.links.selectAll("[data-object='link']").call(e=>{e.select("[data-object='link-line-full']").attr("d",V0),e.select("[data-object='link-line']").attr("d",F0),e.select("[data-object='link-arrow-head']").attr("d",a=>da(a,ve.Head)),e.select("[data-object='link-arrow-tail']").attr("d",a=>da(a,ve.Tail)),e.select("[data-object='link-label']").attr("dy",L0)}),this.simulation.force("forceX").x(e=>Er(e).x).strength(e=>xr(e)),this.simulation.force("forceY").y(e=>Er(e).y).strength(e=>xr(e)),this.eventStore.emit(se.SimulationTick)}function J0(e,t){var n,r,i,o;if(!t.satellite)return;if(typeof t.satellite.source=="string"){const u=e.nodes.find(l=>l.id===t.satellite.source);if(!u)return;t.satellite.source=u}const a=t.satellite.distance??400,s=t.satellite.angle??0,c={x:(((r=(n=t.satellite)==null?void 0:n.source)==null?void 0:r.x)??0)+a*Math.cos(s*Math.PI/180-Math.PI/2),y:(((o=(i=t.satellite)==null?void 0:i.source)==null?void 0:o.y)??0)+a*Math.sin(s*Math.PI/180-Math.PI/2)};t.satellite.x=c.x,t.satellite.y=c.y,t.satellite.type===Os.Hard&&(t.fx=c.x,t.fy=c.y)}function Q0(e){e.satellite||e.anchor&&(e.fx=null,e.fy=null,e.anchor.type===br.Hard&&(e.fx=e.anchor.x,e.fy=e.anchor.y))}function ga(){const e=ah().extent([[0,0],[this.svgElement.clientWidth,this.svgElement.clientHeight]]).scaleExtent([.1,3]).on("zoom",({transform:t})=>js.bind(this)(t));return this.svgSelection.call(e).call(e.transform,Tr.translate(this.worldTransform.x,this.worldTransform.y).scale(this.worldTransform.k)),this.svgSelection.on("dblclick.zoom",null),e}function js(e){if(this.selectionGroups.world.attr("transform",`translate(${e.x}, ${e.y}) scale(${e.k})`),this.worldTransform.k!=e.k){const t=[this.worldTransform.k,e.k].sort();Object.keys(this.onZoomRoutines).forEach(n=>{const r=parseFloat(n);r>t[0]&&r<t[1]&&this.onZoomRoutines[r].forEach(i=>i(e.k))})}this.worldTransform=e,this.eventStore.emit(se.EnvironmentMove,e)}function ey(e,t){if(e.transform)return zs.bind(this)(e.transform,t,e.duration);const n=[];e.boundaries&&n.push(va(e.boundaries)),e.nodes&&n.push(ty(e.nodes)),ny.bind(this)(va(n),t,e.duration,e.padding)}function va(e){let t=e.reduce((o,a)=>Math.min(o,a.x),1/0),n=e.reduce((o,a)=>Math.min(o,a.y),1/0),r=e.reduce((o,a)=>Math.max(o,a.x+a.width),-1/0),i=e.reduce((o,a)=>Math.max(o,a.y+a.height),-1/0);return{x:t,y:n,width:r-t,height:i-n}}function ty(e){const t=bo(e,a=>a.x),n=bo(e,a=>a.y),r=(t[1]??0)-(t[0]??0),i=(n[1]??0)-(n[0]??0),o=Ws(e.map(a=>{var s;return a.shape.scale*(((s=a.shape.template)==null?void 0:s.shapeSize)??300)}))??0;return{x:(t[0]??0)-o/2,y:(n[0]??0)-o/2,width:r+o,height:i+o}}function zs(e,t,n){const r=this.svgElement.clientWidth,i=this.svgElement.clientHeight,o={x:r/2,y:i/2},a={x:-e.x+r/2*(1-e.k)*(e.x/(r/2))+o.x,y:-e.y+i/2*(1-e.k)*(e.y/(i/2))+o.y,k:e.k};ry.bind(this)(a,t,n)}function ny(e,t,n,r){const i=this.svgElement.clientWidth,o=this.svgElement.clientHeight,a=i/o,s=(e.width+(r??0)*2)/(e.height+(r??0)*2),c=a<s?i/(e.width+(r??0)*2):o/(e.height+(r??0)*2),u={x:e.x+e.width/2,y:e.y+e.height/2,k:c};zs.bind(this)(u,t,n)}function ry(e,t,n){isNaN(e.x)||isNaN(e.y)||isNaN(e.k)||this.selectionGroups.world.transition().duration(n??1e3).ease(wf).attr("transform",`translate(${e.x},${e.y}) scale(${e.k})`).on("end",()=>{t(e)})}function iy(){const e=[],t=[];return this.graph.nodes.forEach(n=>{var r,i,o,a,s,c,u,l;const f={id:n.id,x:n.x,y:n.y,shape:{type:n.shape.type,scale:n.shape.scale,url:n.shape.url},gravity:n.gravity,anchor:{type:((r=n.anchor)==null?void 0:r.type)||"",x:((i=n.anchor)==null?void 0:i.x)||0,y:((o=n.anchor)==null?void 0:o.y)||0},satellite:{source:typeof((a=n.satellite)==null?void 0:a.source)=="string"?n.satellite.source:((c=(s=n.satellite)==null?void 0:s.source)==null?void 0:c.id)||"",angle:((u=n.satellite)==null?void 0:u.angle)||0,distance:((l=n.satellite)==null?void 0:l.distance)||0},payload:n.payload};e.push(f)}),this.graph.links.forEach(n=>{const r={source:typeof n.source=="string"?n.source:n.source.id,target:typeof n.target=="string"?n.target:n.target.id,id:n.id,type:n.type,directed:n.directed,label:n.label,strength:n.strength,padding:n.padding,width:n.width,curvature:n.curvature,payload:n.payload};t.push(r)}),{nodes:e,links:t}}class ay{constructor(t){le(this,"debug",{enabled:!1,bodyPoints:{enabled:!0,color:"#00ffff"}}),le(this,"_svgElement"),le(this,"_svgSelection"),le(this,"_simulation"),le(this,"_selectedNodes",[]),le(this,"_zoom"),le(this,"worldTransform",{x:0,y:0,k:1}),le(this,"_onZoomRegister",[]),le(this,"_onZoomRoutines",{}),le(this,"animationDuration",300),le(this,"draggableNodes",!0),le(this,"selectionGroups"),le(this,"graph",{nodes:[],links:[]}),le(this,"templateStore",new S0),le(this,"nodeDataStore",new E0),le(this,"eventStore",new As),le(this,"theme","light"),le(this,"themeChangeObserver",new MutationObserver(n=>{n.forEach(r=>{if(r.attributeName==="class"){const o=r.target.classList.contains("dark")?"dark":"light";this.eventStore.emit(se.ThemeChange,o)}})})),t instanceof SVGElement?(this._svgElement=t,this._svgSelection=Pe(t)):(this._svgSelection=t,this._svgElement=t.node()),this.worldTransform={x:this.svgElement.clientWidth/2,y:this.svgElement.clientHeight/2,k:1},this._simulation=this.createSimulation(),this.selectionGroups=this.createWorld(),this._zoom=ga.bind(this)(),this.setEvents()}get svgElement(){return this._svgElement}set svgElement(t){this._svgElement=t,this._svgSelection=Pe(t),this.selectionGroups=this.createWorld(),this._zoom=ga.bind(this)(),this.themeChangeObserver.disconnect(),this.setEvents(),this.render(this.graph)}get svgSelection(){return this._svgSelection}get simulation(){return this._simulation}get selectedNodes(){return this._selectedNodes}set selectedNodes(t){this._selectedNodes=t,this.selectNodes()}get worldBounds(){const{x:t,y:n,k:r}=this.worldTransform;return{x:-(t/r),y:-(n/r),width:this.svgElement.clientWidth/r,height:this.svgElement.clientHeight/r}}set zoomScaleExtent(t){this._zoom.scaleExtent(t)}set zoomEnabled(t){this._zoom.on("zoom",null),t&&this._zoom.on("zoom",({transform:n})=>js.bind(this)(n))}get onZoomRegister(){return this._onZoomRegister}get onZoomRoutines(){return this._onZoomRoutines}set envGravity(t){this.simulation.force("gravity",ya(t))}set linkDistance(t){this.simulation.force("link",ma(t))}createSimulation(){return Yf().force("link",ma(400)).force("forceX",G0()).force("forceY",B0()).force("gravity",ya(-1e4)).force("shapeCollide",X0.bind(this)).on("tick",W0.bind(this)).on("end",()=>{this.eventStore.emit(se.SimulationTickEnd)})}createWorld(){const t=this.svgSelection.append("g").attr("data-object","world"),n=t.append("g").attr("data-object","links"),r=t.append("g").attr("data-object","nodes");return{world:t,nodes:r,links:n}}setEvents(){function t(n){return{x:this.worldBounds.x+n.offsetX/this.worldTransform.k,y:this.worldBounds.y+n.offsetY/this.worldTransform.k}}this.svgSelection.on("click",n=>this.eventStore.emit(se.EnvironmentClick,n,t.bind(this)(n))),this.svgSelection.on("dblclick",n=>this.eventStore.emit(se.EnvironmentDoubleClick,n,t.bind(this)(n))),this.svgSelection.on("contextmenu",n=>this.eventStore.emit(se.EnvironmentContextMenu,n,t.bind(this)(n))),this.themeChangeObserver.observe(this.svgElement,{attributes:!0})}registerOnZoom(t,n,r){this.deregisterOnZoom(t),this._onZoomRegister.push({id:t,threshold:n,callback:r}),this._onZoomRoutines={},this._onZoomRegister.forEach(i=>{this._onZoomRoutines[i.threshold]||(this._onZoomRoutines[i.threshold]=[]),this._onZoomRoutines[i.threshold].push(i.callback)})}deregisterOnZoom(t){this._onZoomRegister=this._onZoomRegister.filter(({id:n})=>n!==t)}selectNodes(){this.selectionGroups.nodes.selectAll(".gly-selectable").classed("gly-selected",!1),this.selectionGroups.nodes.selectAll("[data-object='node']").filter(t=>this.selectedNodes.includes(t.id)).selectAll(".gly-selectable").classed("gly-selected",!0)}async render(t,n=.05,r=!1){this.theme=this.svgElement.classList.contains("dark")?"dark":"light",r&&(this.nodeDataStore.clear(),this.selectionGroups.nodes.selectAll("*").remove(),this.selectionGroups.links.selectAll("*").remove()),this.graph=t,await I0.bind(this)(this.graph).then(()=>{R0(t),D0.bind(this)(this.graph),this.simulation.nodes(this.graph.nodes),this.simulation.force("link").links(t.links),this.simulation.alphaTarget(n).restart(),setTimeout(()=>{this.simulation.alphaTarget(0)},100),this.selectNodes()})}snapshot(t=0){return this.simulation.tick(t),this.svgElement.cloneNode(!0)}exportGraph(){return iy.bind(this)()}moveTo(t){ey.bind(this)(t,n=>{this.svgSelection.call(this._zoom.transform,Tr.translate(n.x,n.y).scale(n.k))})}on(t,n){this.eventStore.on(t,n)}}export{br as A,se as E,ay as F,ar as L,Os as S,Cs as T,ve as a,Ee as b,P0 as r};
